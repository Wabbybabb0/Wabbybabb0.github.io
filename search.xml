<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>AT24C02</title>
    <url>/2022/11/27/at24c02/</url>
    <content><![CDATA[<h1 id="ä¸€-å­˜å‚¨å™¨ä»‹ç»"><a href="#ä¸€-å­˜å‚¨å™¨ä»‹ç»" class="headerlink" title="ä¸€.å­˜å‚¨å™¨ä»‹ç»"></a>ä¸€.å­˜å‚¨å™¨ä»‹ç»</h1><h2 id="1-æ˜“å¤±æ€§å­˜å‚¨å™¨-RAM"><a href="#1-æ˜“å¤±æ€§å­˜å‚¨å™¨-RAM" class="headerlink" title="1.æ˜“å¤±æ€§å­˜å‚¨å™¨/RAM"></a>1.æ˜“å¤±æ€§å­˜å‚¨å™¨/RAM</h2><p>å…¨ç§°ï¼šRamdomAccessMemory</p>
<p>ç™¾åº¦ç™¾ç§‘ï¼š<strong>å®ƒåœ¨ä»»ä½•æ—¶å€™éƒ½å¯ä»¥è¯»å†™</strong>ï¼ŒRAMé€šå¸¸æ˜¯ä½œä¸ºæ“ä½œç³»ç»Ÿæˆ–å…¶ä»–æ­£åœ¨è¿è¡Œç¨‹åºçš„ä¸´æ—¶å­˜å‚¨ä»‹è´¨(å¯ç§°ä½œç³»ç»Ÿå†…å­˜)ã€‚ä¸è¿‡ï¼Œ<strong>å½“ç”µæºå…³é—­æ—¶RAMä¸èƒ½ä¿ç•™æ•°æ®</strong>ï¼Œå¦‚æœéœ€è¦ä¿å­˜æ•°æ®ï¼Œå°±å¿…é¡»æŠŠå®ƒä»¬å†™å…¥åˆ°ä¸€ä¸ª<strong>é•¿æœŸçš„å­˜å‚¨å™¨</strong>(å¦‚ç¡¬ç›˜)ä¸­ã€‚</p>
<p>â‘ SRAM(é™æ€RAM) steady</p>
<ul>
<li>ç”¨ç”µè·¯å‚¨å­˜ï¼ŒCPUç”¨åˆ°ï¼Œé€Ÿåº¦æœ€å¿«ï¼Œå®¹é‡å°</li>
</ul>
<p>â‘¡DRAM(åŠ¨æ€RAM)</p>
<ul>
<li>ç”¨ç”µå®¹å……æ”¾ç”µçš„é«˜ä½ç”µå¹³æ¥å­˜å‚¨ï¼Œé€šå¸¸é…ä¸€ä¸ªæ‰«æç”µè·¯ï¼Œç»™å®ƒè¡¥ç”µ</li>
</ul>
<h2 id="2-éæ˜“å¤±æ€§å­˜å‚¨å™¨-ROM"><a href="#2-éæ˜“å¤±æ€§å­˜å‚¨å™¨-ROM" class="headerlink" title="2.éæ˜“å¤±æ€§å­˜å‚¨å™¨/ROM"></a>2.éæ˜“å¤±æ€§å­˜å‚¨å™¨/ROM</h2><p>å…¨ç§°ï¼šnon-volatile memory</p>
<p>ç™¾åº¦ç™¾ç§‘ï¼šæ˜¯æŒ‡å½“<strong>ç”µæµå…³æ‰å</strong>ï¼Œ<strong>æ‰€å­˜å‚¨çš„æ•°æ®ä¸ä¼šæ¶ˆå¤±</strong>çš„ç”µè„‘å­˜å‚¨å™¨ï¼Œç¼ºç‚¹æ˜¯å­˜å‚¨æ¯”è¾ƒæ…¢</p>
<p>â‘ Mask ROMï¼ˆæ©è†œROMï¼‰ï¼šåªè¯»ä¸å†™</p>
<p><img src="/../../../../medias/blog_picture/51/67.png"></p>
<p>â‘¡PROM(å¯ç¼–ç¨‹ROM)ï¼šåªèƒ½å†™ä¸€æ¬¡</p>
<p><img src="/../../../../medias/blog_picture/51/68.png"></p>
<ul>
<li>ç¼–ç¨‹æ—¶å·¦è¾¹ç»™é«˜ç”µå¹³ã€ä¸‹è¾¹ç»™0å¯ä»¥æŠŠè“è‰²çš„äºŒæç®¡<strong>å‡»ç©¿</strong>ï¼Œå®ç°å¯å†™ï¼Œæ‰€ä»¥ä¹Ÿå«<strong>çƒ§å½•ç¨‹åº</strong>å“ˆå“ˆ</li>
</ul>
<p>â‘¢EPROM(å¯æ“¦é™¤å¯ç¼–ç¨‹ROM)ï¼šå¯å†™</p>
<p>â‘£E2PROM(ç”µå¯æ“¦é™¤å¯ç¼–ç¨‹ROM)ï¼š5Vå‡ æ¯«ç§’å°±èƒ½æ“¦é™¤</p>
<p>â‘¤Flash(å†…å­˜)ï¼š</p>
<p>â‘¥ç¡¬ç›˜ã€è½¯ç›˜ã€å…‰ç›˜ç­‰ï¼šé€šè¿‡ç£ä»‹è´¨ä¼ é€’</p>
<h1 id="äºŒ-AT24C02ä»‹ç»"><a href="#äºŒ-AT24C02ä»‹ç»" class="headerlink" title="äºŒ.AT24C02ä»‹ç»"></a>äºŒ.AT24C02ä»‹ç»</h1><p><img src="/../../../../medias/blog_picture/51/69.png"></p>
<h1 id="ä¸‰-I2C"><a href="#ä¸‰-I2C" class="headerlink" title="ä¸‰.I2C"></a>ä¸‰.I2C</h1><p><img src="/../../../../medias/blog_picture/51/70.png"></p>
<h2 id="1-èµ·å§‹-ç»ˆæ­¢"><a href="#1-èµ·å§‹-ç»ˆæ­¢" class="headerlink" title="1.èµ·å§‹&amp;ç»ˆæ­¢"></a>1.èµ·å§‹&amp;ç»ˆæ­¢</h2><p><img src="/../../../../medias/blog_picture/51/71.png"></p>
<h2 id="2-å‘é€-æ¥å—å­—èŠ‚"><a href="#2-å‘é€-æ¥å—å­—èŠ‚" class="headerlink" title="2.å‘é€/æ¥å—å­—èŠ‚"></a>2.å‘é€/æ¥å—å­—èŠ‚</h2><p><img src="/../../../../medias/blog_picture/51/72.png"></p>
<p><img src="/../../../../medias/blog_picture/51/73.png"></p>
<p>ğŸ‘†æ³¨æ„ä¸»æœºå’Œä»æœºï¼Œåœ¨SDAä¸­ç´«è‰²æ˜¯ä»æœºï¼Œé»‘è‰²æ˜¯ä¸»æœº</p>
<p>åº”ç­”å¯ä»¥ä½œä¸ºç¬¬ä¹ä½</p>
<ul>
<li>ä¸»æœºé‡Šæ”¾äº†SDA**(ç»™SDAç½®1)**å˜æˆé«˜ç”µå¹³ï¼ŒæŠŠæ§åˆ¶æƒç»™ä»æœº</li>
<li>æ­¤æ—¶ä»æœºå¯ä»¥æ“æ§å‘1æˆ–å‘0</li>
<li>å½“SCLæ‹‰ä½ï¼Œä»æœºè‡ªåŠ¨å°†ä¸‹ä¸€ä½æ•°æ®æ”¾åˆ°æ€»çº¿ä¸Š</li>
</ul>
<h2 id="3-å‘é€-æ¥æ”¶åº”ç­”"><a href="#3-å‘é€-æ¥æ”¶åº”ç­”" class="headerlink" title="3.å‘é€/æ¥æ”¶åº”ç­”"></a>3.å‘é€/æ¥æ”¶åº”ç­”</h2><p><img src="/../../../../medias/blog_picture/51/74.png"></p>
<p>åº”ç­”å¯ä»¥ä½œä¸ºæ•°æ®çš„ç¬¬ä¹ä½</p>
<p>ç”¨æ¥åˆ¤æ–­ä»æœºæ˜¯å¦åº”ç­”æˆ–è€…ä¸»æœºæ˜¯å¦å‘é€åº”ç­”</p>
<p><img src="/../../../../medias/blog_picture/51/75.png"></p>
<p>å‘œå‘œå‘œå‘œå‘œå‘œå‘œå‘œå‘œå‘œ<strong>ä»1ï¼š15ï¼š21å¼€å§‹ï¼Œä»£ç ä¸èƒ½æ­£å¸¸è¿è¡Œ</strong>å‘œå‘œå‘œå‘œå‘œå‘œå‘œå‘œå‘œå‘œæ”¾å¼ƒäº†æ”¾å¼ƒäº†</p>
<h1 id="å››-å­¦åˆ°äº†å•¥"><a href="#å››-å­¦åˆ°äº†å•¥" class="headerlink" title="å››.å­¦åˆ°äº†å•¥"></a>å››.å­¦åˆ°äº†å•¥</h1><hr>
<p>æ„Ÿè§‰æ¯”è¾ƒæœ‰ç”¨çš„æ˜¯åœ¨å®šæ—¶å™¨é‡Œè°ƒç”¨å‡½æ•°ï¼ŒåŒæ—¶å¯¹ä¸åŒæ¨¡å—å‡½æ•°è®¡æ—¶</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Timer0_Routine</span><span class="token punctuation">(</span><span class="token punctuation">)</span> interrupt <span class="token number">1</span>
<span class="token punctuation">{</span>
	<span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> T0Count1<span class="token punctuation">,</span>T0Count2<span class="token punctuation">;</span>
	TL0 <span class="token operator">=</span> <span class="token number">0x18</span><span class="token punctuation">;</span>		<span class="token comment">//è®¾ç½®å®šæ—¶åˆå€¼</span>
	TH0 <span class="token operator">=</span> <span class="token number">0xFC</span><span class="token punctuation">;</span>		<span class="token comment">//è®¾ç½®å®šæ—¶åˆå€¼</span>
	T0Count1<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>T0Count1<span class="token operator">&gt;=</span><span class="token number">20</span><span class="token punctuation">)</span>		<span class="token comment">//20msè¿”å›ä¸€æ¬¡1æˆ–0</span>
						<span class="token comment">//é€šè¿‡è®°å½•ä¸Šä¸€æ¬¡å’Œè¿™ä¸€æ¬¡çš„è¿”å›å€¼åˆ¤æ–­æ˜¯æŒ‰ä¸‹è¿˜æ˜¯æ¾å¼€</span>
	<span class="token punctuation">{</span>
		T0Count1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token function">Key_Loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¿™æ—¶å€™Keyå‡½æ•°æ— ä¸­ç”Ÿæœ‰ï¼Œæœ‰äº†è‡ªå·±çš„ä¸­æ–­</span>
	<span class="token punctuation">}</span>
	
	T0Count2<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>T0Count2<span class="token operator">&gt;=</span><span class="token number">2</span><span class="token punctuation">)</span>		
	<span class="token punctuation">{</span>
		T0Count2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token function">Nixie_Loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>Key_Loop</strong>   <strong>Nixie_Loop</strong></p>
<p>åªéœ€è¦æ”¹å˜T0Count&gt;=xå°±å¯ä»¥æœ‰é’ˆå¯¹çš„è®¡æ—¶</p>
<p>è¿™ä¸ªloopå‡½æ•°ç›¸å½“äºç»•äº†ä¸€ä¸ªåœˆæŠŠå­å‡½æ•°è°ƒç”¨äº†ä¸€æ¬¡ï¼Œä½†æ˜¯èµ·ç èµ·åˆ°äº†è®¡æ—¶çš„ä½œç”¨</p>
]]></content>
      <tags>
        <tag>51å•ç‰‡æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>AlexNetæ¨¡å‹å¤ç°</title>
    <url>/2023/11/28/alexnet-mo-xing-fu-xian/</url>
    <content><![CDATA[<h1 id="1-åˆ›å»ºnet"><a href="#1-åˆ›å»ºnet" class="headerlink" title="1 åˆ›å»ºnet"></a>1 åˆ›å»ºnet</h1><h2 id="1-1-torch-nn-Module"><a href="#1-1-torch-nn-Module" class="headerlink" title="1.1 torch.nn.Module()"></a>1.1 torch.nn.Module()</h2><p><strong>Base class for all neural network modules</strong></p>
<h3 id="1-1-1-Variables"><a href="#1-1-1-Variables" class="headerlink" title="1.1.1 Variables"></a>1.1.1 Variables</h3><ol>
<li><code>cuda(device=None)</code><br>Moves all model parameters and buffers to the GPU<br>å°†æ‰€æœ‰æ¨¡å‹å‚æ•°å’Œç¼“å†²åŒºç§»è‡³ GPU</li>
<li><code>eval()</code><br>Sets the module in evaluation mode<br>å°†æ¨¡å—è®¾ç½®ä¸ºè¯„ä¼°æ¨¡å¼ ^eval</li>
<li><code>forward()</code><br>Defines the computation performed at every call.<br>å®šä¹‰æ¯æ¬¡è°ƒç”¨æ—¶æ‰§è¡Œçš„è®¡ç®— ^forward</li>
</ol>
<h2 id="1-2-é˜…è¯»è®ºæ–‡åå¾—åˆ°netçš„å‚æ•°"><a href="#1-2-é˜…è¯»è®ºæ–‡åå¾—åˆ°netçš„å‚æ•°" class="headerlink" title="1.2 é˜…è¯»è®ºæ–‡åå¾—åˆ°netçš„å‚æ•°"></a>1.2 é˜…è¯»è®ºæ–‡åå¾—åˆ°netçš„å‚æ•°</h2><p>å…³æ³¨$C_{in}$ã€$C_{out}$ã€$kernel_size$ã€$padding$ã€$stride$<br>å…¶ä¸­ï¼Œ$stride$éœ€è¦æ ¹æ®å…¬å¼è®¡ç®—å¾—å‡º<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/a0dda904b7f38e1eea5ebad874024a7.jpg">)</p>
<h2 id="1-3-ç¼–å†™init"><a href="#1-3-ç¼–å†™init" class="headerlink" title="1.3 ç¼–å†™init"></a>1.3 ç¼–å†™init</h2><p>å®šä¹‰æ¯ä¸ªæ­¥éª¤çš„å…·ä½“æ‰§è¡Œè¿‡ç¨‹<br>e.g.</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">self<span class="token punctuation">.</span>c1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">48</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™é‡Œè§„å®š<code>c1</code>çš„æ‰§è¡Œè¿‡ç¨‹æ˜¯æ¥æ”¶è¾“å…¥é€šé“ä¸º$3$çš„å›¾åƒï¼Œç”¨<code>size</code>ä¸º$11$çš„<code>kernel</code>â€¦æœ€åä»¥è¾“å‡ºé€šé“ä¸º$48$ä½œä¸ºè¾“å‡º</p>
<h2 id="1-4-ç¼–å†™forward"><a href="#1-4-ç¼–å†™forward" class="headerlink" title="1.4 ç¼–å†™forward"></a>1.4 ç¼–å†™forward</h2><p>[[#^forward]]<br>æŒ‰ç…§å·ç§¯çš„é¡ºåºè¿›è¡Œxçš„æ›´è¿­</p>
<h2 id="1-5-æµ‹è¯•"><a href="#1-5-æµ‹è¯•" class="headerlink" title="1.5 æµ‹è¯•"></a>1.5 æµ‹è¯•</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>å½“è¿™æ®µä»£ç åªåœ¨ç›´æ¥è¿è¡Œå½“å‰è„šæœ¬æ—¶æ‰ä¼šæ‰§è¡Œï¼Œå¦‚æœå½“å‰è„šæœ¬è¢«å…¶ä»–è„šæœ¬å¼•å…¥ä½œä¸ºæ¨¡å—ä½¿ç”¨ï¼Œåˆ™è¿™éƒ¨åˆ†ä»£ç ä¸ä¼šæ‰§è¡Œã€‚<br>é€šå¸¸ä¼šå¯¹<code>x</code>å’Œ<code>y</code>èµ‹äºˆç®€å•çš„æ•°å­—å¯¹<code>net</code>è¿›è¡Œæµ‹è¯•</p>
<h1 id="2-åˆ’åˆ†æ•°æ®é›†"><a href="#2-åˆ’åˆ†æ•°æ®é›†" class="headerlink" title="2 åˆ’åˆ†æ•°æ®é›†"></a>2 åˆ’åˆ†æ•°æ®é›†</h1><h2 id="2-1-åˆ›å»ºæ–‡ä»¶"><a href="#2-1-åˆ›å»ºæ–‡ä»¶" class="headerlink" title="2.1 åˆ›å»ºæ–‡ä»¶"></a>2.1 åˆ›å»ºæ–‡ä»¶</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºæ–‡ä»¶  </span>
<span class="token keyword">def</span> <span class="token function">mkfile</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  
    <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  
        os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>cla = [Cat, Dog]</li>
<li><code>data/train/</code>+<code>cla</code><ul>
<li><code>data/train/Cat</code></li>
<li><code>data/train/Dog</code></li>
<li><code>data/val/Cat</code></li>
<li><code>dara/val/Dog</code></li>
</ul>
</li>
</ul>
<h2 id="2-2-éå†ä¸åˆ’åˆ†"><a href="#2-2-éå†ä¸åˆ’åˆ†" class="headerlink" title="2.2 éå†ä¸åˆ’åˆ†"></a>2.2 éå†ä¸åˆ’åˆ†</h2><ol>
<li>éå†æ‰€æœ‰ç±»åˆ«çš„å›¾åƒ<br><code>images</code>å­˜å‚¨äº†åŸå§‹dataä¸‹<code>cla</code>åˆ†åˆ«ä¸º<code>Cat</code>å’Œ<code>Dog</code>çš„å›¾åƒåç§°</li>
<li>æŒ‰æ¯”ä¾‹åˆ’åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†<br><code>eval_index</code>æ˜¯<code>images</code>ä¸­çš„éšæœºæŠ½å–çš„$\dfrac{2}{10}$çš„å›¾åƒåç§°çš„é›†åˆ</li>
</ol>
<p>éšåå†æ¬¡éå†<code>images</code></p>
<ul>
<li>å¦‚æœå›¾åƒçš„åå­—åœ¨<code>eval_index</code>ä¸­å­˜åœ¨ï¼Œåˆ™å°†è¿™ä¸ªå›¾åƒå¤åˆ¶åˆ°æ–°è·¯å¾„<code>data/val/+cla</code>(<code>val</code>ä¸­<code>Cat</code>æˆ–<code>Dog</code>çš„æ–‡ä»¶ä¸‹)</li>
<li>å¦‚æœä¸åœ¨<code>eval_index</code>ä¸­å­˜åœ¨ï¼Œåˆ™å¤åˆ¶åˆ°<code>data/train/+cla</code>ä¸­</li>
</ul>
<h1 id="3-ç¼–å†™train-py"><a href="#3-ç¼–å†™train-py" class="headerlink" title="3 ç¼–å†™train.py"></a>3 ç¼–å†™train.py</h1><h2 id="3-1-ç”¨åˆ°çš„åº“"><a href="#3-1-ç”¨åˆ°çš„åº“" class="headerlink" title="3.1 ç”¨åˆ°çš„åº“"></a>3.1 ç”¨åˆ°çš„åº“</h2><h3 id="3-1-1-torchvision-transforms"><a href="#3-1-1-torchvision-transforms" class="headerlink" title="3.1.1 torchvision.transforms"></a>3.1.1 torchvision.transforms</h3><ol>
<li><p>.Normalize(<em>mean, std, inplace=False</em>)<br>ps: Itâ€™s scriptable transforms, which canâ€™t use [[#^Compose]]    :)<br>å½’ä¸€åŒ–å¤„ç†<br>output[channel] = (input[channel] - mean[channel] / std[channel])<br>^normalize</p>
</li>
<li><p>.Compose(<em>transforms</em>)<br>Composes several transforms together.This transform does not support torchscript.<br>^Compose</p>
</li>
</ol>
<h2 id="3-1-å¯¹å›¾åƒåƒç´ å½’ä¸€åŒ–å¤„ç†"><a href="#3-1-å¯¹å›¾åƒåƒç´ å½’ä¸€åŒ–å¤„ç†" class="headerlink" title="3.1 å¯¹å›¾åƒåƒç´ å½’ä¸€åŒ–å¤„ç†"></a>3.1 å¯¹å›¾åƒåƒç´ å½’ä¸€åŒ–å¤„ç†</h2><p>[[#^normalize]]</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">normalize <span class="token operator">=</span> transforms<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># å‡0.5å†é™¤0.5æœ€åå½’ä¸€åŒ–åˆ°[-1, 1]ä¹‹é—´</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="3-2-è®­ç»ƒé›†å’ŒéªŒè¯é›†é¢„å¤„ç†"><a href="#3-2-è®­ç»ƒé›†å’ŒéªŒè¯é›†é¢„å¤„ç†" class="headerlink" title="3.2 è®­ç»ƒé›†å’ŒéªŒè¯é›†é¢„å¤„ç†"></a>3.2 è®­ç»ƒé›†å’ŒéªŒè¯é›†é¢„å¤„ç†</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># è®­ç»ƒé›†é¢„å¤„ç†  </span>
train_transform <span class="token operator">=</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>  
    transforms<span class="token punctuation">.</span>Resize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># Resize the input image to the given size.å› æ­¤å°†å‚æ•°è®¾ç½®ä¸ºè®ºæ–‡ä¸­ç½‘ç»œè¾“å…¥çš„å‚æ•°å¤§å°  </span>
    transforms<span class="token punctuation">.</span>RandomVerticalFlip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># éšæœºå‚ç›´æ—‹è½¬ï¼Œä½¿æ•°æ®é›†æ›´å¤š  </span>
    transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># è½¬æ¢ä¸ºå¼ é‡  </span>
    normalize  <span class="token comment"># å½’ä¸€åŒ–  </span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>  
  
<span class="token comment">#éªŒè¯é›†é¢„å¤„ç†  </span>
val_transform <span class="token operator">=</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>  
    transforms<span class="token punctuation">.</span>Resize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
    transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
    normalize  
<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>[[#^Compose]]<br>åˆ›å»ºæ•°æ®é›†ğŸ‘‡</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">train_dataset <span class="token operator">=</span> ImageFolder<span class="token punctuation">(</span>ROOT_TRAIN<span class="token punctuation">,</span> transform<span class="token operator">=</span>train_transform<span class="token punctuation">)</span>  
val_dataset <span class="token operator">=</span> ImageFolder<span class="token punctuation">(</span>ROOT_TEST<span class="token punctuation">,</span> transform<span class="token operator">=</span>val_transform<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><code>ImageFolder</code>ç”¨äºåˆ›å»ºä¸€ä¸ªæ•°æ®é›†ï¼Œè¯¥æ•°æ®é›†åŒ…å«äº†å›¾åƒæ•°æ®å’Œç›¸åº”çš„æ ‡ç­¾</p>
<p>ğŸ‘‡è®¾ç½®æ‰¹é‡åŠ è½½</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">train_dataloader <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>train_dataset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  
val_dataloader <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>val_dataset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><code>DataLoader</code>ç”¨äºä»æ•°æ®é›†ä¸­åŠ è½½æ‰¹é‡æ•°æ®çš„å·¥å…·<br>æ¯æ‰¹æ•°æ®æœ‰32ä¸ªæ ·æœ¬<br><code>shuffle=True</code>è¡¨ç¤ºæ¯ä¸ª<code>epoch</code>å¼€å§‹å‰å¯¹æ•°æ®ç»§ç»­éšæœºæ’åº</p>
<h2 id="3-4-ä½¿ç”¨GPUåŠ è½½æ•°æ®"><a href="#3-4-ä½¿ç”¨GPUåŠ è½½æ•°æ®" class="headerlink" title="3.4 ä½¿ç”¨GPUåŠ è½½æ•°æ®"></a>3.4 ä½¿ç”¨GPUåŠ è½½æ•°æ®</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">device <span class="token operator">=</span> <span class="token string">'cuda'</span> <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">'cpu'</span>  
<span class="token keyword">print</span><span class="token punctuation">(</span>device<span class="token punctuation">)</span>  
model <span class="token operator">=</span> MyAlexNet<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>  <span class="token comment"># å°†'MyAlexNet'å®ä¾‹åŒ–å¯¹è±¡ç§»åŠ¨åˆ°'device'ä¸Š</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h2 id="3-5-å®šä¹‰æŸå¤±å‡½æ•°å’Œä¼˜åŒ–å™¨å¹¶è®¾ç½®å­¦ä¹ ç‡"><a href="#3-5-å®šä¹‰æŸå¤±å‡½æ•°å’Œä¼˜åŒ–å™¨å¹¶è®¾ç½®å­¦ä¹ ç‡" class="headerlink" title="3.5 å®šä¹‰æŸå¤±å‡½æ•°å’Œä¼˜åŒ–å™¨å¹¶è®¾ç½®å­¦ä¹ ç‡"></a>3.5 å®šä¹‰æŸå¤±å‡½æ•°å’Œä¼˜åŒ–å™¨å¹¶è®¾ç½®å­¦ä¹ ç‡</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># å®šä¹‰ä¸€ä¸ªæŸå¤±å‡½æ•°  </span>
loss_fn <span class="token operator">=</span> nn<span class="token punctuation">.</span>CrossEntropyLoss<span class="token punctuation">(</span><span class="token punctuation">)</span>  
<span class="token comment"># å®šä¹‰ä¸€ä¸ªä¼˜åŒ–å™¨  </span>
optimizer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span> momentum<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span>  <span class="token comment"># å°†æ¨¡å‹å‚æ•°ä¼ ç»™ä¼˜åŒ–å™¨  </span>
<span class="token comment"># å­¦ä¹ ç‡æ¯éš”10è½®å˜ä¸ºåŸæ¥çš„0.5  </span>
lr_scheduler <span class="token operator">=</span> lr_scheduler<span class="token punctuation">.</span>StepLR<span class="token punctuation">(</span>optimizer<span class="token punctuation">,</span> step_size<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> gamma<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token comment"># å¸®åŠ©ä¼˜åŒ–å™¨å†è®­ç»ƒè¿‡ç¨‹ä¸­é€æ­¥å‡å°å­¦ä¹ ç‡</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="3-6-å®šä¹‰è®­ç»ƒå‡½æ•°å’ŒæŸå¤±å‡½æ•°"><a href="#3-6-å®šä¹‰è®­ç»ƒå‡½æ•°å’ŒæŸå¤±å‡½æ•°" class="headerlink" title="3.6 å®šä¹‰è®­ç»ƒå‡½æ•°å’ŒæŸå¤±å‡½æ•°"></a>3.6 å®šä¹‰è®­ç»ƒå‡½æ•°å’ŒæŸå¤±å‡½æ•°</h2><p>â‘ ä»<code>dataloader</code>ä¸­å–å‡ºå›¾åƒæ•°æ®å’Œå¯¹åº”çš„æ ‡ç­¾<br>â‘¡è®¡ç®—<code>cur_loss</code>å’Œ<code>cur_acc</code>^train</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">train</span><span class="token punctuation">(</span>dataloader<span class="token punctuation">,</span> model<span class="token punctuation">,</span> loss_fn<span class="token punctuation">,</span> optimizer<span class="token punctuation">)</span><span class="token punctuation">:</span>
	loss<span class="token punctuation">,</span> current<span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0</span>  
	<span class="token keyword">for</span> batch<span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>dataloader<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># å°†æ•°æ®å–å‡ºæ¥è®­ç»ƒ  </span>
	    image<span class="token punctuation">,</span> y <span class="token operator">=</span> x<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">,</span> y<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>  
	    output <span class="token operator">=</span> model<span class="token punctuation">(</span>image<span class="token punctuation">)</span>  
	    cur_loss <span class="token operator">=</span> loss_fn<span class="token punctuation">(</span>output<span class="token punctuation">,</span> y<span class="token punctuation">)</span>  
	    _<span class="token punctuation">,</span> pred <span class="token operator">=</span> torch<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  
	    cur_acc <span class="token operator">=</span> torch<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>y<span class="token operator">==</span>pred<span class="token punctuation">)</span><span class="token operator">/</span>output<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>â‘¢åå‘ä¼ æ’­</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># åå‘ä¼ æ’­  </span>
optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>  
cur_loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>  
optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>â‘£è®¡ç®—$\dfrac{æ‰€æœ‰æŸå¤±å€¼}{ä¸ªæ•°}$å’Œ$\dfrac{æ‰€æœ‰æ­£ç¡®å€¼}{ä¸ªæ•°}$</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">	loss <span class="token operator">+=</span> cur_loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>  
	current <span class="token operator">+=</span> cur_acc<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>  
	n <span class="token operator">=</span> n<span class="token operator">+</span><span class="token number">1</span>
train_loss <span class="token operator">=</span> loss <span class="token operator">/</span> n  
train_acc <span class="token operator">=</span> current <span class="token operator">/</span> n  
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'train_loss'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>train_loss<span class="token punctuation">)</span><span class="token punctuation">)</span>  
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'train_acc'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>train_acc<span class="token punctuation">)</span><span class="token punctuation">)</span>  
<span class="token keyword">return</span> train_loss<span class="token punctuation">,</span> train_acc<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æŸå¤±å‡½æ•°é™¤äº†ä¸éœ€è¦åå‘ä¼ æ’­ï¼Œå…¶ä»–éƒ½å’Œè®­ç»ƒå‡½æ•°ç±»ä¼¼</p>
<h2 id="3-7-å®šä¹‰ç”»å›¾å‡½æ•°"><a href="#3-7-å®šä¹‰ç”»å›¾å‡½æ•°" class="headerlink" title="3.7 å®šä¹‰ç”»å›¾å‡½æ•°"></a>3.7 å®šä¹‰ç”»å›¾å‡½æ•°</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># å®šä¹‰ä¸€ä¸ªç”»å›¾å‡½æ•°  </span>
<span class="token keyword">def</span> <span class="token function">matplot_loss</span><span class="token punctuation">(</span>train_loss<span class="token punctuation">,</span> val_loss<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>train_loss<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'train_loss'</span><span class="token punctuation">)</span>  
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>val_loss<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'val_loss'</span><span class="token punctuation">)</span>  
    plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'best'</span><span class="token punctuation">)</span>  
    plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'loss'</span><span class="token punctuation">)</span>  
    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'epoch'</span><span class="token punctuation">)</span>  
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"è®­ç»ƒé›†å’ŒéªŒè¯é›†losså€¼å¯¹æ¯”å›¾"</span><span class="token punctuation">)</span>  
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>  
  
<span class="token keyword">def</span> <span class="token function">matplot_acc</span><span class="token punctuation">(</span>train_acc<span class="token punctuation">,</span> val_acc<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>train_acc<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'train_acc'</span><span class="token punctuation">)</span>  
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>val_acc<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'val_acc'</span><span class="token punctuation">)</span>  
    plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'best'</span><span class="token punctuation">)</span>  
    plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'acc'</span><span class="token punctuation">)</span>  
    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'epoch'</span><span class="token punctuation">)</span>  
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"è®­ç»ƒé›†å’ŒéªŒè¯é›†accå€¼å¯¹æ¯”å›¾"</span><span class="token punctuation">)</span>  
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="3-8-å¼€å§‹è®­ç»ƒ"><a href="#3-8-å¼€å§‹è®­ç»ƒ" class="headerlink" title="3.8 å¼€å§‹è®­ç»ƒ"></a>3.8 å¼€å§‹è®­ç»ƒ</h2><p>â‘ åˆå§‹åŒ–å››ä¸ª<code>list</code>ï¼Œå®šä¹‰<code>epoch</code>å’Œ<code>min_acc</code></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">loss_train <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  
acc_train <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  
loss_val <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  
acc_val <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
epoch <span class="token operator">=</span> <span class="token number">20</span>  
min_acc <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment"># æœ€å°ç²¾ç¡®åº¦ï¼Œæ‰¾å‡ºæœ€å¥½çš„æ¨¡å‹</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>â‘¡è°ƒç”¨<code>train</code>å’Œ<code>val</code>å‡½æ•°è¿›è¡Œè®­ç»ƒ<br>[[#^train]]</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> t <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>epoch<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    lr_scheduler<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>  
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"epoch</span><span class="token interpolation"><span class="token punctuation">{</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">\n-------"</span></span><span class="token punctuation">)</span>  
    train_loss<span class="token punctuation">,</span> train_acc <span class="token operator">=</span> train<span class="token punctuation">(</span>train_dataloader<span class="token punctuation">,</span> model<span class="token punctuation">,</span> loss_fn<span class="token punctuation">,</span> optimizer<span class="token punctuation">)</span>  
    val_loss<span class="token punctuation">,</span> val_acc <span class="token operator">=</span> val<span class="token punctuation">(</span>val_dataloader<span class="token punctuation">,</span> model<span class="token punctuation">,</span> loss_fn<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>â‘¢è®¡ç®—å¾—åˆ°çš„<code>train_loss</code>ã€<code>train_acc</code>ã€<code>val_loss</code>ã€<code>val_acc</code>åˆ†åˆ«æ”¾å…¥åˆ°åˆå§‹åŒ–çš„å››ä¸ª<code>list</code>ä¸­</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># åˆ—è¡¨  </span>
loss_train<span class="token punctuation">.</span>append<span class="token punctuation">(</span>train_loss<span class="token punctuation">)</span>  
acc_train<span class="token punctuation">.</span>append<span class="token punctuation">(</span>train_acc<span class="token punctuation">)</span>  
loss_val<span class="token punctuation">.</span>append<span class="token punctuation">(</span>val_loss<span class="token punctuation">)</span>  
acc_val<span class="token punctuation">.</span>append<span class="token punctuation">(</span>val_acc<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>â‘£ä¿å­˜æœ€å¥½çš„æƒé‡å’Œæœ€åä¸€è½®çš„æƒé‡</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># ä¿å­˜æœ€å¥½çš„æƒé‡  </span>
<span class="token keyword">if</span> val_acc <span class="token operator">&gt;</span> min_acc<span class="token punctuation">:</span>  
    folder <span class="token operator">=</span> <span class="token string">'save_model'</span>  
    <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>folder<span class="token punctuation">)</span><span class="token punctuation">:</span>  
        os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token string">'save_model'</span><span class="token punctuation">)</span>  
    min_acc <span class="token operator">=</span> val_acc  
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"save best model, ç¬¬</span><span class="token interpolation"><span class="token punctuation">{</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">è½®"</span></span><span class="token punctuation">)</span>  
    torch<span class="token punctuation">.</span>save<span class="token punctuation">(</span>model<span class="token punctuation">.</span>state_dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'save_model/best_model.pth'</span><span class="token punctuation">)</span>  
<span class="token comment"># ä¿å­˜æœ€åä¸€è½®çš„æƒé‡æ–‡ä»¶  </span>
<span class="token keyword">if</span> t <span class="token operator">==</span> epoch<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>  
    torch<span class="token punctuation">.</span>save<span class="token punctuation">(</span>model<span class="token punctuation">.</span>state_dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'save_model/last_model.pth'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¦‚æœæœ‰<code>val_acc</code>(æŸä¸€ä¸ªè½®æ¬¡è®­ç»ƒå¾—åˆ°çš„)å¤§äº<code>min_acc</code>ï¼Œåˆ™è¯´æ˜è¯¥æ¬¡çš„è®­ç»ƒæ•ˆæœæš‚æ—¶æ˜¯ç›®å‰æœ€å¥½çš„ï¼Œä¿å­˜åˆ°<code>.save_model/best_model.pth</code>ä¸­</p>
<h2 id="3-9-ç”»å›¾"><a href="#3-9-ç”»å›¾" class="headerlink" title="3.9 ç”»å›¾"></a>3.9 ç”»å›¾</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">matplot_loss<span class="token punctuation">(</span>loss_train<span class="token punctuation">,</span> loss_val<span class="token punctuation">)</span>  
matplot_acc<span class="token punctuation">(</span>acc_train<span class="token punctuation">,</span> acc_val<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h1 id="4-ç¼–å†™test-py"><a href="#4-ç¼–å†™test-py" class="headerlink" title="4 ç¼–å†™test.py"></a>4 ç¼–å†™test.py</h1><h2 id="4-1-è®­ç»ƒé›†å’ŒéªŒè¯é›†é¢„å¤„ç†ã€è°ƒç”¨GPU"><a href="#4-1-è®­ç»ƒé›†å’ŒéªŒè¯é›†é¢„å¤„ç†ã€è°ƒç”¨GPU" class="headerlink" title="4.1 è®­ç»ƒé›†å’ŒéªŒè¯é›†é¢„å¤„ç†ã€è°ƒç”¨GPU"></a>4.1 è®­ç»ƒé›†å’ŒéªŒè¯é›†é¢„å¤„ç†ã€è°ƒç”¨GPU</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">train_transform <span class="token operator">=</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>  
    transforms<span class="token punctuation">.</span>Resize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># Resize the input image to the given size.å› æ­¤å°†å‚æ•°è®¾ç½®ä¸ºè®ºæ–‡ä¸­ç½‘ç»œè¾“å…¥çš„å‚æ•°å¤§å°  </span>
    transforms<span class="token punctuation">.</span>RandomVerticalFlip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># éšæœºå‚ç›´æ—‹è½¬ï¼Œä½¿æ•°æ®é›†æ›´å¤š  </span>
    transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># è½¬æ¢ä¸ºå¼ é‡  </span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>  
  
<span class="token comment">#éªŒè¯é›†é¢„å¤„ç†  </span>
val_transform <span class="token operator">=</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>  
    transforms<span class="token punctuation">.</span>Resize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
    transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
    normalize  
<span class="token punctuation">]</span><span class="token punctuation">)</span>
train_dataset <span class="token operator">=</span> ImageFolder<span class="token punctuation">(</span>ROOT_TRAIN<span class="token punctuation">,</span> transform<span class="token operator">=</span>train_transform<span class="token punctuation">)</span>  
val_dataset <span class="token operator">=</span> ImageFolder<span class="token punctuation">(</span>ROOT_TEST<span class="token punctuation">,</span> transform<span class="token operator">=</span>val_transform<span class="token punctuation">)</span>  
  
train_dataloader <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>train_dataset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  
val_dataloader <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>val_dataset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  
  
device <span class="token operator">=</span> <span class="token string">'cuda'</span> <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">'cpu'</span>  
<span class="token keyword">print</span><span class="token punctuation">(</span>device<span class="token punctuation">)</span>  
model <span class="token operator">=</span> MyAlexNet<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>  <span class="token comment"># å°†'MyAlexNet'å®ä¾‹åŒ–å¯¹è±¡ç§»åŠ¨åˆ°'device'ä¸Š</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="4-2-åŠ è½½æ¨¡å‹"><a href="#4-2-åŠ è½½æ¨¡å‹" class="headerlink" title="4.2 åŠ è½½æ¨¡å‹"></a>4.2 åŠ è½½æ¨¡å‹</h2><p>åŠ è½½<code>best_model.pth</code></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">model<span class="token punctuation">.</span>load_state_dict<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">"E:/Project/Cat_and_Dog_Classification/save_model/best_model.pth"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="4-3-éªŒè¯é˜¶æ®µ"><a href="#4-3-éªŒè¯é˜¶æ®µ" class="headerlink" title="4.3 éªŒè¯é˜¶æ®µ"></a>4.3 éªŒè¯é˜¶æ®µ</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">model<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token number">3010</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  
    x<span class="token punctuation">,</span> y <span class="token operator">=</span> val_dataset<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> val_dataset<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment"># xä¸ºç¬¬iå¼ ç…§ç‰‡çš„çš„å›¾ç‰‡ï¼Œyä¸ºç¬¬iå¼ å›¾ç‰‡çš„æ ‡ç­¾  </span>
    show<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>  
    x <span class="token operator">=</span> Variable<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span>x<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">float</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> requires_grad<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>  
    x <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>model.eval()</code><br>[[#^eval]]<br><code>torch.unsqueeze(x, dim=0)</code>å°†<code>x</code>åœ¨ç»´åº¦0ä¸Šæ·»åŠ ä¸€ä¸ªç»´åº¦ï¼Œå¤§å°ä¸º1(æ‰¹æ¬¡ç»´åº¦)</p>
<p>åœ¨ç¦æ­¢æ¢¯åº¦è®¡ç®—çš„æƒ…å†µä¸‹å¾—åˆ°<code>predicted</code>å’Œ<code>actual</code></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  
    pred <span class="token operator">=</span> model<span class="token punctuation">(</span>x<span class="token punctuation">)</span>  
    predicted<span class="token punctuation">,</span> actual <span class="token operator">=</span> classes<span class="token punctuation">[</span>torch<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>pred<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> classes<span class="token punctuation">[</span>y<span class="token punctuation">]</span>  
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'predicted:"</span><span class="token interpolation"><span class="token punctuation">{</span>predicted<span class="token punctuation">}</span></span><span class="token string">", Actual:"</span><span class="token interpolation"><span class="token punctuation">{</span>actual<span class="token punctuation">}</span></span><span class="token string">"'</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>pred</code>ï¼š<code>tensor([[-2.1302,  2.3210]], device='cuda:0')</code><br><code>y</code>ï¼š<code>0</code>(Cat)æˆ–è€…<code>1</code>(Dog)</p>
]]></content>
      <categories>
        <category>äººå·¥æ™ºèƒ½</category>
      </categories>
      <tags>
        <tag>äººå·¥æ™ºèƒ½</tag>
        <tag>å·ç§¯ç¥ç»ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>DS1302æ—¶é’Ÿ</title>
    <url>/2022/11/12/ds1302-shi-zhong/</url>
    <content><![CDATA[<p><strong>DS1302</strong></p>
<h1 id="ä¸€-å¼•è„šåˆ†è£…"><a href="#ä¸€-å¼•è„šåˆ†è£…" class="headerlink" title="ä¸€.å¼•è„šåˆ†è£…"></a>ä¸€.å¼•è„šåˆ†è£…</h1><p>1.DIPç›´æ’</p>
<p>2.SOè´´ç‰‡</p>
<p><img src="/../../../../medias/blog_picture/51/59.png"></p>
<p><img src="/../../../../medias/blog_picture/51/60.png"></p>
<p>å…¶ä¸­ï¼Œ<strong>CEä¸ºé«˜ç”µå¹³çš„æ—¶å€™ä¸‹é¢çš„å‘½ä»¤(ioå’ŒSCLK)æ‰æœ‰ç”¨ã€‚</strong>æ—¶é—´å­˜å‚¨åœ¨å®æ—¶æ—¶é’Ÿé‡Œï¼Œåœ¨å·¦è¾¹è¢«è®¿é—®å’Œè¯»å†™</p>
<h1 id="äºŒ-å†…éƒ¨å¯„å­˜å™¨"><a href="#äºŒ-å†…éƒ¨å¯„å­˜å™¨" class="headerlink" title="äºŒ.å†…éƒ¨å¯„å­˜å™¨"></a>äºŒ.å†…éƒ¨å¯„å­˜å™¨</h1><p><img src="/../../../../medias/blog_picture/51/61.png"></p>
<p>WPæ˜¯è¯»å†™ä¿æŠ¤</p>
<h1 id="ä¸‰-è€ƒè™‘çš„é—®é¢˜"><a href="#ä¸‰-è€ƒè™‘çš„é—®é¢˜" class="headerlink" title="ä¸‰.è€ƒè™‘çš„é—®é¢˜"></a>ä¸‰.è€ƒè™‘çš„é—®é¢˜</h1><p>åœ¨å“ª(xxå¯„å­˜å™¨) å†™å…¥ ä»€ä¹ˆ</p>
<p>åœ¨å“ª(xxå¯„å­˜å™¨) è¯»å‡º ä»€ä¹ˆ(1302èŠ¯ç‰‡è¿”å›çš„ï¼Œå•ç‰‡æœºéœ€è¦è¯»åˆ°)</p>
<p><img src="/../../../../medias/blog_picture/51/62.png"></p>
<p>ç¬¬å…­ä½ï¼šç»™1â€”â€”RAMï¼Œç»™0â€”â€”CK</p>
<p>6~1å®Œæˆâ€œåœ¨å“ªâ€çš„ä»»åŠ¡</p>
<p>ç¬¬é›¶ä½ï¼šå®Œæˆâ€œè¯»/å†™â€çš„ä»»åŠ¡ï¼Œç»™1â€”â€”è¯»ï¼Œç»™0â€”â€”å†™</p>
<p>åœ¨<strong>äºŒ</strong>çš„è¡¨ä¸­å·²ç»æŠŠâ€œè¯»/å†™â€çš„å‘½ä»¤åˆ—å‡ºæ¥äº†</p>
<h2 id="1-æ—¶åºå®šä¹‰"><a href="#1-æ—¶åºå®šä¹‰" class="headerlink" title="1.æ—¶åºå®šä¹‰"></a>1.æ—¶åºå®šä¹‰</h2><p><img src="/../../../../medias/blog_picture/51/63.png"></p>
<p>ä¸Šå‡æ²¿(ioå£çš„ç”µå¹³è¢«)å†™å…¥(/å‘æ—¶é’ŸèŠ¯ç‰‡å†™å…¥æ•°æ®)ï¼Œä¸‹é™æ²¿(DS1302æŠŠä»–çš„æ•°æ®)è¾“å‡º(æ—¶é’ŸèŠ¯ç‰‡å‘å•ç‰‡æœºå†™å…¥æ•°æ®)ï¼Œ<strong>æ‰€ä»¥ï¼Œåªæœ‰READä¸­çš„D0~D7æ˜¯èŠ¯ç‰‡å†™å…¥çš„</strong></p>
<p>å†™å…¥æ—¶ï¼Œå…ˆå†™å…¥æ•°æ®å†è¿›è¡Œä¸Šå‡æ²¿ã€‚</p>
<h2 id="2-æ¯ä¸ªæŒ‰é”®çš„åŠŸèƒ½"><a href="#2-æ¯ä¸ªæŒ‰é”®çš„åŠŸèƒ½" class="headerlink" title="2.æ¯ä¸ªæŒ‰é”®çš„åŠŸèƒ½"></a>2.æ¯ä¸ªæŒ‰é”®çš„åŠŸèƒ½</h2><ul>
<li>K1é€‰æ‹©æ¨¡å¼ MODE=1ğŸ‘‰è®¾ç½®æ—¶é—´ MODE=0ğŸ‘‰æ˜¾ç¤ºæµåŠ¨çš„æ—¶é—´</li>
<li>K2é€‰æ‹©è¦æ›´æ”¹çš„æ—¶é—´å€¼(å¹´æœˆæ—¥æ—¶åˆ†ç§’)</li>
<li>K3æ›´æ”¹æŸä¸ªæ—¶é—´å€¼ï¼Œ+</li>
<li>K4æ›´æ”¹æŸä¸ªæ—¶é—´å€¼ï¼Œ-</li>
</ul>
<h1 id="å››-ä»£ç "><a href="#å››-ä»£ç " class="headerlink" title="å››.ä»£ç "></a>å››.ä»£ç </h1><h2 id="DS1302-C"><a href="#DS1302-C" class="headerlink" title="DS1302.C"></a>DS1302.C</h2><p><strong>1.</strong></p>
<pre class="line-numbers language-C" data-language="C"><code class="language-C">void DS1302_WriteByte(unsigned char Command,Data)//å†™å…¥
{
	unsigned char i;
	DS1302_CE=1;
	
	for(i=0;i&lt;8;i++)
	{
		DS1302_IO=Command&amp;(0x01&lt;&lt;i);//1~7ä½ç›´æ¥æ¸…é›¶ï¼Œåªç•™ç¬¬0ä½
		DS1302_SCLK=1;
		DS1302_SCLK=0;
	}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¯¹äºæ¯ä¸€ä½ï¼Œå…ˆå†™å…¥æ“ä½œæŒ‡ä»¤å†ç»™ä¸Šå‡æ²¿</p>
<p><strong>2.</strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token function">DS1302_ReadByte</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> Command<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> i<span class="token punctuation">,</span>Data<span class="token operator">=</span><span class="token number">0x00</span><span class="token punctuation">;</span>
	Command<span class="token operator">|=</span><span class="token number">0x01</span><span class="token punctuation">;</span>	<span class="token comment">//å°†æŒ‡ä»¤è½¬æ¢ä¸ºè¯»æŒ‡ä»¤</span>
	DS1302_CE<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">8</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//è¯»å‡º-æŒ‡ä»¤</span>
	<span class="token punctuation">{</span>
		DS1302_IO<span class="token operator">=</span>Command<span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token number">0x01</span><span class="token operator">&lt;&lt;</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
		DS1302_SCLK<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
		DS1302_SCLK<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">8</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//è¯»å‡º-æ•°æ®</span>
	<span class="token punctuation">{</span>
		DS1302_SCLK<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//çœ‹æ—¶åºå›¾ï¼Œå…ˆå°‘ä¸€ä¸ªé«˜ç”µå¹³</span>
		DS1302_SCLK<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//æœ€åæ˜¯ä½ç”µå¹³</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>DS1302_IO<span class="token punctuation">)</span><span class="token punctuation">{</span>Data<span class="token operator">|=</span><span class="token punctuation">(</span><span class="token number">0x01</span><span class="token operator">&lt;&lt;</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	DS1302_CE<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	DS1302_IO<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>	<span class="token comment">//è¯»å–åå°†IOè®¾ç½®ä¸º0ï¼Œå¦åˆ™è¯»å‡ºçš„æ•°æ®ä¼šå‡ºé”™</span>
	<span class="token keyword">return</span> Data<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å…³äºä¸ºä»€ä¹ˆè¦return DataXï¼ŒğŸ‘‡æˆ‘çš„ç†è§£</p>
<ul>
<li>é¦–å…ˆåœ¨<strong>DS1302_WriteByte</strong>ä¸­å†™å…¥æ•°æ®ï¼Œæ˜¯å¤šå°‘ç§’(0~15)ï¼Œå°±è¾“å…¥0x xxï¼Œç„¶å16è¿›åˆ¶è½¬2è¿›åˆ¶</li>
<li>åœ¨<strong>DS1302_ReadByte</strong>ä¸­è¯»å–æ•°æ®ï¼Œå¯¹æ¯ä¸€ä½è¿›è¡Œåˆ¤æ–­</li>
<li>e.g. å†™å…¥æ—¶å†™å…¥äº†0x03â€”16è½¬2â€”&gt;0000 0100ï¼Œç„¶ååœ¨readå‡½æ•°é‡Œå¯¹æ¯ä¸€ä½è¿›è¡Œåˆ¤æ–­ï¼Œæ‰§è¡Œå®Œè¯»å‘½ä»¤å­—åï¼Œæ•°æ®ä¼ è¾“åˆ°IOå£ä¸Šï¼Œæ˜¯1çš„ï¼ŒDataå°±ç½®1ï¼Œå¦åˆ™ç½®0ï¼Œæ‰€ä»¥Dataå°±æ˜¯ä¸ªæ¥æ”¶æ•°æ®çš„ä¸­è½¬ç«™ç½¢äº†ã€‚</li>
<li>ç„¶åreturnä¹‹åï¼ŒLCDé‚£é‡Œçš„å®šä¹‰æ˜¯<strong>unsigned int Number</strong>åœ¨ä¼ å‚æ—¶ï¼Œå·²ç»è‡ªåŠ¨æŠŠ2è¿›åˆ¶è½¬æ¢ä¸º10è¿›åˆ¶äº†ï¼Œæ‰€ä»¥æ˜¾ç¤ºå‡ºæ¥çš„æ•°æ®å°±æ˜¯10è¿›åˆ¶çš„ã€‚</li>
</ul>
<p><strong>3.è‡ªåŠ¨æ¸…é›¶</strong></p>
<p>e.g.å¸Œæœ›è®©aè¶…è¿‡5ä¹‹åæ¸…é›¶ï¼Œä»0å¼€å§‹å†é€’å¢</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token operator">&gt;</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">{</span>a<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token operator">&lt;=</span><span class="token operator">=</span><span class="token operator">&gt;</span>
a<span class="token operator">=</span><span class="token operator">%</span><span class="token number">6</span><span class="token punctuation">;</span><span class="token comment">//a=6%6=0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>4.</strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">if</span><span class="token punctuation">(</span>DS1302_Time<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">||</span>DS1302_Time<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">3</span><span class="token operator">||</span>DS1302_Time<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">5</span><span class="token operator">||</span>DS1302_Time<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">7</span><span class="token operator">||</span>DS1302_Time<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">8</span><span class="token operator">||</span>DS1302_Time<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">10</span><span class="token operator">||</span>DS1302_Time<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">12</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>DS1302_Time<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>DS1302_Time<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">31</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>DS1302_Time<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">{</span>DS1302_Time<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span>	<span class="token comment">//12-31è°ƒå›11-xxæ—¶ä¼šæ˜¾ç¤º11-31ï¼Œæ‰€ä»¥éœ€è¦åŠ ä¸Šè¿™å¥è¯</span>
		<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å…³äºä¸ºä»€ä¹ˆè¦åœ¨K4-è¿™é‡Œå¤åˆ¶ä¸€éƒ¨åˆ†K3+çš„ä»£ç </p>
<ul>
<li>ä»12-31è°ƒå›11æœˆä»½æ—¶ï¼Œä¼šæ˜¾ç¤ºä¸º11-31ï¼Œæ‰€ä»¥è¦åŠ ä¸Šé‚£éƒ¨åˆ†ä»£ç </li>
</ul>
<p><strong>5.</strong></p>
<p>æŸä¸ªæ—¶é—´å€¼è¢«é€‰ä¸­åè·³åŠ¨</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">if</span><span class="token punctuation">(</span>TimeSetSelect<span class="token operator">==</span><span class="token number">0</span><span class="token operator">&amp;&amp;</span>TimeSetFlashFlag<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">LCD_ShowString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"  "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">else</span><span class="token punctuation">{</span><span class="token function">LCD_ShowNum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>DS1302_Time<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>å®šæ—¶å™¨æ¯éš”500mså¯¹TimeSetFlashFlagç½®1æˆ–0ï¼Œå½“TSFFä¸º1ä¸”æ—¶é—´å€¼é€‰ä¸­çš„æ˜¯0â€“æ—¶ æ—¶ï¼Œåœ¨åŸæœ¬æ˜¾ç¤ºæ—¶çš„æ—¶é—´é‚£ä¸€å—åœ°æ–¹æ˜¾ç¤ºç©ºæ ¼ï¼›å¦‚æœä¸ç¬¦åˆifçš„æ¡ä»¶ï¼Œåˆ™æ˜¾ç¤ºæ—¶é—´ï¼Œæ‰€ä»¥TSFFåœ¨0å’Œ1è·³åŠ¨æ—¶ï¼Œå†³å®šäº†é¢‘é—ªçš„æ˜¾ç¤ºã€‚</p>
]]></content>
      <categories>
        <category>51å•ç‰‡æœº</category>
      </categories>
      <tags>
        <tag>51å•ç‰‡æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>FirstGameç¬”è®°</title>
    <url>/2023/01/21/firtgame/</url>
    <content><![CDATA[<p>è·Ÿç€éº¦æ‰£è€å¸ˆåšçš„<a href="https://github.com/Wabbybabb0/My-First-Game-Demo">å°ç‹ç‹¸demo</a></p>
<h4 id="Input-GetAxis"><a href="#Input-GetAxis" class="headerlink" title="Input.GetAxis"></a>Input.GetAxis</h4><p>GetAxis()ä¸¤ç§ï¼š</p>
<ul>
<li><p>Vertical:è·å¾—å‚ç›´æ–¹å‘</p>
</li>
<li><p>Horizontal:è·å¾—æ°´å¹³æ–¹å‘</p>
</li>
</ul>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">horizontalmove = Input.GetAxis("Horizontal");//æ£€æµ‹æ°´å¹³æ–¹å‘é”®
verticalmove = Input.GetAxis("Vertical");	 //æ£€æµ‹å‚ç›´æ–¹å‘é”®<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="/../../../../medias/blog_picture/Unity/1.png"></p>
<p>ğŸ‘†Edit-&gt;Project Settings-&gt;Input Manager-&gt;Axes-&gt;Horizontal</p>
<p>ä»ä¸Šå›¾å¯çŸ¥<code>Negative Button</code> <code>-1</code>å¯¹åº”<code>left</code>å’Œ<code>a</code>ï¼›<code>Positive Button</code>å¯¹åº”<code>1</code>å’Œ<code>right</code></p>
<p>æ‰€ä»¥åœ¨ç¨‹åºä¸­åˆ†åˆ«è®¾ç½®ä¸¤ä¸ªå˜é‡æ¥æ”¶<code>-1</code>æˆ–è€…<code>1</code>æ¥åˆ¤æ–­æ˜¯æŒ‰äº†<code>a</code> <code>left</code>è¿˜æ˜¯<code>d</code> <code>right</code></p>
<h4 id="Input-GetAxisRaw"><a href="#Input-GetAxisRaw" class="headerlink" title="Input.GetAxisRaw"></a>Input.GetAxisRaw</h4><p><strong>~ vs Input.GetAxis</strong>ğŸ‘‡</p>
<p>å‰è€…è·å¾—çš„æ•°æ®åªæœ‰<code>-1</code> <code>0</code> <code>1</code></p>
<p>åè€…è·å¾—çš„æ•°æ®æ˜¯<code>-1~0</code> <code>0~1</code></p>
<h4 id="Time-deltaTime"><a href="#Time-deltaTime" class="headerlink" title="Time.deltaTime"></a>Time.deltaTime</h4><p><img src="/../../../../medias/blog_picture/Unity/2.png"></p>
<p><img src="/../../../../medias/blog_picture/Unity/3.png"></p>
<h4 id="Mathf-Abs"><a href="#Mathf-Abs" class="headerlink" title="Mathf.Abs()"></a>Mathf.Abs()</h4><p>å–ç»å¯¹å€¼</p>
<h4 id="transform-Transform"><a href="#transform-Transform" class="headerlink" title="transform&amp;Transform"></a>transform&amp;Transform</h4><ul>
<li>Transformåšå‡½æ•°</li>
<li>transformæ‰æ˜¯å½“å‰çœŸæ­£éœ€è¦æ“ä½œçš„</li>
</ul>
<h4 id="é•œå¤´è®¾ç½®çš„ä¸¤ç§æ–¹æ³•"><a href="#é•œå¤´è®¾ç½®çš„ä¸¤ç§æ–¹æ³•" class="headerlink" title="é•œå¤´è®¾ç½®çš„ä¸¤ç§æ–¹æ³•"></a>é•œå¤´è®¾ç½®çš„ä¸¤ç§æ–¹æ³•</h4><h5 id="1-åœ¨Main-Cameraä¸­åŠ new-script"><a href="#1-åœ¨Main-Cameraä¸­åŠ new-script" class="headerlink" title="1.åœ¨Main Cameraä¸­åŠ new script"></a>1.åœ¨Main Cameraä¸­åŠ new script</h5><p>ğŸ‘‡Scriptä»£ç </p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">public class CameraControl : MonoBehaviour
{
	//â‘ è®¾ç½®ä¸€ä¸ªå«"player"çš„Transformç±»å‹çš„å˜é‡
    public Transform player;

    // Update is called once per frame
    void Update()
    {
    	//â‘¡æŠŠMain Cameraä¸­çš„transformæ ç›®ä¸­çš„positionæ”¹ä¸ºä¸€ä¸ªå®ä¾‹ï¼Œè¯¥å®ä¾‹æ˜¯3Dçš„ï¼Œxyzå„è‡ªå¯¹åº”
        transform.position = new Vector3(player.position.x, 0, -10f);  
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ğŸ‘‡æœ€åæŠŠè¦ç»™é•œå¤´çš„å¯¹è±¡ç§»åŠ¨åˆ°Playerå¤„å³å¯</p>
<p><img src="/../../../../medias/blog_picture/Unity/4.png"></p>
<h5 id="2-cinimachine"><a href="#2-cinimachine" class="headerlink" title="2.cinimachine"></a>2.cinimachine</h5><p>GameObject-&gt;Cinimachine-&gt;2D Cinima-&gt;å¾—åˆ°ä¸‹å›¾æ‰€ç¤ºçš„é€‰é¡¹</p>
<p><img src="/../../../../medias/blog_picture/Unity/5.png"></p>
<p><img src="/../../../../medias/blog_picture/Unity/6.png"></p>
<ul>
<li><p>Followå¤„æ‹‰æ‹½ä¸Šéœ€è¦è·Ÿè¸ªé•œå¤´çš„å¯¹è±¡</p>
</li>
<li><p>ç„¶ååœ¨Lenså¤„è°ƒæ•´é•œå¤´è·ç¦»ç­‰å‚æ•°</p>
</li>
</ul>
<p><img src="/../../../../medias/blog_picture/Unity/7.png"></p>
<ul>
<li><p>Dead Zone</p>
<ul>
<li>å¯ä»¥æ‹‰æ‹½èŒƒå›´ï¼Œå¦‚æœè¶…å‡ºèŒƒå›´åˆ™é•œå¤´ç§»åŠ¨ï¼Œæœªè¶…å‡ºåˆ™ä¸ç§»åŠ¨</li>
</ul>
</li>
<li><p>ä¸ç¦»å¼€èƒŒæ™¯å›¾</p>
<ul>
<li>CM vcam1-&gt;Body-&gt;Add Extension-&gt;Cinimachine Confiner-&gt;</li>
<li><img src="/../../../../medias/blog_picture/Unity/8.png"></li>
</ul>
</li>
<li><p>å›åˆ°Backgroundå›¾å±‚æ‹‰æ‹½èŒƒå›´</p>
</li>
</ul>
<h4 id="è™šå‡½æ•°ä¸ç±»çš„ä½¿ç”¨"><a href="#è™šå‡½æ•°ä¸ç±»çš„ä½¿ç”¨" class="headerlink" title="è™šå‡½æ•°ä¸ç±»çš„ä½¿ç”¨"></a>è™šå‡½æ•°ä¸ç±»çš„ä½¿ç”¨</h4><p><strong>çˆ¶çº§</strong></p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">public class Enemy : MonoBehaviour
{
    protected Animator Anim;
    //ğŸ‘†æ‰€æœ‰Enemyéƒ½éœ€è¦æœ‰â€œè¢«å‡»æ€â€çš„åŠ¨ç”»ï¼Œå› æ­¤å…ˆåˆ›å»ºä¸€ä¸ªåä¸º"Anim"çš„Animatorå˜é‡
    //"protected"â†’1.1
    protected virtual void Start()
    //"virtual"çˆ¶çº§çš„"Start"æ˜¯å¯ä»¥è¢«å­çº§é‡æ–°ç¼–å†™çš„(å› ä¸ºå­çº§åœ¨"Start"ä¸­æœ‰ä¸€äº›æœ¬ä½“çš„å±æ€§)
    {
        Anim = GetComponent&lt;Animator&gt;();
    }
    public void Death()
    {
        Destroy(gameObject);
    }

    public void JumpOn()
    {
        Anim.SetTrigger("death");
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å­çº§</strong></p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">public class Enemy_Frog : Enemy//éš¶å±äºEnemyçš„å­çº§ï¼Œç¡®å®šçˆ¶å­å…³ç³»
{
	protected override void Start()
	//ğŸ‘†override å‘¼åº”virtual
	{
     	base.Start();//è°ƒç”¨çˆ¶çº§çš„Start
	}
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>Player</strong></p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">Enemy enemy = collision.gameObject.GetComponent&lt;Enemy&gt;();//å¯ä»¥è°ƒç”¨åä¸º"Enemy"çš„ç±»çš„çˆ¶å­çº§<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h5 id="1-1protected"><a href="#1-1protected" class="headerlink" title="1.1protected"></a>1.1protected</h5><ul>
<li><p>è‡ªèº«ç±»å’Œæ´¾ç”Ÿç±»å¯ä»¥è®¿é—®ç›¸å½“äºè‡ªèº«çš„privateå‹æˆå‘˜ <code>åˆ›å»ºçš„å‡½æ•°æˆ–è€…å˜é‡åœ¨å­çˆ¶çº§ä¸­éƒ½å¯ä»¥ä½¿ç”¨</code></p>
</li>
<li><p>å¯ä»¥è¢«<code>1.è¯¥ç±»ä¸­çš„å‡½æ•°</code>ã€<code>2.å­ç±»çš„å‡½æ•°</code>ã€ä»¥åŠ<code>3.å…¶å‹å…ƒå‡½æ•°</code>è®¿é—®ã€‚ä½†ä¸èƒ½è¢«è¯¥ç±»çš„å¯¹è±¡è®¿é—®</p>
</li>
<li><p>ä½¿ç”¨protectedç»§æ‰¿ï¼Œçˆ¶ç±»çš„protectedå’Œpublicå±æ€§åœ¨å­ç±»ä¸­å˜ä¸ºprotected</p>
</li>
</ul>
<h4 id="åœºæ™¯è½¬æ¢"><a href="#åœºæ™¯è½¬æ¢" class="headerlink" title="åœºæ™¯è½¬æ¢"></a>åœºæ™¯è½¬æ¢</h4><p>ä»ç¬¬ä¸€å…³è¿›å…¥ç¬¬äºŒå…³</p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">using UnityEngine.SceneManagement;
//.
//.

if(Input.GetKeyDown(KeyCode.E))
{
    SceneManager.LoadScene(SceneManager.GetActiveScene().bulidIndex + 1);
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

]]></content>
  </entry>
  <entry>
    <title>éšå«è¿ªåˆ©å…‹é›·æ¨¡å‹LDA</title>
    <url>/2023/05/21/lda-mo-xing/</url>
    <content><![CDATA[<p><a href="https://blog.csdn.net/v_JULY_v/article/details/41209515?spm=1001.2101.3001.6650.1&amp;utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-1.no_search_link&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-1.no_search_link&amp;utm_relevant_index=2">å‚è€ƒåšå®¢</a></p>
<p><a href="https://oa7vrw2neqh.feishu.cn/docx/CB0WdZbkioi90JxOFTVczXfmngd">é£ä¹¦ç‰ˆç¬”è®°(å¸¦pdf)</a></p>
<h1 id="1-æ•´ä½“æŠŠæ¡"><a href="#1-æ•´ä½“æŠŠæ¡" class="headerlink" title="1.æ•´ä½“æŠŠæ¡"></a>1.æ•´ä½“æŠŠæ¡</h1><p>LDAæ˜¯ä¸€ç§<strong>ä¸»é¢˜æ¨¡å‹</strong>ï¼Œå¯ä»¥å°†æ–‡æ¡£é›†ä¸­æ¯ç¯‡æ–‡æ¡£çš„ä¸»é¢˜ä»¥<strong>æ¦‚ç‡åˆ†å¸ƒ</strong>çš„å½¢å¼ç»™å‡ºï¼Œæ ¹æ®ç»™å®šçš„ä¸€ç¯‡æ–‡ç« ï¼Œåæ¨å…¶ä¸»é¢˜åˆ†å¸ƒ</p>
<p>ä¸€ç¯‡æ–‡æ¡£å¯ä»¥åŒ…å«å¤šä¸ªä¸»é¢˜ï¼Œæ–‡æ¡£ä¸­æ¯ä¸€ä¸ªè¯éƒ½ç”±å…¶ä¸­çš„ä¸€ä¸ªä¸»é¢˜ç”Ÿæˆ</p>
<h2 id="1-1LDAçš„å›¾æ¨¡å‹ç»“æ„"><a href="#1-1LDAçš„å›¾æ¨¡å‹ç»“æ„" class="headerlink" title="1.1LDAçš„å›¾æ¨¡å‹ç»“æ„"></a>1.1LDAçš„å›¾æ¨¡å‹ç»“æ„</h2><p>  ç±»ä¼¼è´å¶æ–¯ç½‘ç»œç»“æ„</p>
<p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702178138892.jpg"></p>
<h3 id="1-1-1è´å¶æ–¯çš„å®šä¹‰"><a href="#1-1-1è´å¶æ–¯çš„å®šä¹‰" class="headerlink" title="1.1.1è´å¶æ–¯çš„å®šä¹‰"></a>1.1.1è´å¶æ–¯çš„å®šä¹‰</h3><p>  èŠ‚ç‚¹è¡¨ç¤ºéšæœºå˜é‡${X_1,X_2,â€¦,X_n}$ï¼Œè®¤ä¸ºæœ‰<strong>å› æœå…³ç³»</strong>(æˆ–éæ¡ä»¶ç‹¬ç«‹)çš„å˜é‡æˆ–å‘½é¢˜ç”¨ç®­å¤´æ¥è¿æ¥ã€‚å¦‚æœç”¨ä¸€ä¸ªå•ç®­å¤´æ¥è¿æ¥ï¼Œè¡¨ç¤ºå…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹æ˜¯â€œå› (parents)â€ï¼Œå¦ä¸€ä¸ªæ˜¯â€œæœ(children)â€ï¼Œä¸¤èŠ‚ç‚¹å°±ä¼šäº§ç”Ÿä¸€ä¸ªæ¡ä»¶æ¦‚ç‡å€¼</p>
<p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702177828629.jpg"></p>
<p>  ğŸ‘†åœˆè¡¨ç¤ºéšæœºå˜é‡(random variables)ï¼Œç”¨ç®­å¤´è¡¨ç¤ºæ¡ä»¶ä¾èµ–(conditional dependencies)</p>
<p>  ä»¤$G = (I,E)$è¡¨ç¤ºä¸€ä¸ªæœ‰å‘æ— ç¯å›¾(DAG)ï¼Œå…¶ä¸­Iä»£è¡¨å›¾å½¢ä¸­æ‰€æœ‰çš„èŠ‚ç‚¹çš„é›†åˆï¼Œè€ŒEä»£è¡¨æœ‰å‘è¿æ¥çº¿æ®µçš„é›†åˆï¼Œä¸”ä»¤$X = (X_i),i âˆˆ I$ä¸ºå…¶æœ‰å‘æ— ç¯å›¾ä¸­çš„æŸä¸€èŠ‚ç‚¹iæ‰€ä»£è¡¨çš„éšæœºå˜é‡ï¼Œè‹¥èŠ‚ç‚¹Xçš„è”åˆæ¦‚ç‡å¯ä»¥è¡¨ç¤ºæˆ$p(x)=\prod\limits_{i\in I}p(x_i|x_{pa(i)})$ï¼Œåˆ™ç§°$X$ä¸ºç›¸å¯¹äºä¸€æœ‰å‘æ— ç¯å›¾G çš„è´å¶æ–¯ç½‘ç»œï¼Œå…¶ä¸­ï¼Œ$pa(i)$è¡¨ç¤ºèŠ‚ç‚¹iä¹‹â€œå› â€ï¼Œæˆ–ç§°$pa(i)$æ˜¯$i$çš„parentsï¼ˆçˆ¶æ¯ï¼‰ã€‚</p>
<p>  è”åˆæ¦‚ç‡ï¼šäº‹ä»¶Aå’Œäº‹ä»¶BåŒæ—¶å‘ç”Ÿçš„æ¦‚ç‡ï¼Œè®°ä¸º$P(AB)$æˆ–$P(A,B)$æˆ–$P(Aâˆ©B)$</p>
<p>  å¯¹äºä»»æ„çš„éšæœºå˜é‡ï¼Œå…¶è”åˆæ¦‚ç‡å¯ç”±å„è‡ªçš„å±€éƒ¨æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒç›¸ä¹˜å¾—å‡ºï¼š</p>
<p>  $p(x_1,â€¦.,x_K)=p(x_K|x_1,â€¦.,x_{K-1})â€¦p(x_2|x_1)p(x_1)$</p>
<p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702177836358.jpg"></p>
<p>  ğŸ‘†ä¸€ä¸ªç®€å•çš„è´å¶æ–¯ç½‘ç»œ(aå¯¼è‡´bï¼Œaå’Œbå¯¼è‡´c)</p>
<p>  $p(a,b,c)=p(c|a.b)p(b|a)p(a)$</p>
<h2 id="1-2äºŒé¡¹å¼åˆ†å¸ƒ"><a href="#1-2äºŒé¡¹å¼åˆ†å¸ƒ" class="headerlink" title="1.2äºŒé¡¹å¼åˆ†å¸ƒ"></a>1.2äºŒé¡¹å¼åˆ†å¸ƒ</h2><p>éšæœºå˜é‡åªæœ‰ä¸¤ä¸ª(éæ­£å³è´Ÿ)ï¼Œå³é‡å¤næ¬¡çš„ä¼¯åŠªåˆ©å®éªŒï¼Œè®°ä¸º$X\sim b(n,p)$</p>
<p>äºŒé¡¹åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºï¼š</p>
<p>$P(K=k)=(n,k)p^k(1-p)^{n-k}$</p>
<p> å¯¹äºk = 0, 1, 2, â€¦, nï¼Œå…¶ä¸­çš„</p>
<p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702177851194(1).jpg"></p>
<p>æ˜¯äºŒé¡¹å¼ç³»æ•°ï¼ˆè¿™å°±æ˜¯äºŒé¡¹åˆ†å¸ƒçš„åç§°çš„ç”±æ¥ï¼‰ï¼Œåˆè®°ä¸º$\dfrac{n!}{k!(n-k)!}$</p>
<h2 id="1-3å¤šé¡¹å¼åˆ†å¸ƒ"><a href="#1-3å¤šé¡¹å¼åˆ†å¸ƒ" class="headerlink" title="1.3å¤šé¡¹å¼åˆ†å¸ƒ"></a>1.3å¤šé¡¹å¼åˆ†å¸ƒ</h2><p>ç”±äºŒé¡¹åˆ†å¸ƒæ‰©å±•åˆ°å¤šç»´çš„æƒ…å†µ</p>
<p>éšæœºå˜é‡å–å€¼ä¸æ˜¯0-1ï¼Œè€Œæ˜¯æœ‰å¤šç§ç¦»æ•£å€¼çš„å¯èƒ½(1,2,3,â€¦,k)</p>
<p>å‡è®¾æœ‰$i$ä¸ªç¦»æ•£å€¼ï¼Œé‚£ä¹ˆæœ‰$\sum_{i=1}^kp_i=1,p_i&gt;0$</p>
<p>å¤šé¡¹å¼åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºï¼š$P(x_1,x_2,â€¦,x_k;n,p_1,p_2,â€¦,p_k)=\dfrac{n!}{x_1!â€¦x_k!}p^{x_1}â€¦p^{x_k}$</p>
<h2 id="1-4Gammaåˆ†å¸ƒ"><a href="#1-4Gammaåˆ†å¸ƒ" class="headerlink" title="1.4Gammaåˆ†å¸ƒ"></a>1.4Gammaåˆ†å¸ƒ</h2><p><a href="https://zhuanlan.zhihu.com/p/69606875">Betaå‡½æ•°å’ŒGammaå‡½æ•°çš„å…³ç³»</a></p>
<p>Gammaå‡½æ•°å®é™…æ„ä¹‰ï¼šé˜¶ä¹˜ä¸€èˆ¬åŒ–ï¼Œå°†é˜¶ä¹˜æ¨å¹¿åˆ°å®æ•°åŸŸ</p>
<p>This content is only supported in a Feishu Docs</p>
<h1 id="2-Betaåˆ†å¸ƒ"><a href="#2-Betaåˆ†å¸ƒ" class="headerlink" title="2.Betaåˆ†å¸ƒ"></a>2.Betaåˆ†å¸ƒ</h1><p>This content is only supported in a Feishu Docs</p>
<h2 id="2-1Betaåˆ†å¸ƒ"><a href="#2-1Betaåˆ†å¸ƒ" class="headerlink" title="2.1Betaåˆ†å¸ƒ"></a>2.1Betaåˆ†å¸ƒ</h2><p>betaæ˜¯æŒ‡ä¸€ç»„å®šä¹‰åœ¨$(0,1)$åŒºé—´çš„è¿ç»­æ¦‚ç‡åˆ†å¸ƒï¼Œæœ‰ä¸¤ä¸ªå‚æ•°$\alpha$å’Œ$\beta$ï¼Œä¸”$\alpha,\beta&gt;0$</p>
<p>äºŒé¡¹åˆ†å¸ƒçš„å…±è½­å…ˆéªŒåˆ†å¸ƒ</p>
<p>ç»™å®šå‚æ•°$\alpha&gt;0$å’Œ$\beta&gt;0$ï¼Œå–å€¼èŒƒå›´ä¸º[0,1]çš„éšæœºå˜é‡ x çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼š$f(x;\alpha,\beta)=\dfrac{1}{B(\alpha,\beta)}x^{\alpha-1}(1-x)^{\beta-1}$</p>
<p>å…¶ä¸­$\dfrac{1}{B(\alpha,\beta)}=\dfrac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)},\Gamma(z)=\int_0^\infty t^{z-1}e^{-t}dt$</p>
<p>è§pdf</p>
<h2 id="2-2Beta-Binomialå…±è½­"><a href="#2-2Beta-Binomialå…±è½­" class="headerlink" title="2.2Beta-Binomialå…±è½­"></a>2.2Beta-Binomialå…±è½­</h2><ul>
<li>é—®é¢˜å¼•å…¥ï¼š<ul>
<li><strong>é—®é¢˜1</strong>ï¼šéšæœºå˜é‡$X_1,X_2,â€¦,X_n\sim^{idd}Uniform(0,1)$ï¼ŒæŠŠè¿™nä¸ªéšæœºå˜é‡æ’åºåå¾—åˆ°é¡ºåºç»Ÿè®¡é‡$X_{(1)},X_{(2)},â€¦,X_{(n)}$ï¼Œé—®$X_{(k)}$çš„åˆ†å¸ƒæ˜¯ä»€ä¹ˆ</li>
<li><strong>é—®é¢˜2</strong>ï¼š$X_{(k)}$çš„åˆ†å¸ƒæ˜¯ä»€ä¹ˆ &lt;==&gt; çŒœæµ‹$p=X_{(k)}$ï¼Œ<ul>
<li>$Y_1,Y_2,â€¦,Y_n\sim^{idd}Uniform(0,1)$,$Y_i$ä¸­æœ‰$m_1$ä¸ªæ¯”$p$å°ï¼Œ$m_2$ä¸ªæ¯”$p$å¤§ï¼Œé—®$P(p|Y_1,Y_2,â€¦Y_m)$çš„åˆ†å¸ƒæ˜¯ä»€ä¹ˆ</li>
</ul>
</li>
</ul>
</li>
<li>åˆ†æï¼š<ul>
<li>æ¢è¨€ä¹‹ï¼Œ$Y_i$ä¸­æœ‰$m_1$ä¸ªæ¯”$X_{(k)}$å°ï¼Œæœ‰$m_2$ä¸ªæ¯”$X_{(k)}$å¤§ï¼Œæ‰€ä»¥$X_{(k)}$æ˜¯$X_1,X_2,â€¦,X_n,Y_1,Y_2,â€¦,Y_n\sim^{idd}Uniform(0,1)$ä¸­ç¬¬$k+m_1$å¤§çš„æ•°</li>
<li>äº‹ä»¶æœä»Betaåˆ†å¸ƒ</li>
<li>å¯çŸ¥$p=X_{(k)}$çš„å¯†åº¦æ¦‚ç‡å‡½æ•°ä¸ºï¼š$Beta(p|k+m_1,n-k+1+m_2)$</li>
</ul>
</li>
<li>ä¸è´å¶æ–¯ç»“åˆè¿‡ç¨‹<ul>
<li><p>è´å¶æ–¯æ´¾æ€è€ƒé—®é¢˜çš„å›ºå®šæ¨¡å¼ï¼š</p>
</li>
<li><p><strong>å…ˆéªŒåˆ†å¸ƒ</strong>$\pi(\theta)$<strong>+ æ ·æœ¬ä¿¡æ¯</strong>$X$$\rightarrow$<strong>åéªŒåˆ†å¸ƒ</strong>$\pi(\theta|x)$</p>
</li>
<li><p>åœ¨å¾—åˆ°æ–°çš„æ ·æœ¬ä¿¡æ¯ä¹‹å‰ï¼Œäººä»¬å¯¹$\theta$çš„è®¤çŸ¥æ˜¯å…ˆéªŒåˆ†å¸ƒ$\pi(\theta)$ï¼Œåœ¨å¾—åˆ°æ–°çš„æ ·æœ¬ä¿¡æ¯</p>
<p>$X$åï¼Œäººä»¬å¯¹$\theta$çš„è®¤çŸ¥ä¸º$\pi(\theta|x)$</p>
</li>
<li><p>è¿‡ç¨‹</p>
<ul>
<li>ä¸ºäº†çŒœæµ‹$p=X_{(k)}$ï¼Œåœ¨è·å¾—ä¸€å®šçš„è§‚æµ‹æ•°æ®å‰ï¼Œæˆ‘ä»¬å¯¹$p$çš„è®¤çŸ¥æ˜¯ï¼š$f(p)=Beta(p|k,n-k+1)$ï¼Œæ­¤ç§°ä¸º$p$çš„å…ˆéªŒåˆ†å¸ƒ</li>
<li>ä¸ºäº†è·å¾—ç»“æœ$Y_i$ä¸­æœ‰$m_1$ä¸ªæ¯”$p$å°ï¼Œ$m_2$ä¸ªæ¯”$p$å¤§ï¼Œé’ˆå¯¹$Y_i$åšäº†$m$æ¬¡ä¼¯åŠªåˆ©å®éªŒï¼Œæ‰€ä»¥$m_1$æœä»äºŒé¡¹åˆ†å¸ƒ$B(m,p)$</li>
<li>åœ¨å¾—åˆ°$(m_1,m_2)$çš„æ•°æ®åï¼Œ$p$çš„åéªŒåˆ†å¸ƒä¸º$f(p|m_1,m_2)=Beta(p|k+m_1,n-k+1+m_2)$</li>
</ul>
</li>
<li><p>ç»“åˆè´å¶æ–¯</p>
<ul>
<li>$Beta(p|k,n-k+1)+Count(m_1,m_2)=Beta(p|k+m_1,n-k+1+m_2)$</li>
<li>æ›´ä¸€èˆ¬çš„ï¼Œå¯¹äºéè´Ÿå®æ•°$\alpha$å’Œ$\beta$ï¼šæœ‰å¦‚ä¸‹å…³ç³»$Beta(p|\alpha,\beta)+Count(m_1,m_2)=Beta(p|\alpha+m_1,\beta+m_2)$ï¼Œå…¶ä¸­$Count(m_1,m_2)$å¯¹åº”$B(m,p)$</li>
<li>é’ˆå¯¹è¿™ç§è§‚æµ‹åˆ°çš„æ•°æ®ç¬¦åˆä»¥ä¸‹æ¡ä»¶çš„ï¼Œå°±æ˜¯Beta-Binomialå…±è½­ï¼Œæ¢è¨€ä¹‹ï¼ŒBetaåˆ†å¸ƒæ˜¯äºŒé¡¹å¼åˆ†å¸ƒçš„å…±è½­å…ˆéªŒæ¦‚ç‡åˆ†å¸ƒ<ul>
<li>æ¡ä»¶ä¸€ï¼šäºŒé¡¹åˆ†å¸ƒ</li>
<li>æ¡ä»¶äºŒï¼šå‚æ•°çš„å…ˆéªŒåˆ†å¸ƒå’ŒåéªŒåˆ†å¸ƒéƒ½æ˜¯Betaåˆ†å¸ƒ</li>
<li>å…±è½­å…ˆéªŒåˆ†å¸ƒâ†’2.3</li>
</ul>
</li>
<li>äºŒé¡¹åˆ†å¸ƒå’ŒBetaåˆ†å¸ƒæ˜¯å…±è½­åˆ†å¸ƒæ„å‘³ç€ï¼Œå¦‚æœæˆ‘ä»¬ä¸ºäºŒé¡¹åˆ†å¸ƒçš„å‚æ•°pé€‰å–çš„å…ˆéªŒåˆ†å¸ƒæ˜¯Betaåˆ†å¸ƒï¼Œé‚£ä¹ˆä»¥pä¸ºå‚æ•°çš„äºŒé¡¹åˆ†å¸ƒç”¨è´å¶æ–¯ä¼°è®¡å¾—åˆ°çš„åéªŒåˆ†å¸ƒä»ç„¶æœä»Betaåˆ†å¸ƒ</li>
</ul>
</li>
<li><p>$\alpha$å’Œ$\beta$å¯ä»¥è®¤ä¸ºæ˜¯å½¢çŠ¶å‚æ•°</p>
</li>
</ul>
</li>
</ul>
<h2 id="2-3å…±è½­å…ˆéªŒåˆ†å¸ƒ"><a href="#2-3å…±è½­å…ˆéªŒåˆ†å¸ƒ" class="headerlink" title="2.3å…±è½­å…ˆéªŒåˆ†å¸ƒ"></a>2.3å…±è½­å…ˆéªŒåˆ†å¸ƒ</h2><p>å¦‚æœåéªŒæ¦‚ç‡å’Œå…ˆéªŒæ¦‚ç‡æ»¡è¶³åŒæ ·çš„åˆ†å¸ƒå¾‹ï¼Œé‚£ä¹ˆå…ˆéªŒåˆ†å¸ƒå’ŒåéªŒåˆ†å¸ƒè¢«å«åšå…±è½­åˆ†å¸ƒï¼ŒåŒæ—¶ï¼Œå…ˆéªŒåˆ†å¸ƒå«åšä¼¼ç„¶å‡½æ•°çš„å…±è½­å…ˆéªŒåˆ†å¸ƒã€‚</p>
<p>  æ¯”å¦‚ï¼ŒæŸè§‚æµ‹æ•°æ®æœä»æ¦‚ç‡åˆ†å¸ƒP(Î¸)(å…ˆéªŒ)æ—¶ï¼Œå½“è§‚æµ‹åˆ°æ–°çš„Xæ•°æ®(æ ·æœ¬ä¿¡æ¯)æ—¶ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šé‡åˆ°å¦‚ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li>å¯å¦æ ¹æ®æ–°è§‚æµ‹æ•°æ®Xï¼Œæ›´æ–°å‚æ•°Î¸ï¼Ÿ</li>
<li>æ ¹æ®æ–°è§‚æµ‹æ•°æ®å¯ä»¥åœ¨å¤šå¤§ç¨‹åº¦ä¸Šæ”¹å˜å‚æ•°Î¸ï¼Œå³$\theta \leftarrow \theta + \triangle \theta$</li>
<li>å½“é‡æ–°ä¼°è®¡Î¸çš„æ—¶å€™ï¼Œç»™å‡ºæ–°å‚æ•°å€¼Î¸çš„æ–°æ¦‚ç‡åˆ†å¸ƒï¼Œå³P(Î¸|x)ã€‚</li>
</ul>
<h2 id="2-4ä»Betaåˆ†å¸ƒæ¨å¹¿åˆ°Dirichletåˆ†å¸ƒ"><a href="#2-4ä»Betaåˆ†å¸ƒæ¨å¹¿åˆ°Dirichletåˆ†å¸ƒ" class="headerlink" title="2.4ä»Betaåˆ†å¸ƒæ¨å¹¿åˆ°Dirichletåˆ†å¸ƒ"></a>2.4ä»Betaåˆ†å¸ƒæ¨å¹¿åˆ°Dirichletåˆ†å¸ƒ</h2><p>è§pdf</p>
<p>ç»“è®ºæ˜¯ï¼šå¯¹äºBetaåˆ†å¸ƒçš„éšæœºå˜é‡ï¼Œå…¶å‡å€¼(æœŸæœ›)å¯ä»¥ç”¨$\dfrac{\alpha}{\alpha+\beta}$æ¥ä¼°è®¡</p>
<p>ç±»æ¯”åˆ°Dirichletåˆ†å¸ƒï¼šå¦‚æœ$\mathop{p}\limits^{\rightarrow}\sim Dir(\mathop{t}\limits^{\rightarrow}|\mathop{\alpha}\limits^{\rightarrow})$ï¼Œé‚£ä¹ˆæœ‰$E(\mathop{p}\limits^{\rightarrow})=(\dfrac{\alpha_1}{\sum^K_{i=1}\alpha_i},\dfrac{\alpha_2}{\sum^K_{i=1}\alpha_i},â€¦,\dfrac{\alpha_3}{\sum^K_{i=1}\alpha_i})$</p>
<h1 id="3-Dirichletåˆ†å¸ƒ"><a href="#3-Dirichletåˆ†å¸ƒ" class="headerlink" title="3.Dirichletåˆ†å¸ƒ"></a>3.Dirichletåˆ†å¸ƒ</h1><p>æ˜¯betaåˆ†å¸ƒåœ¨é«˜çº¬åº¦ä¸Šçš„æ¨å¹¿</p>
<p>$f(x_1,x_2,â€¦,x_k;\alpha_1,\alpha_1,â€¦,\alpha_k)=\dfrac{1}{B(\alpha)}\prod_{i=1}^kx_{i}^{a^i-1}$</p>
<p>å…¶ä¸­$B(\alpha)=\dfrac{\prod_{i=1}^k\Gamma(a^i)}{\Gamma(\sum_{i=1}^k)a^i},\sum x_i=1$</p>
<h2 id="3-1Dirichletåˆ†å¸ƒ"><a href="#3-1Dirichletåˆ†å¸ƒ" class="headerlink" title="3.1Dirichletåˆ†å¸ƒ"></a>3.1Dirichletåˆ†å¸ƒ</h2><p>This content is only supported in a Feishu Docs</p>
<h2 id="3-2Dirichlet-Multinomialå…±è½­"><a href="#3-2Dirichlet-Multinomialå…±è½­" class="headerlink" title="3.2Dirichlet-Multinomialå…±è½­"></a>3.2Dirichlet-Multinomialå…±è½­</h2><ul>
<li>é—®é¢˜å¼•å…¥ï¼šåœ¨2.2çš„é—®é¢˜2çš„åŸºç¡€ä¸Šç»§ç»­æ·±å…¥<ul>
<li><strong>é—®é¢˜3</strong>ï¼šéšæœºå˜é‡$X_1,X_2,â€¦,X_n\sim^{idd}Uniform(0,1)$ï¼ŒæŠŠè¿™nä¸ªéšæœºå˜é‡æ’åºåå¾—åˆ°é¡ºåºç»Ÿè®¡é‡$X_{(1)},X_{(2)},â€¦,X_{(n)}$ï¼Œé—®$(X_{(k_1)},X_{k_1+k_2})$çš„è”åˆåˆ†å¸ƒæ˜¯ä»€ä¹ˆ<ul>
<li>è®¡ç®—è§pdf</li>
</ul>
</li>
<li>ä¸ºè®ºè¯Dirichletåˆ†å¸ƒæ˜¯å¤šé¡¹å¼åˆ†å¸ƒçš„å…±è½­å…ˆéªŒæ¦‚ç‡åˆ†å¸ƒï¼Œåœ¨é—®é¢˜3çš„åŸºç¡€ä¸Šç»§ç»­æ·±å…¥<ul>
<li>é—®é¢˜4ï¼š<ul>
<li>éšæœºå˜é‡$X_1,X_2,â€¦,X_n\sim^{idd}Uniform(0,1)$ï¼ŒæŠŠè¿™nä¸ªéšæœºå˜é‡æ’åºåå¾—åˆ°é¡ºåºç»Ÿè®¡é‡$X_{(1)},X_{(2)},â€¦,X_{(n)}$</li>
<li>ä»¤$p_1=X_{k_1},p_2=X(k_1+k_2),p_3=1-p_1-p_2$ï¼Œç°åœ¨è¦çŒœæµ‹$\mathop{p}\limits^{\rightarrow}=(p_1,p_2,p_3)$</li>
<li>$Y_1,Y_2,â€¦,Y_m\sim^{idd}Uniform(0,1)$ï¼Œ$Y_i$ä¸­è½åˆ°$(0,p_1],[p_1,p_2),[p_2,1]$ä¸‰ä¸ªåŒºé—´çš„ä¸ªæ•°åˆ†åˆ«ä¸º$m_1,m_2,m_3$ï¼Œ$m=m_1+m_2+m_3$</li>
<li>é—®åéªŒåˆ†å¸ƒ$P(\mathop{p}\limits^{\rightarrow}|Y_1,Y_2,â€¦Y_m)$çš„åˆ†å¸ƒæ˜¯ä»€ä¹ˆ</li>
<li>è®¨è®ºè§pdf</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>ä¸è´å¶æ–¯ç»“åˆæ¨ç†ï¼š<ul>
<li>è¦çŒœæµ‹å‚æ•°$\mathop{p}\limits^{\rightarrow}=(p_1,p_2,p_3)$ï¼Œå…¶å…ˆéªŒåˆ†å¸ƒä¸º$Dir(\mathop{p}\limits^{\rightarrow}|\mathop{k}\limits^{\rightarrow})$</li>
<li>$Y_1,Y_2,â€¦,Y_m\sim^{idd}Uniform(0,1)$ï¼Œ$Y_i$ä¸­è½åˆ°$(0,p_1],[p_1,p_2),[p_2,1]$ä¸‰ä¸ªåŒºé—´çš„ä¸ªæ•°åˆ†åˆ«ä¸º$m_1,m_2,m_3$ï¼Œæ‰€ä»¥$\mathop{m}\limits^{\rightarrow}=(m_1,m_2,m_3)$æœä»å¤šé¡¹åˆ†å¸ƒ$Mult(\mathop{m}\limits^{\rightarrow}|\mathop{p}\limits^{\rightarrow})$</li>
<li>ç»™å®šäº†æ¥è‡ªæ•°æ®æä¾›çš„$\mathop{m}\limits^{\rightarrow}$åï¼Œ$\mathop{p}\limits^{\rightarrow}$çš„åéªŒåˆ†å¸ƒå˜ä¸º$Dir(\mathop{p}\limits^{\rightarrow}|\mathop{k}\limits^{\rightarrow}+\mathop{m}\limits^{\rightarrow})$</li>
<li>ç›´è§‚è¡¨è¿°ï¼š<ol>
<li>$Dir(\mathop{p}\limits^{\rightarrow}|\mathop{k}\limits^{\rightarrow})+MultCount(\mathop{m}\limits^{\rightarrow})=Dir(\mathop{p}\limits^{\rightarrow}|\mathop{k}\limits^{\rightarrow}+\mathop{m}\limits^{\rightarrow})$</li>
<li>ä»¤$\mathop{\alpha}\limits^{\rightarrow}=\mathop{k}\limits^{\rightarrow}ï¼Œå¯ä»¥æŠŠ$\mathop{\alpha}\limits^{\rightarrow}$ä»æ•´æ•°é›†åˆå»¶æ‹“åˆ°å®æ•°é›†åˆï¼Œä»è€Œå¾—åˆ°æ›´ä¸€èˆ¬çš„è¡¨è¾¾ï¼š</li>
<li>$Dir(\mathop{p}\limits^{\rightarrow}|\mathop{\alpha}\limits^{\rightarrow})+MultCount(\mathop{m}\limits^{\rightarrow})=Dir(\mathop{p}\limits^{\rightarrow}|\mathop{\alpha}\limits^{\rightarrow}+\mathop{m}\limits^{\rightarrow})$</li>
</ol>
</li>
</ul>
</li>
<li>ç»“è®ºï¼š<ul>
<li>è§‚æµ‹åˆ°çš„æ•°æ®ç¬¦åˆå¤šé¡¹åˆ†å¸ƒ</li>
<li>å‚æ•°çš„å…ˆéªŒåˆ†å¸ƒå’ŒåéªŒåˆ†å¸ƒéƒ½æ˜¯Dirichletåˆ†å¸ƒ</li>
<li>å°±æ˜¯Dirichlet-Multinomialå…±è½­</li>
<li>ä¸€èˆ¬å½¢å¼çš„Dirichletåˆ†å¸ƒå®šä¹‰å’Œå¯¹äºç»™å®šçš„$\mathop{p}\limits^{\rightarrow}$å’Œ$N$ï¼Œå…¶å¤šé¡¹å¼åˆ†å¸ƒè§pdf</li>
<li>Dirichletåˆ†å¸ƒ$Dir(\mathop{p}\limits^{\rightarrow}|\mathop{\alpha}\limits^{\rightarrow})$å’Œå¤šé¡¹åˆ†å¸ƒ$MultCount(\mathop{n}\limits^{\rightarrow}|\mathop{p}\limits^{\rightarrow},N)$æ˜¯å…±è½­å…³ç³»</li>
</ul>
</li>
</ul>
<h1 id="4-LDAæ¨¡å‹"><a href="#4-LDAæ¨¡å‹" class="headerlink" title="4.LDAæ¨¡å‹"></a>4.LDAæ¨¡å‹</h1><p><strong>å®šä¹‰çš„å˜é‡</strong></p>
<ul>
<li>$w$è¡¨ç¤ºè¯ï¼Œ$V$è¡¨ç¤ºæ‰€æœ‰å•è¯çš„ä¸ªæ•°ï¼ˆå›ºå®šå€¼ï¼‰</li>
<li>$z$è¡¨ç¤ºä¸»é¢˜ï¼Œæ˜¯ä¸»é¢˜çš„ä¸ªæ•°ï¼ˆé¢„å…ˆç»™å®šï¼Œå›ºå®šå€¼ï¼‰</li>
<li>$D(w_1,â€¦,w_M)$è¡¨ç¤ºè¯­æ–™åº“ï¼Œå…¶ä¸­çš„$M$æ˜¯è¯­æ–™åº“ä¸­çš„æ–‡æ¡£æ•°ï¼ˆå›ºå®šå€¼ï¼‰</li>
<li>$\mathbf{w}=(w_1,w_2,â€¦,w_N)$è¡¨ç¤ºæ–‡æ¡£ï¼Œå…¶ä¸­çš„$N$è¡¨ç¤ºä¸€ä¸ªæ–‡æ¡£ä¸­çš„è¯æ•°ï¼ˆéšæœºå˜é‡ï¼‰</li>
</ul>
<h2 id="4-1å„ä¸ªæ¨¡å‹åŸºç¡€"><a href="#4-1å„ä¸ªæ¨¡å‹åŸºç¡€" class="headerlink" title="4.1å„ä¸ªæ¨¡å‹åŸºç¡€"></a>4.1å„ä¸ªæ¨¡å‹åŸºç¡€</h2><h3 id="4-1-1Unigram-model"><a href="#4-1-1Unigram-model" class="headerlink" title="4.1.1Unigram model"></a>4.1.1Unigram model</h3><p>å¯¹äºæ–‡æ¡£$\mathbf{w}=(w_1,w_2,â€¦,w_N)$ï¼Œç”¨$p(w_n)$è¡¨ç¤ºè¯$w_n$çš„å…ˆéªŒæ¦‚ç‡ï¼Œç”Ÿæˆæ–‡æ¡£$\mathbf{w}$çš„æ¦‚ç‡ä¸ºï¼š$p(\mathbf{w})=\sum^N_{n=1}p(w_n)$</p>
<p>å›¾æ¨¡å‹ä¸º</p>
<ul>
<li><p>å›¾æ¨¡å‹ä¸€</p>
<ul>
<li>(å›¾ä¸­è¢«æ¶‚è‰²çš„w(word)è¡¨ç¤ºå¯è§‚æµ‹å˜é‡ï¼ŒNè¡¨ç¤ºä¸€ç¯‡æ–‡æ¡£ä¸­æ€»å…±Nä¸ªå•è¯ï¼ŒMè¡¨ç¤ºMç¯‡æ–‡æ¡£)</li>
<li><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702177856933.jpg"></li>
</ul>
</li>
<li><p>å›¾æ¨¡å‹äºŒ</p>
<ul>
<li><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702177862768.jpg"></li>
<li>nigram modelå‡è®¾æ–‡æœ¬ä¸­çš„è¯æœä»Multinomialåˆ†å¸ƒï¼Œè€Œæˆ‘ä»¬å·²ç»çŸ¥é“Multinomialåˆ†å¸ƒçš„å…ˆéªŒåˆ†å¸ƒä¸ºDirichletåˆ†å¸ƒã€‚ä¸Šå›¾ä¸­çš„$w_n$è¡¨ç¤ºåœ¨æ–‡æœ¬ä¸­è§‚å¯Ÿåˆ°çš„ç¬¬nä¸ªè¯ï¼Œ$n\in[1,N]$è¡¨ç¤ºè¯¥æ–‡æœ¬ä¸­ä¸€å…±æœ‰$N$ä¸ªå•è¯ã€‚åŠ ä¸Šæ–¹æ¡†è¡¨ç¤ºé‡å¤ï¼Œå³ä¸€å…±æœ‰$N$ä¸ªè¿™æ ·çš„éšæœºå˜é‡$w_n$ã€‚å…¶ä¸­ï¼Œ$p$å’Œ$\alpha$æ˜¯éšå«æœªçŸ¥å˜é‡ï¼š</li>
<li>$p$æ˜¯è¯æœä»çš„Multinomialåˆ†å¸ƒçš„å‚æ•°</li>
<li>$\alpha$æ˜¯Dirichletåˆ†å¸ƒ(å³Multinomialåˆ†å¸ƒçš„å…ˆéªŒåˆ†å¸ƒ)çš„å‚æ•°</li>
<li>ä¸€èˆ¬$\alpha$ç”±ç»éªŒäº‹å…ˆç»™å®š(å…ˆéªŒ)ï¼Œ$p$ç”±è§‚å¯Ÿåˆ°çš„æ–‡æœ¬ä¸­å‡ºç°çš„è¯å­¦ä¹ å¾—åˆ°(æ ·æœ¬)ï¼Œè¡¨ç¤ºæ–‡æœ¬ä¸­å‡ºç°æ¯ä¸ªè¯çš„æ¦‚ç‡</li>
</ul>
</li>
</ul>
<h3 id="4-1-2Mixture-of-unigrams-model"><a href="#4-1-2Mixture-of-unigrams-model" class="headerlink" title="4.1.2Mixture of unigrams model"></a>4.1.2Mixture of unigrams model</h3><p>è¯¥æ¨¡å‹çš„ç”Ÿæˆè¿‡ç¨‹æ˜¯ï¼šç»™æŸä¸ªæ–‡æ¡£å…ˆé€‰æ‹©ä¸€ä¸ªä¸»é¢˜$z$ï¼Œå†æ ¹æ®è¯¥ä¸»é¢˜ç”Ÿæˆæ–‡æ¡£ï¼Œè¯¥æ–‡æ¡£ä¸­çš„æ‰€æœ‰è¯éƒ½æ¥è‡ªä¸€ä¸ªä¸»é¢˜ã€‚å‡è®¾ä¸»é¢˜æœ‰$z_1,â€¦z_k$ï¼Œç”Ÿæˆæ–‡æ¡£$\mathbf{w}$çš„æ¦‚ç‡ä¸ºï¼š</p>
<p>$p(\mathbf{w})=p(z_1)\prod^N_{n=1}p(w_n|z_1)+â€¦+p(z_k)\prod^N_{n=1}p(w_n|z_k)=\sum_zp(z)\prod^N_{n=1}p(w_n|z)$</p>
<p>å›¾æ¨¡å‹ä¸ºï¼š(å›¾ä¸­è¢«æ¶‚è‰²çš„wè¡¨ç¤ºå¯è§‚æµ‹å˜é‡ï¼Œæœªè¢«æ¶‚è‰²çš„zè¡¨ç¤ºæœªçŸ¥çš„éšå˜é‡ï¼ŒNè¡¨ç¤ºä¸€ç¯‡æ–‡æ¡£ä¸­æ€»å…±Nä¸ªå•è¯ï¼ŒMè¡¨ç¤ºMç¯‡æ–‡æ¡£)</p>
<p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702177867686(1).jpg"></p>
<h2 id="4-2PLSAæ¨¡å‹"><a href="#4-2PLSAæ¨¡å‹" class="headerlink" title="4.2PLSAæ¨¡å‹"></a>4.2PLSAæ¨¡å‹</h2><p>å»ºè®®ç›´æ¥<a href="https://blog.csdn.net/v_JULY_v/article/details/41209515?spm=1001.2101.3001.6650.1&amp;utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-1.no_search_link&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-1.no_search_link&amp;utm_relevant_index=2">çœ‹è¿™ä¸ª</a></p>
<h3 id="4-2-1pLSAæ¨¡å‹ä¸‹ç”Ÿæˆæ–‡æ¡£"><a href="#4-2-1pLSAæ¨¡å‹ä¸‹ç”Ÿæˆæ–‡æ¡£" class="headerlink" title="4.2.1pLSAæ¨¡å‹ä¸‹ç”Ÿæˆæ–‡æ¡£"></a>4.2.1pLSAæ¨¡å‹ä¸‹ç”Ÿæˆæ–‡æ¡£</h3><p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702177872673.jpg"></p>
<h3 id="4-2-2æ ¹æ®æ–‡æ¡£åæ¨å…¶ä¸»é¢˜åˆ†å¸ƒ"><a href="#4-2-2æ ¹æ®æ–‡æ¡£åæ¨å…¶ä¸»é¢˜åˆ†å¸ƒ" class="headerlink" title="4.2.2æ ¹æ®æ–‡æ¡£åæ¨å…¶ä¸»é¢˜åˆ†å¸ƒ"></a>4.2.2æ ¹æ®æ–‡æ¡£åæ¨å…¶ä¸»é¢˜åˆ†å¸ƒ</h3><p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702177893244.jpg"></p>
<p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702177906171.jpg"></p>
<h3 id="4-2-3EMç®—æ³•"><a href="#4-2-3EMç®—æ³•" class="headerlink" title="4.2.3EMç®—æ³•"></a>4.2.3EMç®—æ³•</h3><p>This content is only supported in a Feishu Docs</p>
<h4 id="4-2-3-1EMç®—æ³•çš„ç®€å•ä»‹ç»"><a href="#4-2-3-1EMç®—æ³•çš„ç®€å•ä»‹ç»" class="headerlink" title="4.2.3.1EMç®—æ³•çš„ç®€å•ä»‹ç»"></a>4.2.3.1EMç®—æ³•çš„ç®€å•ä»‹ç»</h4><p><a href="https://zhuanlan.zhihu.com/p/78311644">EMç®—æ³•</a></p>
<p>éšå˜é‡$Z=(z_1,z_2,z_3,z_4,z_5)$ä»£è¡¨æ¯ä¸€è½®æ‰€ä½¿ç”¨çš„ç¡¬å¸</p>
<p>æ‰€ä»¥ç¬¬ä¸€æ­¥å…ˆä¼°ç®—$Z$ï¼Œè¿™æ­¥åŒæ—¶æ˜¯E-step</p>
<p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702177911648.jpg"></p>
<p>ğŸ‘†æµç¨‹ï¼š</p>
<ol>
<li>éšæœºåˆå§‹åŒ–$\theta_A=0.6$å’Œ$\theta_B=0.5$(E-step)</li>
<li>Hä»£è¡¨æ­£é¢ï¼ŒTä»£è¡¨åé¢ï¼›å¯¹äºç¬¬ä¸€è½®æ¥è¯´ï¼Œå®é™…çš„æƒ…å†µæ˜¯5ä¸ªæ­£çš„5ä¸ªåçš„ï¼Œè¿›è¡Œå¦‚ä¸‹è®¡ç®—<ol>
<li>$P_A=\dfrac{0.6^5<em>0.4^5}{(0.6^5</em>0.4^5)+(0.5^5+0.5^5)}=0.45$</li>
<li>$P_B=\dfrac{(0.5^5+0.5^5)}{(0.6^5*0.4^5)+(0.5^5+0.5^5)}=0.55$<ul>
<li>â€‹    å¯¹äºç¬¬ä¸€è½®æŠ›æ·ï¼Œè¯¥æšç¡¬å¸æ˜¯ç¡¬å¸Açš„æ¦‚ç‡ä¸º0.45ï¼Œæ˜¯ç¡¬å¸Bçš„æ¦‚ç‡ä¸º0.55ï¼Œå…¶ä»–è½®åŒç†ï¼Œè¿™ä¸€æ­¥å¾—åˆ°äº†Zçš„æ¦‚ç‡åˆ†å¸ƒ</li>
<li><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702177916936.jpg"></li>
</ul>
</li>
</ol>
</li>
<li>åˆ©ç”¨æœŸæœ›æ±‚ç¡¬å¸Aå’Œç¡¬å¸Bçš„è´¡çŒ®ï¼Œå¯¹äºç¬¬ä¸€è½®æ¥è¯´<ol>
<li>Hï¼š0.45*5=2.25</li>
<li>Tï¼š0.55*5=2.75</li>
<li>å…¶ä»–è½®åŒç†</li>
<li><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702177922766.jpg"></li>
<li>ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡æ¥ä¼°è®¡æ–°çš„$\theta_A$å’Œ$\theta_B$ï¼Œè¿™æ­¥å°±æ˜¯M-Step<ul>
<li>$\theta_A=\dfrac{21.3}{21.3+8.6}=0.71$</li>
<li>$\theta_B=\dfrac{11.7}{11.7+8.4}=0.58$</li>
</ul>
</li>
</ol>
</li>
<li>å¦‚æ­¤åå¤è¿­ä»£ï¼Œå¯ä»¥ç®—å‡ºæœ€ç»ˆçš„å‚æ•°å€¼</li>
<li>$L(\theta)$ä¸$J(z,Q)$çš„å…³ç³»<ol>
<li>è¿™å¼ å›¾çš„æ„æ€æ˜¯</li>
<li>å…ˆå›ºå®š$\theta$ï¼Œè°ƒæ•´$Q(z)$ä½¿ä¸‹ç•Œ$J(z,Q)$ä¸Šå‡è‡³ä¸$L(\theta)$åœ¨è¯¥$\theta$å€¼ä¸‹ç›¸åŒ(ç”±ç»¿çº¿åˆ°è“çº¿)</li>
<li>ç„¶åå›ºå®š$Q(z)$ï¼Œè°ƒæ•´$\theta$ä½¿ä¸‹ç•Œ$J(z,Q)$è¾¾åˆ°æœ€å¤§å€¼</li>
<li>å†å›ºå®š$\theta$â€¦</li>
<li>ç›´åˆ°æ”¶æ•›åˆ°ä¼¼ç„¶å‡½æ•°$L(\theta)$çš„æœ€å¤§å€¼æ—¶ï¼Œå¾—åˆ°è¯¥å¤„çš„$\theta^{*}$</li>
<li><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702177927472.jpg"></li>
</ol>
</li>
<li>EMç®—æ³•çš„æ•´ä½“æ¡†æ¶</li>
</ol>
<p>Repeat until convergence{</p>
<p>  (E-step) For each </p>
<p>$i$</p>
<p>,set</p>
<p>â€‹    $Q_i(z):=p(z^{(i)}|x^{(i)};\theta)$                                   æ‰¾éšå˜é‡çš„åˆ†å¸ƒ(ç›´çº¿å¾€ä¸Šç§»)</p>
<p>â€‹     (M-step) Set</p>
<p>â€‹    $\theta:=arg max_{\theta}\sum_i\sum_{z^{(i)}}log\dfrac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})}$   æ‰¾æ–°çš„$\theta$(ç‚¹ä½å¾€å·¦å³ç§»)</p>
<p>}</p>
<h4 id="4-2-3-2EMç®—æ³•ä¼°è®¡pLSAçš„ä¸¤ä¸ªæœªçŸ¥å‚æ•°"><a href="#4-2-3-2EMç®—æ³•ä¼°è®¡pLSAçš„ä¸¤ä¸ªæœªçŸ¥å‚æ•°" class="headerlink" title="4.2.3.2EMç®—æ³•ä¼°è®¡pLSAçš„ä¸¤ä¸ªæœªçŸ¥å‚æ•°"></a>4.2.3.2EMç®—æ³•ä¼°è®¡pLSAçš„ä¸¤ä¸ªæœªçŸ¥å‚æ•°</h4><p>ä»<strong>çŸ©é˜µè§’åº¦</strong>æè¿°å¸¦ä¼°è®¡çš„ä¸¤ä¸ªæœªçŸ¥å˜é‡$P(w_j|z_k)$å’Œ$P(z_k|d_i)$</p>
<p>è¯è¡¨$V$æœ‰$j$ä¸ªè¯é¡¹ï¼›æ‰€æœ‰ä¸»é¢˜$Z$æœ‰$k$ä¸ªä¸»é¢˜ï¼›æœ‰$i$ç¯‡æ–‡ç« </p>
<ul>
<li>å‡å®šç”¨$\phi_k$è¡¨ç¤ºè¯è¡¨$V$åœ¨ä¸»é¢˜$z_k$ä¸Šçš„ä¸€ä¸ªå¤šé¡¹åˆ†å¸ƒï¼Œåˆ™$\phi_k$å¯ä»¥è¡¨ç¤ºæˆä¸€ä¸ªå‘é‡ï¼Œæ¯ä¸ªå…ƒç´ $\phi_{k,j}$è¡¨ç¤ºè¯é¡¹$w_j$å‡ºç°åœ¨ä¸»é¢˜$z_k$ä¸­çš„æ¦‚ç‡ï¼Œå³ï¼š<ul>
<li>$P(w_j|z_k)=\phi_{k,j}$ï¼Œ$\sum_{w_j\in V}\phi_{k,j}=1$</li>
</ul>
</li>
<li>å‡å®šç”¨$\theta_i$è¡¨ç¤ºæ‰€æœ‰ä¸»é¢˜$K$åœ¨æ–‡æ¡£$d_i$ä¸Šçš„ä¸€ä¸ªå¤šé¡¹åˆ†å¸ƒï¼Œåˆ™$\theta_i$å¯ä»¥è¡¨ç¤ºæˆä¸€ä¸ªå‘é‡ï¼Œæ¯ä¸ªå…ƒç´ $\theta_{i,k}$è¡¨ç¤ºä¸»é¢˜$z_k$å‡ºç°åœ¨æ–‡æ¡£$d_i$ä¸­çš„æ¦‚ç‡ï¼Œå³ï¼š<ul>
<li>$P(z_k|d_i)=\theta_{i,k}$ï¼Œ$\sum_{z_k\in K}\theta_{i,k}=1$</li>
</ul>
</li>
</ul>
<p>$P(w_j|z_k)$å’Œ$P(z_k|d_i)$è½¬æ¢æˆäº†ä¸¤ä¸ªçŸ©é˜µï¼Œæ¢è¨€ä¹‹ï¼Œæˆ‘ä»¬è¦æ±‚è§£çš„å‚æ•°å°±æ˜¯è¿™ä¸¤ä¸ªçŸ©é˜µï¼š</p>
<ul>
<li>$\Phi=[\phi_1,â€¦\phi_K], z_k\in Z$</li>
<li>$\Theta=[\theta_i,â€¦,\theta_M],d_i\in D$</li>
</ul>
<p>è¯å’Œè¯ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œæ•´ç¯‡æ–‡æ¡£$N$ä¸ªè¯çš„åˆ†å¸ƒä¸ºï¼š</p>
<ul>
<li>$P(W|d_i)=\prod_{j=1}^NP(d_i,w_j)^{n(d_i,w_j)}$</li>
</ul>
<p>æ–‡æ¡£å’Œæ–‡æ¡£ä¹‹é—´ä¹Ÿæ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œæ•´ä¸ªè¯­æ–™åº“($M$ç¯‡æ–‡æ¡£,æ¯ç¯‡æ–‡æ¡£$N$ä¸ªè¯)ä¸­è¯çš„åˆ†å¸ƒä¸º</p>
<ul>
<li>$P(W|D)=\prod_{i=1}^M\prod_{j=1}^NP(d_i,w_j)^{n(d_i,w_j)}$</li>
</ul>
<p>å…¶ä¸­ï¼Œ</p>
<p>$n(d_i,w_j)$è¡¨ç¤ºè¯é¡¹$w_j$åœ¨æ–‡æ¡£$d_i$ä¸­çš„è¯é¢‘</p>
<p>$n(d_i)$è¡¨ç¤ºæ–‡æ¡£$d_i$ä¸­æ–‡æ¡£è¯çš„æ€»æ•°</p>
<p>æ˜¾ç„¶æœ‰$n(d_i)=\sum_{w_j\in V}n(d_i,w_j)$ï¼Œä¸€ç¯‡æ–‡æ¡£ä¸­è¯çš„æ€»æ•°ç­‰äºè¯è¡¨ä¸­æ¯ä¸ªè¯å‡ºç°çš„æ¬¡æ•°ä¹‹å’Œ</p>
<p>æ•´ä¸ªè¯­æ–™åº“çš„è¯åˆ†å¸ƒçš„å¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼š</p>
<p>$\begin{align} l(\Phi,\Theta)&amp;=\sum_{i=1}^{M}\sum_{j=1}^Nn(d_i,w_j)logP(d_i,w_j)\ &amp;=\sum_{i=1}^Mn(d_i)\left(logP(d_i)+\sum_{j=1}^N\dfrac{n(d_i,w_j)}{n(d_i)}log\sum_{k=1}^KP(w_j|z_k)P(z_k|d_i)\right)\ &amp;=\sum_{i=1}^Mn(d_i)\left(logP(d_i)+\sum_{j=1}^N\dfrac{n(d_i,w_j)}{n(d_i)}log\sum_{k=1}^K\phi_{k,j}\theta_{i,k}\right) \end{align}$</p>
<ul>
<li>(1)å¯¹åº”çš„æ˜¯$L(\theta)\geq\sum_{i=1}^n\sum_z^ZQ_i(z)log\dfrac{P(x_i,z;\theta)}{Q_i(z)}$ï¼Œå…¶ä¸­$Q_i(z)$è¡¨ç¤ºçš„æ˜¯æ ·æœ¬$i$éšå«å˜é‡$z$çš„æŸç§åˆ†å¸ƒï¼›$log\dfrac{P(x_i,z;\theta)}{Q_i(z)}$è¡¨ç¤ºçš„æ˜¯å¯¹æ•°ä¼¼ç„¶å‡½æ•°</li>
<li>(2)åˆ†åˆ«æ±‚æ–‡æœ¬çš„å¯¹æ•°ä¼¼ç„¶å‡½æ•°å’Œè¯çš„å¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼Œè§pdf</li>
<li>(3)å°±æ˜¯ä¸Šé¢å¾—åˆ°çš„ä»¥çŸ©é˜µçš„å½¢å¼è¡¨è¾¾å¤šé¡¹å¼åˆ†å¸ƒ</li>
</ul>
<p>å¤šå…ƒå‡½æ•°åœ¨æœ‰çº¦æŸæ¡ä»¶$\sum_{j=1}^{M}\theta_{k,j}=1$å’Œ$\sum_{k=1}^K\phi_{i,k}=1$ä¸‹æ±‚æå€¼ï¼Œç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•(å³é€šè¿‡å¼•å…¥æ‹‰æ ¼æœ—æ—¥ä¹˜å­å°†çº¦æŸæ¡ä»¶å’Œå¤šå…ƒ(ç›®æ ‡)å‡½æ•°èåˆåˆ°ä¸€èµ·ï¼Œè½¬åŒ–ä¸ºæ— çº¦æŸæ¡ä»¶çš„æå€¼é—®é¢˜)è§pdf</p>
<p>æ€»ç»“ï¼š</p>
<ol>
<li>ä¸ºæ±‚å¾—$P(w_j|z_k)$å’Œ$P(z_k|d_i)$ï¼Œå› æ­¤ç”¨EMç®—æ³•å»ä¼°è®¡$\theta=(P(w_j|z_k),z_k|d_i)$è¿™ä¸ªå‚æ•°</li>
<li>$\phi_{k,j}$è¡¨ç¤ºè¯é¡¹$w_j$å‡ºç°åœ¨ä¸»é¢˜$z_k$ä¸­çš„é¢‘ç‡ï¼Œå³$P(w_j|z_k)=\phi_{k,j}$ï¼Œä»è€ŒæŠŠ$P(w_j|z_k)$è½¬æ¢æˆçŸ©é˜µ$\Phi$</li>
<li>$\theta_{i,k}$è¡¨ç¤ºä¸»é¢˜$z_k$å‡ºç°åœ¨æ–‡æ¡£$d_i$ä¸­çš„é¢‘ç‡ï¼Œå³$P(z_k|d_i)=\theta_{k,i}$ï¼Œä»è€ŒæŠŠ$P(z_k|d_i)$è½¬æ¢æˆçŸ©é˜µ$\Theta$</li>
<li>æœ€åé€šè¿‡EMç®—æ³•æ±‚å‡ºä¸¤ä¸ªçŸ©é˜µ</li>
</ol>
<h5 id="4-2-3-2-1æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•"><a href="#4-2-3-2-1æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•" class="headerlink" title="4.2.3.2.1æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•"></a>4.2.3.2.1æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•</h5><ol>
<li>æ²¡æœ‰çº¦æŸæ¡ä»¶</li>
</ol>
<p>ç›®æ ‡å‡½æ•°$f(x,y)$æ˜¯ä¸€åº§å±±çš„é«˜åº¦ï¼Œçº¦æŸ$g(x,y)$æ˜¯é•¶åµŒåœ¨å±±ä¸Šçš„ä¸€æ¡æ›²çº¿ï¼Œå¦‚ä¸‹å›¾</p>
<p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702177933575.jpg"></p>
<p>çº¢çº¿æ˜¯çº¦æŸæ›²çº¿</p>
<p>ç›®çš„ï¼šæ‰¾çº¢çº¿ä¸Šçš„æœ€ä½ç‚¹</p>
<p>æ­¥éª¤ï¼š</p>
<ul>
<li>ä»ç¬¬0æ¡çº¿å¼€å§‹å¾€ä¸Šæ•°ï¼Œæ•°åˆ°ç¬¬ä¸‰æ¡ï¼Œä¸çº¦æŸæ›²çº¿æœ‰äº¤ç‚¹ï¼Œæ¯”ç¬¬ä¸‰æ¡ä½çš„åœ°æ–¹éƒ½ä¸åœ¨çº¦æŸèŒƒå›´å†…ï¼Œæ‰€ä»¥è¿™æ˜¯çº¦æŸæ›²çº¿çš„æœ€ä½ç‚¹</li>
<li>çº¦æŸæ›²çº¿ä¸ä¼šå’Œç­‰é«˜çº¿ç›¸äº¤ï¼Œä¸€å®šæ˜¯ç›¸åˆ‡ï¼Œå¦‚æœæ˜¯ç›¸äº¤çš„è¯ï¼Œçº¦æŸæ›²çº¿æœ‰ä¸€éƒ¨åˆ†åœ¨æœ€ä½ç‚¹çš„æ›²çº¿çš„ä¸‹ç«¯(å³ç›®æ ‡æ›²çº¿å¹¶ä¸èƒ½åŒ…æ‹¬çº¦æŸæ›²çº¿çš„æœ€ä½ç‚¹)ï¼Œå¦‚ä¸‹å›¾ä¸­çº¦æŸæ›²çº¿æœ‰ä¸€éƒ¨åˆ†åœ¨BåŒºåŸŸï¼Œä½†æ˜¯BåŒºåŸŸæ¯”ç­‰é«˜çº¿ä½<ul>
<li><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702177938067.jpg"></li>
</ul>
</li>
<li>é‚£ä¹ˆä¸¤æ¡çº¿åªèƒ½ç›¸åˆ‡ï¼Œæ„å‘³ä»–ä»¬çš„æ³•çº¿å¹³è¡Œ&lt;==&gt;æ³•å‘é‡åªå·®ä¸€ä¸ªä»»æ„çš„å¸¸æ•°ä¹˜å­(å–-$\lambda$)ï¼š<ul>
<li>âˆ‡$f(x,y)=-\lambda$âˆ‡$g(x,y)$</li>
<li>âˆ‡$f(x,y)+\lambda$âˆ‡$g(x,y)=0$</li>
</ul>
</li>
</ul>
<ol>
<li><a href="https://zhuanlan.zhihu.com/p/55532322">æœ‰çº¦æŸæ¡ä»¶</a></li>
</ol>
<p>è§pdf</p>
<h2 id="4-3LDAæ¨¡å‹"><a href="#4-3LDAæ¨¡å‹" class="headerlink" title="4.3LDAæ¨¡å‹"></a>4.3LDAæ¨¡å‹</h2><h3 id="4-3-1pLSAå’ŒLDAçš„å¯¹æ¯”ï¼šç”Ÿæˆæ–‡æ¡£ä¸å‚æ•°ä¼°è®¡"><a href="#4-3-1pLSAå’ŒLDAçš„å¯¹æ¯”ï¼šç”Ÿæˆæ–‡æ¡£ä¸å‚æ•°ä¼°è®¡" class="headerlink" title="4.3.1pLSAå’ŒLDAçš„å¯¹æ¯”ï¼šç”Ÿæˆæ–‡æ¡£ä¸å‚æ•°ä¼°è®¡"></a>4.3.1pLSAå’ŒLDAçš„å¯¹æ¯”ï¼šç”Ÿæˆæ–‡æ¡£ä¸å‚æ•°ä¼°è®¡</h3><p>ğŸ‘‡é¢‘ç‡æ´¾vsè´å¶æ–¯æ´¾</p>
<p>This content is only supported in a Feishu Docs</p>
<p><strong>LDA</strong>æ¨¡å‹ä¸­ä¸€ç¯‡æ–‡æ¡£ç”Ÿæˆçš„æ–¹å¼ï¼š</p>
<ol>
<li>æŒ‰ç…§å…ˆéªŒåˆ†å¸ƒ$P(d_i)$é€‰æ‹©ä¸€ç¯‡æ–‡æ¡£$d_i$</li>
<li>ä»Dirichletåˆ†å¸ƒ$\alpha$ä¸­å–æ ·ç”Ÿæˆæ–‡æ¡£$d_i$çš„ä¸»é¢˜åˆ†å¸ƒ$\theta_i$ï¼Œå³ä¸»é¢˜åˆ†å¸ƒ$\theta_i$ç”±è¶…å‚æ•°ä¸º$\alpha$çš„Dirichletåˆ†å¸ƒç”Ÿæˆâ‘ </li>
<li>ä»ä¸»é¢˜çš„å¤šé¡¹å¼åˆ†å¸ƒ$\theta_i$ä¸­å–æ ·ç”Ÿæˆæ–‡æ¡£$d_i$ç¬¬$j$ä¸ªè¯çš„ä¸»é¢˜$z_{i,j}$</li>
<li>ä»Dirichletåˆ†å¸ƒ$\beta$ä¸­å–æ ·ç”Ÿæˆä¸»é¢˜$z_{i,j}$å¯¹åº”çš„è¯è¯­åˆ†å¸ƒ$\phi_{z_i,j}$ï¼Œå³è¯è¯­åˆ†å¸ƒ$\phi_{z_i,j}$ç”±å‚æ•°ä¸º$\beta$çš„Dirichletåˆ†å¸ƒç”Ÿæˆâ‘¡</li>
<li>ä»è¯è¯­çš„å¤šé¡¹å¼åˆ†$\phi_{z_i,j}$ä¸­é‡‡æ ·æœ€ç»ˆç”Ÿæˆè¯è¯­$w_{i,j}$</li>
</ol>
<p>ğŸ‘‡LDAå’ŒpLSAçš„åŒºåˆ«ï¼š</p>
<ul>
<li>LDAæ˜¯pLSAçš„è´å¶æ–¯ç‰ˆæœ¬ï¼Œä¸»é¢˜åˆ†å¸ƒå’Œè¯åˆ†å¸ƒæœ¬èº«éƒ½ç”±å…ˆéªŒçŸ¥è¯†éšæœºç»™å®š</li>
<li>â‘ â‘¡LDAåœ¨pLSAçš„åŸºç¡€ä¸Šä¸ºä¸»é¢˜åˆ†å¸ƒå’Œè¯åˆ†å¸ƒåŠ äº†ä¸¤ä¸ªDirichletå…ˆéªŒåˆ†å¸ƒ$\alpha$å’Œ$\beta$</li>
<li><strong>pLSA</strong>ä¸­ä¸»é¢˜åˆ†å¸ƒå’Œè¯åˆ†å¸ƒæ˜¯å”¯ä¸€ç¡®å®šçš„ï¼Œä½†æ˜¯<strong>LDA</strong>ä¸­ä¸»é¢˜åˆ†å¸ƒå’Œè¯åˆ†å¸ƒä¸å†å”¯ä¸€ç¡®å®šä¸å˜ï¼Œå³æ— æ³•ç¡®åˆ‡ç»™å‡ºï¼Œä½†æ˜¯å†æ€ä¹ˆå˜åŒ–ä¹Ÿä¾ç„¶æœä»ä¸€å®šçš„åˆ†å¸ƒï¼Œå³ä¸»é¢˜åˆ†å¸ƒå’Œè¯åˆ†å¸ƒç”±Dirichletå…ˆéªŒéšæœºç¡®å®š</li>
<li>æ–‡æœ¬ç”Ÿæˆåï¼Œä¸¤è€…éƒ½è¦æ ¹æ®æ–‡æ¡£å»æ¨æ–­ä¸»é¢˜åˆ†å¸ƒå’Œè¯åˆ†å¸ƒï¼Œåªæ˜¯ç”¨çš„å‚æ•°æ¨æ–­æ–¹æ³•ä¸åŒ<ul>
<li>pLSAä¸­ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡çš„æ€æƒ³</li>
<li>LDAä¸­æŠŠä¸¤ä¸ªå‚æ•°è§†ä¸ºéšæœºå˜é‡ï¼ŒåŠ å…¥Dirichletå…ˆéªŒ</li>
</ul>
</li>
<li>pLSAå±äºé¢‘ç‡æ´¾æ€æƒ³ï¼Œæ ·æœ¬éšæœºï¼Œå‚æ•°($\theta_{k,j}$å’Œ$\phi_{i,j}$)è™½æœªçŸ¥ä½†å›ºå®šï¼›LDAå±äºè´å¶æ–¯æ´¾æ€æƒ³ï¼Œæ ·æœ¬å›ºå®šï¼Œå‚æ•°($\theta_i$å’Œ$\phi_{z_i,j}$)æœªçŸ¥ä½†ä¸å›ºå®šï¼Œæ˜¯ä¸ªéšæœºå˜é‡ï¼Œæœä»ä¸€å®šçš„åˆ†å¸ƒ(Dirichletåˆ†å¸ƒ)<ul>
<li><strong>pLSAä¸­</strong><ul>
<li>ä¸»é¢˜åˆ†å¸ƒå’Œè¯åˆ†å¸ƒç¡®å®šåï¼Œä»¥ä¸€å®šæ¦‚ç‡$\left(P(z_k|d_i),P(w_j|z_k)\right)$åˆ†åˆ«é€‰å–å…·ä½“çš„ä¸»é¢˜å’Œè¯é¡¹ï¼Œç”Ÿæˆå¥½æ–‡æ¡£</li>
<li>ç„¶åæ ¹æ®ç”Ÿæˆå¥½çš„æ–‡æ¡£åæ¨å…¶ä¸»é¢˜åˆ†å¸ƒã€è¯åˆ†å¸ƒ</li>
<li>æœ€ç»ˆç”¨EMç®—æ³•æ±‚è§£å‡ºä¸¤ä¸ªæœªçŸ¥ä½†å›ºå®šçš„å‚æ•°çš„å€¼ï¼š<ul>
<li>$\phi_{k,j}$(ç”±$P(w_j|z_k)$è½¬æ¢è€Œæ¥)</li>
<li>$\theta_{i,k}$(ç”±$P(z_k|d_i)$è½¬æ¢è€Œæ¥)</li>
<li><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702177942549.jpg"></li>
</ul>
</li>
</ul>
</li>
<li><strong>LDA****ä¸­</strong><ul>
<li>ä¸»é¢˜åˆ†å¸ƒå’Œè¯åˆ†å¸ƒæ˜¯éšæœºå˜é‡(å³æ–‡æ¡£$d_i$äº§ç”Ÿä¸»é¢˜$z_k$å’Œä¸»é¢˜$z_k$äº§ç”Ÿè¯é¡¹$w_j$çš„æ¦‚ç‡éƒ½æ˜¯éšæœºå˜é‡)</li>
<li>Dirichletå…ˆéªŒä¸ºæ–‡æ¡£$d_i$ç”Ÿæˆä¸»é¢˜åˆ†å¸ƒ$\Theta$ï¼Œç„¶åæ ¹æ®ä¸»é¢˜åˆ†å¸ƒ$\Theta$äº§ç”Ÿä¸»é¢˜$z_k$</li>
<li>ä»æ— ç©·å¤šä¸ªä¸»é¢˜åˆ†å¸ƒä¸­æŒ‰ç…§Dirichletå…ˆéªŒéšæœºæŠ½å–å‡ºæŸä¸ªä¸»é¢˜åˆ†å¸ƒå‡ºæ¥</li>
<li><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702177951260.jpg"></li>
</ul>
</li>
</ul>
</li>
<li>ä¾‹å­<ul>
<li>å¥½æ¯”ï¼Œå»ä¸€æœ‹å‹å®¶ï¼š<ul>
<li>æŒ‰ç…§<strong>é¢‘ç‡æ´¾</strong>çš„æ€æƒ³ï¼Œæˆ‘ä¼°è®¡ä»–åœ¨å®¶çš„æ¦‚ç‡æ˜¯1/2ï¼Œä¸åœ¨å®¶çš„æ¦‚ç‡ä¹Ÿæ˜¯1/2ï¼Œæ˜¯ä¸ª<strong>å®šå€¼</strong>ã€‚</li>
<li>è€ŒæŒ‰ç…§è´å¶æ–¯æ´¾çš„æ€æƒ³ï¼Œä»–åœ¨å®¶ä¸åœ¨å®¶çš„æ¦‚ç‡ä¸å†è®¤ä¸ºæ˜¯ä¸ªå®šå€¼1/2ï¼Œè€Œæ˜¯éšæœºå˜é‡ã€‚æ¯”å¦‚æŒ‰ç…§æˆ‘ä»¬çš„ç»éªŒï¼ˆæ¯”å¦‚å½“å¤©å‘¨æœ«ï¼‰ï¼ŒçŒœæµ‹ä»–åœ¨å®¶çš„æ¦‚ç‡æ˜¯0.6ï¼Œä½†è¿™ä¸ª0.6ä¸æ˜¯è¯´å°±æ˜¯å®Œå…¨ç¡®å®šçš„ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯0.7ã€‚å¦‚æ­¤ï¼Œè´å¶æ–¯æ´¾æ²¡æ³•ç¡®åˆ‡ç»™å‡ºå‚æ•°çš„ç¡®å®šå€¼ï¼ˆ0.3,0.4ï¼Œ0.6,0.7ï¼Œ0.8,0.9éƒ½æœ‰å¯èƒ½ï¼‰ï¼Œä½†è‡³å°‘æ˜ç™½åœ¨å“ªä¸ªèŒƒå›´æˆ–å“ªäº›å–å€¼ï¼ˆ0.6,0.7ï¼Œ0.8,0.9ï¼‰æ›´æœ‰å¯èƒ½ï¼Œå“ªä¸ªèŒƒå›´æˆ–å“ªäº›å–å€¼ï¼ˆ0.3,0.4ï¼‰ ä¸å¤ªå¯èƒ½ã€‚è¿›ä¸€æ­¥ï¼Œè´å¶æ–¯ä¼°è®¡ä¸­ï¼Œå‚æ•°çš„å¤šä¸ªä¼°è®¡å€¼æœä»ä¸€å®šçš„å…ˆéªŒåˆ†å¸ƒï¼Œè€Œåæ ¹æ®å®è·µè·å¾—çš„æ•°æ®ï¼ˆä¾‹å¦‚å‘¨æœ«ä¸æ–­è·‘ä»–å®¶ï¼‰ï¼Œä¸æ–­ä¿®æ­£ä¹‹å‰çš„å‚æ•°ä¼°è®¡ï¼Œä»å…ˆéªŒåˆ†å¸ƒæ…¢æ…¢è¿‡æ¸¡åˆ°åéªŒåˆ†å¸ƒã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="4-3-2LDAç”Ÿæˆæ–‡æ¡£â€“ä¸‰ç»´åæ ‡ç³»"><a href="#4-3-2LDAç”Ÿæˆæ–‡æ¡£â€“ä¸‰ç»´åæ ‡ç³»" class="headerlink" title="4.3.2LDAç”Ÿæˆæ–‡æ¡£â€“ä¸‰ç»´åæ ‡ç³»"></a>4.3.2LDAç”Ÿæˆæ–‡æ¡£â€“ä¸‰ç»´åæ ‡ç³»</h3><p><a href="https://blog.csdn.net/v_JULY_v/article/details/41209515?spm=1001.2101.3001.6650.1&amp;utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-1.no_search_link&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-1.no_search_link&amp;utm_relevant_index=2">çœ‹</a></p>
<h3 id="4-3-3pLSAå’ŒLDAæ¦‚ç‡å›¾å¯¹æ¯”"><a href="#4-3-3pLSAå’ŒLDAæ¦‚ç‡å›¾å¯¹æ¯”" class="headerlink" title="4.3.3pLSAå’ŒLDAæ¦‚ç‡å›¾å¯¹æ¯”"></a>4.3.3pLSAå’ŒLDAæ¦‚ç‡å›¾å¯¹æ¯”</h3><p>zè·Ÿwéƒ½å¾—æ˜¯å°å†™ï¼Œé˜´å½±åœ†åœˆè¡¨ç¤ºå¯è§‚æµ‹çš„å˜é‡ï¼Œéé˜´å½±åœ†åœˆè¡¨ç¤ºéšå˜é‡æˆ–å‚æ•°ï¼Œç®­å¤´è¡¨ç¤ºä¸¤å˜é‡é—´çš„æ¡ä»¶ä¾èµ–æ€§ï¼Œæ–¹æ¡†è¡¨ç¤ºé‡å¤æŠ½æ ·ï¼Œæ–¹æ¡†å³ä¸‹è§’çš„æ•°å­—ä»£è¡¨é‡å¤æŠ½æ ·çš„æ¬¡æ•°</p>
<ul>
<li>pLSA<ul>
<li><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702177955942.jpg"></li>
</ul>
</li>
<li>LDA <ul>
<li><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702177960834(1).jpg"></li>
<li>å‡å®šè¯­æ–™åº“ä¸­å…±æœ‰Mç¯‡æ–‡ç« ï¼Œæ¯ç¯‡æ–‡ç« ä¸‹çš„Topicçš„ä¸»é¢˜åˆ†å¸ƒæ˜¯ä¸€ä¸ªä»å‚æ•°ä¸º$\alpha$çš„Dirichletå…ˆéªŒåˆ†å¸ƒä¸­é‡‡æ ·å¾—åˆ°çš„Multinomialåˆ†å¸ƒï¼Œæ¯ä¸ªTopicä¸‹çš„è¯åˆ†å¸ƒæ˜¯ä¸€ä¸ªä»å‚æ•°$\beta$ä¸ºçš„Dirichletå…ˆéªŒåˆ†å¸ƒä¸­é‡‡æ ·å¾—åˆ°çš„Multinomialåˆ†å¸ƒã€‚</li>
<li>å¯¹äºæŸç¯‡æ–‡ç« ä¸­çš„ç¬¬nä¸ªè¯ï¼Œé¦–å…ˆä»è¯¥æ–‡ç« ä¸­å‡ºç°çš„æ¯ä¸ªä¸»é¢˜çš„Multinomialåˆ†å¸ƒä¸­é€‰æ‹©æˆ–é‡‡æ ·ä¸€ä¸ªä¸»é¢˜ï¼Œç„¶åå†åœ¨è¿™ä¸ªä¸»é¢˜å¯¹åº”çš„è¯çš„Multinomialåˆ†å¸ƒä¸­é€‰æ‹©æˆ–é‡‡æ ·ä¸€ä¸ªè¯ã€‚ä¸æ–­é‡å¤è¿™ä¸ªéšæœºç”Ÿæˆè¿‡ç¨‹ï¼Œç›´åˆ°Mç¯‡æ–‡ç« å…¨éƒ¨ç”Ÿæˆå®Œæˆã€‚</li>
<li>M ç¯‡æ–‡æ¡£ä¼šå¯¹åº”äº M ä¸ªç‹¬ç«‹çš„ Dirichlet-Multinomial å…±è½­ç»“æ„ï¼ŒK ä¸ª topic ä¼šå¯¹åº”äº K ä¸ªç‹¬ç«‹çš„ Dirichlet-Multinomial å…±è½­ç»“æ„<ul>
<li>$\alpha\rightarrow\theta\rightarrow z$è¡¨ç¤ºç”Ÿæˆæ–‡æ¡£ä¸­çš„æ‰€æœ‰è¯å¯¹åº”çš„ä¸»é¢˜<ul>
<li>$\alpha\rightarrow\theta$å¯¹åº”çš„æ˜¯Dirichletåˆ†å¸ƒ</li>
<li>$\theta\rightarrow z$å¯¹åº”çš„æ˜¯Multinomialåˆ†å¸ƒ</li>
<li>â€‹      å› æ­¤æ•´ä½“æ˜¯ä¸€ä¸ªDirichlet-Multinomialå…±è½­ç»“æ„</li>
</ul>
</li>
<li>$\beta\rightarrow\theta\rightarrow w$è¡¨ç¤ºæŸä¸ªä¸»é¢˜å¯¹åº”çš„è¯<ul>
<li>åŒä¸Š</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="4-3-4pLSAå’ŒLDAå‚æ•°ä¼°è®¡æ–¹æ³•çš„å¯¹æ¯”"><a href="#4-3-4pLSAå’ŒLDAå‚æ•°ä¼°è®¡æ–¹æ³•çš„å¯¹æ¯”" class="headerlink" title="4.3.4pLSAå’ŒLDAå‚æ•°ä¼°è®¡æ–¹æ³•çš„å¯¹æ¯”"></a>4.3.4pLSAå’ŒLDAå‚æ•°ä¼°è®¡æ–¹æ³•çš„å¯¹æ¯”</h3><ul>
<li>pLSA<ul>
<li>ä½¿ç”¨EMç®—æ³•ä¼°è®¡$\Phi$å’Œ$\Theta$ï¼Œä½¿ç”¨çš„æ€æƒ³æ˜¯æå¤§ä¼¼ç„¶ä¼°è®¡</li>
</ul>
</li>
<li>LDA<ul>
<li>ä¼°è®¡$\Phi$å’Œ$\Theta$å¯ç”¨å˜åˆ†(Variational inference)-EMç®—æ³•<strong>ï¼Œ</strong>ä¹Ÿå¯ä»¥ç”¨gibbsé‡‡æ ·<strong>ï¼Œ</strong>å‰è€…çš„æ€æƒ³æ˜¯æœ€å¤§åéªŒä¼°è®¡MAPï¼ˆMAPä¸MLEç±»ä¼¼ï¼Œéƒ½æŠŠæœªçŸ¥å‚æ•°å½“ä½œå›ºå®šçš„å€¼ï¼‰ï¼Œåè€…çš„æ€æƒ³æ˜¯è´å¶æ–¯ä¼°è®¡</li>
</ul>
</li>
</ul>
<h3 id="4-3-5Gibbsé‡‡æ ·"><a href="#4-3-5Gibbsé‡‡æ ·" class="headerlink" title="4.3.5Gibbsé‡‡æ ·"></a>4.3.5Gibbsé‡‡æ ·</h3><p>GibbsæŠ½æ ·æ˜¯é©¬å°”å¯å¤«é“¾è’™ç‰¹å¡å°”ç†è®ºï¼ˆMCMCï¼‰ä¸­ç”¨æ¥è·å–ä¸€ç³»åˆ—è¿‘ä¼¼ç­‰äºæŒ‡å®šå¤šç»´æ¦‚ç‡åˆ†å¸ƒï¼ˆæ¯”å¦‚2ä¸ªæˆ–è€…å¤šä¸ªéšæœºå˜é‡çš„è”åˆæ¦‚ç‡åˆ†å¸ƒï¼‰è§‚å¯Ÿæ ·æœ¬çš„ç®—æ³•ã€‚</p>
<h1 id="5-ä»£ç å®ç°"><a href="#5-ä»£ç å®ç°" class="headerlink" title="5.ä»£ç å®ç°"></a>5.ä»£ç å®ç°</h1><p>This content is only supported in a Feishu Docs</p>
<h2 id="5-1corpora-Dictionary-texts"><a href="#5-1corpora-Dictionary-texts" class="headerlink" title="5.1corpora.Dictionary(texts):"></a>5.1<strong>corpora.Dictionary(texts)</strong>:</h2><p>ä¸ºæ¯ä¸ªå‡ºç°åœ¨è¯­æ–™åº“ä¸­çš„å•è¯åˆ†é…äº†ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„ç¼–å·id</p>
<h2 id="5-2dictionary-doc2bow"><a href="#5-2dictionary-doc2bow" class="headerlink" title="5.2dictionary.doc2bow():"></a>5.2<strong>dictionary.doc2bow()</strong>:</h2><p>æŠŠæ–‡æ¡£å˜æˆä¸€ä¸ªç¨€ç–å‘é‡ï¼Œ[(0,1), (1,1)]ï¼Œè¡¨æ˜idä¸º0ï¼Œ1çš„è¯æ±‡å‡ºç°äº†ä¸€æ¬¡ï¼Œè€Œå…¶ä»–è¯æ±‡æ²¡æœ‰å‡ºç°</p>
<h2 id="5-3models-Ldamodel"><a href="#5-3models-Ldamodel" class="headerlink" title="5.3models.Ldamodel:"></a>5.3<strong>models.Ldamodel</strong>:</h2><p><strong>å‚æ•°ï¼š</strong></p>
<p>corpusï¼šä¸€ç»„æ–‡æ¡£çš„è¯­æ–™åº“ï¼Œæ˜¯list of list of tupleçš„å½¢å¼ï¼Œæ¯ä¸ªlistå†…çš„å…ƒç´ æ˜¯(word_id, count)ï¼Œè¡¨ç¤ºä¸€ä¸ªæ–‡æ¡£ä¸­æ¯ä¸ªè¯å‡ºç°çš„æ¬¡æ•°</p>
<p>num_topicsï¼šä¸»é¢˜æ•°é‡</p>
<p>id2wordï¼šå°†æ¯ä¸ªè¯çš„idæ˜ å°„åˆ°è¯¥è¯çš„å­—ç¬¦ä¸²è¡¨ç¤º</p>
<p>passesï¼šåœ¨æ‹Ÿåˆæ¨¡å‹ä¸­è¦æ‰§è¡Œçš„è¿­ä»£æ¬¡æ•°</p>
<p>random_stateï¼šéšæœºæ•°ç”Ÿæˆå™¨çš„ç§å­</p>
<h2 id="5-4ldamodel-show-topics"><a href="#5-4ldamodel-show-topics" class="headerlink" title="5.4ldamodel.show_topics"></a>5.4ldamodel.show_topics</h2><p>ç”¨äºå±•ç¤ºLDAæ¨¡å‹çš„ä¸»é¢˜å‡½æ•°</p>
<h3 id="5-4-1x"><a href="#5-4-1x" class="headerlink" title="5.4.1x"></a>5.4.1x</h3><p>æ ¼å¼ï¼š</p>
<p>[</p>
<p>(ä¸»é¢˜1ï¼Œ[(å…³é”®è¯1.1ï¼Œæ¦‚ç‡1.1),(å…³é”®è¯1.2ï¼Œæ¦‚ç‡1.2)â€¦])ï¼Œ</p>
<p>(ä¸»é¢˜2ï¼Œ[(å…³é”®è¯2.1ï¼Œæ¦‚ç‡2.1),(å…³é”®è¯2.2ï¼Œæ¦‚ç‡2.2)â€¦])ï¼Œ</p>
<p>()ï¼Œ</p>
<p>â€¦.]</p>
<p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702177965964(1).jpg"></p>
<h3 id="5-4-2tp"><a href="#5-4-2tp" class="headerlink" title="5.4.2tp"></a>5.4.2tp</h3><p>tp[0]â€“&gt;ä¸»é¢˜</p>
<p>tp[1]â€“&gt;[(å…³é”®è¯1ï¼Œæ¦‚ç‡1),(å…³é”®è¯2ï¼Œæ¦‚ç‡2)â€¦]</p>
<h3 id="5-4-3æ‰“å°æ¯ä¸ªä¸»é¢˜ä¸‹æ¯ä¸ªå•è¯çš„æ¦‚ç‡"><a href="#5-4-3æ‰“å°æ¯ä¸ªä¸»é¢˜ä¸‹æ¯ä¸ªå•è¯çš„æ¦‚ç‡" class="headerlink" title="5.4.3æ‰“å°æ¯ä¸ªä¸»é¢˜ä¸‹æ¯ä¸ªå•è¯çš„æ¦‚ç‡"></a>5.4.3æ‰“å°æ¯ä¸ªä¸»é¢˜ä¸‹æ¯ä¸ªå•è¯çš„æ¦‚ç‡</h3><p>This content is only supported in a Feishu Docs</p>
<p>ğŸ‘‡ç”¨.split()å‡½æ•°</p>
<ul>
<li>å…ˆæŒ‰ç…§â€+â€å·è¿›è¡Œæ‹†åˆ†</li>
<li>ç„¶åå¯¹äºä»¥â€+â€å·æ‹†åˆ†å‡ºæ¥çš„ä¸œè¥¿ï¼Œå†ä»¥â€*â€å·è¿›è¡Œæ‹†åˆ†</li>
<li>æ‰“å°æ ¼å¼ï¼šâ€å•è¯â€(å•è¯å‡ºç°çš„æ¦‚ç‡)</li>
</ul>
<p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702177971365.jpg"></p>
<h3 id="5-4-4è®¡ç®—ä¸€è‡´æ€§"><a href="#5-4-4è®¡ç®—ä¸€è‡´æ€§" class="headerlink" title="5.4.4è®¡ç®—ä¸€è‡´æ€§"></a>5.4.4è®¡ç®—ä¸€è‡´æ€§</h3><p><strong>CoherenceModel(model, texts, dictionary, coherence)</strong></p>
<p>modelï¼šæŒ‡å®šç”¨äºè®¡ç®—ä¸€è‡´æ€§çš„ä¸»é¢˜æ¨¡å‹å¯¹è±¡(ldamodel)</p>
<p>textï¼šæŒ‡å®šä¸€ä¸ªæ–‡æœ¬åˆ—è¡¨</p>
<p>dictionaryï¼šæŒ‡å®šä¸€ä¸ªè¯å…¸å¯¹è±¡</p>
<p>coherenceï¼šæŒ‡å®šè¦è®¡ç®—çš„ä¸€è‡´æ€§æŒ‡æ ‡</p>
<ul>
<li>C_Vï¼šè¡¡é‡ä¸»é¢˜å†…éƒ¨çš„ä¸€è‡´æ€§å’Œä¸»é¢˜ä¹‹é—´çš„äº’å¼‚æ€§</li>
</ul>
<p>è¿”å›çš„æ˜¯ä¸€è‡´æ€§è¯„åˆ†ï¼Œåˆ†æ•°è¶Šé«˜ï¼Œè¡¨ç¤ºä¸»é¢˜æ¨¡å‹çš„ä¸»é¢˜æ›´å…·æœ‰ä¸€è‡´æ€§ï¼Œä¸€è‡´æ€§è¯„åˆ†ä»…ç”¨äºæ¯”è¾ƒä¸åŒä¸»é¢˜æ¨¡å‹ä¹‹é—´çš„ä¸€è‡´æ€§</p>
<p>This content is only supported in a Feishu Docs</p>
<p>å‘ç°ï¼Œå½“ä¸»é¢˜æ•°ç›®ä¸º10çš„æ—¶å€™ï¼Œåä¸ªä¸åŒçš„ä¸»é¢˜ä¹‹é—´çš„coherenceå€¼è¾ƒå¤§ï¼Œä¸€è‡´æ€§è¾ƒé«˜ã€‚è¿™å››ä¸ªä¸»é¢˜ä¸‹çš„å…³é”®è¯èƒ½å¤Ÿå¾ˆå¥½åœ°æ¦‚æ‹¬æ‰€æœ‰æ–‡æ¡£çš„å…³é”®è¯</p>
<h1 id="6-æ²¡æ‡‚çš„åœ°æ–¹"><a href="#6-æ²¡æ‡‚çš„åœ°æ–¹" class="headerlink" title="6.æ²¡æ‡‚çš„åœ°æ–¹"></a>6.æ²¡æ‡‚çš„åœ°æ–¹</h1><ol>
<li>ç¬¬å››è¡Œåˆ°ç¬¬äº”è¡Œ</li>
</ol>
<p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LDA/1702177981781.jpg"></p>
]]></content>
      <categories>
        <category>äººå·¥æ™ºèƒ½</category>
      </categories>
      <tags>
        <tag>äººå·¥æ™ºèƒ½</tag>
        <tag>DMIRè€ƒæ ¸</tag>
        <tag>NLP</tag>
        <tag>LDA</tag>
      </tags>
  </entry>
  <entry>
    <title>LCD1602</title>
    <url>/2022/10/30/lcd1602/</url>
    <content><![CDATA[<h1 id="LCD1602-16-2"><a href="#LCD1602-16-2" class="headerlink" title="LCD1602(16*2)"></a>LCD1602(16*2)</h1><h2 id="ä¸€-åŸç†éƒ¨åˆ†"><a href="#ä¸€-åŸç†éƒ¨åˆ†" class="headerlink" title="ä¸€.åŸç†éƒ¨åˆ†"></a>ä¸€.åŸç†éƒ¨åˆ†</h2><h3 id="1-å¼•è„š"><a href="#1-å¼•è„š" class="headerlink" title="1.å¼•è„š"></a>1.å¼•è„š</h3><p>æ˜¾ç¤ºå®¹é‡ï¼š16*2ä¸ªå­—ç¬¦</p>
<p><img src="/../../../../medias/blog_picture/51/76.png"></p>
<p>VO(å¯¹æ¯”åº¦)ï¼š<strong>å€¼å¤ªå°</strong>æ˜¾ç¤ºä¼šå¾ˆæµ…ï¼Œ<strong>çœ‹ä¸æ¸…</strong>ï¼Œ<strong>å€¼å¤ªå¤§</strong>æ¯ä¸ªåƒç´ éƒ½æ˜¾ç¤ºå‡ºæ¥ï¼Œ<strong>æ— æ³•è¾¨åˆ«</strong>å“ªäº›æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œ<strong>æˆ‘ä»¬ç”¨R1æ¥è°ƒèŠ‚</strong></p>
<p>D1~D7ï¼š<strong>å¹¶è¡Œä¼ é€æ¨¡å¼</strong>ï¼Œæœ€å¥½æ¥åœ¨<strong>ä¸€ç»„ioå£</strong>ä¸Šï¼ŒD0â€“P0_1ï¼ŒD7â€“P0_7(é«˜ä½å¯¹é«˜ä½ï¼Œä½ä½å¯¹ä½ä½)</p>
<p>RS(åœ¨å“ªå†™)&amp;RW(å†™ä»€ä¹ˆ)&amp;Eï¼šæ§åˆ¶å¼•è„šï¼Œæ§åˆ¶D1~D7</p>
<p>Eï¼šä¸Šå‡æ²¿çš„æ—¶å€™æŠŠæ•°æ®ä¼ åˆ°D1~D7ï¼Œä¸‹é™æ²¿çš„æ—¶å€™æ‰§è¡Œå‘½ä»¤</p>
<h3 id="2-å†…éƒ¨ç»“æ„"><a href="#2-å†…éƒ¨ç»“æ„" class="headerlink" title="2.å†…éƒ¨ç»“æ„"></a>2.å†…éƒ¨ç»“æ„</h3><p><img src="/../../../../medias/blog_picture/51/77.png"></p>
<p>C(character)G(generater)å­—ç¬¦ç”Ÿæˆ</p>
<p>CGRAMæ˜¯å¯å†™çš„ï¼Œæ˜¯è‡ªå®šä¹‰å­˜å‚¨æ•°æ®</p>
<p>CGROMä¸å¯å†™ï¼Œæ—©å·²è§„å®šï¼Œç›¸å½“äºå­—å…¸</p>
<p>å­—æ¨¡åº“å°±æ˜¯æ®µç è¡¨</p>
<p>D(data)D(display)æ•°æ®æ˜¾ç¤º</p>
<p>DDRAMï¼Œç”¨æˆ·å¯å†™ï¼Œå¯¹åº”åˆ°å±å¹•çš„è¯åªä¼šæ˜¾ç¤ºå‰16åˆ—(å‰16åˆ—æ˜ å°„åˆ°å±å¹•ä¸Š)ï¼Œä»ç¬¬17åˆ—å¼€å§‹å¯ä»¥å†™ï¼Œå› ä¸ºå±å¹•ä¸å¤Ÿå¤§æ‰€ä»¥æ˜¾ç¤ºä¸äº†(é—®é¢˜ä¸å¤§)</p>
<h3 id="3-æ®µç è¡¨"><a href="#3-æ®µç è¡¨" class="headerlink" title="3.æ®µç è¡¨"></a>3.æ®µç è¡¨</h3><p>æˆ‘ä»¬å…ˆè¦æœ‰ä¸€ä¸ªæ®µç è¡¨ï¼Œç„¶åæ‰¾ç´¢å¼•å¯¹åº”å±å¹•é‡Œçš„</p>
<p><img src="/../../../../medias/blog_picture/51/78.png"></p>
<p>å¯å†™çš„åªæœ‰å…«ä¸ªï¼Œåœ¨0001 0000-0001 0111</p>
<p>ä¸å¯å†™e.g.æ¯”å¦‚Aï¼Œå¯¹åº”0100 0001â€“è½¬16è¿›åˆ¶â€“&gt;0x41</p>
<h3 id="4-æ—¶åºå›¾"><a href="#4-æ—¶åºå›¾" class="headerlink" title="4.æ—¶åºå›¾"></a>4.æ—¶åºå›¾</h3><p><img src="/../../../../medias/blog_picture/51/79.png"></p>
<p><img src="/../../../../medias/blog_picture/51/80.png"></p>
<p>æœ€é«˜ä½ä¸º1ä½ç½®ä¸åŒå¯ä»¥åŒºåˆ†ä¸åŒçš„æŒ‡ä»¤</p>
<ul>
<li>ç‰¹åˆ«æ˜¯åœ¨DB7ç½®1ç»å¯¹æ˜¯è¦æ“ä½œDDRAM</li>
</ul>
<h3 id="5-è®¾ç½®å…‰æ ‡ä½ç½®DDRAM-æ•°æ®æ˜¾ç¤º"><a href="#5-è®¾ç½®å…‰æ ‡ä½ç½®DDRAM-æ•°æ®æ˜¾ç¤º" class="headerlink" title="5.è®¾ç½®å…‰æ ‡ä½ç½®DDRAM(æ•°æ®æ˜¾ç¤º)"></a>5.è®¾ç½®å…‰æ ‡ä½ç½®DDRAM(æ•°æ®æ˜¾ç¤º)</h3><p><img src="/../../../../medias/blog_picture/51/81.png"></p>
<p>ç¬¬ä¸€è¡Œï¼š<strong>1</strong>000 0000 â€“&gt;0x80</p>
<p>ç¬¬äºŒè¡Œï¼š<strong>1</strong>100 0000 â€“&gt;0xC0</p>
<p>ä¸¤ä¸²çš„ç¬¬ä¸€ä¸ª<strong>1</strong>éƒ½ä»£è¡¨è¦è¿›å…¥DDRAMè¿™ä¸ªæŒ‡ä»¤</p>
<p>å› ä¸ºç¬¬ä¸€è¡Œçš„åœ°å€æ˜¯00æ‰€ä»¥åæ¥000 0000ï¼Œç¬¬äºŒè¡Œçš„åœ°å€æ˜¯40æ‰€ä»¥åæ¥100(äºŒè½¬åå°±æ˜¯4) 0000</p>
<h2 id="äºŒ-ä»£ç éƒ¨åˆ†"><a href="#äºŒ-ä»£ç éƒ¨åˆ†" class="headerlink" title="äºŒ.ä»£ç éƒ¨åˆ†"></a>äºŒ.ä»£ç éƒ¨åˆ†</h2><h3 id="1-å­å‡½æ•°"><a href="#1-å­å‡½æ•°" class="headerlink" title="1.å­å‡½æ•°"></a>1.å­å‡½æ•°</h3><h4 id="â‘ LCD-WriteCommand"><a href="#â‘ LCD-WriteCommand" class="headerlink" title="â‘ LCD_WriteCommand"></a>â‘ LCD_WriteCommand</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">LCD_WriteCommand</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> Command<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	LCD_RS<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>		<span class="token comment">//0ä¸ºæŒ‡ä»¤</span>
	LCD_RW<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>		<span class="token comment">//0ä¸ºè¾“å…¥</span>
	LCD_DataPort<span class="token operator">=</span>Command<span class="token punctuation">;</span>
	LCD_E<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token function">LCD_Delay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//å»¶ç¼“å¿«é€Ÿä¸Šä¸‹æ‹‰</span>
	LCD_E<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">LCD_Delay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//å»¶ç¼“å¿«é€Ÿä¸Šä¸‹æ‹‰</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="â‘¡LCD-DataCommand"><a href="#â‘¡LCD-DataCommand" class="headerlink" title="â‘¡LCD_DataCommand"></a>â‘¡LCD_DataCommand</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">LCD_WriteData</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> Data<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	LCD_RS<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>		<span class="token comment">//0ä¸ºæ•°æ®</span>
	LCD_RW<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>		<span class="token comment">//0ä¸ºè¾“å…¥</span>
	LCD_DataPort<span class="token operator">=</span>Data<span class="token punctuation">;</span>
	LCD_E<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token function">LCD_Delay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//å»¶ç¼“å¿«é€Ÿä¸Šä¸‹æ‹‰</span>
	LCD_E<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">LCD_Delay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//å»¶ç¼“å¿«é€Ÿä¸Šä¸‹æ‹‰</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="â‘¢LCD-Init"><a href="#â‘¢LCD-Init" class="headerlink" title="â‘¢LCD_Init"></a>â‘¢LCD_Init</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">LCD_Init</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">LCD_WriteCommand</span><span class="token punctuation">(</span><span class="token number">0x38</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å…«ä½æ•°æ®æ¥å£ï¼Œä¸¤è¡Œæ˜¾ç¤ºï¼Œ5x7ç‚¹é˜µå±</span>
	<span class="token function">LCD_WriteCommand</span><span class="token punctuation">(</span><span class="token number">0x0C</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ˜¾ç¤ºå¼€ï¼Œå…‰æ ‡å…³ï¼Œé—ªçƒå…³</span>
	<span class="token function">LCD_WriteCommand</span><span class="token punctuation">(</span><span class="token number">0x06</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ•°æ®è¯»å†™æ“ä½œåï¼Œå…‰æ ‡è‡ªåŠ¨åŠ ä¸€ï¼Œç”»é¢ä¸åŠ¨</span>
	<span class="token function">LCD_WriteCommand</span><span class="token punctuation">(</span><span class="token number">0x01</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ¸…å±</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="â‘£-LCD-ShowChar"><a href="#â‘£-LCD-ShowChar" class="headerlink" title="â‘£.LCD_ShowChar"></a>â‘£.LCD_ShowChar</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token function">LCD_WriteCommand</span><span class="token punctuation">(</span><span class="token number">0x80</span><span class="token operator">|</span>Column<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ğŸ‘†ç†è§£ï¼šColumnæ˜¯åˆ—ã€‚åˆ—-1å†å¹¶ä¸Š0x80æ‰è½¬æ¢ä¸ºå¯¹åº”çš„åœ°å€</p>
<ul>
<li>e.g. å½“é€‰æ‹©**(1,2)<strong>æ—¶ï¼Œç”±</strong>DDRAM**çš„è¡¨æ ¼æˆ‘ä»¬å¾—çŸ¥è¯¥ä½ç½®çš„åœ°å€æ˜¯01H</li>
<li>æ­¤æ—¶ä¼ å‚åˆ°Columnçš„æ˜¯2ï¼Œ2-1=1ï¼Œ1â€“10è¿›åˆ¶è½¬2è¿›åˆ¶â€“&gt;0001</li>
<li>1000 0000|0000 0001=1000 0001</li>
<li>æŠŠ<code>1</code> <code>000 0001</code>åˆ†æˆä¸¤ä¸ªæ¨¡å—</li>
<li><code>1</code>æ˜¯æŒ‡è¿›å…¥DDRAMæ¨¡å¼</li>
<li><code>000 0001</code>å¯¹åº”01Hï¼Œå†™å…¥åˆ°(1,2)ä½ä¸Š</li>
</ul>
]]></content>
      <categories>
        <category>51å•ç‰‡æœº</category>
      </categories>
      <tags>
        <tag>51å•ç‰‡æœº</tag>
        <tag>å¤§äº‘å±‹è€ƒæ ¸</tag>
      </tags>
  </entry>
  <entry>
    <title>CNN(æå®æ¯…)</title>
    <url>/2023/11/04/cnn-li-hong-yi/</url>
    <content><![CDATA[<h1 id="1-Image-Classification"><a href="#1-Image-Classification" class="headerlink" title="1 Image Classification"></a>1 Image Classification</h1><p>ä¸€å¼ 100x100pixelsçš„å›¾ç‰‡å…¶å®æ˜¯ä¸€ä¸ª3D-tensorï¼š<br>â‘ å›¾ç‰‡çš„é«˜<code>100</code>â‘¡å›¾ç‰‡çš„å®½<code>100</code>â‘¢3 channels<code>RGB</code><br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231104203002.png"><br>æ¯ä¸€ä¸ªæ•°å€¼ä»£è¡¨æŸä¸€ä¸ªé¢œè‰²æŸä¸€ä¸ªpixelçš„å¼ºåº¦</p>
<h1 id="2-Image-Feature-Observation"><a href="#2-Image-Feature-Observation" class="headerlink" title="2 Image Feature Observation"></a>2 Image Feature Observation</h1><h2 id="2-1-Observation-1"><a href="#2-1-Observation-1" class="headerlink" title="2.1 Observation 1"></a>2.1 Observation 1</h2><ol>
<li><p>Identifying some critical patterns<br> æ¯”å¦‚è¯´ä¸€åªé¸Ÿï¼Œåªç”¨çœ‹é¸Ÿå˜´ã€çœ¼ç›å’Œè„šä¹Ÿèƒ½å¤§è‡´è¾¨è®¤å‡ºæ¥<br> A neuron does not have to see the whole image</p>
</li>
<li><p>Simplification<br> è®¾å®šä¸€ä¸ªåŒºåŸŸä¸ºReceptive fieldï¼Œæ¯ä¸€ä¸ªneuronåªå…³å¿ƒè‡ªå·±çš„Receptive fieldã€‚<br> Receptive field can be overlapped<br> neuron can have the same receptive field<br> <img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231104204207.png"></p>
</li>
<li><p>Simplification 1-Typical Setting</p>
</li>
<li><p>ä¼šçœ‹all channelsï¼Œä¸ç”¨ææ·±åº¦ï¼Œé«˜å’Œå®½åˆèµ·æ¥å«kernel size</p>
</li>
<li><p>Each receptive field has a set of neurons</p>
</li>
<li><p>å¹³ç§»receptive fieldï¼Œæ­¥é•¿ä¸ºstrideï¼Œreceprive fieldæœ‰é‡å ï¼Œé˜²æ­¢äº¤ç•Œå¤„æœ‰patternæ²¡è¢«neuronä¾¦æµ‹åˆ°</p>
</li>
<li><p>å¹³ç§»æ—¶è¶…å‡ºèŒƒå›´äº†ï¼Œç”¨å¡«è¡¥0ä»£æ›¿è¶…å‡ºçš„èŒƒå›´(æ–¹æ³•ä¸å”¯ä¸€)</p>
</li>
</ol>
<h2 id="2-2-Observation-2"><a href="#2-2-Observation-2" class="headerlink" title="2.2 Observation 2"></a>2.2 Observation 2</h2><ol>
<li>The same patterns appear in different regions<br> ğŸ‘‡solution: parameter sharing<br> çº¿æ¡ä»£è¡¨weightï¼Œç›¸åŒé¢œè‰²ä»£è¡¨weightä¸€æ ·ï¼Œå®ˆå¤‡çš„receptive fieldä¸ä¸€æ ·ï¼Œå‚æ•°ä¸€æ ·ï¼Œå› ä¸ºè¾“å…¥ä¸ä¸€æ ·ï¼Œæ‰€ä»¥è¾“å‡ºä¹Ÿä¸ä¸€æ ·<br> <img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231104215341.png"></li>
<li>Simplification 2-Typical Setting<ol>
<li>æ¯ä¸€ä¸ªreceptive fieldéƒ½æœ‰ä¸€ç»„neurons</li>
<li>ç›¸åŒé¢œè‰²çš„åœ†åœˆä»£è¡¨å…±äº«ä¸€æ ·çš„å‚æ•°çš„neurons</li>
<li>æ¯ä¸€ä¸ªreceptive fieldéƒ½åªæœ‰ä¸€ç»„å‚æ•°ï¼Œè¿™äº›å‚æ•°å«filter x<br> <img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231104215840.png"></li>
</ol>
</li>
</ol>
<h2 id="2-3-Obeservation-3"><a href="#2-3-Obeservation-3" class="headerlink" title="2.3 Obeservation 3"></a>2.3 Obeservation 3</h2><p>Subsampling the pixels will not change the object<br>e.g.æ‹¿æ‰imageå¥‡æ•°è¡Œå’Œå¶æ•°åˆ—çš„pixelsï¼Œå›¾ç‰‡å˜æˆåŸæ¥çš„$\frac{1}{4}$å¤§å°</p>
<h1 id="3-Benefit-of-Convolutional-Layer"><a href="#3-Benefit-of-Convolutional-Layer" class="headerlink" title="3 Benefit of Convolutional Layer"></a>3 Benefit of Convolutional Layer</h1><ul>
<li><code>Fully Connected Layer</code>ä¸éœ€è¦çœ‹æ•´ä¸ªå›¾ç‰‡ï¼Œåªéœ€è¦é‡è¦çš„patternğŸ‘‰<code>receptive field</code>æŸä¸€äº›neuronsä¸€å®šè¦ä¸€æ‘¸ä¸€æ ·ğŸ‘‰<code>parameter sharing</code></li>
<li><code>receptive field</code>+<code>parameter sharing</code>=<code>convolutional layer</code>ï¼Œè™½ç„¶ä¼šæœ‰è¾ƒå¤§çš„model biasï¼Œä½†æ˜¯convolutional layeræ˜¯ä¸“é—¨ä¸ºå½±åƒè®¾è®¡çš„ï¼Œæ‰€ä»¥ç”¨åœ¨imageä¸Šåå·®ä¸ä¼šå¾ˆå¤§</li>
<li>ç”¨<code>convolutional layer</code>çš„networkå«åš<code>CNN</code></li>
</ul>
<h1 id="4-Multiple-Convolutional-Layers"><a href="#4-Multiple-Convolutional-Layers" class="headerlink" title="4 Multiple Convolutional Layers"></a>4 Multiple Convolutional Layers</h1><ul>
<li>nä¸ªfilterså¯å½¢æˆfeature map with n channels</li>
<li><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231104223016.png"><ol>
<li>å…ˆæ˜¯å°†<code>RGB</code>å›¾ç‰‡æ”¾å…¥convolutioné‡Œï¼Œå‡è®¾æœ‰64ä¸ªfilter(æ¯ä¸ªfilteréƒ½æ˜¯3x3x3)ï¼Œé‚£ä¹ˆå°±ä¼šå¾—åˆ°ä¸€ä¸ª feature map(å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªæ–°çš„å›¾ç‰‡ï¼Œåªæ˜¯ä»–çš„channelsæœ‰64ä¸ª) </li>
<li>å†æŠŠfeature mapæ”¾å…¥convolutioné‡Œï¼Œfilterçš„å¤§å°ä¸ºï¼š3x3x<strong>64</strong>(filterçš„é«˜åº¦å°±æ˜¯å®ƒè¦å¤„ç†çš„imageçš„channel)</li>
</ol>
</li>
<li>filteræ¯”è¾ƒå°çš„æƒ…å†µä¸‹ä¹Ÿèƒ½è®©networkçœ‹æ¯”è¾ƒå¤§èŒƒå›´çš„pattern<br>   <img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231104224407.png"><br>   å³ä¸‹è§’è“è‰²åœ†åœˆçš„æ˜¯å…¶ä¸­ä¸€ä¸ªfilterï¼Œå³ä¸Šè§’æ˜¯imageï¼Œimageå·¦ä¸Šè§’çº¢è‰²æ¡†å¯¹åº”filterå·¦ä¸Šè§’çº¢è‰²æ¡†ï¼Œimageå³ä¸‹è§’çº¢è‰²æ¡†å¯¹åº”filterå³ä¸‹è§’çº¢è‰²æ¡†ã€‚feature mapçš„3x3å¯¹åº”imageçš„5x5<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231104225301.png"></li>
</ul>
<h1 id="5-Pooling-Max-Pooling"><a href="#5-Pooling-Max-Pooling" class="headerlink" title="5 Pooling - Max Pooling"></a>5 Pooling - Max Pooling</h1><p>åœ¨feature mapä¸­ï¼Œn x nä¸ªæ•°å­—ä¸€ç»„<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231104225853.png">ğŸ‘‰<img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231104225920.png"><br>max poolingå°±æ˜¯é€‰ä¸€ç»„é‡Œæœ€å¤§çš„é‚£ä¸ªæ•°<br>åšå®Œconvolutionä¹‹åé€šå¸¸ä¼šæ­é…poolingï¼Œpoolingä¸æ”¹å˜channelsï¼Œä½†æ˜¯æ”¹å˜é•¿å®½</p>
<h1 id="6-The-whole-CNN"><a href="#6-The-whole-CNN" class="headerlink" title="6 The whole CNN"></a>6 The whole CNN</h1><p>Flattenï¼šå°†poolingçš„outputæœ¬æ¥çŸ©é˜µçš„æ ·å­æ‹‰ç›´</p>
<h1 id="7-Application-Playing-Go"><a href="#7-Application-Playing-Go" class="headerlink" title="7 Application: Playing Go"></a>7 Application: Playing Go</h1><ul>
<li>Alpha Go uses 5x5 for first layerï¼Œå¯èƒ½æ˜¯5x5çš„èŒƒå›´æ¯”è¾ƒé‡è¦</li>
<li>åŒæ ·å¯èƒ½å­˜åœ¨ç›¸åŒçš„pattersåœ¨ä¸åŒçš„regionsé‡Œ</li>
<li>ä¸ç”¨pooling</li>
</ul>
<h1 id="8-å®æ“"><a href="#8-å®æ“" class="headerlink" title="8 å®æ“"></a>8 å®æ“</h1><h2 id="8-1-Code"><a href="#8-1-Code" class="headerlink" title="8.1 Code"></a>8.1 Code</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> torchvision<span class="token punctuation">.</span>transforms <span class="token keyword">as</span> transforms

image_data <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  <span class="token comment"># Your image data here</span>

<span class="token comment"># Applying the transformations</span>
transform <span class="token operator">=</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>
    transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    transforms<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0.1307</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0.3081</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

transformed_data <span class="token operator">=</span> transform<span class="token punctuation">(</span>image_data<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="8-2-åŸç†"><a href="#8-2-åŸç†" class="headerlink" title="8.2 åŸç†"></a>8.2 åŸç†</h2><p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231113221316.png"></p>
<h1 id="9-Advanced-CNN"><a href="#9-Advanced-CNN" class="headerlink" title="9 Advanced CNN"></a>9 Advanced CNN</h1><ul>
<li>å½“è®­ç»ƒæ¬¡æ•°è¿‡å¤šæ—¶ä¼šå‘ç”Ÿè¿‡æ‹Ÿåˆï¼Œå› æ­¤å¹¶ä¸æ˜¯è®­ç»ƒæ¬¡æ•°è¶Šå¤šæ¨¡å‹å‡†ç¡®åº¦è¶Šé«˜</li>
<li>è§£å†³æ¢¯åº¦æ¶ˆå¤±(è¿‡æ‹Ÿåˆ)ï¼Œä½¿ç”¨<strong>Residual net</strong></li>
</ul>
<p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231119135500.png"><br>$z=H(x)$<br>$\dfrac{\partial z}{x}=\dfrac{\partial F(x)}{\partial x} + \dfrac{\partial x}{\partial x}=\dfrac{\partial F(x)}{\partial x}+1$<br>æ¢¯åº¦=$\dfrac{\partial L}{\partial z}\times\dfrac{\partial z}{\partial x}$<br>å½“$\dfrac{\partial F}{\partial x}$å¾ˆå°çš„æ—¶å€™ï¼Œ$\dfrac{\partial z}{\partial x}$ä¸ä¼šåœ¨0çš„é™„è¿‘</p>
]]></content>
      <categories>
        <category>äººå·¥æ™ºèƒ½</category>
      </categories>
      <tags>
        <tag>äººå·¥æ™ºèƒ½</tag>
        <tag>å·ç§¯ç¥ç»ç½‘ç»œ</tag>
        <tag>æ·±åº¦å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>mlc-llm é¦™æ©™æ´¾éƒ¨ç½²è¿‡ç¨‹</title>
    <url>/2024/01/27/mlc-llm-orangepi-bu-shu-guo-cheng/</url>
    <content><![CDATA[<p>å‚è€ƒç½‘ç«™ï¼š<a href="https://blog.mlc.ai/2023/08/09/GPU-Accelerated-LLM-on-Orange-Pi">GPU-Accelerated LLM on a $100 Orange Pi</a>ã€<a href="https://llm.mlc.ai/docs/install/gpu.html#orange-pi-5-rk3588-based-sbc">Orange Pi 5 (RK3588 based SBC)Â¶</a></p>
<p>èµ„æ–™æ¥æºï¼š<a href="https://github.com/mlc-ai/mlc-llm">Githubâ€”â€”mlc-llm</a></p>
<p>ç›¸å…³è®ºå›ï¼š<a href="https://www.reddit.com/r/MachineLearning/comments/15r1vy5/project_gpuaccelerated_llm_on_a_100_orange_pi/?rdt=33752&amp;onetap_auto=true">Redditâ€”â€”GPU-Accelerated LLM on a $100 Orange Pi</a></p>
<h1 id="1-Prepare"><a href="#1-Prepare" class="headerlink" title="1 Prepare"></a>1 Prepare</h1><h2 id="1-1-Installation"><a href="#1-1-Installation" class="headerlink" title="1.1 Installation"></a>1.1 Installation</h2><p><strong>- Download and istall the Ubuntu 22.04 for your board from <a href="https://github.com/Joshua-Riek/ubuntu-rockchip/releases/tag/v1.22">here</a></strong>(pick â€œOrange Pi 5 Plusâ€)<br>(:ps åœ¨è¿™ä¸ªç‰ˆæœ¬é‡Œï¼Œæˆ‘æ— æ³•ä½¿ç”¨ä¸²å£ï¼Œapt updateä¼šå‡ºç°æ— æ³•è§£æåŸŸåç­‰é—®é¢˜ï¼Œäºæ˜¯æœ€åç”¨äº†<a href="https://pan.baidu.com/s/1cQR1pcca0P-xuQbTrnGXAw?pwd=pjhv#list/path=%2Fsharelink1077680202-1101560075650855%2FUbuntu&amp;parentPath=%2Fsharelink1077680202-1101560075650855">é¦™æ©™æ´¾å®˜æ–¹çš„ç³»ç»Ÿâ€”â€”1.0.8_ubuntu_jammy_desktop_xfce_linux5.10.150</a><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240127153142.png"></p>
<ol>
<li>åœ¨çƒ§å½•å‰ï¼Œéœ€è¦å‡†å¤‡ä¸€å¼ SDå¡(æˆ‘ç”¨çš„32G)ï¼Œå‡†å¤‡<a href="https://etcher.balena.io/#download-etcher">çƒ§å½•è½¯ä»¶balenaEtcher</a></li>
<li>å¦‚ä½•çŸ¥é“è‡ªå·±æ˜¯å¦çƒ§å½•æˆåŠŸï¼Ÿ<ul>
<li>ä½¿ç”¨ä¸²å£<a href="https://blog.csdn.net/itt21044ZCY/article/details/132742245#:~:text=%E9%A6%99%E6%A9%99%E6%B4%BE%E4%B8%B2%E5%8F%A3%E8%BF%9E%E6%8E%A5%E7%94%B5%E8%84%91%20%E4%B8%B2%E5%8F%A3%E8%BF%9E%E6%8E%A5%EF%BC%9AGND%E6%8E%A5GND%EF%BC%8CTX%E6%8E%A5RX%EF%BC%8CRX%E6%8E%A5TX%20%E4%B8%B2%E5%8F%A3%E7%9A%84%20TX%20%E5%92%8C%20RX%20%E6%98%AF%E9%9C%80%E8%A6%81%E4%BA%A4%E5%8F%89%E8%BF%9E%E6%8E%A5%E7%9A%84%EF%BC%8C%E5%A6%82%E6%9E%9C%E4%B8%8D%E6%83%B3%E4%BB%94%E7%BB%86%E5%8C%BA%E5%88%86%20TX%E5%92%8C,TX%20%E5%92%8C%20RX%20%E5%85%88%E9%9A%8F%E4%BE%BF%E6%8E%A5%E4%B8%8A%EF%BC%8C%E5%A6%82%E6%9E%9C%E6%B5%8B%E8%AF%95%E4%B8%B2%E5%8F%A3%E6%B2%A1%E6%9C%89%E8%BE%93%E5%87%BA%E5%86%8D%E4%BA%A4%E6%8D%A2%E4%B8%8B%20TX%20%E5%92%8C%20RX%20%E7%9A%84%E9%A1%BA%E5%BA%8F%EF%BC%8C%E8%BF%99%E6%A0%B7%E5%B0%B1%E6%80%BB%E6%9C%89%E4%B8%80%E7%A7%8D%E9%A1%BA%E5%BA%8F%E6%98%AF%E5%AF%B9%E7%9A%84">CSDNâ€”â€”ä½¿ç”¨é¦™æ©™æ´¾è¿æ¥ç”µè„‘ï¼Œä¸²å£å’ŒSSH</a></li>
<li>ä½¿ç”¨å¦ä¸€ä¸ªæ˜¾ç¤ºå±æŸ¥çœ‹</li>
</ul>
</li>
<li>çƒ§å½•æˆåŠŸåï¼Œé€šè¿‡ä¸Šé¢ä¸¤ç§åŠæ³•çŸ¥é“é¦™æ©™æ´¾çš„ipåœ°å€(å¦‚æœæ˜¯ç”¨æ˜¾ç¤ºå±çš„ï¼Œåœ¨å®˜æ–¹æ–‡æ¡£é‡ŒæŸ¥é˜…â€œè®¾ç½®é™æ€IPåœ°å€çš„æ–¹æ³•â€)ï¼Œæˆ‘è‡ªå·±çš„ä¿®æ”¹ä¸ºäº†192.168.1.201ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç”¨è‡ªå·±çš„ç”µè„‘pingä¸€ä¸‹é¦™æ©™æ´¾<img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240126214418.png"></li>
<li>ä½¿ç”¨vscodeè¿æ¥é¦™æ©™æ´¾<a href="https://blog.csdn.net/mjmmm/article/details/133981063#:~:text=%E7%82%B9%E5%87%BB%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6%E5%A4%B9%EF%BC%9A%20%E4%B8%AD%E9%97%B4%E4%B8%8A%E6%96%B9%E9%80%89%E6%8B%A9%E2%80%9Csmart_bin%E2%80%9D%EF%BC%9A,%E7%82%B9%E5%87%BB%E2%80%9C%E7%A1%AE%E5%AE%9A%E2%80%9D%EF%BC%9A%20%E5%86%8D%E6%AC%A1%E9%80%89%E6%8B%A9%E2%80%9CLinux%E2%80%9D%EF%BC%8C%E5%B9%B6%E8%BE%93%E5%85%A5%E9%A6%99%E6%A9%99%E6%B4%BE%E5%AF%86%E7%A0%81%EF%BC%9A%20%E6%AD%A4%E6%97%B6%EF%BC%8C%E5%B0%B1%E6%88%90%E5%8A%9F%E8%BF%9E%E6%8E%A5%E4%B8%8A%E4%BA%86smart_bin%E6%96%87%E4%BB%B6%E5%A4%B9%EF%BC%8C%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8VSCODE%E5%AF%B9%E4%BA%8E%E4%BB%A3%E7%A0%81%E8%BF%9B%E8%A1%8C%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C%E4%BA%86%EF%BC%81">CSDNâ€”â€”ä½¿ç”¨Visual Studio Codeè¿œç¨‹è¿æ¥é¦™æ©™æ´¾</a><ul>
<li>è¸©å‘ç‚¹ï¼šæ³¨æ„Ubuntuä¸Šæ˜¯å¦å¼€å¯äº†ssh</li>
<li>æ›´æ–°è½¯ä»¶åŒ…<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> update<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li>ä¸‹è½½<code>open ssh</code><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> openssh-server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li>ä¸‹è½½å®ŒæˆåæŸ¥çœ‹<code>ssh</code>æ˜¯å¦æ‰“å¼€<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">ps</span> <span class="token parameter variable">-e</span> <span class="token operator">|</span><span class="token function">grep</span> <span class="token function">ssh</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
è¿æ¥æˆåŠŸåä¼šå‡ºç°ä¸‹é¢çš„å›¾<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240126222152.png"></li>
</ul>
</li>
</ol>
<p><strong>- Download and install&nbsp;<code>libmali-g610.so</code></strong></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /usr/lib <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> <span class="token function">wget</span> https://github.com/JeffyCN/mirrors/raw/libmali/lib/aarch64-linux-gnu/libmali-valhall-g610-g6p0-x11-wayland-gbm.so<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol>
<li>æˆ‘çš„é¦™æ©™æ´¾æ— æ³•è®¿é—®githubï¼Œäºæ˜¯é‡‡ç”¨ä¸»æœºä¸‹è½½æ–‡ä»¶åç”¨FileZillaä¼ è¾“æ–‡ä»¶åˆ°è™šæ‹Ÿæœºä¸Šï¼Œç”¨äº†ä¹‹å‰æ–¹æ³•ä½†æ˜¯æ˜¾ç¤ºæ— æ³•è¿æ¥<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240127093218.png"></li>
<li>æ›´æ”¹åè®®åè¿æ¥æˆåŠŸï¼Œåè®®å¦‚ä¸‹å›¾æ‰€ç¤º<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240127094737.png"></li>
<li>åœ¨ä¸»æœºä¸Šç‚¹å‡»<a href="https://github.com/JeffyCN/mirrors/tree/libmali/lib/aarch64-linux-gnu">ç½‘ç«™</a>æ‰¾åˆ°libmali-valhall-g610-g6p0-x11-wayland-gbm.soå¹¶ä¸‹è½½</li>
<li>FileZillaå‡ºç°â€œæ— æ³•å¯åŠ¨ä¼ è¾“â€å­—æ · <img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240127100058.png"><ul>
<li>åŸå› ï¼šæ–‡ä»¶æƒé™ä¸è¶³</li>
<li>è§£å†³ï¼šä¿®æ”¹è¿œç¨‹ç«™ç‚¹æ–‡ä»¶çš„æƒé™<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">chmod</span> <span class="token parameter variable">-R</span> <span class="token number">777</span> æ–‡ä»¶å<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240127100350.png"><br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240127100646.png"></li>
</ul>
</li>
</ol>
<p><strong>- Check if file&nbsp;<code>mali_csffw.bin</code>&nbsp;exist under path&nbsp;<code>/lib/firmware</code>, if not download it with command:</strong></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /lib/firmware <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> <span class="token function">wget</span> https://github.com/JeffyCN/mirrors/raw/libmali/firmware/g610/mali_csffw.bin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>æˆ‘æ‰¾åˆ°äº†è¿™ä¸ªæ–‡ä»¶æ‰€ä»¥å°±ä¸ç”¨ä¸‹è½½äº†ï¼Œ<a href="https://github.com/JeffyCN/mirrors/tree/libmali/firmware/g610">æ–‡ä»¶ä¸‹è½½å¤„</a><br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240127101202.png"></p>
<p><strong>- Download OpenCL ICD loader and manually add libmali to ICD</strong></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> update
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> mesa-opencl-icd
<span class="token function">sudo</span> <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /etc/OpenCL/vendors
<span class="token builtin class-name">echo</span> <span class="token string">"/usr/lib/libmali-valhall-g610-g6p0-x11-wayland-gbm.so"</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> /etc/OpenCL/vendors/mali.icd<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>


<h2 id="1-2-Validata-Installation"><a href="#1-2-Validata-Installation" class="headerlink" title="1.2 Validata Installation"></a>1.2 Validata Installation</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">clinfo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="1-3-Prepare"><a href="#1-3-Prepare" class="headerlink" title="1.3 Prepare"></a>1.3 Prepare</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># clone mlc-llm from GitHub</span>
<span class="token function">git</span> clone <span class="token parameter variable">--recursive</span> https://github.com/mlc-ai/mlc-llm.git <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> mlc-llm
<span class="token comment"># Download prebuilt weights and libs</span>
<span class="token function">git</span> lfs <span class="token function">install</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> dist/prebuilt <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> dist/prebuilt
<span class="token function">git</span> clone https://github.com/mlc-ai/binary-mlc-llm-libs.git lib
<span class="token function">git</span> clone https://huggingface.co/mlc-ai/mlc-chat-RedPajama-INCITE-Chat-3B-v1-q4f16_1
<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>æˆ‘é‡‡ç”¨åœ¨æœ¬åœ°æ‹‰å–åå†ä¼ è¾“åˆ°é¦™æ©™æ´¾ä¸Šï¼Œå»ºè®®æ˜¯å…ˆå‹ç¼©å†ä¼ è¾“ï¼Œå†åœ¨é¦™æ©™æ´¾ä¸Šè§£å‹(.zip)</p>
<p>åœ¨ç¬¬ä¸€æ­¥<code>git clone --recursive https://github.com/mlc-ai/mlc-llm.git &amp;&amp; cd mlc-llm</code>å¦‚æœé‡åˆ°è¿™ä¸ª443é—®é¢˜ï¼Œç‚¹å‡»<a href="https://blog.csdn.net/qq_40296909/article/details/134285451">é“¾æ¥</a><br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240127140733.png"></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> config <span class="token parameter variable">--global</span> http.proxy <span class="token number">127.0</span>.0.1:7890
<span class="token function">git</span> config <span class="token parameter variable">--global</span> https.proxy <span class="token number">127.0</span>.0.1:7890
<span class="token comment"># æ³¨æ„7890è¦æ”¹æˆè‡ªå·±çš„ç”µè„‘ä¸Šçš„</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>


<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clone <span class="token parameter variable">--recursive</span> https://github.com/mlc-ai/mlc-llm.git <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> mlc-llm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>






<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> lfs <span class="token function">install</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>åœ¨è¿™ä¸€æ­¥ä¹‹å‰å…ˆinstall<code>git-lfs</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> git-lfs<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>ğŸ‘‡åœ¨å®¿ä¸»æœºä¸­åˆ›å»ºæ–‡ä»¶å¹¶è¿›å…¥æ–‡ä»¶<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240127143842.png"><br>ğŸ‘‡ä¼šç›´æ¥åœ¨ä½ (ä¸»æœº)é€‰ä¸­çš„ç›®å½•ä¸‹(æˆ‘è¿™é‡Œçš„æ˜¯mlc-llm)ä¸‹æœ‰ä¸€ä¸ªlibæ–‡ä»¶<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240127144257.png"><br>å°†ä¸»æœºä¸­çš„libå‹ç¼©åæ‹–è¿›å®¿ä¸»æœºçš„libæ–‡ä»¶ä¸‹<br>ğŸ‘‡åœ¨å®¿ä¸»æœºä¸­cdåˆ°libå¹¶å°†åˆšæ‰çš„å‹ç¼©åŒ…è§£å‹ç¼©</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">unzip</span> FileName.zip <span class="token comment"># è§£å‹</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240127152142.png"></p>
<p>RedPajama-INCITE-Chat-3B-v1-q4f16_1:<a href="https://huggingface.co/togethercomputer/RedPajama-INCITE-Chat-3B-v1">https://huggingface.co/togethercomputer/RedPajama-INCITE-Chat-3B-v1</a></p>
<p>Llama-2-7b-chat-hf-q4f16_1:<a href="https://huggingface.co/mlc-ai/mlc-chat-Llama-2-7b-chat-hf-q4f16_1">https://huggingface.co/mlc-ai/mlc-chat-Llama-2-7b-chat-hf-q4f16_1</a></p>
<p>Llama-2-13b-chat-hf-q4f16_1:<a href="https://huggingface.co/mlc-ai/mlc-chat-Llama-2-13b-chat-hf-q4f16_1">https://huggingface.co/mlc-ai/mlc-chat-Llama-2-13b-chat-hf-q4f16_1</a></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clone https://huggingface.co/mlc-ai/mlc-chat-Llama-2-13b-chat-hf-q4f16_1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>ğŸ‘†åœ¨ä¸»æœºä¸Šä¸‹è½½(æ³¨æ„è¿™ä¸ªç½‘å€å–å†³äºä½ ç”¨ä»€ä¹ˆæ¥ä½œä¸ºæ¨¡å‹)ï¼Œä¸‹è½½å®Œæ¯•åé‡‡ç”¨ğŸ‘‡å‘½ä»¤ä¼ è¾“åˆ°é¦™æ©™æ´¾ä¸Šï¼Œå¥½å¤„æ˜¯å¯ä»¥çœ‹åˆ°ä¼ è¾“çš„è¿‡ç¨‹(è¿™ä¸ªæ–‡ä»¶æœ‰13å¤šä¸ªG)<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240127151212.png"></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">scp</span> <span class="token parameter variable">-r</span> ./mlc-chat-Llama-2-13b-chat-hf-q4f16_1 orangepi@192.168.1.202:/home/orangepi/Project/MLC-LLM/dist/prebuit<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">scp</span> <span class="token parameter variable">-r</span> ç›¸å¯¹è·¯å¾„ä¸‹éœ€è¦ä¼ è¾“çš„æ–‡ä»¶ ä¸»æœºå@ip:è¢«ä¼ è¾“æ–‡ä»¶çš„ç›®çš„æ–‡ä»¶<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>







<h1 id="2-Try-out-the-CLI"><a href="#2-Try-out-the-CLI" class="headerlink" title="2 Try out the CLI"></a>2 Try out the CLI</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> mlc-llm/
<span class="token comment"># create build directory</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> build <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> build
<span class="token comment"># generate build configuration</span>
python3 <span class="token punctuation">..</span>/cmake/gen_cmake_config.py
<span class="token comment"># build `mlc_chat_cli`</span>
cmake <span class="token punctuation">..</span> <span class="token operator">&amp;&amp;</span> cmake <span class="token parameter variable">--build</span> <span class="token builtin class-name">.</span> <span class="token parameter variable">--parallel</span> <span class="token variable"><span class="token variable">$(</span>nproc<span class="token variable">)</span></span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> <span class="token punctuation">..</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python3 <span class="token punctuation">..</span>/cmake/gen_cmake_config.py<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>ğŸ‘†è¿™ä¸€æ­¥ä¸­ï¼Œ<code>CUDA</code>ã€<code>Vulkan</code>ã€<code>ROCm</code>ã€<code>Metal</code>å…¨é€‰<code>n</code>ï¼Œå…¶ä½™é€‰<code>y</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">cmake <span class="token punctuation">..</span> <span class="token operator">&amp;&amp;</span> cmake <span class="token parameter variable">--build</span> <span class="token builtin class-name">.</span> <span class="token parameter variable">--parallel</span> <span class="token variable"><span class="token variable">$(</span>nproc<span class="token variable">)</span></span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> <span class="token punctuation">..</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>ğŸ‘†åœ¨è¿™ä¸€æ­¥å¯èƒ½ä¼šæŠ¥ä¸¤æ¬¡é”™<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240127155002.png"></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> cmake<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿˜æœ‰ä¸€ä¸ªæŠ¥é”™æ²¡æ‰¾åˆ°å›¾ï¼Œå¤§æ¦‚æ„æ€æ˜¯æ‰¾ä¸åˆ°cargoï¼Œinstallä¸€ä¸ªå°±å¥½ğŸ‘‡</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token function">cargo</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240127155902.png"><br>è§£å†³æ–¹æ³•<a href="https://blog.csdn.net/iamzhoujunjia/article/details/113835347">æ›´æ¢Cargoè½¯ä»¶æº</a></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> <span class="token environment constant">$HOME</span>/.cargo/config<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>ğŸ‘†æˆ‘çš„æ˜¯æ–°å»ºçš„ä¸€ä¸ªæ–‡ä»¶</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># ä¸­ç§‘å¤§</span>
<span class="token punctuation">[</span>source.crates-io<span class="token punctuation">]</span>
registry <span class="token operator">=</span> <span class="token string">"https://github.com/rust-lang/crates.io-index"</span>
replace-with <span class="token operator">=</span> <span class="token string">'ustc'</span>
<span class="token punctuation">[</span>source.ustc<span class="token punctuation">]</span>
registry <span class="token operator">=</span> <span class="token string">"git://mirrors.ustc.edu.cn/crates.io-index"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å†æ¬¡æ‰§è¡ŒğŸ‘‡å¯ä»¥çœ‹åˆ°æœ‰åç»­çš„è¿›åº¦</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">cmake <span class="token punctuation">..</span> <span class="token operator">&amp;&amp;</span> cmake <span class="token parameter variable">--build</span> <span class="token builtin class-name">.</span> <span class="token parameter variable">--parallel</span> <span class="token variable"><span class="token variable">$(</span>nproc<span class="token variable">)</span></span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> <span class="token punctuation">..</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240127161834.png"><br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240127162004.png"></p>
<p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240127162200.png"></p>
<p>ğŸ‘†è¿™ä¸€æ­¥æ˜¯è®©æˆ‘ä»¬çœ‹æ˜¯å¦æœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«å¯¹åº”å³å›¾ä¸­ç»¿è‰²çš„ä¸‰ä¸ª</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./build/mlc_chat_cli <span class="token parameter variable">--model</span> Llama-2-13b-chat-hf-q4f16_1 â€“device mali<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æŠ¥é”™ï¼šæ‰¾ä¸åˆ°<code>mlc-chat-config.json</code><br>è§£å†³é—®é¢˜<a href="https://github.com/mlc-ai/mlc-llm/issues/730">Githubâ€”â€”Cannot find â€œmlc-chat-config.jsonâ€ in path â€œâ€distâ€/RedPajama-INCITE-Chat-3B-v1-q4f16_1</a>ï¼š<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240127164042.png"><br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240127164305.png"><br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240127164020.png"><br>åŸå› ï¼š<code>mlc-chat-config.json</code>åœ¨<code>mlc-llm</code>çš„ä¸Šä¸€çº§æ–‡ä»¶é‡Œçš„<code>mlc-chat-Llama-2-13b-chat-hf-q4f16_1</code>æ–‡ä»¶ä¸­ï¼Œä¸€å¼€å§‹æ˜¯åœ¨<code>mlc-llm</code>ä¸­<code>bulid</code>ä¸­è¿è¡Œï¼Œå› ä¸ºæ— æ³•è°ƒç”¨/è®¿é—®<code>mlc-llm</code>çš„åŒçº§æ–‡ä»¶æ‰€ä»¥æŠ¥é”™ã€‚æ‰€ä»¥æ¢æˆ<code>MLC-LLM</code>æ¥è°ƒç”¨<code>mlc_chat_cli</code>ï¼Œå³<code>dist</code>çš„ä¸Šä¸€çº§</p>
<p><strong>å¤§åŠŸå‘Šæˆï¼</strong><br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/LLM%E9%83%A8%E7%BD%B2%E5%9B%BE%E7%89%87/Pasted%20image%2020240127170657.png"></p>
]]></content>
      <categories>
        <category>äººå·¥æ™ºèƒ½</category>
      </categories>
      <tags>
        <tag>äººå·¥æ™ºèƒ½</tag>
        <tag>NLP</tag>
      </tags>
  </entry>
  <entry>
    <title>RNN(æå®æ¯…)</title>
    <url>/2023/11/06/rnn-li-hong-yi/</url>
    <content><![CDATA[<h1 id="1-Example-Application"><a href="#1-Example-Application" class="headerlink" title="1 Example Application"></a>1 Example Application</h1><h2 id="1-1-Slot-Filling"><a href="#1-1-Slot-Filling" class="headerlink" title="1.1 Slot Filling"></a>1.1 Slot Filling</h2><p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231106133700.png"><br>ğŸ‘†å¥å­ä¸­åªæœ‰<strong>Taipei</strong>å’Œ<strong>November</strong> $2^{nd}$ å±äºä¸¤ä¸ªslotä¸­ï¼Œå…¶ä½™è¯æ±‡ä¸å±äºä»»ä½•slot</p>
<h2 id="1-2é€šè¿‡feedforward-networkå®ç°slot-filling"><a href="#1-2é€šè¿‡feedforward-networkå®ç°slot-filling" class="headerlink" title="1.2é€šè¿‡feedforward networkå®ç°slot filling"></a>1.2é€šè¿‡feedforward networkå®ç°slot filling</h2><p>Input : a word<br>(Each word is represented as a vector):</p>
<pre><code>1. 1-of-N encoding
2. beyond 1-of-N encoding
    1. dimension for "other"ï¼šåœ¨1-of-N encodingå¤šåŠ ä¸€ä¸ªdimensionï¼Œè¿™ä¸ªdimensionä»£è¡¨other(æ²¡è§è¿‡çš„è¯æ±‡)
        ![](https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231107222413.png)
    2.word hashing
    ![](https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231106134607.png)
</code></pre>
<p>Outputï¼šprobability distribution that the input word belonging to the slots</p>
<h2 id="1-3Problem"><a href="#1-3Problem" class="headerlink" title="1.3Problem"></a>1.3Problem</h2><p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231106135520.png"><br>input Taipeiè¿™ä¸ªè¯æ±‡ï¼Œè¦ä¹ˆéƒ½æ˜¯destinationå‡ ç‡æœ€é«˜ï¼Œè¦ä¹ˆéƒ½æ˜¯place of departureå‡ ç‡æœ€é«˜ğŸ‘‰æˆ‘ä»¬å¸Œæœ›nerual networkæ˜¯æœ‰è®°å¿†åŠ›çš„ğŸ‘‰å¦‚æœä»–èƒ½è®°ä½arriveå’Œleaveé‚£ä»–çš„outputå°±å¯ä»¥ä¸åŒ</p>
<h2 id="1-4-Solution"><a href="#1-4-Solution" class="headerlink" title="1.4 Solution"></a>1.4 Solution</h2><p>ä½¿ç”¨Recurrent Neural Networkæ—¶ï¼Œè¦å…ˆç»™memoryçš„èµ·å§‹å€¼<img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231106140426.png"><br>ğŸ‘†åˆå§‹å€¼ä¸º0ï¼Œè¾“å…¥ä¸º1ï¼Œç»¿è‰²neuronæ¥æ”¶1ã€1å’Œ0ã€0<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231106140717.png"><br>ğŸ‘†$y_1=4$ã€$y_2=4$<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231106140826.png"><br>ğŸ‘†ç»¿è‰²neuroné‡Œmemoryçš„å€¼å˜æˆ2<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231106140937.png"><br>ğŸ‘†ç¬¬äºŒæ¬¡è¾“å…¥[1,1]<br>å¦‚æœinputçš„é¡ºåºä¸ä¸€æ ·ï¼Œoutputçš„å†…å®¹ä¹Ÿä¼šä¸ä¸€æ ·</p>
<p>æ€»å†µï¼š<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231106141627.png"><br>åœ¨memoryä¸­storeä¸åŒçš„valuesä½¿å¾—Taipeiçš„slotä¸åŒï¼Œä¸€ä¸ªæ˜¯destinationä¸€ä¸ªæ˜¯place of departure</p>
<h1 id="2-Deep-hidden-layer-RNN"><a href="#2-Deep-hidden-layer-RNN" class="headerlink" title="2 Deep hidden layer RNN"></a>2 Deep hidden layer RNN</h1><p>ğŸ‘‡æ¯ä¸€ä¸ªç»¿è‰²æ¡†æ˜¯ä¸€ä¸ªhidden layerï¼Œè“è‰²ç®­å¤´æ˜¯hidden layerçš„å€¼memory<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231106144457.png"></p>
<h2 id="2-1-Elman-Network"><a href="#2-1-Elman-Network" class="headerlink" title="2.1 Elman Network"></a>2.1 Elman Network</h2><p>ğŸ‘‡hidden layerçš„å€¼å…ˆå­˜èµ·æ¥ï¼Œä¸‹ä¸€ä¸ªæ—¶é—´ç‚¹å†è¯»å‡ºæ¥<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231106144650.png"></p>
<h2 id="2-2-Jordan-Network"><a href="#2-2-Jordan-Network" class="headerlink" title="2.2 Jordan Network"></a>2.2 Jordan Network</h2><p>ğŸ‘‡æŠŠoutputçš„å€¼å…ˆå­˜åœ¨memoryé‡Œé¢ï¼Œä¸‹ä¸€ä¸ªæ—¶é—´ç‚¹å†è¯»å‡ºæ¥<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231106144747.png"></p>
<h2 id="2-3-Bidirectional-RNN"><a href="#2-3-Bidirectional-RNN" class="headerlink" title="2.3 Bidirectional RNN"></a>2.3 Bidirectional RNN</h2><p>ğŸ‘‡åŒæ—¶trainæ­£å‘å’Œé€†å‘çš„RNNï¼ŒæŠŠæ­£å‘å’Œé€†å‘çš„outputéƒ½ä¸¢åˆ°output layeräº§ç”Ÿ$y^t$<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231106150157.png"><br>ç›¸å½“äºçœ‹äº†æ•´ä¸ªsequence</p>
<h1 id="3-Long-Short-term-Memory"><a href="#3-Long-Short-term-Memory" class="headerlink" title="3 Long Short-term Memory"></a>3 Long Short-term Memory</h1><p>4 input:â‘ æƒ³è¦å­˜åˆ°memoryä¸­çš„å€¼ â‘¡æ“æ§Input Gateçš„ä¿¡å· â‘¢æ“æ§Output Gateçš„ä¿¡å· â‘£æ“æ§Forget Gateçš„ä¿¡å·<img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231106151107.png"></p>
<p>$f(z_i)$å†³å®š$g(z)$èƒ½å¦è¾“å…¥<br>Forget Gateè¢«å…³é—­ï¼Œå³$f(z_f)$æ•°å€¼ä¸º0æ—¶ä»£è¡¨é—å¿˜ï¼Œåä¹‹ä¸ºè®°å¿†<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231106210058.png"></p>
<h2 id="3-1-LSTM-Example"><a href="#3-1-LSTM-Example" class="headerlink" title="3.1 LSTM - Example"></a>3.1 LSTM - Example</h2><p>tæ—¶åˆ»å¯¹memoryçš„å½±å“ä¼šåœ¨t+1æ—¶åˆ»ä½“ç°<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231106211702.png"></p>
<p>weight å’Œ biasç”¨training dataé€šè¿‡gradient descentå¾—åˆ°çš„<br>LSTM vs original network: 4 times of parameter</p>
<ul>
<li>*$x^t$ä¹˜ä¸Šä¸€ä¸ªtransformå¾—åˆ°vector$z$ï¼Œvector$z$çš„æ¯ä¸€ä¸ªdimensionæ“æ§æ¯ä¸€ä¸ªLSTMçš„inputï¼Œ$z$çš„dimensionæ•°ç›®=LSTM memory cellçš„æ•°ç›®ï¼Œ$z^i$ã€$z^o$ã€$z^f$åŒç†</li>
<li>*$z^i$ã€$z^o$ã€$z^f$ã€$z$ä¸¢åˆ°cellé‡Œçš„å€¼åªæ˜¯ä»–ä»¬å…¶ä¸­çš„ä¸€ä¸ªdimension</li>
<li>$c^{t-1}$ã€$h^{t-1}$ã€$x^t$ä¸€èµ·ä¹˜transformç„¶åä½œä¸ºè¾“å…¥<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231106223442.png"></li>
</ul>
<h2 id="3-2-Learning-Target"><a href="#3-2-Learning-Target" class="headerlink" title="3.2 Learning Target"></a>3.2 Learning Target</h2><p>æœ‰ä¸€ä¸ªtraining sentenceï¼Œè¦ç»™sentenceé‡Œçš„æ¯ä¸€ä¸ªwordä¸€ä¸ªlabel<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231107165449.png"><br>ğŸ‘‡è¾“å…¥arriveå¾—åˆ°ä¸€ä¸ªvetorï¼Œvetorä¸­dimension<code>other</code>çš„å€¼ä¸º1ï¼Œå…¶ä½™ä¸º0ã€‚åœ¨ä¸¢$x^2$ä¹‹å‰è¦å…ˆä¸¢$x^1$<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231107165849.png"><br>reference vector(çº¢è‰²é‚£æ¡)çš„é•¿åº¦å°±æ˜¯slotçš„æ•°ç›®</p>
<p>ğŸ‘‡RNNå¯ä»¥ç”¨gradient descent trainå‡ºæ¥<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231107170120.png"></p>
<h2 id="3-3-Problem"><a href="#3-3-Problem" class="headerlink" title="3.3 Problem"></a>3.3 Problem</h2><p>ğŸ‘‡RNN-based network is not always easy to learn<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231107171122.png"><br>ğŸ‘‡ä»æœ€å³è¾¹çš„æ©™è‰²ç‚¹updateåˆ°ä¸­é—´çš„å†updateåˆ°å·¦è¾¹çš„æ©™è‰²ç‚¹ï¼ŒTotal Lossçªç„¶æš´å¢<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231107171305.png"><br>ğŸ‘‡Error Surface æœ€å·¦è¾¹æ©™è‰²çš„ç‚¹çš„ä½ç½®çš„gradientå¾ˆå¤§ï¼Œä¸€å¼€å§‹çš„gradientå¾ˆå°ï¼Œlearning rateæœ‰å¯èƒ½è®¾ç½®å¾—å¾ˆé«˜ï¼Œå¯¼è‡´$gradient$ x $learning$ $rate$ä¼šå¾ˆå¤§ï¼Œå°±åƒå¼€é£æœºä¸€æ ·<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231107194049.png"><br>ğŸ‘†è§£å†³åŠæ³•ï¼šè®¾ç½®threshold valueï¼Œå½“gradientå¤§äºæŸå€¼æ—¶å°†gradientè®¾ç½®ä¸ºæŸå€¼</p>
<p>RNNçš„é—®é¢˜åœ¨äºtime sequenceçš„weighåœ¨ä¸åŒçš„æ—¶é—´ç‚¹ä¼šè¢«åå¤ä½¿ç”¨<br>ğŸ‘‡$w$ç­‰äº$1$ã€$1.01$ã€$0.99$ã€$0.01$æ—¶ï¼Œ$y$çš„å–å€¼å˜åŒ–éƒ½ä¼šå¾ˆå¤§<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231107200606.png"></p>
<h2 id="3-4-Solution"><a href="#3-4-Solution" class="headerlink" title="3.4 Solution"></a>3.4 Solution</h2><p><strong>LSTM</strong></p>
<ol>
<li>Can deal with gradient vanishing(not gradient explode) ä¸ä¼šå‡ºç°error surfaceå¾ˆå¹³å¦çš„åœ°æ–¹ï¼Œå¯ä»¥è§£å†³æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ğŸ‘‰æ‰€ä»¥learning rateå¯ä»¥è®¾ç½®å¾—å°ä¸€ç‚¹</li>
<li>RNN vs LSTM<ol>
<li>RNNä¸­æ¯ä¸ªæ—¶é—´$t$ memoryçš„å€¼ä¼šè¢«è¦†ç›–æ‰</li>
<li>LSTMä¸­<ol>
<li>æ¯ä¸ªæ—¶é—´$t$ menory and input are <strong>added</strong>ğŸ‘‰è§£å†³æ¢¯åº¦æ¶ˆå¤±</li>
<li>The influence never disappears unless forget gate is closedï¼Œåªæœ‰foget gateå…³ä¸Šæ‰æœ‰å¯èƒ½å¯¼è‡´LSTMä¸æ–­æ›´æ–°inputå’Œmemoryçš„å€¼</li>
<li>No gradient vanishing(If forget gate is opened)</li>
</ol>
</li>
</ol>
</li>
</ol>
<h1 id="4-More-Applications"><a href="#4-More-Applications" class="headerlink" title="4 More Applications"></a>4 More Applications</h1><h2 id="4-1-Sequence-to-sequence"><a href="#4-1-Sequence-to-sequence" class="headerlink" title="4.1 Sequence-to-sequence"></a>4.1 Sequence-to-sequence</h2><ol>
<li>Input is a vector sequence, but output is only one vector(Many to  One)<ol>
<li>Sentiment Analysis</li>
<li>Key Term Extraction</li>
</ol>
</li>
<li>Both input and output are both sequences, but the output is shorter(Many to Many)<ol>
<li>Speech Recognition</li>
<li>Connectionist Temporal Classification(CTC)<ol>
<li><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231107205719.png"></li>
<li>æŠŠå³è¾¹ä¸‰ç§ç»“æœéƒ½è§†ä¸ºæ­£ç¡®ä¸¢åˆ°training dataä¸­ <img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231107205955.png"></li>
<li>æœºå™¨ä¸éœ€è¦è®¤è¯†æŸä¸ªè¯æ±‡<img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231107210143.png"></li>
</ol>
</li>
<li>Sequence to sequence learning(Many to Many(No Limitation))<ol>
<li>RNNçš„inputå’Œoutputéƒ½æ˜¯sequenceï¼Œinputå’Œoutputçš„é•¿åº¦ä¸ç¡®å®šã€‚é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨æœ€åä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œmemoryé‡Œå­˜äº†æ‰€æœ‰input sequenceçš„informationï¼Œç„¶åå°±è®©machineå¼€å§‹åcharacterï¼Œå†å°†ä¹‹å‰çš„outputçš„characterä½œä¸ºinputï¼Œå†è¯»å–ä¸Šä¸€ä¸ªmemoryçš„å€¼ï¼Œç»§ç»­output</li>
<li>Problem:Donâ€™t know when to stop<img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231107222413.png"></li>
<li>Solution:Add a symbol â€œ===â€œæ–­<img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231107222616.png"></li>
</ol>
</li>
</ol>
</li>
<li>Sequence-to-sequence Auto-encoder<img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231108102135.png"><br>ğŸ‘†RNN Encoderå’ŒRNN Decoderæ˜¯ä¸€èµ·trainçš„ï¼Œç›®çš„æ˜¯è®©trainå‡ºæ¥çš„$y_1$ã€$y_2$ã€$y_3$ã€$y_4$ä¸$x_1$ã€$x_2$ã€$x_3$ã€$x_4$ç›¸è¿‘</li>
</ol>
<h2 id="4-2-Attention-based-Model"><a href="#4-2-Attention-based-Model" class="headerlink" title="4.2 Attention-based Model"></a>4.2 Attention-based Model</h2><p>ğŸ‘‡ä¸­å¤®å¤„ç†å™¨DNN/RNNæ“æ§Reading Head Controllerã€è¯»å†™å¤´å†³å®šReading Headæ”¾çš„ä½ç½®<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231108102942.png"><br>ğŸ‘‡ç‰ˆæœ¬â…¡ Neural Turing Machine(2014)<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/DL%26ML_picture/Pasted%20image%2020231108103018.png"></p>
]]></content>
      <categories>
        <category>äººå·¥æ™ºèƒ½</category>
      </categories>
      <tags>
        <tag>äººå·¥æ™ºèƒ½</tag>
        <tag>å¾ªç¯ç¥ç»ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸‡å¹´å†</title>
    <url>/2023/02/08/wan-nian-li/</url>
    <content><![CDATA[<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdbool.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">printMonth</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">printMonthBody</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">getStartDay</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">getTotalNumOfDays</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">getNumOfDaysInMonth</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">)</span><span class="token punctuation">;</span>
bool <span class="token function">isLeapYear</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> year<span class="token punctuation">,</span> month<span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥è¦æŸ¥è¯¢çš„å¹´ä»½ï¼š\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">scanf_s</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>year<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥è¦æŸ¥è¯¢çš„æœˆä»½ï¼š\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">scanf_s</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>month<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printMonth</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span> month<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">printMonth</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span><span class="token keyword">int</span> month<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%då¹´%dæœˆä»½çš„æ—¥å†\n"</span><span class="token punctuation">,</span>year<span class="token punctuation">,</span>month<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"--------------------------------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"æ—¥\tä¸€\täºŒ\tä¸‰\tå››\täº”\tå…­\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printMonthBody</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span> month<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">printMonthBody</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span><span class="token keyword">int</span> month<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> week <span class="token operator">=</span> <span class="token function">getStartDay</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span> month<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> days <span class="token operator">=</span> <span class="token function">getNumOfDaysInMonth</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span> month<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> i<span class="token punctuation">;</span>
	<span class="token keyword">int</span> date <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> circulation <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token comment">//ç¬¬ä¸€è¡Œçš„æ—¥æœŸ</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> week <span class="token operator">%</span> <span class="token number">7</span><span class="token punctuation">;</span> i <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"  \t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> week<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">7</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\t"</span><span class="token punctuation">,</span> date<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//ä»ç¬¬äºŒè¡Œå¼€å§‹çš„æ—¥æœŸ</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> date<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> days<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>circulation <span class="token operator">==</span> <span class="token number">7</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			circulation <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\t"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
		circulation<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">getStartDay</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span><span class="token keyword">int</span> month<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> week<span class="token punctuation">;</span>
	week <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">getTotalNumOfDays</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span> month<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">7</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>week <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token number">7</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span>
		<span class="token keyword">return</span> week<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">getTotalNumOfDays</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span><span class="token keyword">int</span> month<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> i<span class="token punctuation">;</span>
	<span class="token keyword">int</span> yearChange <span class="token operator">=</span> year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> sum1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> sum2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> daysOfYear<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> year <span class="token operator">-</span> <span class="token number">1800</span><span class="token punctuation">;</span> i <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isLeapYear</span><span class="token punctuation">(</span>yearChange<span class="token punctuation">)</span><span class="token punctuation">)</span>
			daysOfYear <span class="token operator">=</span> <span class="token number">366</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span>
			daysOfYear <span class="token operator">=</span> <span class="token number">365</span><span class="token punctuation">;</span>
		sum1 <span class="token operator">+=</span> daysOfYear<span class="token punctuation">;</span>
		yearChange<span class="token operator">--</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> month <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>
		sum2 <span class="token operator">+=</span> <span class="token function">getNumOfDaysInMonth</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
	sum <span class="token operator">=</span> sum1 <span class="token operator">+</span> sum2<span class="token punctuation">;</span>
	<span class="token keyword">return</span> sum<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">getNumOfDaysInMonth</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span><span class="token keyword">int</span> month<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	
	<span class="token keyword">if</span> <span class="token punctuation">(</span>month <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">||</span> month <span class="token operator">==</span> <span class="token number">3</span> <span class="token operator">||</span> month <span class="token operator">==</span> <span class="token number">5</span> <span class="token operator">||</span> month <span class="token operator">==</span> <span class="token number">7</span> <span class="token operator">||</span> month <span class="token operator">==</span> <span class="token number">8</span> <span class="token operator">||</span> month <span class="token operator">==</span> <span class="token number">10</span> <span class="token operator">||</span> month <span class="token operator">==</span> <span class="token number">12</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token number">31</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>month <span class="token operator">==</span> <span class="token number">4</span> <span class="token operator">||</span> month <span class="token operator">==</span> <span class="token number">6</span> <span class="token operator">||</span> month <span class="token operator">==</span> <span class="token number">9</span> <span class="token operator">||</span> month <span class="token operator">==</span> <span class="token number">11</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token number">31</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>month <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isLeapYear</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span> <span class="token number">29</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span>
			<span class="token keyword">return</span> <span class="token number">28</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

bool <span class="token function">isLeapYear</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>year <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> true<span class="token punctuation">;</span>
	<span class="token keyword">else</span>
		<span class="token keyword">return</span> false<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



]]></content>
      <categories>
        <category>Cè¯­è¨€</category>
      </categories>
      <tags>
        <tag>Cè¯­è¨€</tag>
        <tag>é—²ç€æ²¡äº‹å¹²</tag>
      </tags>
  </entry>
  <entry>
    <title>åŸºæœ¬å…ƒç´ å’Œç±»å‹</title>
    <url>/2023/01/11/ji-ben-yuan-su-he-shu-ju-lei-xing/</url>
    <content><![CDATA[<h2 id="ä¸€-åŸºæœ¬å…ƒç´ "><a href="#ä¸€-åŸºæœ¬å…ƒç´ " class="headerlink" title="ä¸€.åŸºæœ¬å…ƒç´ "></a>ä¸€.åŸºæœ¬å…ƒç´ </h2><ul>
<li>æ ‡è®°Tokenï¼šå¯¹ç¼–è¯‘å™¨æœ‰æ„ä¹‰çš„ç¬¦å·<ul>
<li>å…³é”®å­—Keyword</li>
<li>æ“ä½œç¬¦Operator</li>
<li>æ ‡è¯†ç¬¦Identifier<ul>
<li>å…è®¸â€œ@â€å­—ç¬¦ä½œä¸ºå‰ç¼€ä»¥ä½¿å…³é”®å­—èƒ½å¤Ÿç”¨ä½œæ ‡è¯†ç¬¦</li>
</ul>
</li>
<li>æ ‡ç‚¹ç¬¦å·</li>
<li>æ–‡æœ¬(å­—é¢å€¼)</li>
</ul>
</li>
<li>æ³¨é‡Šä¸ç©ºç™½<ul>
<li>CTRL+K CTRL+CğŸ‘‰æ³¨é‡Š</li>
<li>CTRL+K CTRL+UğŸ‘‰å–æ¶ˆæ³¨é‡Š</li>
<li>CTRL+K CTRL+DğŸ‘‰è®¾ç½®æ–‡æ¡£æ ¼å¼(è‡ªåŠ¨å¯¹é½)</li>
</ul>
</li>
</ul>
<h2 id="äºŒ-æ•°æ®ç±»å‹"><a href="#äºŒ-æ•°æ®ç±»å‹" class="headerlink" title="äºŒ.æ•°æ®ç±»å‹"></a>äºŒ.æ•°æ®ç±»å‹</h2><ul>
<li><p>å€¼ç±»å‹</p>
<ul>
<li>ç»“æ„ä½“Structures</li>
<li>æšä¸¾Enumerations<ul>
<li>åªèƒ½ä»ä¸€ä¸ªé›†åˆä¸­é€‰å–æœ‰æ•ˆå€¼</li>
</ul>
</li>
</ul>
</li>
<li><p>å¼•ç”¨ç±»å‹</p>
<ul>
<li><p>ç±»Classes</p>
</li>
<li><p>æ¥å£Interfaces</p>
</li>
<li><p>å§”æ‰˜Delegates</p>
</li>
</ul>
</li>
</ul>
<h2 id="ä¸‰-å˜é‡"><a href="#ä¸‰-å˜é‡" class="headerlink" title="ä¸‰.å˜é‡"></a>ä¸‰.å˜é‡</h2><p>ğŸ‘‡ä»è¡¨é¢çœ‹ï¼Œå˜é‡æ˜¯ç”¨æ¥<strong>å­˜å‚¨æ•°æ®</strong>çš„</p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">int x;
x = 100;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>å®é™…ä¸Šï¼Œ<strong>å˜é‡è¡¨ç¤ºäº†å­˜å‚¨ä½ç½®ï¼Œå¹¶ä¸”æ¯ä¸ªå˜é‡éƒ½æœ‰ä¸€ä¸ªç±»å‹ï¼Œä»¥å†³å®šä»€ä¹ˆæ ·çš„å€¼èƒ½å¤Ÿå­˜å…¥å˜é‡</strong></p>
<p>ğŸ‘†äº†è§£ä¸ºï¼Œxæ˜¯ä¸€ä¸ª<code>æ ‡ç­¾</code>ï¼Œå¯¹åº”ç€å†…å­˜ä¸­çš„ä¸€ä¸ªåœ°å€ï¼Œ100è¿™ä¸ªå€¼å°±å­˜åœ¨è¯¥åœ°å€</p>
<p><strong>å˜é‡ = <code>ä»¥å˜é‡åæ‰€å¯¹åº”çš„å†…å­˜åœ°å€ä¸ºèµ·ç‚¹</code>ã€<code>ä»¥å…¶æ•°æ®ç±»å‹æ‰€è¦æ±‚çš„å­˜å‚¨ç©ºé—´ä¸ºé•¿åº¦</code>çš„ä¸€å—å†…å­˜åŒºåŸŸ</strong></p>
<p><img src="/../../../../medias/blog_picture/C#/2.png" alt="å †ï¼Œæ ˆï¼Œåœ°å€çš„ç†è§£"></p>
<p>å¼•ç”¨å˜é‡å­˜çš„æ˜¯å®ä¾‹çš„åœ°å€</p>
<h4 id="è£…ç®±å’Œæ‹†ç®±"><a href="#è£…ç®±å’Œæ‹†ç®±" class="headerlink" title="è£…ç®±å’Œæ‹†ç®±"></a>è£…ç®±å’Œæ‹†ç®±</h4><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">//è£…ç®±
int x = 100;
object obj;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å½“å‘ç°objå¼•ç”¨çš„å®ä¾‹åœ¨å †ä¸Šè€Œä¸åœ¨æ ˆä¸Šæ—¶ï¼ŒæŠŠè¯¥å®ä¾‹å¯¹åº”çš„å€¼çš„å†…å­˜å¤§å°åœ¨æ ˆä¸Šæ‰¾ä¸€å—ç©ºé—´ï¼Œå†æŠŠè¿™ä¸ªåœ°å€å­˜å‚¨å›objçš„å†…å­˜ç©ºé—´</p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">//æ‹†ç®±
int y = (int)obj;
Console.WriteLine(y);

//100<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/../../../../medias/blog_picture/C#/3.png" alt="è£…ç®±å’Œæ‹†ç®±"></p>
<h2 id="å››-æ–¹æ³•"><a href="#å››-æ–¹æ³•" class="headerlink" title="å››.æ–¹æ³•"></a>å››.æ–¹æ³•</h2><p>æ–¹æ³•æ˜¯ç±»æˆ–ç»“æ„ä½“çš„æˆå‘˜</p>
<p>æ–¹æ³•ç›¸å½“äºè‡ªå®šä¹‰å‡½æ•°</p>
<p><img src="/../../../../medias/blog_picture/C#/4.png"></p>
<p>ğŸ‘†å¤ç”¨ï¼Œå¦‚æœè¦æ›´æ”¹3.14159ä¸º3.14æˆ–è€…Math.PIå¯ä»¥ç›´æ¥åœ¨GetCircleAreaå¤„æ”¹</p>
<p>å®ä¾‹æ–¹æ³•ğŸ‘‡</p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">Calculator c = new Calculator();
c.Add(2.0,3.0);
class Calculator
{
    public double Add(double a,double b);
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é™æ€æ–¹æ³•</p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">Calculator c = new Calculator();
//c.Add(2.0,3.0);æ­¤æ—¶è¿™å¥è¯æ— ç”¨
class Calculator
{
    public static double Add(double a,double b);
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="äº”-æ„é€ å™¨"><a href="#äº”-æ„é€ å™¨" class="headerlink" title="äº”.æ„é€ å™¨"></a>äº”.æ„é€ å™¨</h2><p><strong>ä¸å¸¦ä»¥0ä¸ºé»˜è®¤å‚æ•°çš„æ„é€ å™¨</strong></p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">namespace ConstructExample
{
    class Program
    {
        static void Main(string[]args)
        {
            Student stu = new Student;
            Console.WriteLine(stu.ID);
            Console.WriteLine(stu.Name);
        }
    }
    class Student
    {
        //ä¸å¸¦å‚æ•°çš„æ„é€ ä½“
    	public Student()
        {
            this.ID = 1;
            this.Name = "No name";
        }
        //
        public int ID;
        public string Name;
    }
}

//1
//No Name<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å¼ºåˆ¶ç¨‹åºå‘˜ç»™æ„é€ å™¨è®¾ç½®å‚æ•°</strong>ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹å¦‚æœä¸æƒ³è®¾ç½®å‚æ•°ä½†æ˜¯è¦è°ƒç”¨è¯¥æ–¹æ³•ï¼Œå°±éœ€è¦è‡ªå®šä¹‰ä¸€ä¸ªé»˜è®¤å‚æ•°ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤º</p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">namespace ConstructExample
{
    class Program
    {
        static void Main(string[]args)
        {
            Student stu = new Student(1,"No name");//ä¸èƒ½å†å†™æˆnew Student();
            Console.WriteLine(stu.ID);
            Console.WriteLine(stu.Name);
        }
    }
    class Student
    {
        //ä¸å¸¦å‚æ•°çš„æ„é€ ä½“
    	public Student(int initId,string initName)
        {
            this.ID = initId;
            this.Name = initName;
        }
        //
        public int ID;
        public string Name;
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æ„é€ å™¨å¿«æ·é”®ï¼šctor+tab*2</strong>ctor=Code snippet(å°ç‰‡æ®µ)</p>
<h4 id="é‡è½½"><a href="#é‡è½½" class="headerlink" title="é‡è½½"></a>é‡è½½</h4><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">class Calculator
{
    //â‘ 
    public double Add(int a, int b)
    {
        return a + b;
    }
    //â‘¡
    public int Add(int a, int b)
    {
        return a + b;
    }
    â‘¢
    public double Add(int a, int b, int c)
    {
        return a + b + c;
    } 
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ğŸ‘†â‘ ä¸â‘¡ä¸èƒ½å…±å­˜ï¼Œé‡è½½ä¸æ–¹æ³•çš„ç±»å‹æ— å…³</p>
<p>â‘ å’Œâ‘¢ã€â‘¡å’Œâ‘¢å¯å…±å­˜</p>
<h2 id="è°ƒç”¨æ–¹æ³•å®é™…ä¸Šæ˜¯å‹æ ˆçš„è¿‡ç¨‹"><a href="#è°ƒç”¨æ–¹æ³•å®é™…ä¸Šæ˜¯å‹æ ˆçš„è¿‡ç¨‹" class="headerlink" title="è°ƒç”¨æ–¹æ³•å®é™…ä¸Šæ˜¯å‹æ ˆçš„è¿‡ç¨‹"></a>è°ƒç”¨æ–¹æ³•å®é™…ä¸Šæ˜¯å‹æ ˆçš„è¿‡ç¨‹</h2>]]></content>
      <categories>
        <category>C#</category>
      </categories>
      <tags>
        <tag>é—²ç€æ²¡äº‹å¹²</tag>
        <tag>C#</tag>
      </tags>
  </entry>
  <entry>
    <title>CUDAç¼–ç¨‹ï¼šåŸºç¡€ä¸å®è·µå­¦ä¹ ç¬”è®°</title>
    <url>/2024/08/02/cudac/</url>
    <content><![CDATA[<h1 id="ç¬¬äºŒç« -CUDAä¸­çš„çº¿ç¨‹ç»„ç»‡"><a href="#ç¬¬äºŒç« -CUDAä¸­çš„çº¿ç¨‹ç»„ç»‡" class="headerlink" title="ç¬¬äºŒç«  CUDAä¸­çš„çº¿ç¨‹ç»„ç»‡"></a>ç¬¬äºŒç«  CUDAä¸­çš„çº¿ç¨‹ç»„ç»‡</h1><p><code>cudaDeviceSynchronize();</code>ï¼šåŒæ­¥ä¸»æœºå’Œè®¾å¤‡ï¼Œ(å› ä¸ºè°ƒç”¨è¾“å‡ºå‡½æ•°æ—¶ï¼Œè¾“å‡ºæµå…ˆæ”¾åœ¨ç¼“å†²åŒºï¼Œä½†æ˜¯ç¼“å†²åŒºä¸ä¼šè‡ªåŠ¨åˆ·æ–°ï¼Œåªæœ‰é‡åˆ°æŸç§åŒæ­¥æ“ä½œæ—¶æ‰ä¼šåˆ·æ–°)ï¼Œå¦‚æœæ²¡æœ‰è¿™å¥è¯æ˜¯ä¸ä¼šæ‰§è¡Œæ ¸å‡½æ•°çš„å†…å®¹</p>
<p><code>dim3</code>å’Œ<code>unit3</code>çš„åŒºåˆ«</p>
<ul>
<li><code>unit3</code>ï¼šæ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œå…·æœ‰<code>x</code>ã€<code>y</code>ã€<code>z</code>ä¸‰ä¸ªæˆå‘˜ã€‚é€‚ç”¨<code>blockIdx</code>å’Œ<code>threadIdx</code></li>
<li><code>dim3</code>ï¼šæ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œå’Œ<code>unit3</code>ç±»ä¼¼ï¼Œé€‚ç”¨<code>blockDim</code>å’Œ<code>gridDim</code></li>
<li>äºŒè€…å…³ç³»ï¼ŒxxxIdx.açš„å–å€¼èŒƒå›´æ˜¯yyyDim.a-1ï¼Œå¦‚ï¼š<code>blockIdx.x</code>çš„å–å€¼èŒƒå›´æ˜¯<code>gridDim.x-1</code></li>
</ul>
<h1 id="ç¬¬ä¸‰ç« -ç®€å•CUDAç¨‹åºçš„åŸºæœ¬æ¡†æ¶"><a href="#ç¬¬ä¸‰ç« -ç®€å•CUDAç¨‹åºçš„åŸºæœ¬æ¡†æ¶" class="headerlink" title="ç¬¬ä¸‰ç«  ç®€å•CUDAç¨‹åºçš„åŸºæœ¬æ¡†æ¶"></a>ç¬¬ä¸‰ç«  ç®€å•CUDAç¨‹åºçš„åŸºæœ¬æ¡†æ¶</h1><h3 id="3-2-2-è®¾å¤‡å†…å­˜çš„é‡Šæ”¾ä¸åˆ†é…"><a href="#3-2-2-è®¾å¤‡å†…å­˜çš„é‡Šæ”¾ä¸åˆ†é…" class="headerlink" title="3.2.2 è®¾å¤‡å†…å­˜çš„é‡Šæ”¾ä¸åˆ†é…"></a>3.2.2 è®¾å¤‡å†…å­˜çš„é‡Šæ”¾ä¸åˆ†é…</h3><p><code>cudaMalloc()</code></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token class-name">cudaError_t</span> <span class="token function">cudaMalloc</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span>address<span class="token punctuation">,</span> <span class="token class-name">size_t</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li><code>address</code>ï¼šå¾…åˆ†é…è®¾å¤‡å†…å­˜çš„æŒ‡é’ˆã€‚å› ä¸ºå†…å­˜(åœ°å€)æœ¬èº«å°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œæ‰€ä»¥addressæ˜¯æŒ‡é’ˆçš„æŒ‡é’ˆ</li>
<li><code>size</code>ï¼šå¾…åˆ†é…å†…å­˜çš„å­—èŠ‚æ•°</li>
<li><code>cudaError_t</code>ï¼šä½œä¸ºè¿”å›å€¼ï¼Œå¦‚æœè°ƒç”¨æˆåŠŸåˆ™è¿”å›<code>cudaSuccess</code></li>
<li><code>(void **)</code>ï¼šå°†æŸä¸€ç§ç±»å‹çš„åŒé‡æŒ‡é’ˆå˜ä¸ºvoidç±»å‹çš„åŒé‡æŒ‡é’ˆ</li>
<li>åŠŸèƒ½æ˜¯æ”¹å˜æŒ‡é’ˆd_xæœ¬èº«çš„å€¼ï¼Œå³å°†ä¸€ä¸ªæŒ‡é’ˆèµ‹å€¼ç»™d_xï¼Œå› æ­¤è¦å–d_xçš„åœ°å€ï¼Œå³<code>&amp;d_x</code>ï¼ŒåŒæ—¶è¯¥å‡½æ•°ä¸æ˜¯è¿”å›ä¸€ä¸ªæŒ‡é’ˆ</li>
<li>é…åˆ<code>cudaFree()</code>å‡½æ•°ä½¿ç”¨</li>
</ul>
<h3 id="3-2-3-ä¸»æœºä¸è®¾å¤‡ä¹‹é—´æ•°æ®çš„ä¼ é€’"><a href="#3-2-3-ä¸»æœºä¸è®¾å¤‡ä¹‹é—´æ•°æ®çš„ä¼ é€’" class="headerlink" title="3.2.3 ä¸»æœºä¸è®¾å¤‡ä¹‹é—´æ•°æ®çš„ä¼ é€’"></a>3.2.3 ä¸»æœºä¸è®¾å¤‡ä¹‹é—´æ•°æ®çš„ä¼ é€’</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token class-name">cudaError_t</span> <span class="token function">cudaMemcpy</span>
<span class="token punctuation">(</span>
	<span class="token keyword">void</span> <span class="token operator">*</span>dst<span class="token punctuation">,</span>               <span class="token comment">// ç›®æ ‡åœ°å€</span>
	<span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>src<span class="token punctuation">,</span>         <span class="token comment">// æºåœ°å€</span>
	<span class="token class-name">size_t</span> count<span class="token punctuation">,</span>            <span class="token comment">// å¤åˆ¶æ•°æ®çš„å­—èŠ‚æ•°</span>
	<span class="token keyword">enum</span> <span class="token class-name">cudaMemcpyKind</span> kind <span class="token comment">// æ ‡å¿—æ•°æ®ä¼ é€’æ–¹å‘</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>cudaMemcpy + <code>Host</code>/<code>Device</code> + To + <code>Device</code>/<code>Host</code><br>æˆ–è€…<code>cudaMemcpyDefault</code></p>
<h3 id="3-2-4-æ ¸å‡½æ•°ä¸­æ•°æ®ä¸çº¿ç¨‹çš„å¯¹åº”"><a href="#3-2-4-æ ¸å‡½æ•°ä¸­æ•°æ®ä¸çº¿ç¨‹çš„å¯¹åº”" class="headerlink" title="3.2.4 æ ¸å‡½æ•°ä¸­æ•°æ®ä¸çº¿ç¨‹çš„å¯¹åº”"></a>3.2.4 æ ¸å‡½æ•°ä¸­æ•°æ®ä¸çº¿ç¨‹çš„å¯¹åº”</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> __global__ <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">*</span>x<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">*</span>y<span class="token punctuation">,</span> <span class="token keyword">double</span><span class="token operator">*</span>z<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token keyword">int</span> n <span class="token operator">=</span> blockDim<span class="token punctuation">.</span>x <span class="token operator">*</span> blockIdx<span class="token punctuation">.</span>x <span class="token operator">+</span> threadIdx<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
    z<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">+</span> y<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä¸»æœºä¸­çš„addå‡½æ•°éœ€è¦å¾ªç¯ï¼Œè®¾å¤‡ä¸­çš„ä¸éœ€è¦ï¼Œåªéœ€è¦æ•°ç»„å…ƒç´ æŒ‡æ ‡ä¸çº¿ç¨‹æŒ‡æ ‡ä¸€ä¸€å¯¹åº”å³å¯ï¼Œåœ¨3.3<code>add1.cu</code>ä¸­å°±ç”¨äº†<code>const int n = blockDim.x * blockIdx.x + blockIdx.x</code>æ¥å®ç°å¯¹åº”å…³ç³»(è€Œä¸»æœºä¸­çš„éœ€è¦ç”¨<code>for(int n=0; n&lt;N; n++)</code>)</p>
<h3 id="3-2-6-æ ¸å‡½æ•°ä¸­ifè¯­å¥çš„å¿…è¦æ€§"><a href="#3-2-6-æ ¸å‡½æ•°ä¸­ifè¯­å¥çš„å¿…è¦æ€§" class="headerlink" title="3.2.6 æ ¸å‡½æ•°ä¸­ifè¯­å¥çš„å¿…è¦æ€§"></a>3.2.6 æ ¸å‡½æ•°ä¸­ifè¯­å¥çš„å¿…è¦æ€§</h3><p><code>N</code>ä¸ºæ•°ç»„å…ƒç´ ï¼Œ$grid_size=\dfrac{N}{block_size}$ï¼Œå¦‚æœæœ‰ä½™æ•°éœ€è¦+1ï¼Œæ­¤æ—¶çº¿ç¨‹æ•°ä¸º<code>N+block_size</code>ï¼Œå› ä¸º<code>grid_size</code>æ¯åŠ ä¸€ï¼Œå°±å¤šä¸€ä¸ª<code>block</code>ï¼Œæ¯ä¸€ä¸ª<code>block</code>æœ‰<code>block_size</code>ä¸ªçº¿ç¨‹ï¼Œæ‰€ä»¥æ­¤æ—¶çº¿ç¨‹æ•°ä¸º<code>N+block_size</code></p>
<table>
<thead>
<tr>
<th></th>
<th>åŸæœ¬</th>
<th>åæ¥</th>
</tr>
</thead>
<tbody><tr>
<td>N</td>
<td>$10^8$</td>
<td>$10^8+1$</td>
</tr>
<tr>
<td>block_size</td>
<td>128</td>
<td>128</td>
</tr>
<tr>
<td>grid_size</td>
<td>$\dfrac{10^8}{128}=781250$</td>
<td>$\dfrac{10^8}{128}+1=781251$</td>
</tr>
<tr>
<td>å®é™…çš„çº¿ç¨‹æ•°$n=block_size*grid_size$</td>
<td>$10^8$</td>
<td>$10^8+128$</td>
</tr>
<tr>
<td>å› æ­¤éœ€è¦åŠ ä¸Š<code>if(n&gt;=N) return;</code>ï¼Œå¦‚æœä¸åŠ ä¸Šè¿™å¥ï¼Œä¼šå‡ºç°éæ³•çš„è®¾å¤‡å†…å­˜æ“ä½œ</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h1 id="ç¬¬å››ç« -CUDAç¨‹åºçš„é”™è¯¯æ£€éªŒ"><a href="#ç¬¬å››ç« -CUDAç¨‹åºçš„é”™è¯¯æ£€éªŒ" class="headerlink" title="ç¬¬å››ç«  CUDAç¨‹åºçš„é”™è¯¯æ£€éªŒ"></a>ç¬¬å››ç«  CUDAç¨‹åºçš„é”™è¯¯æ£€éªŒ</h1><ul>
<li>åœ¨å®šä¹‰å®æ—¶ï¼Œå¦‚æœä¸€è¡Œå†™ä¸ä¸‹ï¼Œåˆ™éœ€è¦åœ¨æœ«å°¾å†™â€\"ï¼Œè¡¨ç¤ºç»­è¡Œ</li>
<li>ç”¨è‡ªå®šä¹‰çš„å®å‡½æ•°<code>CHECK</code>æ£€æŸ¥è¿è¡Œæ—¶API<img src="https://raw.githubusercontent.com/Wabbybabb0/Note/refs/heads/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240829162039.png?token=GHSAT0AAAAAAC7KAB5H3IZENVL3XO2O62LGZ6S66VA"></li>
<li>ç”¨ä»¥ä¸‹ä¸¤å¥æ£€æŸ¥æ ¸å‡½æ•°<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token function">CHECK</span><span class="token punctuation">(</span><span class="token function">cudaGetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// æ•æ‰ç¬¬äºŒä¸ªè¯­å¥ä¹‹å‰çš„æœ€åä¸€ä¸ªé”™è¯¯</span>
<span class="token function">CHECK</span><span class="token punctuation">(</span><span class="token function">cudaDeviceSynchronize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ•æ‰æ˜¯å¦æœ‰æ— æ³•åŒæ­¥ä¸»æœºä¸è®¾å¤‡çš„é”™è¯¯ã€‚å› ä¸ºæ ¸å‡½æ•°çš„è°ƒç”¨æ˜¯å¼‚æ­¥çš„ï¼Œå³ä¸»æœºå‘å‡ºè°ƒç”¨æ ¸å‡½æ•°çš„å‘½ä»¤åä¼šæ‰§è¡Œåé¢çš„è¯­å¥ï¼Œä¸ä¼šç­‰å¾…æ ¸å‡½æ•°</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
åªè¦åœ¨æ ¸å‡½æ•°çš„è°ƒç”¨ä¹‹å è¿˜æœ‰å…¶ä»–ä»»ä½•èƒ½<strong>è¿”å›é”™è¯¯å€¼çš„APIå‡½æ•°</strong>è¿›è¡ŒåŒæ­¥è°ƒç”¨ï¼Œéƒ½èƒ½è§¦å‘ä¸»æœºä¸è®¾å¤‡çš„åŒæ­¥å¹¶æ•æ‰åˆ°æ ¸å‡½æ•°è°ƒç”¨ä¸­å¯èƒ½å‘ç”Ÿçš„é”™è¯¯ã€‚</li>
</ul>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¦‚æœéœ€è¦è·å¾—å‡†ç¡®çš„å‡ºé”™ä½ç½®ï¼Œéœ€è¦æ˜¾å¼åŒæ­¥ã€‚ä¾‹å¦‚è°ƒç”¨<code>cudaDeviceSynchronize()</code>å‡½æ•°ï¼Œæˆ–è€…è®¾ç½®</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">$ export CUDA_LAUNCH_BLOCKING<span class="token operator">=</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è®¾ç½®å®Œæ¯•åï¼Œæ‰€æœ‰æ ¸å‡½æ•°çš„è°ƒç”¨éƒ½æ˜¯åŒæ­¥çš„ï¼Œä½†æ˜¯æœ€å¥½åªç”¨äºè°ƒè¯•ç¨‹åºï¼Œå› ä¸ºè¿™æ ·ä¼šå½±å“ç¨‹åºçš„æ€§èƒ½ã€‚</p>
<p>â“è¿™ä¸ª<code>cuda-memcheck</code>æ²¡ç»™æˆ‘checkå‡ºæ¥é”™è¯¯<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240829164737.png?token=GHSAT0AAAAAAC7KAB5GH4FCVEGI7V7P7STWZ6S667A"></p>
<h1 id="ç¬¬äº”ç« -è·å¾—GPUåŠ é€Ÿçš„å…³é”®"><a href="#ç¬¬äº”ç« -è·å¾—GPUåŠ é€Ÿçš„å…³é”®" class="headerlink" title="ç¬¬äº”ç«  è·å¾—GPUåŠ é€Ÿçš„å…³é”®"></a>ç¬¬äº”ç«  è·å¾—GPUåŠ é€Ÿçš„å…³é”®</h1><h3 id="5-1-1-ä¸ºC-ç¨‹åºè®¡æ—¶"><a href="#5-1-1-ä¸ºC-ç¨‹åºè®¡æ—¶" class="headerlink" title="5.1.1 ä¸ºC++ç¨‹åºè®¡æ—¶"></a>5.1.1 ä¸ºC++ç¨‹åºè®¡æ—¶</h3><p>é€‰æ‹©æµ®ç‚¹æ•°ç²¾åº¦</p>
<ul>
<li>å•ç²¾åº¦æµ®ç‚¹æ•°çš„è¿è¡Œæ—¶é—´ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240829200351.png?token=GHSAT0AAAAAAC7KAB5H26M4WRTZZMZAXEL2Z6S67EQ" alt="å•ç²¾åº¦æµ®ç‚¹æ•°"></li>
<li>åŒç²¾åº¦æµ®ç‚¹æ•°çš„è¿è¡Œæ—¶é—´ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240829200445.png?token=GHSAT0AAAAAAC7KAB5GBY7HJCM4EHEFCXQEZ6S67SA" alt="åŒç²¾åº¦æµ®ç‚¹æ•°"></li>
</ul>
<h3 id="5-1-2-ä¸ºCUDAç¨‹åºè®¡æ—¶"><a href="#5-1-2-ä¸ºCUDAç¨‹åºè®¡æ—¶" class="headerlink" title="5.1.2 ä¸ºCUDAç¨‹åºè®¡æ—¶"></a>5.1.2 ä¸ºCUDAç¨‹åºè®¡æ—¶</h3><ol>
<li>ä»…æ ¸å‡½æ•°</li>
</ol>
<ul>
<li>å•ç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240829201703.png?token=GHSAT0AAAAAAC7KAB5G2HDQNH3HHSLEGJBYZ6S7AHQ"></li>
<li>åŒç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240829201718.png?token=GHSAT0AAAAAAC7KAB5HXLEABB5QR7J5SJTEZ6S7AOQ"></li>
</ul>
<ol start="2">
<li>æ ¸å‡½æ•°ä¸æ•°æ®å¤åˆ¶</li>
</ol>
<ul>
<li>å•ç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240829203507.png?token=GHSAT0AAAAAAC7KAB5HZBMGTQEL7T3BX7JCZ6S7ATA"></li>
<li>åŒç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240829203524.png?token=GHSAT0AAAAAAC7KAB5GPOYRFMCBITJO43MCZ6S7AYA"><br>å¯¹æ¯”æ˜¯å¦åŠ å…¥äº†æ•°æ®å¤åˆ¶çš„ç”¨æ—¶ï¼Œå¯ä»¥å‘ç°ï¼š</li>
<li>æ ¸å‡½æ•°çš„è¿è¡Œæ—¶é—´æ¯”æ•°æ®å¤åˆ¶æ—¶é—´è¦çŸ­çš„å¤šï¼Œçº¦å 2.5%</li>
<li>å¦‚æœä¸€ä¸ªç¨‹åºçš„ä»»åŠ¡ä»…ä»…å°†æ¥è‡ªä¸»æœºç«¯çš„ä¸¤ä¸ªæ•°ç»„ç›¸åŠ ï¼Œå†å°†ç»“æœä¼ åˆ°ä¸»æœºç«¯ï¼Œä½¿ç”¨GPUçš„è¯æ•ˆç‡æ›´åŠ ä½ä¸‹ï¼Œ(CUDAç¨‹åºç›¸è¾ƒäºC++ç¨‹åºæ€§èƒ½é™ä½</li>
</ul>
<p>å…³äº<code>nvprof</code><br>æ˜¯ä¸€ä¸ªå¯ç”¨äºå¯¹CUDAç¨‹åºè¿›è¡Œæ›´å¤šæ€§èƒ½å‰–æçš„CUDAå·¥å…·ç®±é‡Œçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¦‚æœè®¾å¤‡è®¡ç®—èƒ½åŠ›å¤§äº8.0ä¸å¯ç”¨ï¼Œè¾“å…¥<code>nsys nvprof</code>å¯ç”¨<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240829205829.png?token=GHSAT0AAAAAAC7KAB5H34G6NITTJ7H2TDE4Z6S7A5Q"></p>
<ul>
<li>ç¬¬ä¸€åˆ—æ˜¯æ¯ç±»æ“ä½œ(ç¬¬ä¸ƒåˆ—Name)å ç”¨æ—¶é—´ç™¾åˆ†æ¯”</li>
<li>ç¬¬äºŒåˆ—æ—¶æ¯ç±»æ“ä½œæ‰€ç”¨çš„æ—¶é—´</li>
<li>ç¬¬ä¸‰åˆ—æ˜¯æ¯ç±»æ“ä½œè¢«è°ƒç”¨çš„æ¬¡æ•°</li>
<li>ç¬¬å››åˆ—æ˜¯æ¯ç±»æ“ä½œå•è¯è°ƒç”¨æ‰€ç”¨æ—¶é—´çš„å¹³å‡å€¼</li>
<li>ç¬¬äº”åˆ—å’Œç¬¬å…­åˆ—åˆ†åˆ«æ˜¯æ¯ç±»æ“ä½œå•æ¬¡è°ƒç”¨æ‰€ç”¨æ—¶é—´çš„æœ€å°å€¼å’Œæœ€å¤§å€¼</li>
</ul>
<h3 id="5-2-1-æ•°æ®ä¼ è¾“çš„æ¯”ä¾‹"><a href="#5-2-1-æ•°æ®ä¼ è¾“çš„æ¯”ä¾‹" class="headerlink" title="5.2.1 æ•°æ®ä¼ è¾“çš„æ¯”ä¾‹"></a>5.2.1 æ•°æ®ä¼ è¾“çš„æ¯”ä¾‹</h3><p>é¿å…è¿‡å¤šçš„æ•°æ®ç»ç”±(è¿æ¥GPUå’ŒCPU)PCIeä¼ é€’ï¼Œå¿…é¡»å°½é‡ç¼©å‡æ•°æ®ä¼ è¾“æ‰€èŠ±æ—¶é—´çš„æ¯”ä¾‹(æ•°æ®åœ¨GPUå’ŒCPUä¸Šä¼ è¾“çš„æ—¶é—´æ¯”è®¡ç®—æœ¬èº«è¦å¤šçš„è¯å°±å¾—ä¸å¿å¤±äº†)ã€‚ç†è®ºä¸ŠGPUçš„æ˜¾å­˜å¸¦å®½ä¸ºå‡ ç™¾å…†å­—èŠ‚ï¼Œå¸¸ç”¨çš„PCIeä»…æœ‰16GB/sçš„å¸¦å®½ã€‚</p>
<p><code>nvcc -O3</code>ä¸­çš„<code>-O3</code>æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨å°½å¯èƒ½å¤šåœ°è¿›è¡Œä¼˜åŒ–</p>
<h3 id="5-2-2-ç®—æ•°å¼ºåº¦"><a href="#5-2-2-ç®—æ•°å¼ºåº¦" class="headerlink" title="5.2.2 ç®—æ•°å¼ºåº¦"></a>5.2.2 ç®—æ•°å¼ºåº¦</h3><p>è¿›è¡Œè¾ƒå¤æ‚çš„æµ®ç‚¹è¿ç®—ï¼Œå¯èƒ½ä¼šå¾—åˆ°æ›´é«˜çš„åŠ é€Ÿæ¯”ï¼Œäºæ˜¯å°†ä¹‹å‰çš„æ•°ç»„ç›¸åŠ å‡½æ•°è¿›è¡Œæ›´æ”¹ä¸ºğŸ‘‡</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">arithmetic</span><span class="token punctuation">(</span>real <span class="token operator">*</span>x<span class="token punctuation">,</span> <span class="token keyword">const</span> real x0<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> n<span class="token operator">&lt;</span>N<span class="token punctuation">;</span> <span class="token operator">++</span>n<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        real x_tmp <span class="token operator">=</span> x<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">sqrt</span><span class="token punctuation">(</span>x_tmp<span class="token punctuation">)</span> <span class="token operator">&lt;</span> x0<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token operator">++</span>x_tmp<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        x<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> x_tmp<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol>
<li>CPU</li>
</ol>
<ul>
<li>å•ç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240830164803.png?token=GHSAT0AAAAAAC7KAB5GYBQCWGMOWIBUNPXKZ6S7CCQ"></li>
<li>åŒç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240830164907.png?token=GHSAT0AAAAAAC7KAB5GKKY532SLQZNF5NCWZ6S7CHQ"></li>
</ul>
<ol start="2">
<li>GPU<br>åŸæœ¬æ‰§è¡Œç¨‹åºæ˜¯<code>.\arithmetic2gpu</code>ï¼Œå› ä¸ºæœ‰<code>const int N = atoi(argv[1]);</code>ï¼Œæ‰€ä»¥å˜æˆ<code>.\arithmetic2gpu N</code>ï¼ŒNå¯ä»¥æ˜¯ä»»ä½•æ•°å­—ï¼Œåœ¨å‘½ä»¤è¡Œä¸­æ‰‹åŠ¨è¾“å…¥ï¼Œå°†ä¼šè¢«è¯»å–åˆ°ç¨‹åºä¸­çš„N</li>
</ol>
<ul>
<li>å•ç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240830210914.png?token=GHSAT0AAAAAAC7KAB5HMPA6RZ7GX5FJTX66Z6S7C4Q"></li>
<li>åŒç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240830211004.png?token=GHSAT0AAAAAAC7KAB5GPK2XS7SF7EGI6B5EZ6S7DEQ"></li>
</ul>
<h3 id="5-2-3-å¹¶è¡Œè§„æ¨¡"><a href="#5-2-3-å¹¶è¡Œè§„æ¨¡" class="headerlink" title="5.2.3 å¹¶è¡Œè§„æ¨¡"></a>5.2.3 å¹¶è¡Œè§„æ¨¡</h3><p>å¹¶è¡Œè§„æ¨¡å¯ç”¨GPUä¸­æ€»çš„çº¿ç¨‹æ•°ç›®æ¥è¡¡é‡<br>å°ç»“ï¼š</p>
<ul>
<li>æ•°æ®ä¼ è¾“æ¯”ä¾‹å°â€”â€”å‡å°‘ä¸»æœºä¸è®¾å¤‡ä¹‹é—´çš„æ•°æ®ä¼ è¾“</li>
<li>æ ¸å‡½æ•°çš„ç®—æœ¯å¼ºåº¦è¾ƒé«˜â€”â€”æé«˜æ ¸å‡½æ•°çš„ç®—æœ¯å¼ºåº¦</li>
<li>æ ¸å‡½æ•°ä¸­å®šä¹‰çš„çº¿ç¨‹æ•°ç›®è¾ƒå¤šâ€”â€”å¢å¤§æ ¸å‡½æ•°çš„å¹¶è¡Œè§„æ¨¡</li>
</ul>
<h1 id="ç¬¬å…­ç« -CPUçš„ç»„ç»‡å†…å­˜"><a href="#ç¬¬å…­ç« -CPUçš„ç»„ç»‡å†…å­˜" class="headerlink" title="ç¬¬å…­ç«  CPUçš„ç»„ç»‡å†…å­˜"></a>ç¬¬å…­ç«  CPUçš„ç»„ç»‡å†…å­˜</h1><h3 id="6-2-1-å…¨å±€å†…å­˜"><a href="#6-2-1-å…¨å±€å†…å­˜" class="headerlink" title="6.2.1 å…¨å±€å†…å­˜"></a>6.2.1 å…¨å±€å†…å­˜</h3><ol>
<li><p>åœ¨æ ¸å‡½æ•°ä¸­ï¼Œå¯ç›´æ¥å¯¹é™æ€å…¨å±€å†…å­˜å˜é‡è¿›è¡Œè®¿é—®ï¼Œå¹¶ä¸éœ€è¦å°†å®ƒä»¬ä»¥å‚æ•°çš„å½¢å¼ä¼ ç»™æ ¸å‡½æ•°ï¼Œå³ï¼š<br>ç›´æ¥è®¿é—®é™æ€å…¨å±€å†…æ‘å˜é‡(d_xå’Œd_y[])ğŸ‘‡</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">__device__ <span class="token keyword">int</span> d_x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
__device__ <span class="token keyword">int</span> d_y<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

__global__ <span class="token keyword">void</span> <span class="token function">my_kernel</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    d_y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+=</span> d_x<span class="token punctuation">;</span> <span class="token comment">// ç›´æ¥è®¿é—®</span>
    d_y<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+=</span> d_x<span class="token punctuation">;</span> <span class="token comment">// ç›´æ¥è®¿é—®</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"d_x = %d\t d_y[0] = %d\t d_y[1] = %d\n"</span><span class="token punctuation">,</span> d_x<span class="token punctuation">,</span> d_y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> d_y<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    my_kernel<span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ— éœ€ä¼ å‚</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>(d_dataå’Œvalue)ä½œä¸ºå‚æ•°ä¼ ç»™æ ¸å‡½æ•°</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">__global__ <span class="token keyword">void</span> <span class="token function">myKernel</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>data<span class="token punctuation">,</span> <span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> idx <span class="token operator">=</span> threadIdx<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
    data<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> <span class="token operator">*</span>d_data<span class="token punctuation">;</span>
    <span class="token keyword">int</span> value <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token function">cudaMalloc</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>d_data<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token operator">*</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>
    myKernel<span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span><span class="token number">1</span><span class="token punctuation">,</span> N<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>d_data<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// éœ€è¦ä¼ å‚(d_dataå’Œvalue)</span>
    <span class="token function">cudaFree</span><span class="token punctuation">(</span>d_data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>ä¸å¯åœ¨ä¸»æœºå‡½æ•°ä¸­ç›´æ¥è®¿é—®é™æ€å…¨å±€å†…å­˜å˜é‡ï¼Œä½†å¯ä»¥ç”¨<code>cudaMemcpyToSymbol()</code>å’Œ<code>cudaMemcpyFromSymbol()</code>å‡½æ•°åœ¨é™æ€å…¨å±€å†…å­˜ä¸ä¸»æœºå†…å­˜ä¹‹é—´ä¼ è¾“æ•°æ®ï¼Œè¿™ä¸¤ä¸ªCUDAè¿è¡Œæ—¶APIå‡½æ•°å¦‚ä¸‹(symbolæŒ‡çš„æ˜¯é™æ€å…¨å±€å†…å­˜å˜é‡)</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token class-name">cudaError_t</span> <span class="token function">cudaMemcpyToSymbol</span>
<span class="token punctuation">(</span>
	<span class="token keyword">const</span> <span class="token keyword">void</span><span class="token operator">*</span> symbol<span class="token punctuation">,</span> <span class="token comment">// é™æ€å…¨å±€å†…å­˜å˜é‡å</span>
	<span class="token keyword">const</span> <span class="token keyword">void</span><span class="token operator">*</span> src<span class="token punctuation">,</span>    <span class="token comment">// ä¸»æœºå†…å­˜ç¼“å†²åŒºæŒ‡é’ˆ</span>
	<span class="token class-name">size_t</span> count<span class="token punctuation">,</span>       <span class="token comment">// å¤åˆ¶çš„å­—èŠ‚æ•°</span>
	<span class="token class-name">size_t</span> offset <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token comment">// ä»symbolå¯¹åº”è®¾å¤‡åœ°å€å¼€å§‹åç§»çš„å­—èŠ‚æ•°</span>
	cudaMemcpyKind kind <span class="token operator">=</span> cudaMemcpyHostToDevice <span class="token comment">// å¯é€‰å‚æ•°</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">cudaError_t</span> <span class="token function">cudaMemcpyFromSymbol</span>
<span class="token punctuation">(</span>
	<span class="token keyword">void</span> <span class="token operator">*</span>dst<span class="token punctuation">,</span>          <span class="token comment">// ä¸»æœºå†…å­˜ç¼“å†²åŒºæŒ‡é’ˆ</span>
	<span class="token keyword">const</span> <span class="token keyword">void</span><span class="token operator">*</span> symbol<span class="token punctuation">,</span> <span class="token comment">// é™æ€å…¨å±€å†…å­˜å˜é‡</span>
	<span class="token class-name">size_t</span> count<span class="token punctuation">,</span>       <span class="token comment">// å¤åˆ¶çš„å­—èŠ‚æ•°</span>
	<span class="token class-name">size_t</span> offset <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token comment">// ä»symbolå¯¹åº”è®¾å¤‡åœ°å€å¼€å§‹åç§»çš„å­—èŠ‚æ•°</span>
	cudaMemcpyKind kind <span class="token operator">=</span> cudaMemcpyDeviceToHost <span class="token comment">// å¯é€‰å‚æ•°</span>
<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>ç‰¹ç‚¹</p>
</li>
</ol>
<ul>
<li>æ‰€æœ‰çº¿ç¨‹éƒ½èƒ½è®¿é—®ï¼Œå…¨å±€å†…å­˜å¯¹æ•´ä¸ªç½‘æ ¼çš„æ‰€æœ‰çº¿ç¨‹å¯è§</li>
<li>æ²¡æœ‰æ”¾åœ¨GPUèŠ¯ç‰‡ä¸Šï¼Œå…·æœ‰è¾ƒé«˜å»¶è¿Ÿå’Œè¾ƒä½çš„è®¿é—®é€Ÿåº¦ï¼›æ˜¯æ‰€æœ‰è®¾å¤‡ä¸­å†…å­˜æœ€å¤§çš„ï¼Œå®¹é‡åŸºæœ¬ä¸Šå°±æ˜¯æ˜¾å­˜å®¹é‡</li>
<li>å¯è¯»å¯å†™</li>
<li>ç”Ÿå‘½å‘¨æœŸï¼šä»ä¸»æœºç«¯ç”¨<code>cudaMalloc()</code>å¯¹ä»–ä»¬åˆ†é…å¼€å§‹ï¼Œåˆ°ä¸»æœºç«¯ç”¨<code>cudaFree()</code>é‡Šæ”¾ä»–ä»¬çš„å†…å­˜ç»“æŸ</li>
</ul>
<h3 id="6-2-2-å¸¸é‡å†…å­˜"><a href="#6-2-2-å¸¸é‡å†…å­˜" class="headerlink" title="6.2.2 å¸¸é‡å†…å­˜"></a>6.2.2 å¸¸é‡å†…å­˜</h3><ul>
<li>æ˜¯æœ‰å¸¸é‡ç¼“å­˜çš„å…¨å±€å†…å­˜ï¼Œä»…æœ‰64KB</li>
<li>å¯è¯»ä¸å¯å†™</li>
<li>(å› ä¸ºæœ‰ç¼“å­˜)è®¿é—®é€Ÿåº¦æ¯”å…¨å±€å†…å­˜é«˜ï¼Œé€Ÿåº¦é«˜çš„å‰ææ˜¯ä¸€ä¸ªçº¿ç¨‹æŸä¸­çš„çº¿ç¨‹(ä¸€ä¸ªçº¿ç¨‹å—ä¸­ç›¸é‚»çš„32ä¸ªçº¿ç¨‹)è¦è¯»å–ç›¸åŒçš„å¸¸é‡å†…å­˜æ•°æ®</li>
<li>ä½¿ç”¨ä¾‹å­ï¼šç”¨<code>__constant__</code>å®šä¹‰å˜é‡ã€<code>const int N</code>(è¿™æ˜¯åœ¨ä¸»æœºç«¯å®šä¹‰çš„å˜é‡ï¼Œé€šè¿‡ä¼ å€¼çš„æ–¹å¼ä¼ é€ç»™æ ¸å‡½æ•°ä¸­çš„çº¿ç¨‹ä½¿ç”¨)ï¼Œæ ¸å‡½æ•°å¯¹å¸¸é‡å†…å­˜çš„è®¿é—®æ¯”å¯¹å…¨å±€å†…å­˜çš„è®¿é—®è¦å¿«</li>
<li>ç»™æ ¸å‡½æ•°ä¼ é€’çš„å‚æ•°å­˜æ”¾åœ¨å¸¸é‡å†…å­˜ä¸­ï¼Œæœ€å¤šåªèƒ½ç”¨4KBå¸¸é‡å†…å­˜</li>
</ul>
<h3 id="6-2-4-å¯„å­˜å™¨"><a href="#6-2-4-å¯„å­˜å™¨" class="headerlink" title="6.2.4 å¯„å­˜å™¨"></a>6.2.4 å¯„å­˜å™¨</h3><p>æ ¸å‡½æ•°ä¸­å®šä¹‰çš„ä¸”å­˜æ”¾åœ¨å¯„å­˜å™¨çš„æœ‰ï¼š</p>
<ul>
<li>ä¸åŠ ä»»ä½•é™å®šç¬¦çš„å˜é‡</li>
<li>ä¸åŠ ä»»ä½•é™å®šç¬¦çš„æ•°ç»„(ä¹Ÿæœ‰å¯èƒ½åœ¨å±€éƒ¨å†…å­˜ä¸­)</li>
<li>å†…å»ºå˜é‡(å¦‚<code>gridDim</code>ã€<code>blockDim</code>ã€<code>blockIdx</code>ã€<code>threadIdx</code>ã€<code>warpSize</code>ç­‰ç­‰)<br>å¯„å­˜å™¨å¯è¯»å¯å†™ï¼š</li>
<li>å†™å…¥ï¼š<code>const int n = blockDim.x * blockIdx.x + threadIdx.x</code>ä¸­çš„<code>n</code>å°±æ˜¯ä¸€ä¸ªå¯„å­˜å™¨å˜é‡</li>
<li>è¯»å‡ºï¼š<code>z[n] = x[n] + y[n]</code><br>å¯„å­˜å™¨å˜é‡ä»…è¢«ä¸€ä¸ªçº¿ç¨‹å¯è§(ä»¥å¯è¯»å¯å†™å¤„ä»£ç ä¸ºä¾‹)ï¼š</li>
<li>æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªå˜é‡<code>n</code>çš„å‰¯æœ¬ï¼Œè™½ç„¶éƒ½æ˜¯åŒä¸€ä¸ªå˜é‡å<code>n</code>ï¼Œä½†æ˜¯ä¸åŒçº¿ç¨‹ä¸­è¯¥å¯„å­˜å™¨å˜é‡çš„å€¼å¯ä»¥ä¸åŒã€‚è€Œä¸”æ¯ä¸ªçº¿ç¨‹åªèƒ½å¯¹å®ƒçš„å‰¯æœ¬è¿›è¡Œè¯»å†™</li>
<li>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨ä¸»æœºå‡½æ•°ä¸­éœ€è¦ç”¨åˆ°<code>for</code>å¾ªç¯å†™å…¥å’Œè¯»å‡º<code>n</code>(<code>for int n=0; n&lt;N; N++</code>å’Œ<code>z[n]=x[n]+y[n]</code>)ï¼Œè€Œæ ¸å‡½æ•°åªéœ€è¦<code>const int n = blockDim.x * blockIdx. + threadIdx.x</code>å³å¯å®šä½åˆ°ä¸åŒçš„<code>n</code>ï¼Œå› ä¸ºéƒ½æ˜¯å‰¯æœ¬</li>
</ul>
<h3 id="6-2-5-å±€éƒ¨å†…å­˜"><a href="#6-2-5-å±€éƒ¨å†…å­˜" class="headerlink" title="6.2.5 å±€éƒ¨å†…å­˜"></a>6.2.5 å±€éƒ¨å†…å­˜</h3><p>å¯„å­˜å™¨ä¸­æ”¾ä¸ä¸‹çš„å˜é‡ã€ç´¢å¼•å€¼ä¸èƒ½åœ¨ç¼–è¯‘æ—¶å°±ç¡®å®šçš„æ•°ç»„éƒ½æœ‰å¯èƒ½æ”¾åœ¨å±€éƒ¨å†…å­˜ä¸­</p>
<h3 id="6-2-6-å…±äº«å†…å­˜"><a href="#6-2-6-å…±äº«å†…å­˜" class="headerlink" title="6.2.6 å…±äº«å†…å­˜"></a>6.2.6 å…±äº«å†…å­˜</h3><ul>
<li>å’Œå¯„å­˜å™¨ç±»ä¼¼ï¼Œé€Ÿåº¦ä»…æ¬¡äºå¯„å­˜å™¨çš„è¯»å†™é€Ÿåº¦</li>
<li>å…±äº«å†…å­˜å¯¹æ•´ä¸ª<strong>çº¿ç¨‹å—</strong>å¯è§ï¼Œæ¯ä¸ªçº¿ç¨‹å—æ‹¥æœ‰ä¸€ä¸ªå…±äº«å†…å­˜å˜é‡çš„å‰¯æœ¬ï¼Œå…±äº«å†…å­˜å˜é‡çš„å€¼åœ¨ä¸åŒçš„çº¿ç¨‹å—ä¸­å¯ä»¥ä¸åŒã€‚ä¸€ä¸ªçº¿ç¨‹å—ä¸­çš„æ‰€æœ‰çº¿ç¨‹éƒ½å¯ä»¥è®¿é—®è¯¥çº¿ç¨‹å—çš„å…±äº«å˜é‡å‰¯æœ¬ï¼Œä½†æ˜¯ä¸èƒ½è®¿é—®å…¶ä»–çº¿ç¨‹å—çš„å…±äº«å†…å­˜å˜é‡å‰¯æœ¬</li>
<li>ä¸»è¦ä½œç”¨æ˜¯å‡å°‘å¯¹å…¨å±€å†…å­˜çš„è®¿é—®</li>
</ul>
<h2 id="6-4-ç”¨CUDAè¿è¡Œæ—¶APIå‡½æ•°æŸ¥è¯¢è®¾å¤‡"><a href="#6-4-ç”¨CUDAè¿è¡Œæ—¶APIå‡½æ•°æŸ¥è¯¢è®¾å¤‡" class="headerlink" title="6.4 ç”¨CUDAè¿è¡Œæ—¶APIå‡½æ•°æŸ¥è¯¢è®¾å¤‡"></a>6.4 ç”¨CUDAè¿è¡Œæ—¶APIå‡½æ•°æŸ¥è¯¢è®¾å¤‡</h2><p><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240831195051.png?token=GHSAT0AAAAAAC7KAB5GSKFQHXIVLET6DJIEZ6S7DOQ"></p>
<h1 id="ç¬¬ä¸ƒç« -å…¨å±€å†…å­˜çš„åˆç†ä½¿ç”¨"><a href="#ç¬¬ä¸ƒç« -å…¨å±€å†…å­˜çš„åˆç†ä½¿ç”¨" class="headerlink" title="ç¬¬ä¸ƒç«  å…¨å±€å†…å­˜çš„åˆç†ä½¿ç”¨"></a>ç¬¬ä¸ƒç«  å…¨å±€å†…å­˜çš„åˆç†ä½¿ç”¨</h1><h2 id="7-1-å…¨å±€å†…å­˜çš„åˆå¹¶ä¸éåˆå¹¶è®¿é—®"><a href="#7-1-å…¨å±€å†…å­˜çš„åˆå¹¶ä¸éåˆå¹¶è®¿é—®" class="headerlink" title="7.1 å…¨å±€å†…å­˜çš„åˆå¹¶ä¸éåˆå¹¶è®¿é—®"></a>7.1 å…¨å±€å†…å­˜çš„åˆå¹¶ä¸éåˆå¹¶è®¿é—®</h2><p>$åˆå¹¶åº¦=\dfrac{çº¿ç¨‹æŸè¯·æ±‚çš„å­—èŠ‚æ•°}{ç”±è¯¥è¯·æ±‚å¯¼è‡´çš„æ‰€æœ‰æ•°æ®ä¼ è¾“å¤„ç†çš„å­—èŠ‚æ•°}$<br><strong>æ•°æ®ä¼ è¾“å¯¹æ•°æ®åœ°å€çš„è¦æ±‚ï¼šåœ¨ä¸€æ¬¡æ•°æ®ä¼ è¾“ä¸­ï¼Œä»å…¨å±€å†…å­˜è½¬ç§»åˆ°L2ç¼“å­˜çš„ä¸€ç‰‡å†…å­˜é¦–åœ°å€ä¸€å®šæ˜¯ä¸€ä¸ªæœ€å°é¢—ç²’åº¦(æœ¬ä¾‹æ˜¯32)çš„æ•´æ•°å€ã€‚</strong></p>
<ol>
<li>é¡ºåºçš„åˆå¹¶è®¿é—®<pre class="line-numbers language-c" data-language="c"><code class="language-c">__global__ <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">float</span> <span class="token operator">*</span>x<span class="token punctuation">,</span> <span class="token keyword">float</span> <span class="token operator">*</span>y<span class="token punctuation">,</span> <span class="token keyword">float</span> <span class="token operator">*</span>z<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> n <span class="token operator">=</span> threadIdx<span class="token punctuation">.</span>x <span class="token operator">+</span> blockIdx<span class="token punctuation">.</span>x <span class="token operator">*</span> blcokDim<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
    z<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">+</span> y<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<ul>
<li>ç¬¬ä¸€ä¸ªçº¿ç¨‹å—(blockIdx.x=0)ä¸­çš„çº¿ç¨‹æŸå°†è®¿é—®æ•°ç»„<code>x</code>ä¸­ç¬¬0~31ä¸ªå…ƒç´ (æ¯ä¸ªå…ƒç´ ç±»å‹ä¸ºfloatï¼Œå å››ä¸ªå­—èŠ‚)ï¼Œåˆ™å¯¹åº”32Ã—4=128å­—èŠ‚çš„è¿ç»­å†…å­˜</li>
<li>é¦–åœ°å€ä¸€å®šæ˜¯256å­—èŠ‚çš„æ•´æ•°å€(ä½¿ç”¨CUDAè¿è¡Œæ—¶APIå¦‚<code>cudaMalloc</code>åˆ†é…çš„å†…å­˜çš„é¦–åœ°å€è‡³å°‘æ˜¯256å­—èŠ‚çš„æ•´æ•°å€)</li>
<li>è¿™æ ·åªéœ€è¦è®¿é—®4æ¬¡æ•°æ®ä¼ è¾“å³å¯å®Œæˆ(è¦æ±‚ï¼šä¸€æ¬¡æ•°æ®ä¼ è¾“åªèƒ½ä»å…¨å±€å†…å­˜è¯»å–åœ°å€ä¸º0<del>31å­—èŠ‚ã€32</del>63å­—èŠ‚ç­‰ç‰‡æ®µçš„æ•°æ®ã€‚å¦‚æœçº¿ç¨‹æŸè¯·æ±‚çš„å…¨å±€å†…å­˜æ•°æ®çš„åœ°å€åˆšå¥½ä¸º0<del>127å­—èŠ‚æˆ–è€…128</del>256å­—èŠ‚ï¼Œå°±èƒ½ä¸<strong>4æ¬¡æ•°æ®ä¼ è¾“</strong>(0<del>31ã€32</del>63ã€64<del>95ã€96</del>127å››æ¬¡)æ‰€å¤„ç†çš„æ•°æ®å®Œå…¨å»åˆ)</li>
<li>åˆå¹¶åº¦ä¸º100%</li>
</ul>
<ol start="2">
<li>ä¹±åºçš„åˆå¹¶è®¿é—®<pre class="line-numbers language-c" data-language="c"><code class="language-c">__global__ <span class="token keyword">void</span> <span class="token function">add_permuted</span><span class="token punctuation">(</span><span class="token keyword">float</span> <span class="token operator">*</span>x<span class="token punctuation">,</span> <span class="token keyword">float</span> <span class="token operator">*</span>y<span class="token punctuation">,</span> <span class="token keyword">float</span> <span class="token operator">*</span>z<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> tid_permuted <span class="token operator">=</span> threadIdx<span class="token punctuation">.</span>x <span class="token operator">^</span> <span class="token number">0x1</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> n <span class="token operator">=</span> tid_permuted <span class="token operator">+</span> blockIdx<span class="token punctuation">.</span>x <span class="token operator">*</span> blcokDim<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
    z<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">+</span> y<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<ul>
<li><code>threadIdx.x ^ 0x1</code>å¼‚æˆ–ï¼Œå°†<code>threadIdx.x</code>æœ€åä¸€ä½ç¿»è½¬</li>
<li>ä»…æŠŠçº¿ç¨‹å—ä¸­å¥‡å¶æ¬¡åºè°ƒè½¬ã€‚å¦‚ç¬¬ä¸€ä¸ªçº¿ç¨‹å—ä¸­ï¼ŒåŸæœ¬nçš„é¡ºåºä¸º0ã€1ã€2ã€3â€¦ã€‚å˜ä¸º1ã€0ã€3ã€2â€¦ï¼Œå³åªä¸è¿‡çº¿ç¨‹å·ä¸æ•°ç»„å…ƒç´ æŒ‡æ ‡ä¸å®Œå…¨ä¸€è‡´</li>
<li>åˆå¹¶åº¦ä¸º100%</li>
</ul>
<ol start="3">
<li>ä¸å¯¹é½çš„éåˆå¹¶è®¿é—®<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> __global__ <span class="token function">add_offset</span><span class="token punctuation">(</span><span class="token keyword">float</span> <span class="token operator">*</span>x<span class="token punctuation">,</span> <span class="token keyword">float</span> <span class="token operator">*</span>y<span class="token punctuation">,</span> <span class="token keyword">float</span> <span class="token operator">*</span>z<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> threadIdx<span class="token punctuation">.</span>x <span class="token operator">+</span> blockIdx<span class="token punctuation">.</span>x <span class="token operator">*</span> blcokDim<span class="token punctuation">.</span>x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    z<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">+</span> y<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
add_permuted<span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<ul>
<li>ä»¥ç¬¬ä¸€ä¸ªçº¿ç¨‹å—ä¸ºä¾‹ï¼Œç¬¬ä¸€ä¸ªçº¿ç¨‹å—ä¸­çš„çº¿ç¨‹æŸå°†è®¿é—®æ•°ç»„xä¸­ç¬¬1~32ä¸ªå…ƒç´ ã€‚</li>
<li>å‡å¦‚æ•°ç»„xçš„é¦–åœ°å€ä¸º256ï¼Œé‚£ä¹ˆ<code>x[0]</code>ä¸º256<del>259ï¼Œ<code>x[1]</code>ä¸º260</del>263ï¼Œ<code>x[32]</code>ä¸º382~387</li>
<li>è¿™å°†è§¦å‘5æ¬¡æ•°æ®ä¼ è¾“ï¼Œå¯¹åº”çš„å†…å­˜åœ°å€ä¸º256<del>287å­—èŠ‚ã€288</del>319å­—èŠ‚ã€320<del>351å­—èŠ‚ã€352</del>383å­—èŠ‚å’Œ384~415å­—èŠ‚</li>
<li>åˆå¹¶åº¦ä¸º$\dfrac{4}{5}Ã—100=80%$</li>
</ul>
<ol start="4">
<li>è·¨è¶Šå¼çš„éåˆå¹¶è®¿é—®<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> __global__ <span class="token function">add_stride</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token operator">*</span> x<span class="token punctuation">,</span> <span class="token keyword">float</span><span class="token operator">*</span> y<span class="token punctuation">,</span> <span class="token keyword">float</span><span class="token operator">*</span> z<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> blockIdx<span class="token punctuation">.</span>x <span class="token operator">+</span> threadIdx<span class="token punctuation">.</span>x <span class="token operator">*</span> gridDim<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
    z<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">+</span> y<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
add_stride<span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<ul>
<li>ç¬¬ä¸€ä¸ªçº¿ç¨‹å—ä¸­çš„çº¿ç¨‹æŸå°†è®¿é—®æ•°ç»„xä¸­æŒ‡æ ‡ä¸º<code>0 + threadIdx.x * gridDim.x=1*128ã€2*128ã€3*128...</code>çš„å…ƒç´ </li>
<li>æ¯ä¸€å¯¹æ•°æ®éƒ½ä¸åœ¨ä¸€ä¸ªè¿ç»­çš„32å­—èŠ‚çš„å†…å­˜ç‰‡æ®µï¼Œå› æ­¤è¯¥çº¿ç¨‹æŸçš„è®¿é—®å°†è§¦å‘32æ¬¡æ•°æ®ä¼ è¾“</li>
<li>åˆå¹¶åº¦ä¸º$\dfrac{4}{32}Ã—100%=12.5%$</li>
</ul>
<ol start="5">
<li>å¹¿æ’­å¼çš„éåˆå¹¶è®¿é—®<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> __global__ <span class="token function">add_broadcast</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token operator">*</span> x<span class="token punctuation">,</span> <span class="token keyword">float</span><span class="token operator">*</span> y<span class="token punctuation">,</span> <span class="token keyword">float</span><span class="token operator">*</span> z<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> blockIdx<span class="token punctuation">.</span>x <span class="token operator">+</span> threadIdx<span class="token punctuation">.</span>x <span class="token operator">*</span> gridDim<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
    z<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> y<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
add_stride<span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<ul>
<li>ç¬¬ä¸€ä¸ªçº¿ç¨‹å—ä¸­çš„çº¿ç¨‹æŸå°†ä¸€è‡´åœ°è®¿é—®æ•°ç»„xä¸­çš„ç¬¬0ä¸ªå…ƒç´ ã€‚è¿™å®é™…ä¸Šåªéœ€è¦ä¸€æ¬¡æ•°æ®ä¼ è¾“(å¤„ç†32å­—èŠ‚çš„æ•°æ®)ï¼Œä½†æ•´ä¸ªçº¿ç¨‹æŸéƒ½åœ¨è®¿é—®åŒä¸€ä¸ªå†…å­˜åœ°å€<code>x[0]</code>ï¼Œåªä½¿ç”¨äº†4å­—èŠ‚çš„æ•°æ®</li>
<li>åˆå¹¶åº¦ä¸º$\dfrac{4}{32}Ã—100%=12.5%$</li>
</ul>
<h2 id="7-2-ä¾‹å­ï¼šçŸ©é˜µè½¬ç½®"><a href="#7-2-ä¾‹å­ï¼šçŸ©é˜µè½¬ç½®" class="headerlink" title="7.2 ä¾‹å­ï¼šçŸ©é˜µè½¬ç½®"></a>7.2 ä¾‹å­ï¼šçŸ©é˜µè½¬ç½®</h2><p><code>transpose1()</code>ï¼šå¯¹çŸ©é˜µAä¸­æ•°æ®çš„è®¿é—®(è¯»å–)æ˜¯é¡ºåºçš„(/åˆå¹¶çš„)ï¼Œå¯¹çŸ©é˜µBä¸­æ•°æ®çš„è®¿é—®(å†™å…¥)ä¸æ˜¯é¡ºåºçš„(/éåˆå¹¶çš„)</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">if</span><span class="token punctuation">(</span>nx <span class="token operator">&lt;</span> N <span class="token operator">&amp;&amp;</span> ny <span class="token operator">&lt;</span> N<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        B<span class="token punctuation">[</span>nx <span class="token operator">*</span> N <span class="token operator">+</span> ny<span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>ny <span class="token operator">*</span> N <span class="token operator">+</span> nx<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240902095334.png?token=GHSAT0AAAAAAC7KAB5H3KCI2TTFITY3WHPGZ6S7H2A" alt="|277"><br><code>transpose2()</code>ï¼šå¯¹çŸ©é˜µAä¸­æ•°æ®çš„è®¿é—®(è¯»å–)ä¸æ˜¯é¡ºåºçš„(/éåˆå¹¶çš„)ï¼Œå¯¹çŸ©é˜µBä¸­æ•°æ®çš„è®¿é—®(å†™å…¥)æ˜¯é¡ºåºçš„(/åˆå¹¶çš„)</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">if</span><span class="token punctuation">(</span>nx <span class="token operator">&lt;</span> N <span class="token operator">&amp;&amp;</span> ny <span class="token operator">&lt;</span> N<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        B<span class="token punctuation">[</span>ny <span class="token operator">*</span> N <span class="token operator">+</span> nx<span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>nx <span class="token operator">*</span> N <span class="token operator">+</span> ny<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240902095353.png?token=GHSAT0AAAAAAC7KAB5HUXRGB7MXCDAAJ6W6Z6S7IAQ" alt="|277"><br>å¯ä»¥å‘ç°<code>transpose2()</code>çš„ç”¨æ—¶æ¯”<code>transpose1()</code>çš„æ›´ä¹…ï¼Ÿ<br>ä¹¦ä¸ŠåŸè¯ï¼š</p>
<ul>
<li>åœ¨ä¸èƒ½æ»¡è¶³è¯»å–å’Œå†™å…¥éƒ½æ˜¯åˆå¹¶çš„æƒ…å†µä¸‹ï¼Œä¸€èˆ¬æ¥è¯´åº”å½“å°½é‡åšåˆ°åˆå¹¶åœ°å†™å…¥</li>
<li>ä¹¦ä¸Šçš„ç»“æœæ˜¯2æ¯”1ç”¨æ—¶æ›´çŸ­ï¼Œå› ä¸ºç¼–è¯‘å™¨èƒ½å¤Ÿåˆ¤æ–­ä¸€ä¸ªå…¨å±€å†…å­˜å˜é‡<strong>åœ¨æ•´ä¸ªæ ¸å‡½æ•°çš„èŒƒå›´éƒ½åªå¯è¯»</strong>ï¼Œåˆ™ä¼šè‡ªåŠ¨ç”¨å‡½æ•°<code>__ldg()</code>è¯»å–å…¨å±€å†…å­˜ï¼Œä»è€Œå¯¹æ•°æ®çš„è¯»å–è¿›è¡Œ<strong>ç¼“å­˜</strong>ï¼Œç¼“è§£éåˆå¹¶è®¿é—®å¸¦æ¥çš„å½±å“ã€‚è€Œå¯¹äºå…¨å±€å†…å­˜çš„å†™å…¥åˆ™æ²¡æœ‰ç±»ä¼¼çš„å‡½æ•°å¯ç”¨<br>ğŸ‘‡ç”¨äº†åˆ«äººçš„ä»£ç å<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240902100134.png?token=GHSAT0AAAAAAC7KAB5G3FJET6P6CFFUGAZEZ6S7IQA"></li>
</ul>
<h1 id="ç¬¬å…«ç« -å…±äº«å†…å­˜çš„åˆç†ä½¿ç”¨"><a href="#ç¬¬å…«ç« -å…±äº«å†…å­˜çš„åˆç†ä½¿ç”¨" class="headerlink" title="ç¬¬å…«ç«  å…±äº«å†…å­˜çš„åˆç†ä½¿ç”¨"></a>ç¬¬å…«ç«  å…±äº«å†…å­˜çš„åˆç†ä½¿ç”¨</h1><h2 id="8-1-ä¾‹å­ï¼šæ•°ç»„å½’çº¦è®¡ç®—"><a href="#8-1-ä¾‹å­ï¼šæ•°ç»„å½’çº¦è®¡ç®—" class="headerlink" title="8.1 ä¾‹å­ï¼šæ•°ç»„å½’çº¦è®¡ç®—"></a>8.1 ä¾‹å­ï¼šæ•°ç»„å½’çº¦è®¡ç®—</h2><ul>
<li>C++å®ç°è®¡ç®—é•¿åº¦è¾ƒå¤§çš„ç´¯åŠ è®¡ç®—æ—¶ï¼Œä¼šå‡ºç°â€å¤§æ•°åƒå°æ•°â€œçš„ç°è±¡</li>
<li>CUDAå®ç°æ¯”C++å®ç°ä¸Šè¿°å†…å®¹æ—¶è¦ç¨³å¥å¾—å¤š<br>å•ç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240911215856.png?token=GHSAT0AAAAAAC7KAB5HPT5VHI7HFTLCIYISZ6S7IUA" alt="|325"><br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240911220431.png?token=GHSAT0AAAAAAC7KAB5GZLNKZ5FBSICAKXPYZ6S7IZQ" alt="325"><br>ä¸Šé¢ä¸¤ä¸ªå‡ºç°å¤§æ•°åƒå°æ•°çš„æƒ…å†µ</li>
</ul>
<table>
<thead>
<tr>
<th>ç²¾åº¦</th>
<th>reduce_global</th>
<th>reduce_shared</th>
<th>reduce_dynamic</th>
<th>ç»“æœ</th>
</tr>
</thead>
<tbody><tr>
<td>float</td>
<td>6~7ms</td>
<td>7~8ms</td>
<td>7~9ms</td>
<td>123633392.000000.</td>
</tr>
<tr>
<td>double</td>
<td>9~11ms</td>
<td>15~17ms</td>
<td>15~18ms</td>
<td>122999999.998770.</td>
</tr>
</tbody></table>
<p>å•ç²¾åº¦çš„ç»“æœæ²¡æœ‰é‚£ä¹ˆç¦»è°±ï¼Œä½†æ˜¯ç¦»æ­£ç¡®ç­”æ¡ˆè¿˜æœ‰ä¸€æ®µè·ç¦»</p>
<h3 id="8-1-1-ä»…ä½¿ç”¨å…¨å±€å†…å­˜"><a href="#8-1-1-ä»…ä½¿ç”¨å…¨å±€å†…å­˜" class="headerlink" title="8.1.1 ä»…ä½¿ç”¨å…¨å±€å†…å­˜"></a>8.1.1 ä»…ä½¿ç”¨å…¨å±€å†…å­˜</h3><ul>
<li>è®¿é—®é¢‘ç¹</li>
<li>ä½¿ç”¨æŠ˜åŠå½’çº¦æ³•</li>
<li>å‡è®¾æ ¸å‡½æ•°çš„ç½‘æ ¼å¤§å°å’Œçº¿ç¨‹å—å¤§å°çš„ä¹˜ç§¯ä¸º<code>N</code></li>
<li>å¯¹äºå¤šçº¿ç¨‹çš„ç¨‹åºï¼Œä¸¤ä¸ªä¸åŒçº¿ç¨‹ä¸­æŒ‡ä»¤çš„æ‰§è¡Œæ¬¡åºå¯èƒ½å’Œä»£ç ä¸­å±•ç°çš„æ¬¡åºä¸åŒ</li>
<li>ä¾‹(å¾ªç¯çš„å‰ä¸¤æ¬¡)ï¼š<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">// å¾ªç¯çš„ç¬¬ä¸€æ¬¡</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">&lt;</span> N<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>d_x<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">+=</span> d_x<span class="token punctuation">[</span>n <span class="token operator">+</span> N<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token comment">// åœ¨è¿™æ¬¡æ“ä½œä¸­å¯èƒ½ä¼šæœ‰å‘æ•°ç»„d_x[N/4]å†™å…¥æ•°æ®çš„æ“ä½œï¼›</span>
<span class="token comment">// å¾ªç¯çš„ç¬¬äºŒæ¬¡</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">&lt;</span> N<span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">{</span>d_x<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">+=</span> d_x<span class="token punctuation">[</span>n <span class="token operator">+</span> N<span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token comment">// æœ‰å¯èƒ½åœ¨çº¿ç¨‹n=0å¼€å§‹æ‰§è¡Œè¿™å¥æ—¶ï¼Œn=N/4è¿˜æ²¡æ‰§è¡Œå®Œä¸Šä¸€è¡Œ</span>
<span class="token punctuation">[</span><span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span>
 <span class="token number">5</span> <span class="token number">6</span> <span class="token number">7</span> <span class="token number">8</span><span class="token punctuation">]</span>
N <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> N<span class="token operator">/</span><span class="token number">2</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> ç¬¬ä¸€æ¬¡n<span class="token operator">=</span><span class="token number">0</span><span class="token operator">~</span><span class="token number">3</span><span class="token punctuation">,</span> d_x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+=</span> d<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> ç­‰ä»·äº d_x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span> <span class="token number">1</span><span class="token operator">+</span><span class="token number">5</span> <span class="token operator">=</span> <span class="token number">6</span>
<span class="token punctuation">[</span><span class="token number">6</span> <span class="token number">8</span> <span class="token number">10</span> <span class="token number">12</span><span class="token punctuation">]</span>
N<span class="token operator">/</span><span class="token number">4</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> ç¬¬äºŒæ¬¡n<span class="token operator">=</span><span class="token number">0</span><span class="token operator">~</span><span class="token number">1</span><span class="token punctuation">,</span> å¯èƒ½ä¼šå‡ºç°ä¸Šé¢è¿˜æ²¡åŠ å®Œï¼Œå°±æ‰§è¡Œè¿™é‡Œçš„æƒ…å†µ <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li>è§£å†³æ–¹æ³•ï¼šè¦ä¿è¯æ ¸å‡½æ•°ä¸­è¯­å¥çš„æ‰§è¡Œé¡ºåºä¸å‡ºç°é¡ºåºä¸€è‡´ï¼Œç”¨åŒæ­¥å‡½æ•°<code>__syncthreads()</code><ul>
<li>åªé’ˆå¯¹ä¸€ä¸ªçº¿ç¨‹å—ä¸­çš„çº¿ç¨‹(å³åªèƒ½å¤ŸåŒæ­¥å•ä¸ªçº¿ç¨‹å—ä¸­çš„çº¿ç¨‹)<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> __global__ <span class="token function">reduce_global</span><span class="token punctuation">(</span>real<span class="token operator">*</span> d_x<span class="token punctuation">,</span> real<span class="token operator">*</span> d_y<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span> tid <span class="token operator">=</span> threadIdx<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
	real<span class="token operator">*</span> x <span class="token operator">=</span> d_x <span class="token operator">+</span> blockDim<span class="token punctuation">.</span>x <span class="token operator">*</span> blockIdx<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
	<span class="token comment">// ä¸åŒçš„çº¿ç¨‹å—æŒ‡å‘å…¨å±€å†…å­˜ä¸­çš„ä¸åŒåœ°å€</span>
	<span class="token comment">// ä¸Šé¢ä¹Ÿå¯ä»¥å†™æˆ real* x = &amp;d_x[blockDim.x * blockIdx.x];</span>
	<span class="token comment">// d_xæ˜¯åŠ¨æ€æ•°ç»„ï¼Œæ•°ç»„åå°±æ˜¯æ•°ç»„é¦–åœ°å€</span>
	<span class="token comment">// å–d_x[blockDim.x + blockIdx.x]çš„åœ°å€ç­‰ä»·äºé¦–åœ°å€+åç§»é‡(bDimx.x+bIdx.x)</span>
	<span class="token comment">// å®šä¹‰çš„xåœ¨ä¸åŒçš„çº¿ç¨‹å—ä¸­æŒ‡å‘å…¨å±€å†…å­˜ä¸­çš„ä¸åŒåœ°å€ï¼</span>
	
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset <span class="token operator">=</span> blockDim<span class="token punctuation">.</span>x <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span> offset <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span> offset <span class="token operator">&gt;&gt;=</span> <span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>tid <span class="token operator">&lt;</span> offset<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			x<span class="token punctuation">[</span>tid<span class="token punctuation">]</span> <span class="token operator">+=</span> x<span class="token punctuation">[</span>tid<span class="token operator">+</span>offset<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token function">__syncthreads</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä¿è¯åŒä¸€ä¸ªçº¿ç¨‹å—å†…åœ°çº¿ç¨‹æŒ‰ç…§ä»£ç å‡ºç°åœ°é¡ºåºæ‰§è¡Œå‘½ä»¤</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// ä¸Šè¿°forå¾ªç¯ä¿è¯å„ä¸ªçº¿ç¨‹å—å†…å¯¹å…¶ä¸­çš„æ•°æ®ç‹¬ç«‹åœ°è¿›è¡Œå½’çº¦</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>tid <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		d_y<span class="token punctuation">[</span>blockIdx<span class="token punctuation">.</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">real<span class="token operator">*</span> x <span class="token operator">=</span> d_x <span class="token operator">+</span> blockDim<span class="token punctuation">.</span>x <span class="token operator">*</span> blockIdx<span class="token punctuation">.</span>x<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li>==xåœ¨ä¸åŒçš„çº¿ç¨‹å—ä¸­æŒ‡å‘å…¨å±€å†…å­˜ä¸­çš„ä¸åŒåœ°å€==ï¼Œå¯ä»¥ç†è§£ä¸ºä¸Šé¢æ¯ä¸€ä¸ªå°æ•°ç»„(ä¹¦ä¸Šçš„ä¾‹å­çš„å°æ•°ç»„é•¿åº¦ä¸º$10^8$)ä¸ºä¸€ä¸ª<code>d_x</code>ï¼Œä¸åŒçš„çº¿ç¨‹å—å¯¹<code>d_x</code>ä¸­ä¸åŒçš„éƒ¨åˆ†è¿›è¡Œå½’çº¦ï¼Œ(åŒä¸€ä¸ªçº¿ç¨‹å—ä¸­çš„çº¿ç¨‹çš„å¤„ç†é€Ÿåº¦ä¸ä¸€è‡´ï¼Ÿ</li>
<li>è¯¥æ ¸å‡½æ•°ä»…å°†ä¸€ä¸ªé•¿åº¦ä¸º$10^8$çš„æ•°ç»„<code>d_x</code>å½’çº¦åˆ°ä¸€ä¸ªé•¿åº¦ä¸º$\dfrac{10^8}{128}$çš„æ•°ç»„<code>d_y</code>(ä¹¦ä¸Šçš„æ“ä½œæ˜¯æŠŠ<code>d_y</code>ä»è®¾å¤‡å¤åˆ¶åˆ°ä¸»æœºé‡Œå¹¶åœ¨ä¸»æœºç»§ç»­å¯¹<code>d_y</code>è¿›è¡Œå½’çº¦å¾—åˆ°æœ€ç»ˆçš„ç»“æœï¼Œå®é™…ä¸Šè¿™æ ·ä¸æ˜¯å¾ˆé«˜æ•ˆ)</li>
<li>åˆ©ç”¨ä½æ“ä½œï¼Œå°†<code>blockDim.x/2</code>å’Œ<code>offset/=2</code>åˆ†åˆ«å†™æˆäº†<code>blockDim.x&gt;&gt;1</code>å’Œ<code>offset&gt;&gt;=1</code>ï¼Œåœ¨æ ¸å‡½æ•°ä¸­ï¼Œ<strong>ä½æ“ä½œæ¯”å¯¹åº”çš„æ•´æ•°æ“ä½œé«˜æ•ˆ</strong>ã€‚å½“æ‰€æ¶‰åŠçš„å˜é‡åœ¨ç¼–è¯‘æœŸé—´å°±çŸ¥é“å…¶å¯èƒ½çš„å–å€¼ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ç”¨ä¼ªæ“ä½œå–ä»£ç›¸åº”çš„æ•´æ•°æ“ä½œ</li>
</ul>
<h3 id="8-1-2-ä½¿ç”¨å…±äº«å†…å­˜"><a href="#8-1-2-ä½¿ç”¨å…±äº«å†…å­˜" class="headerlink" title="8.1.2 ä½¿ç”¨å…±äº«å†…å­˜"></a>8.1.2 ä½¿ç”¨å…±äº«å†…å­˜</h3><p>å…±äº«å†…å­˜çš„ä¸»è¦ä½œç”¨ï¼šâ‘ å‡å°‘æ ¸å‡½æ•°ä¸­å¯¹å…¨å±€å†…å­˜çš„è®¿é—®æ¬¡æ•°â‘¡æé«˜å…¨å±€è®¿é—®çš„åˆå¹¶åº¦<br>å…±äº«å†…å­˜çš„ç‰¹ç‚¹ï¼šå¯¹æ•´ä¸ªçº¿ç¨‹å—å¯è§ï¼Œæ¯ä¸ªçº¿ç¨‹å—éƒ½æœ‰ä¸€ä¸ªå…±äº«å†…å­˜å˜é‡çš„å‰¯æœ¬<br>å®šä¹‰å…±äº«å†…å­˜å˜é‡<code>__shared__</code></p>
<ul>
<li>åœ¨ä¸€ä¸ªæ ¸å‡½æ•°ä¸­å®šä¹‰ä¸€ä¸ªå…±äº«å†…å­˜å˜é‡ï¼Œå°±ç›¸å½“äºåœ¨<strong>æ¯ä¸ªçº¿ç¨‹å—ä¸­æœ‰ä¸€ä¸ªè¯¥å˜é‡çš„å‰¯æœ¬</strong>ï¼Œè™½ç„¶æ¯ä¸ªå‰¯æœ¬å…±ç”¨ä¸€ä¸ªå˜é‡åï¼Œä½†æ˜¯æ¯ä¸ªå‰¯æœ¬éƒ½ä¸ä¸€æ ·</li>
<li>æ ¸å‡½æ•°ä¸­ï¼Œå¯¹å…±äº«å†…å­˜å˜é‡çš„æ“ä½œéƒ½æ˜¯<strong>åŒæ—¶ä½œç”¨åœ¨æ‰€æœ‰çš„å‰¯æœ¬ä¸Š</strong>çš„<pre class="line-numbers language-c" data-language="c"><code class="language-c">__global__ <span class="token keyword">void</span> <span class="token function">reduce_shared</span><span class="token punctuation">(</span>real <span class="token operator">*</span>d_x<span class="token punctuation">,</span> real <span class="token operator">*</span>d_y<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span> tid <span class="token operator">=</span> threadIdx<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span> bid <span class="token operator">=</span> blockIdx<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span> n <span class="token operator">=</span> bid<span class="token operator">*</span>blockDimx<span class="token punctuation">.</span>x <span class="token operator">+</span> tid<span class="token punctuation">;</span>
	__shared__ real s_y<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// å…±äº«å†…å­˜çš„æ•°ç»„é•¿åº¦ä¸æ ¸å‡½æ•°çš„æ‰§è¡Œé…ç½®å‚æ•°blockDim.xä¸€æ ·ï¼Œå¦‚æœè¿™é‡Œå†™é”™äº†ï¼Œä¼šå¼•èµ·é”™è¯¯æˆ–é™ä½æ ¸å‡½æ•°æ€§èƒ½</span>
	s_y<span class="token punctuation">[</span>tid<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>n<span class="token operator">&lt;</span>N<span class="token punctuation">)</span> <span class="token operator">?</span> d_x<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">;</span> <span class="token comment">// å°†å…¨å±€å†…å­˜ä¸­çš„æ•°æ®å¤åˆ¶åˆ°å…±äº«å†…å­˜ä¸­</span>
	<span class="token function">__syncthreads</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset <span class="token operator">=</span> blockDim<span class="token punctuation">.</span>x <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>tid <span class="token operator">&lt;</span> offset<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			s_y<span class="token punctuation">[</span>tid<span class="token punctuation">]</span> <span class="token operator">+=</span> s_y<span class="token punctuation">[</span>tid <span class="token operator">+</span> offset<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token function">__syncthreads</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>tid<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		d_y<span class="token punctuation">[</span>tid<span class="token punctuation">]</span> <span class="token operator">=</span> s_y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/345a4268a6a5f1d9ad0e183fb311f40.jpg?token=GHSAT0AAAAAAC7KAB5GSKYJEHWEED76FAYAZ6S7JEQ"></li>
<li>ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨æ ¸å‡½æ•°ä¸­å¯¹å…±äº«å†…å­˜è®¿é—®çš„æ¬¡æ•°è¶Šå¤šï¼Œåˆ™ç”±äºä½¿ç”¨å…±äº«å†…å­˜å¸¦æ¥çš„åŠ é€Ÿæ•ˆæœè¶Šæ˜æ˜¾</li>
<li>å› ä¸ºæœ‰<code>n&lt;N</code>çš„åˆ¤æ–­ï¼Œè¯¥å‡½æ•°èƒ½å¤Ÿå¤„ç†<code>N</code>ä¸æ˜¯çº¿ç¨‹å—å¤§å°çš„æ•´æ•°å€çš„æƒ…å½¢</li>
</ul>
<h3 id="8-1-3-ä½¿ç”¨åŠ¨æ€å…±äº«å†…å­˜"><a href="#8-1-3-ä½¿ç”¨åŠ¨æ€å…±äº«å†…å­˜" class="headerlink" title="8.1.3 ä½¿ç”¨åŠ¨æ€å…±äº«å†…å­˜"></a>8.1.3 ä½¿ç”¨åŠ¨æ€å…±äº«å†…å­˜</h3><p>ä½¿ç”¨åŠ¨æ€å…±äº«å†…å­˜å¯ä»¥å‡å°‘8.1.2ä¸­â€œ<strong>å…±äº«å†…å­˜çš„æ•°ç»„é•¿åº¦</strong>ä¸æ ¸å‡½æ•°çš„æ‰§è¡Œé…ç½®å‚æ•°éœ€ä¸<strong>blockDim.x</strong>ä¸€æ ·ï¼Œå¦‚æœè¿™é‡Œå†™é”™äº†ï¼Œä¼šå¼•èµ·é”™è¯¯æˆ–é™ä½æ ¸å‡½æ•°æ€§èƒ½â€é”™è¯¯å‘ç”Ÿçš„æ¦‚ç‡</p>
<p>å°†é™æ€å†…å­˜æ”¹ä¸ºåŠ¨æ€å†…å­˜çš„ä¿®æ”¹ï¼š</p>
<ul>
<li><code>&lt;&lt;&lt;grid_size, block_size, sizeof(real) * block_size&gt;&gt;&gt;</code>ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°å°±æ˜¯æ ¸å‡½æ•°ä¸­æ¯ä¸ªçº¿ç¨‹å—éœ€è¦å®šä¹‰çš„åŠ¨æ€å…±äº«å†…å­˜çš„å­—èŠ‚æ•°</li>
<li>æ”¹å˜æ ¸å‡½æ•°ä¸­å…±äº«å†…å­˜å˜é‡çš„å£°æ˜æ–¹å¼<ul>
<li>é™æ€ï¼š<code>__shared__ real s_y[128];</code></li>
<li>åŠ¨æ€ï¼š`extern <strong>shared</strong> real s_y[];</li>
</ul>
</li>
</ul>
<p>å•ç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240919200305.png?token=GHSAT0AAAAAAC7KAB5HIPKTRBN2ZRGCNXNCZ6S7JIA" alt="|375"><br>åŒç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240919200331.png?token=GHSAT0AAAAAAC7KAB5H6Q6SU3SRL3UREQZ6Z6S7JOQ" alt="375"></p>
<h2 id="8-2-ä½¿ç”¨å…±äº«å†…å­˜è¿›è¡ŒçŸ©é˜µè½¬ç½®"><a href="#8-2-ä½¿ç”¨å…±äº«å†…å­˜è¿›è¡ŒçŸ©é˜µè½¬ç½®" class="headerlink" title="8.2 ä½¿ç”¨å…±äº«å†…å­˜è¿›è¡ŒçŸ©é˜µè½¬ç½®"></a>8.2 ä½¿ç”¨å…±äº«å†…å­˜è¿›è¡ŒçŸ©é˜µè½¬ç½®</h2><p>åˆ©ç”¨å…±äº«å†…å­˜å¯ä»¥æ”¹å–„å…¨å±€å†…å­˜çš„è®¿é—®æ¨¡å¼ï¼Œä½¿å¾—å¯¹å…¨å±€å†…å­˜çš„è¯»å’Œå†™éƒ½æ˜¯åˆå¹¶çš„</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">__gobal__ <span class="token keyword">void</span> <span class="token function">transpose1</span><span class="token punctuation">(</span><span class="token keyword">const</span> real <span class="token operator">*</span>A<span class="token punctuation">,</span> real <span class="token operator">*</span>B<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	__shared__ real S<span class="token punctuation">[</span>TILE_DIM<span class="token punctuation">]</span><span class="token punctuation">[</span>TILE_DIM<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// ç”¨ä¸€ä¸ªçº¿ç¨‹å—å¤„ç†ä¸€ç‰‡32x32çš„çŸ©é˜µ</span>
	<span class="token keyword">int</span> bx <span class="token operator">=</span> blockIdx<span class="token punctuation">.</span>x <span class="token operator">*</span> TILE_DIM<span class="token punctuation">;</span>
	<span class="token keyword">int</span> by <span class="token operator">=</span> blockIdx<span class="token punctuation">.</span>y <span class="token operator">*</span> TILE_DIM<span class="token punctuation">;</span>

	<span class="token keyword">int</span> nx1 <span class="token operator">=</span> bx <span class="token operator">+</span> threadIdx<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
	<span class="token keyword">int</span> ny1 <span class="token operator">=</span> by <span class="token operator">+</span> threadIdx<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>nx1 <span class="token operator">&lt;</span> N <span class="token operator">&amp;&amp;</span> ny1 <span class="token operator">&lt;</span> N<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		S<span class="token punctuation">[</span>threadIdx<span class="token punctuation">.</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>threadIdx<span class="token punctuation">.</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>ny1 <span class="token operator">*</span> N <span class="token operator">+</span> nx1<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// å› ä¸ºç›¸é‚»çš„threadIdx.xä¸å…¨å±€å†…å­˜ä¸­ç›¸é‚»çš„æ•°æ®å¯¹åº”ï¼Œæ‰€ä»¥è¿™é‡Œå¯¹å…¨å±€å†…å­˜çš„è®¿é—®æ˜¯åˆå¹¶çš„</span>
	<span class="token punctuation">}</span>
	<span class="token function">__syncthreads</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">int</span> nx2 <span class="token operator">=</span> bx <span class="token operator">+</span> threadIdx<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
	<span class="token keyword">int</span> ny2 <span class="token operator">=</span> by <span class="token operator">+</span> threadIdx<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>nx2 <span class="token operator">&lt;</span> N <span class="token operator">&amp;&amp;</span> ny2 <span class="token operator">&lt;</span> N<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		B<span class="token punctuation">[</span>nx2 <span class="token operator">*</span> N <span class="token operator">+</span> ny2<span class="token punctuation">]</span> <span class="token operator">=</span> S<span class="token punctuation">[</span>threadIdx<span class="token punctuation">.</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>threadIdx<span class="token punctuation">.</span>y<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸Šè¿°ä»£ç çš„èŠ‚é€‰éƒ¨åˆ†ğŸ‘‡</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> nx2 <span class="token operator">=</span> bx <span class="token operator">+</span> threadIdx<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
<span class="token keyword">int</span> ny2 <span class="token operator">=</span> by <span class="token operator">+</span> threadIdx<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
<span class="token comment">// ä¸Šé¢è¿™ä¸¤è¡Œæ”¹å˜äº†å¯¹å…¨å±€å†…å­˜çš„è®¿é—®æ–¹å¼</span>
<span class="token comment">// è¿™é‡Œçš„bxå’Œbyæ ¹æ®blockIdx.xå’ŒblockIdx.yçš„å˜åŒ–è€Œå˜åŒ–ã€‚å¯ä»¥è§†ä¸ºæŸä¸ªçº¿ç¨‹å—åœ¨å…¨å±€ä¸­çš„åç§»é‡</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>nx2 <span class="token operator">&lt;</span> N <span class="token operator">&amp;&amp;</span> ny2 <span class="token operator">&lt;</span> N<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	B<span class="token punctuation">[</span>nx2 <span class="token operator">*</span> N <span class="token operator">+</span> ny2<span class="token punctuation">]</span> <span class="token operator">=</span> S<span class="token punctuation">[</span>threadIdx<span class="token punctuation">.</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>threadIdx<span class="token punctuation">.</span>y<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// ç›¸é‚»çš„threadIdx.xä¸å…¨å±€å†…å­˜ä¸­çš„æ•°ç»„Bä¸­çš„ç›¸é‚»çš„æ•°æ®å¯¹åº”</span>
	<span class="token comment">//Bçš„ç›¸é‚»æ˜¯ny2ï¼Œny2åˆå’ŒthreadIdx.xä¸€è‡´ç›¸é‚»</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç¬¬ä¸ƒç« <code>transpose1()</code>ç›¸å…³éƒ¨åˆ†ğŸ‘‡</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">__global__ <span class="token keyword">void</span> <span class="token function">transpose1</span><span class="token punctuation">(</span><span class="token keyword">const</span> real<span class="token operator">*</span> A<span class="token punctuation">,</span> real<span class="token operator">*</span> B<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token keyword">int</span> nx <span class="token operator">=</span> blockIdx<span class="token punctuation">.</span>x <span class="token operator">*</span> blockDim<span class="token punctuation">.</span>x <span class="token operator">+</span> threadIdx<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token keyword">int</span> ny <span class="token operator">=</span> blockIdx<span class="token punctuation">.</span>y <span class="token operator">*</span> blockDim<span class="token punctuation">.</span>y <span class="token operator">+</span> threadIdx<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>nx <span class="token operator">&lt;</span> N <span class="token operator">&amp;&amp;</span> ny <span class="token operator">&lt;</span> N<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        B<span class="token punctuation">[</span>nx <span class="token operator">*</span> N <span class="token operator">+</span> ny<span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>ny <span class="token operator">*</span> N <span class="token operator">+</span> nx<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è·Ÿä¸Šé¢ä»£ç ä¸€æ ·çš„å†™æ³•ğŸ‘‡</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> nx2 <span class="token operator">=</span> bx <span class="token operator">+</span> threadIdx<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
<span class="token keyword">int</span> ny2 <span class="token operator">=</span> by <span class="token operator">+</span> threadIdx<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
<span class="token comment">// è¿™æ ·å­å®šä¹‰nx2å’Œny2çš„è¯å’Œä¸Šé¢å…¨å±€å†…å­˜çš„è®¿é—®æ–¹å¼ä¸€æ ·</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>nx2 <span class="token operator">&lt;</span> N <span class="token operator">&amp;&amp;</span> ny2 <span class="token operator">&lt;</span> N<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	B<span class="token punctuation">[</span>nx2 <span class="token operator">*</span> N <span class="token operator">+</span> ny2<span class="token punctuation">]</span> <span class="token operator">=</span> S<span class="token punctuation">[</span>threadIdx<span class="token punctuation">.</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>threadIdx<span class="token punctuation">.</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="8-3-é¿å…å…±äº«å†…å­˜çš„bankå†²çª"><a href="#8-3-é¿å…å…±äº«å†…å­˜çš„bankå†²çª" class="headerlink" title="8.3 é¿å…å…±äº«å†…å­˜çš„bankå†²çª"></a>8.3 é¿å…å…±äº«å†…å­˜çš„bankå†²çª</h2><p>ä¸ºäº†è·å¾—é«˜çš„å†…å­˜å¸¦å®½ï¼Œå…±äº«å†…å­˜åœ¨ç‰©ç†ä¸Šè¢«åˆ†ä¸º32ä¸ª(åˆšå¥½ç­‰äºä¸€ä¸ªçº¿ç¨‹æŸä¸­çš„çº¿ç¨‹æ•°ç›®32)åŒæ ·å®½åº¦çš„ã€èƒ½è¢«åŒæ—¶è®¿é—®çš„å†…å­˜bank</p>
<ul>
<li>å•ç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240913182434.png?token=GHSAT0AAAAAAC7KAB5HX3O7FKJBF3JROJMYZ6S7KDA" alt="|350"></li>
<li>åŒç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240913182530.png?token=GHSAT0AAAAAAC7KAB5HUQSC4FWK54BNEFVWZ6S7KHA" alt="|350"><br><code>bank</code>å®½åº¦ä¸º4å­—èŠ‚çš„æ¶æ„ï¼Œ$\dfrac{128å­—èŠ‚(å®šä¹‰çš„å…±äº«å†…å­˜æ•°ç»„çš„å¤§å°)}{32bank(å¤§å°å’Œä¸€ä¸ªçº¿ç¨‹æŸä¸­çš„çº¿ç¨‹æ•°ç›®ç›¸åŒ)}=4å­—èŠ‚/bank$</li>
<li>åªè¦åŒä¸€ä¸ªçº¿ç¨‹æŸå†…çš„å¤šä¸ªçº¿ç¨‹<strong>ä¸åŒæ—¶</strong>è®¿é—®åŒä¸€ä¸ª<code>bank</code>ä¸­ä¸åŒå±‚çš„æ•°æ®ï¼Œè¯¥çº¿ç¨‹æŸå¯¹å…±äº«å†…å­˜çš„è®¿é—®å°±åªéœ€è¦<strong>ä¸€æ¬¡</strong>å†…å­˜äº‹åŠ¡</li>
<li>å½“åŒä¸€çº¿ç¨‹çš„å¤šä¸ªçº¿ç¨‹æ•°è¯•å›¾è®¿é—®åŒä¸€ä¸ª<code>bank</code>ä¸­ä¸åŒå±‚(nå±‚)çš„æ•°æ®(å°†å¯¼è‡´næ¬¡å†…å­˜äº‹åŠ¡)ï¼Œä¼šå‘ç”Ÿbankå†²çª(nè·¯bankå†²çª)</li>
<li>ä¸Šé¢çš„<code>transpose with shared memory bank conflit</code>æ˜¯å‘ç”Ÿäº†32è·¯bankå†²çª<ul>
<li><code>B[nx2 * N + ny2] = S[threadIdx.x][threadIdx.y]</code></li>
<li>åŒä¸€ä¸ªçº¿ç¨‹æŸçš„32ä¸ªçº¿ç¨‹(è¿ç»­çš„32ä¸ª<code>threadIdx.x</code>å€¼)å¯¹åº”<code>S</code>ä¸­è·¨åº¦ä¸º32çš„æ•°æ®(<code>[threadIdx.y]</code>)</li>
</ul>
</li>
<li>äºæ˜¯å°†<code>__shared__ real S[TILE_DIM][TILE_DIM]</code>æ”¹ä¸º<code>__shared__ real S[TILE_DIM][TILE_DIM + 1]</code><ul>
<li>åŒä¸€ä¸ªçº¿ç¨‹æŸçš„32ä¸ªçº¿ç¨‹(è¿ç»­çš„32ä¸ª<code>threadIdx.x</code>)å¯¹åº”<code>S</code>ä¸­è·¨åº¦ä¸º33çš„æ•°æ®</li>
<li>å¦‚æœç¬¬ä¸€ä¸ªçº¿ç¨‹è®¿é—®ç¬¬ä¸€ä¸ª<code>bank</code>çš„ç¬¬ä¸€å±‚ï¼Œç¬¬äºŒä¸ªçº¿ç¨‹åˆ™ä¼šè®¿é—®ç¬¬äºŒä¸ª<code>bank</code>çš„ç¬¬äºŒå±‚ï¼Œè€Œä¸æ˜¯ç¬¬ä¸€ä¸ª<code>bank</code>çš„ç¬¬äºŒå±‚ï¼Œä»¥æ­¤ç±»æ¨ï¼Œæ²¡æœ‰<code>bank</code>å†²çª<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/%E6%9C%AA%E5%91%BD%E5%90%8D%E6%96%87%E6%A1%A3_1.jpg?token=GHSAT0AAAAAAC7KAB5G4GHY36VSXVZADHPQZ6S7KMA"><br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/%E6%9C%AA%E5%91%BD%E5%90%8D%E6%96%87%E6%A1%A3_2.jpg?token=GHSAT0AAAAAAC7KAB5HOGHEMWPERFKDJIMMZ6S7KVQ"><br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/%E6%9C%AA%E5%91%BD%E5%90%8D%E6%96%87%E6%A1%A3_3.jpg?token=GHSAT0AAAAAAC7KAB5GODSSQZX3ELFCIRH6Z6S7K2Q"><br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/%E6%9C%AA%E5%91%BD%E5%90%8D%E6%96%87%E6%A1%A3_4.jpg?token=GHSAT0AAAAAAC7KAB5HSDIMELDVMWI4PZHYZ6S7K6A"><br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/%E6%9C%AA%E5%91%BD%E5%90%8D%E6%96%87%E6%A1%A3_5.jpg?token=GHSAT0AAAAAAC7KAB5H67SBSJVXY34TVANOZ6S7LDQ"></li>
</ul>
</li>
</ul>
<h1 id="ç¬¬ä¹ç« -åŸå­å‡½æ•°çš„åˆç†ä½¿ç”¨"><a href="#ç¬¬ä¹ç« -åŸå­å‡½æ•°çš„åˆç†ä½¿ç”¨" class="headerlink" title="ç¬¬ä¹ç«  åŸå­å‡½æ•°çš„åˆç†ä½¿ç”¨"></a>ç¬¬ä¹ç«  åŸå­å‡½æ•°çš„åˆç†ä½¿ç”¨</h1><h2 id="9-1-å®Œå…¨åœ¨GPUä¸­è¿›è¡Œå½’çº¦"><a href="#9-1-å®Œå…¨åœ¨GPUä¸­è¿›è¡Œå½’çº¦" class="headerlink" title="9.1 å®Œå…¨åœ¨GPUä¸­è¿›è¡Œå½’çº¦"></a>9.1 å®Œå…¨åœ¨GPUä¸­è¿›è¡Œå½’çº¦</h2><ul>
<li>æœ¬ä¹¦ä½¿ç”¨åœ¨å…ˆå‰çš„æ ¸å‡½æ•°çš„æœ«å°¾åˆ©ç”¨<strong>åŸå­å‡½æ•°</strong>è¿›è¡Œå½’çº¦ç›´æ¥å¾—åˆ°æœ€ç»ˆçš„ç»“æœçš„æ–¹æ³•</li>
<li>ä¸èƒ½ä½¿ç”¨ğŸ‘‡çš„åŸå› ï¼šä¸ç®¡æ¯ä¸ªçº¿ç¨‹å—ç¬¬0å·çº¿ç¨‹çš„æ‰§è¡Œæ¬¡åºå¦‚ä½•ï¼Œåªæœ‰å½“ä¸€ä¸ªçº¿ç¨‹çš„â€œè¯»-å†™â€æ“ä½œä¸è¢«å…¶ä»–çº¿ç¨‹å¹²æ‰°æ—¶ï¼Œæ‰èƒ½å¾—åˆ°æ­£ç¡®ç»“æœ<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">if</span><span class="token punctuation">(</span>tid <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	d_y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+=</span> s_y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
å¦‚æœå­˜åœ¨ä¸¤ä¸ªçº¿ç¨‹å—ç¬¬0å·çº¿ç¨‹åŒæ—¶è¯»å–d_y[0]çš„å€¼ï¼Œé‚£ç»“æœå°±æ˜¯é”™è¯¯çš„</li>
<li>åŸå­å‡½æ•°<code>atomicAdd(address, val)</code>ï¼š<ul>
<li>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¾…ç´¯åŠ çš„å˜é‡çš„åœ°å€</li>
<li>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ç´¯åŠ çš„å€¼</li>
<li>â€œåœ¨è°ƒç”¨è¯¥ç‰ˆæœ¬çš„æ ¸å‡½æ•°ä¹‹å‰ï¼Œå¿…é¡»å°†<code>d_y[0]</code>çš„å€¼åˆå§‹åŒ–ä¸º0â€</li>
<li>ğŸ‘‡<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">if</span><span class="token punctuation">(</span>tid <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// threadIdx.x = 0ï¼Œä¿è¯æ¯ä¸ªçº¿ç¨‹å—çš„s_y[0]åªç´¯åŠ ä¸€æ¬¡</span>
<span class="token punctuation">{</span>
	<span class="token function">atomicAdd</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>d_y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//&amp;d_y[0]å¯ä»¥å†™æˆd_y(æ•°ç»„åæ˜¯æ•°ç»„é¦–ä¸ªå…ƒç´ çš„åœ°å€)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
ä»£ç ä¸­ï¼š<br><code>d_x</code>æ˜¯é•¿åº¦ä¸º<code>M</code>çš„æ•°ç»„ã€<code>N</code>ä¸ºå…ƒç´ ä¸ªæ•°</li>
</ul>
</li>
<li>åˆå§‹åŒ–<code>h_x</code>ï¼Œå¤åˆ¶ç»™<code>d_x</code></li>
<li><strong><code>timing(d_x)</code>ï¼š</strong><ul>
<li>é‡å¤<code>NUM_REPEATS</code>æ¬¡</li>
<li>åˆ›å»ºäº‹ä»¶ã€è®¡æ—¶ã€æŸ¥è¯¢</li>
<li><strong><code>reduce(d_x)</code>ã€</strong><ul>
<li>å®šä¹‰ç½‘æ ¼å¤§å°</li>
<li><code>h_y[1]</code>ä½œç”¨æ˜¯ä¼ ä¸€ä¸ªåˆå§‹å€¼ä¸º0çš„å€¼ç»™<code>d_y</code>ï¼Œæ»¡è¶³<code>d_y[0]</code>çš„å€¼åˆå§‹åŒ–ä¸º0çš„è¦æ±‚<ul>
<li><strong><code>reduce(d_x, d_y, N)</code>ï¼šåŠ¨æ€å†…å­˜<code>&lt;&lt;&lt;grid_size, block_size, sizeof(real) * block_size&gt;&gt;&gt;</code></strong><ul>
<li>ä½¿ç”¨åŠ¨æ€å†…å­˜è¿›è¡ŒæŠ˜åŠç›¸åŠ </li>
<li>ä½¿ç”¨<code>atomicAdd</code>å¯¹æ¯ä¸ªçº¿ç¨‹å—çš„é¦–ä¸ªå…ƒç´ ç›¸åŠ å¾—åˆ°æœ€ç»ˆç»“æœ</li>
</ul>
</li>
</ul>
</li>
<li>å°†ç»“æœä»<code>d_y</code>å¤åˆ¶å›<code>h_y</code>ä¸­</li>
<li>é‡Šæ”¾å†…å­˜</li>
</ul>
</li>
<li>ç»“æŸè®¡æ—¶ï¼Œæ‰“å°è®¡æ—¶ç»“æœå’Œæœ€åä¸€æ¬¡çš„æ±‚å’Œç»“æœ</li>
</ul>
</li>
<li>é‡Šæ”¾<code>d_x</code>å’Œ<code>h_x</code>çš„å†…å­˜</li>
</ul>
<p>å•ç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240919200542.png?token=GHSAT0AAAAAAC7KAB5HD6P4NKF6CKPZEJVSZ6S7LIA" alt="375"><br>åŒç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240919200554.png?token=GHSAT0AAAAAAC7KAB5GH7PUH7DEJ33TBY2OZ6S7LOA" alt="375"><br>ç¡®å®æ˜¯æ¯”å…ˆå‰çš„æå‡çº¦2ms</p>
<h2 id="9-3-ä¾‹å­ï¼šé‚»å±…åˆ—è¡¨çš„å»ºç«‹"><a href="#9-3-ä¾‹å­ï¼šé‚»å±…åˆ—è¡¨çš„å»ºç«‹" class="headerlink" title="9.3 ä¾‹å­ï¼šé‚»å±…åˆ—è¡¨çš„å»ºç«‹"></a>9.3 ä¾‹å­ï¼šé‚»å±…åˆ—è¡¨çš„å»ºç«‹</h2><p><code>MN</code>æ˜¯æ¯ä¸ªåŸå­çš„æœ€å¤šé‚»å±…åŸå­æ•°<br><code>NN[n]</code>æ˜¯ç¬¬nä¸ªç²’å­çš„é‚»å±…ä¸ªæ•°<br><code>NL[n * MN + k]</code>æ˜¯ç¬¬nä¸ªç²’å­çš„ç¬¬kä¸ªé‚»å±…çš„æŒ‡æ ‡</p>
<h3 id="9-3-1-C-ç‰ˆæœ¬çš„å¼€å‘"><a href="#9-3-1-C-ç‰ˆæœ¬çš„å¼€å‘" class="headerlink" title="9.3.1 C++ç‰ˆæœ¬çš„å¼€å‘"></a>9.3.1 C++ç‰ˆæœ¬çš„å¼€å‘</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">find_neighbor</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>NN<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>NL<span class="token punctuation">,</span> <span class="token keyword">const</span> real<span class="token operator">*</span> x<span class="token punctuation">,</span> <span class="token keyword">const</span> real<span class="token operator">*</span> y<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> n <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> n<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        NN<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

	<span class="token comment">// n1å’Œn2ä»£è¡¨ä¸¤ä¸ªå¯èƒ½äº’ä¸ºé‚»å±…çš„åŸå­</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> n1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> n1 <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>n1<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        real x1 <span class="token operator">=</span> x<span class="token punctuation">[</span>n1<span class="token punctuation">]</span><span class="token punctuation">;</span>
        real y1 <span class="token operator">=</span> y<span class="token punctuation">[</span>n1<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> n2 <span class="token operator">=</span> n1 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> n2 <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>n2<span class="token punctuation">)</span> <span class="token comment">// å› ä¸ºn1å’Œn2äº’ä¸ºé‚»å±…ï¼Œæ‰€ä»¥åªè€ƒè™‘n2&gt;n1çš„æƒ…å½¢</span>
        <span class="token punctuation">{</span>
            real x12 <span class="token operator">=</span> x<span class="token punctuation">[</span>n2<span class="token punctuation">]</span> <span class="token operator">-</span> x1<span class="token punctuation">;</span>
            real y12 <span class="token operator">=</span> y<span class="token punctuation">[</span>n2<span class="token punctuation">]</span> <span class="token operator">-</span> y1<span class="token punctuation">;</span>
            real distance_square <span class="token operator">=</span> x12 <span class="token operator">*</span> x12 <span class="token operator">+</span> y12 <span class="token operator">*</span> y12<span class="token punctuation">;</span> <span class="token comment">// </span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>distance_square <span class="token operator">&lt;</span> cutoff_square<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                NL<span class="token punctuation">[</span>n1 <span class="token operator">*</span> MN <span class="token operator">+</span> NN<span class="token punctuation">[</span>n1<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> n2<span class="token punctuation">;</span> <span class="token comment">// å…ˆæ·»åŠ é‚»å±…ä¿¡æ¯ï¼Œå†å¯¹é‚»å±…ä¸ªæ•°++</span>
                NL<span class="token punctuation">[</span>n2 <span class="token operator">*</span> MN <span class="token operator">+</span> NN<span class="token punctuation">[</span>n2<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> n1<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="9-3-2-åˆ©ç”¨åŸå­æ“ä½œçš„CUDAç‰ˆæœ¬"><a href="#9-3-2-åˆ©ç”¨åŸå­æ“ä½œçš„CUDAç‰ˆæœ¬" class="headerlink" title="9.3.2 åˆ©ç”¨åŸå­æ“ä½œçš„CUDAç‰ˆæœ¬"></a>9.3.2 åˆ©ç”¨åŸå­æ“ä½œçš„CUDAç‰ˆæœ¬</h3><p>å¦‚æœä»ç„¶ä½¿ç”¨9.3.1ä¸­çš„<code>find_neighbor</code>å‡½æ•°ï¼Œä¼šå¯¼è‡´â€œ<strong>å¹¶å‘å†™å…¥å†²çª</strong>â€<br>ä¸€ä¸ªçº¿ç¨‹ä¸ä¸€ä¸ªåŸå­å¯¹åº”</p>
<ul>
<li>ä¸n1å¯¹åº”çš„çº¿ç¨‹ğŸ‘‡<pre class="line-numbers language-c" data-language="c"><code class="language-c">d_NL<span class="token punctuation">[</span>n1 <span class="token operator">*</span> MN <span class="token operator">+</span> NN<span class="token punctuation">[</span>n1<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> n2<span class="token punctuation">;</span> 
d_NL<span class="token punctuation">[</span>n2 <span class="token operator">*</span> MN <span class="token operator">+</span> NN<span class="token punctuation">[</span>n2<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> n1<span class="token punctuation">;</span> <span class="token comment">// ç¬¬äºŒæ¡è¯­å¥</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
<li>ä¸n2å¯¹åº”çš„çº¿ç¨‹ğŸ‘‡<pre class="line-numbers language-c" data-language="c"><code class="language-c">d_NL<span class="token punctuation">[</span>n2 <span class="token operator">*</span> MN <span class="token operator">+</span> NN<span class="token punctuation">[</span>n2<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> n1<span class="token punctuation">;</span> <span class="token comment">// ç¬¬ä¸€æ¡è¯­å¥</span>
d_NL<span class="token punctuation">[</span>n1 <span class="token operator">*</span> MN <span class="token operator">+</span> NN<span class="token punctuation">[</span>n1<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> n2<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
ä¹¦ä¸ŠåŸè¯â€œåœ¨ä¸<code>n1</code>å¯¹åº”çš„çº¿ç¨‹ä¸­ï¼Œç¬¬äºŒæ¡è¯­å¥ä»£è¡¨æˆ‘ä»¬è¯•å›¾å¯¹<code>d_NN[n2]</code>è¿›è¡Œç´¯åŠ æ“ä½œã€‚ä½†æ˜¯ï¼Œåœ¨ä¸<code>n2</code>å¯¹åº”çš„çº¿ç¨‹ä¸­ï¼Œç¬¬ä¸€æ¡è¯­å¥ä»£è¡¨æˆ‘ä»¬ä¹Ÿè¯•å›¾å¯¹<code>d_NN[n2]</code>è¿›è¡Œç´¯åŠ æ“ä½œâ€<br>éœ€è¦ç”¨åŸå­å‡½æ•°ï¼š<pre class="line-numbers language-c" data-language="c"><code class="language-c">d_NL<span class="token punctuation">[</span>n1 <span class="token operator">*</span> MN <span class="token operator">+</span> d_NN<span class="token punctuation">[</span>n1<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> n2<span class="token punctuation">;</span>
d_NL<span class="token punctuation">[</span>n2 <span class="token operator">*</span> MN <span class="token operator">+</span> d_NN<span class="token punctuation">[</span>n2<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> n1<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<p>åˆç†åˆ©ç”¨è¿”å›å€¼ï¼š<br>å¯ä»¥å°†ğŸ‘‡ä»£ç </p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">NL<span class="token punctuation">[</span>n1 <span class="token operator">*</span> MN <span class="token operator">+</span> NN<span class="token punctuation">[</span>n1<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> n2<span class="token punctuation">;</span>
NL<span class="token punctuation">[</span>n2 <span class="token operator">*</span> MN <span class="token operator">+</span> NN<span class="token punctuation">[</span>n2<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> n1<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>æ”¹å†™ä¸ºğŸ‘‡</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">NL<span class="token punctuation">[</span>n1 <span class="token operator">*</span> MN <span class="token operator">+</span> NN<span class="token punctuation">[</span>n1<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> n2<span class="token punctuation">;</span>
NN<span class="token punctuation">[</span>n1<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
NL<span class="token punctuation">[</span>n2 <span class="token operator">*</span> MN <span class="token operator">+</span> NN<span class="token punctuation">[</span>n2<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> n1<span class="token punctuation">;</span>
NN<span class="token punctuation">[</span>n2<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä½†å¦‚æœç±»ä¼¼åœ°æ”¹å†™åŸå­å‡½æ•°çš„ä»£ç ï¼š</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">d_NL<span class="token punctuation">[</span>n1 <span class="token operator">*</span> MN <span class="token operator">+</span> <span class="token function">atomicAdd</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>d_NN<span class="token punctuation">[</span>n1<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> n2<span class="token punctuation">;</span>
d_NL<span class="token punctuation">[</span>n2 <span class="token operator">*</span> MN <span class="token operator">+</span> <span class="token function">atomicAdd</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>d_NN<span class="token punctuation">[</span>n2<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> n1<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>ğŸ‘†æ”¹å†™ä¸ºğŸ‘‡</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">d_NL<span class="token punctuation">[</span>n1 <span class="token operator">*</span> MN <span class="token operator">+</span> d_NN<span class="token punctuation">[</span>n1<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> n2<span class="token punctuation">;</span>
<span class="token function">atomicAdd</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>d_NN<span class="token punctuation">[</span>n1<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
d_NL<span class="token punctuation">[</span>n2 <span class="token operator">*</span> MN <span class="token operator">+</span> d_NN<span class="token punctuation">[</span>n2<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> n1<span class="token punctuation">;</span>
<span class="token function">atomicAdd</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>d_NN<span class="token punctuation">[</span>n2<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>åŸå­å‡½æ•°çš„æ“ä½œæœ¬èº«æ˜¯ç«‹å³ç”Ÿæ•ˆçš„ï¼Œä¸”åœ¨åŸå­æ“ä½œçš„æ‰§è¡Œè¿‡ç¨‹ä¸­å…¶ä»–çº¿ç¨‹æ— æ³•åŒæ—¶ä¿®æ”¹è¯¥å˜é‡</li>
<li>ä¸åŒçš„çº¿ç¨‹å¯èƒ½ä¼šåŒæ—¶è®¿é—®<code>d_NN[n1]</code>å’Œ<code>d_NN[n2]</code>ï¼Œå¦‚æœä¸¤ä¸ªçº¿ç¨‹å‡ ä¹åŒæ—¶æ‰§è¡Œå¯¹ <code>d_NN[n1]</code> çš„ <code>atomicAdd</code> æ“ä½œï¼Œé‚£ä¹ˆå°½ç®¡æ“ä½œæœ¬èº«æ˜¯åŸå­çš„ï¼Œå®ƒä»¬çš„æ‰§è¡Œé¡ºåºå´æ˜¯ä¸ç¡®å®šçš„ï¼Œä¸€ä¸ªçº¿ç¨‹å¯èƒ½åœ¨å¦ä¸€ä¸ªçº¿ç¨‹æ›´æ–°<code>d_NN[n1]</code>ä¹‹å‰å°±è¯»åˆ°äº†è¯¥å€¼<br>æ­£ç¡®å†™æ³•ğŸ‘‡<pre class="line-numbers language-none"><code class="language-none">int tmp1 = atomicAdd(&amp;d_NN[n1], 1);
d_NL[n1 * MN + tmp1] = n2;
int tmp2 = atomicAdd(&amp;d_NN[n2], 1);
d_NL[n2 * MN + tmp1] = n1;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
ä½¿ç”¨ä¸´æ—¶å˜é‡<code>tmp1</code>å’Œ<code>tmp2</code>ä¿å­˜<code>d_NN[n1]</code>å’Œ<code>d_NN[n2]</code>çš„æ—§å€¼</li>
</ul>
<p>å•ç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240921115244.png?token=GHSAT0AAAAAAC7KAB5GUTT3QZ5BAHGQLT3QZ6S7LWQ" alt="375"><br>åŒç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240921115308.png?token=GHSAT0AAAAAAC7KAB5HWLX63PU2YMLVUB3EZ6S7L2Q" alt="375"></p>
<p>åœ¨æ ¸å‡½æ•°<code>find_neighbor_no_atomic</code>ä¸­ï¼Œ<br>â‘ å°†<code>d_NL[n1 * MN + count++]</code>æ”¹ä¸º<code>d_NL[(count++) * N + n1]</code><br>â‘¡<code>const int n1 = blockIdx.x * blockDim.x + threadIdx.x;</code></p>
<ul>
<li>å‰è€…çš„ç´¢å¼•ä¸­ï¼šæ¯ä¸ªçº¿ç¨‹çš„åœ°å€è·¨åº¦ä¸º<code>MN</code></li>
<li>åè€…çš„ç´¢å¼•ä¸­ï¼šæ¯ä¸ªçº¿ç¨‹åœ¨æ¯æ¬¡å¾ªç¯æ—¶è®¿é—®ç›¸é‚»çš„å†…å­˜ä½ç½®</li>
</ul>
<p>å¯¹äº<code>find_neighbor_not_atomic</code><br>â‘ å°†<code>if((distance_square) &lt; cutoff_square &amp;&amp; (n2 != n1))</code><br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240921115244.png?token=GHSAT0AAAAAAC7KAB5GYMBXAZFEN5IT5PDAZ6S7MVQ" alt="375"><br>æ”¹ä¸º<code>if((n2 != n1) &amp;&amp; (distance_square) &lt; cutoff_square)</code>ï¼Œç”¨æ—¶å˜å¤š<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240921170942.png?token=GHSAT0AAAAAAC7KAB5H3EI2WVSPOD24LVZYZ6S7M3A" alt="375"></p>
<p>å¯¹æ¯”ä½¿ç”¨å¯„å­˜å™¨å˜é‡ä¸ä¸ä½¿ç”¨å¯„å­˜å™¨å˜é‡<br>ä½¿ç”¨ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240921115244.png?token=GHSAT0AAAAAAC7KAB5HTCMN2S3NMK6M7UXQZ6S7NMQ" alt="375"><br>ä¸ä½¿ç”¨ğŸ‘‡ï¼Œç”¨æ—¶å˜å¤š<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240921171012.png?token=GHSAT0AAAAAAC7KAB5H2UKYVDZ74CTQC53WZ6S7NQA" alt="375"></p>
<h1 id="ç¬¬åç« -çº¿ç¨‹æŸåŸºæœ¬å‡½æ•°ä¸åä½œç»„"><a href="#ç¬¬åç« -çº¿ç¨‹æŸåŸºæœ¬å‡½æ•°ä¸åä½œç»„" class="headerlink" title="ç¬¬åç«  çº¿ç¨‹æŸåŸºæœ¬å‡½æ•°ä¸åä½œç»„"></a>ç¬¬åç«  çº¿ç¨‹æŸåŸºæœ¬å‡½æ•°ä¸åä½œç»„</h1><h2 id="10-1-å•æŒ‡ä»¤-å¤šçº¿ç¨‹æ‰§è¡Œæ¨¡å¼"><a href="#10-1-å•æŒ‡ä»¤-å¤šçº¿ç¨‹æ‰§è¡Œæ¨¡å¼" class="headerlink" title="10.1 å•æŒ‡ä»¤-å¤šçº¿ç¨‹æ‰§è¡Œæ¨¡å¼"></a>10.1 å•æŒ‡ä»¤-å¤šçº¿ç¨‹æ‰§è¡Œæ¨¡å¼</h2><p>å¹¶å‘å’ŒåŒæ­¥ï¼š</p>
<ul>
<li>å¹¶å‘ï¼šä¾§é‡ä»»åŠ¡çš„(é€»è¾‘)åŒæ—¶è¿›è¡Œï¼Œåœ¨åŒä¸€æ®µæ—¶é—´å†…<strong>å¤šä¸ªä»»åŠ¡äº¤æ›¿è¿›è¡Œ</strong></li>
<li>åŒæ­¥ï¼šä¾§é‡æ§åˆ¶äººç‰©çš„æ‰§è¡Œé¡ºåºï¼Œä¿è¯å®ƒä»¬åœ¨åˆé€‚çš„æ—¶åˆ»è®¿é—®å…±äº«èµ„æº</li>
</ul>
<p>å•æŒ‡ä»¤-å¤šçº¿ç¨‹ï¼šåŒä¸€æ—¶åˆ»ï¼Œä¸€ä¸ªçº¿ç¨‹æŸä¸­çš„çº¿ç¨‹åªèƒ½æ‰§è¡Œä¸€ä¸ªå…±åŒçš„æŒ‡ä»¤æˆ–è€…é—²ç½®<br>åˆ†æ²»å‘æ•£ï¼šä¸€ä¸ªçº¿ç¨‹æŸä¸­çš„çº¿ç¨‹é¡ºåºåœ°æ‰§è¡Œåˆ¤æ–­è¯­å¥ä¸­çš„ä¸åŒåˆ†æ”¯(åˆ†æ”¯æ˜¯ä¾æ¬¡æ‰§è¡Œçš„)</p>
<p>ä¸€ä¸ªSMå¯ä»¥å¤„ç†ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹å—ï¼Œä¸€ä¸ªçº¿ç¨‹å—ä¸ä¼šè¢«åˆ†é…åˆ°ä¸åŒçš„SMä¸­<br>ä¸€ä¸ªçº¿ç¨‹å—å¯ä»¥æ°›å›´è‹¥å¹²çº¿ç¨‹æŸ</p>
<h2 id="10-3-æ›´å¤šçº¿ç¨‹æŸå†…çš„åŸºæœ¬å‡½æ•°"><a href="#10-3-æ›´å¤šçº¿ç¨‹æŸå†…çš„åŸºæœ¬å‡½æ•°" class="headerlink" title="10.3 æ›´å¤šçº¿ç¨‹æŸå†…çš„åŸºæœ¬å‡½æ•°"></a>10.3 æ›´å¤šçº¿ç¨‹æŸå†…çš„åŸºæœ¬å‡½æ•°</h2><p><code>mask</code>ä¸ºæ©ç ï¼Œæ˜¯ä¸€ä¸ª32ä½çš„æ— ç¬¦å·æ•´æ•°ï¼Œç”¨äºæŒ‡å®šè¦å‚ä¸è®¡ç®—çš„çº¿ç¨‹ï¼Œæ©ç ä¸­çš„ä¸€ä¸ªäºŒè¿›åˆ¶ä½ä¸º0/1ä»£è¡¨å¯¹åº”çš„çº¿ç¨‹å‚ä¸/ä¸å‚ä¸è®¡ç®—<br>â‘ <code>__ballot_sync(mask, predicate)</code>ï¼šè¿”å›ä¸€ä¸ªæ–°çš„æ©ç </p>
<ul>
<li><code>mask</code>å…ˆå†³å®šçº¿ç¨‹æŸå†…ç¬¬n(n=1~32)ä¸ªçº¿ç¨‹æ˜¯å¦å‚ä¸è®¡ç®—(0/1)</li>
<li><code>predicate</code>ç”¨äºåˆ¤æ–­å‚ä¸è®¡ç®—çš„çº¿ç¨‹æ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼Œå¦‚æœæ»¡è¶³åˆ™è¯¥çº¿ç¨‹å¯¹åº”çš„<code>predicate</code>ä¸º1ï¼Œå¯¹åº”çš„<code>mask</code>å–1çš„æ¯”ç‰¹ä½ï¼Œå¦åˆ™å¯¹åº”çš„<code>predicate</code>ä¸º0ï¼Œå¯¹åº”çš„<code>mask</code>å–0</li>
</ul>
<p>â‘¡<code>__all_sync(mask, predicate)</code>ï¼šè¿”å›0/1</p>
<ul>
<li>çº¿ç¨‹æŸå†…æ‰€æœ‰å‚ä¸çš„çº¿ç¨‹å¯¹åº”çš„<code>predicate</code>å€¼éƒ½ä¸ä¸º0æ‰è¿”å›1ï¼Œå¦åˆ™è¿”å›0</li>
<li>ç±»ä¼¼äºé€‰ä¸¾æ“ä½œï¼Œæ‰€æœ‰å‚é€‰äººéƒ½åŒæ„æ—¶é€šè¿‡<ul>
<li>ä¾‹ï¼š<code>int result = __all_sync(FULL_MASK, tid);</code>å¦‚æœæ‰€æœ‰çº¿ç¨‹çš„ <code>tid</code> éƒ½ä¸ºçœŸï¼ˆéé›¶ï¼‰ï¼Œå‡½æ•°è¿”å› 1ï¼Œè¡¨ç¤ºæ¡ä»¶å¯¹æ‰€æœ‰çº¿ç¨‹éƒ½æ»¡è¶³ï¼›å¦åˆ™è¿”å› 0ï¼Œè¡¨ç¤ºè‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹çš„ <code>tid</code> ä¸ºé›¶ã€‚</li>
</ul>
</li>
</ul>
<p>â‘¢<code>__any_sync(mask, predicate)</code>ï¼šè¿”å›0/1</p>
<ul>
<li>çº¿ç¨‹æŸå†…æ‰€æœ‰å‚ä¸çš„çº¿ç¨‹å¯¹åº”çš„<code>predicate</code>å€¼åªè¦æœ‰ä¸€ä¸ªä¸ä¸º0å°±è¿”å›1ï¼Œå¦‚æœå…¨æ˜¯0æ‰è¿”å›0</li>
<li>ç±»ä¼¼é€‰ä¸¾æ“ä½œï¼Œåªè¦æœ‰ä¸€ä¸ªå‚é€‰äººåŒæ„å°±é€šè¿‡</li>
</ul>
<p>â‘£<code>__shfl_sync(mask, var, srcLane, width);</code>æ¯ä¸ªå­ç»„ä¸­å‚ä¸çš„çº¿ç¨‹è·å–<code>land_id</code>ä¸º<code>srcLane</code>çš„çº¿ç¨‹ä¸­çš„å˜é‡</p>
<ul>
<li><code>land_id = threadIdx.x % w; = threadIdx.x &amp; (w - 1);</code></li>
<li><code>mask</code>ï¼šè¡¨ç¤ºçº¿ç¨‹æŸå†…å‚ä¸çš„çº¿ç¨‹</li>
<li><code>var</code>ï¼šè¡¨ç¤ºå½“å‰çº¿ç¨‹çš„å˜é‡</li>
<li><code>srcLane</code>ï¼šè¡¨ç¤ºä»å“ªä¸ªçº¿ç¨‹ç´¢å¼•è¯»å–<code>v</code>çš„å€¼</li>
<li><code>width</code>ï¼šè¡¨ç¤ºå‚ä¸è¿™ä¸ª<code>shuffle</code>æ“ä½œçš„<code>warp</code>çš„å®½åº¦<ul>
<li>ä¾‹ï¼š<code>__shfl_sync(FULL_MASK, tid, 2, 8)</code><ul>
<li><code>8</code>è¡¨ç¤º<code>__shfl_sync()</code>æ“ä½œåªåœ¨8ä¸ªçº¿ç¨‹çš„å°ç»„ä¸­è¿›è¡Œï¼Œå¯¹äº32çº¿ç¨‹çš„<code>wrap</code>ï¼Œçº¿ç¨‹è¢«åˆ†ä¸º4ç»„æœ‰8ä¸ªçº¿ç¨‹çš„å­ç»„(0-7, 8-15, 16-23, 24-31)</li>
<li><code>2</code>è¡¨ç¤ºæºçº¿ç¨‹ç´¢å¼•ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½ä¼šè¯»å–ç¬¬2å·çº¿ç¨‹çš„<code>tid</code>å€¼å¹¶å­˜åˆ°<code>value</code>å˜é‡ä¸­</li>
<li><code>tid</code>è¡¨ç¤ºæ¯ä¸ªçº¿ç¨‹çš„å±€éƒ¨å˜é‡</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">__global__ <span class="token keyword">void</span> <span class="token function">shuffleExample</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> tid <span class="token operator">=</span> threadIdx<span class="token punctuation">.</span>x <span class="token operator">%</span> <span class="token number">32</span><span class="token punctuation">;</span>  <span class="token comment">// å‡è®¾æ¯ä¸ªçº¿ç¨‹çš„tidæ˜¯çº¿ç¨‹ç´¢å¼•ï¼ˆ0~31ï¼‰</span>
    <span class="token keyword">int</span> value <span class="token operator">=</span> <span class="token function">__shfl_sync</span><span class="token punctuation">(</span><span class="token number">0xFFFFFFFF</span><span class="token punctuation">,</span> tid<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Thread %d got value %d\n"</span><span class="token punctuation">,</span> tid<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//æ‰“å°ç»“æœğŸ‘‡</span>
Thread <span class="token number">0</span> got value <span class="token number">2</span>
Thread <span class="token number">1</span> got value <span class="token number">2</span>
Thread <span class="token number">2</span> got value <span class="token number">2</span>
Thread <span class="token number">3</span> got value <span class="token number">2</span>
Thread <span class="token number">4</span> got value <span class="token number">2</span>
Thread <span class="token number">5</span> got value <span class="token number">2</span>
Thread <span class="token number">6</span> got value <span class="token number">2</span>
Thread <span class="token number">7</span> got value <span class="token number">2</span>
Thread <span class="token number">8</span> got value <span class="token number">10</span>
Thread <span class="token number">9</span> got value <span class="token number">10</span>
Thread <span class="token number">10</span> got value <span class="token number">10</span>
Thread <span class="token number">11</span> got value <span class="token number">10</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
Thread <span class="token number">30</span> got value <span class="token number">26</span>
Thread <span class="token number">31</span> got value <span class="token number">26</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>å°†ä¸€ä¸ªçº¿ç¨‹ä¸­çš„æ•°æ®å¹¿æ’­åˆ°æ‰€æœ‰(åŒ…æ‹¬è‡ªå·±)çº¿ç¨‹</li>
</ul>
<p>â‘¤<code>__shfl_up_sync(mask, var, delta, width);</code></p>
<ul>
<li><code>delta</code>ï¼šè¡¨ç¤ºæ¯ä¸ªçº¿ç¨‹ä»å‰é¢å¤šå°‘ä¸ªçº¿ç¨‹å¤„è·å–æ•°æ®</li>
<li><code>width</code>ï¼šå†³å®šäº†<code>warp</code>å†…çš„åˆ†ç»„èŒƒå›´ï¼Œé€šä¿¡åªåœ¨æŒ‡å®šå¤§å°çš„ç»„å†…è¿›è¡Œ<ul>
<li>ä¾‹ï¼š<code>__shfl_up_sync(mask, var, 1, 8);</code></li>
</ul>
</li>
<li><code>vat</code>ï¼šå†³å®šè·å–çš„æ•°æ®æ¥æº</li>
</ul>
<table>
<thead>
<tr>
<th>çº¿ç¨‹ID</th>
<th>tid</th>
<th>æ‰§è¡Œåçš„tid</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>3</td>
<td>2</td>
</tr>
</tbody></table>
<ul>
<li>æ˜¯ä¸€ç§å°†æ•°æ®å‘ä¸Šå¹³ç§»çš„æ“ä½œ</li>
</ul>
<p>â‘¥<code>__shfl_down_sync(mask, var, delta, width);</code></p>
<ul>
<li>æ˜¯ä¸€ç§å°†æ•°æ®å‘ä¸‹å¹³ç§»çš„æ“ä½œ</li>
</ul>
<p>â‘¦<code>__shfl_xor_sync(mask, var, landMask, width);</code><br>çº¿ç¨‹<code>i</code>ä¸çº¿ç¨‹<code>i ^ landMask</code>(è¿™é‡Œè¡¨ç¤ºå¼‚æˆ–)äº¤æ¢æ•°æ®<br>ä¾‹å­ï¼š<code>landMask=1</code>ã€<code>width=8</code></p>
<table>
<thead>
<tr>
<th>çº¿ç¨‹ID</th>
<th>tid</th>
<th>æ‰§è¡Œåçš„tid</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
<td>3</td>
</tr>
<tr>
<td>3</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>4</td>
<td>4</td>
<td>5</td>
</tr>
<tr>
<td>5</td>
<td>5</td>
<td>4</td>
</tr>
<tr>
<td>6</td>
<td>6</td>
<td>7</td>
</tr>
<tr>
<td>7</td>
<td>7</td>
<td>6</td>
</tr>
<tr>
<td>8</td>
<td>8</td>
<td>9</td>
</tr>
<tr>
<td>9</td>
<td>9</td>
<td>8</td>
</tr>
<tr>
<td>10</td>
<td>10</td>
<td>11</td>
</tr>
<tr>
<td>11</td>
<td>11</td>
<td>10</td>
</tr>
<tr>
<td>12</td>
<td>12</td>
<td>13</td>
</tr>
<tr>
<td>13</td>
<td>13</td>
<td>12</td>
</tr>
<tr>
<td>14</td>
<td>14</td>
<td>15</td>
</tr>
<tr>
<td>15</td>
<td>15</td>
<td>14</td>
</tr>
<tr>
<td>ä»¥<code>__shlf</code>å¼€å¤´çš„å‡½æ•°ä¸ºæ´—ç‰Œå‡½æ•°ï¼Œå¥½å¤„æ˜¯<strong>ä½¿å¾—çº¿ç¨‹æŸä¸­çš„çº¿ç¨‹å½¼æ­¤ä¹‹é—´å¯ä»¥ç›´æ¥äº¤æ¢æ•°æ®ï¼Œè€Œä¸æ˜¯é€šè¿‡å…±äº«å†…å­˜æˆ–å…¨å±€å†…å­˜æ¥è¿›è¡Œçš„</strong>ã€‚æ´—ç‰ŒæŒ‡ä»¤æ¯”å…±äº«å†…å­˜æœ‰æ›´ä½çš„å»¶è¿Ÿï¼Œå¹¶ä¸”è¯¥æŒ‡ä»¤åœ¨æ‰§è¡Œæ•°æ®äº¤æ¢æ—¶ä¸æ¶ˆè€—é¢å¤–çš„å†…å­˜</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240922162221.png?token=GHSAT0AAAAAAC7KAB5GEBUFNETDHMQRKL2UZ6S7NYA"></p>
<ul>
<li><code>all_sync(FULL_MASK):0</code>ï¼Œçº¿ç¨‹0çš„<code>tid</code>ä¸º0ï¼Œä¸æ˜¯å…¨éƒ¨å‚ä¸çš„çº¿ç¨‹çš„<code>predicate</code>å€¼éƒ½ä¸º1ï¼Œæ‰€ä»¥ä¸º0</li>
<li><code>all_sync(mask1):1</code>ï¼Œçº¿ç¨‹0æ²¡æœ‰å‚ä¸ï¼Œå…¨éƒ¨å‚ä¸çš„çº¿ç¨‹çš„<code>predicate</code>å€¼éƒ½ä¸º1ï¼Œæ‰€ä»¥ä¸º1</li>
<li><code>any_sync(FULL_MASK):1</code>ï¼Œçº¿ç¨‹0çš„<code>tid</code>ä¸º0ï¼Œåªè¦å‚ä¸çš„çº¿ç¨‹çš„<code>predicate</code>å€¼è‡³å°‘æœ‰ä¸€ä¸ªä¸º1åˆ™ä¸º1ï¼Œæ‰€ä»¥ä¸º1</li>
<li><code>any_sync(mask2):1</code>ï¼Œçº¿ç¨‹0çš„<code>tid</code>ä¸º0ï¼Œå‚ä¸çš„çº¿ç¨‹çš„åªæœ‰çº¿ç¨‹0ï¼Œ<code>predicate</code>å€¼åªæœ‰0ï¼Œæ‰€ä»¥ä¸º0</li>
</ul>
<h3 id="10-3-2-åˆ©ç”¨çº¿ç¨‹æŸæ´—ç‰Œå‡½æ•°è¿›è¡Œè§„çº¦è®¡ç®—"><a href="#10-3-2-åˆ©ç”¨çº¿ç¨‹æŸæ´—ç‰Œå‡½æ•°è¿›è¡Œè§„çº¦è®¡ç®—" class="headerlink" title="10.3.2 åˆ©ç”¨çº¿ç¨‹æŸæ´—ç‰Œå‡½æ•°è¿›è¡Œè§„çº¦è®¡ç®—"></a>10.3.2 åˆ©ç”¨çº¿ç¨‹æŸæ´—ç‰Œå‡½æ•°è¿›è¡Œè§„çº¦è®¡ç®—</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c">real y <span class="token operator">=</span> s_y<span class="token punctuation">[</span>tid<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// å°†å…±äº«å†…å­˜ä¸­çš„æ•°æ®å¤åˆ¶åˆ°å¯„å­˜å™¨ï¼Œåœ¨çº¿ç¨‹æŸå†…ä½¿ç”¨æ´—ç‰Œå‡½æ•°è¿›è¡Œå½’çº¦æ—¶ï¼Œä¸éœ€è¦æ˜æ˜¾åœ°ä½¿ç”¨å…±äº«å†…å­˜</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span> offset <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span> offset <span class="token operator">&gt;&gt;=</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	y <span class="token operator">+=</span> <span class="token function">__shfl_down_sync</span><span class="token punctuation">(</span>FULL_MASK<span class="token punctuation">,</span> y<span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// yæ˜¯è¯»å–çš„å€¼ï¼Œoffsetæ˜¯å‘åç§»çš„ä¸ªæ•°</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>tid <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">atomicAdd</span><span class="token punctuation">(</span>d_y<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ğŸ‘†ç†è§£ï¼š</p>
<ul>
<li>å°†å…±äº«å†…å­˜ä¸­çš„æ•°æ®å¤åˆ¶åˆ°å¯„å­˜å™¨ï¼Œåœ¨çº¿ç¨‹æŸå†…ä½¿ç”¨æ´—ç‰Œå‡½æ•°è¿›è¡Œå½’çº¦æ—¶ï¼Œä¸éœ€è¦æ˜æ˜¾åœ°ä½¿ç”¨å…±äº«å†…å­˜</li>
<li>æ´—ç‰Œå‡½æ•°å…ˆè¯»å–å„ä¸ªçº¿ç¨‹ä¸­yçš„å€¼ï¼Œå†å°†æ´—ç‰Œæ“ä½œçš„ç»“æœå†™å…¥å„ä¸ªçº¿ç¨‹çš„yä¸­<ul>
<li>å‡è®¾<code>y(tid = n) = n</code><ul>
<li>`offset=16<ul>
<li><code>y(tid=0) += __shfl_down_sync(FULL_MASK, y(tid=0), offset);</code><ul>
<li><code>y(tid=0) = 0</code></li>
<li><code>__shfl_down_sync() -&gt; y(tid=0)' = y(tid=16) = 16</code>ï¼Œ<code>'</code>è¡¨ç¤ºåæ¥çš„</li>
<li><code>y(tid=0) = y(tid=0) + y(tid=0)' = 0 + 16 = 16</code></li>
</ul>
</li>
<li><code>y(tid=1) = 1 + 17 = 18</code></li>
<li>â€¦</li>
<li><code>y(tid=15) = 15 + 31 = 46</code></li>
</ul>
</li>
<li><code>offset=8</code><ul>
<li><code>y(tid=0) = y(tid=0) + y(tid=7)</code></li>
<li>â€¦</li>
</ul>
</li>
<li><code>offset=1</code><ul>
<li><code>y(tid=0) = y(tid=0) + y(tid=1)</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="10-4-åä½œç»„"><a href="#10-4-åä½œç»„" class="headerlink" title="10.4 åä½œç»„"></a>10.4 åä½œç»„</h2><p>åä½œç»„ï¼šçœ‹ä½œçº¿ç¨‹å—å’Œçº¿ç¨‹æŸåŒæ­¥æœºåˆ¶çš„æ¨å¹¿</p>
<ul>
<li>ä½¿ç”¨åä½œç»„çš„åŠŸèƒ½æ—¶éœ€è¦åœ¨ç›¸å…³æºæ–‡ä»¶åŒ…å«å¦‚ä¸‹å¤´æ–‡ä»¶ï¼š<br><code>#include&lt;cooperative_groups.h&gt;</code></li>
<li>å¯¼å…¥å‘½åç©ºé—´<code>cooprtative_groups</code>ä¸­çš„å†…å®¹ï¼š<br><code>using namespace cooperative_groups;</code></li>
</ul>
<p>å®šä¹‰å¹¶åˆå§‹åŒ–ä¸€ä¸ª<code>thread_block</code>å¯¹è±¡ï¼š<br><code>thread_block g = this_thread_block();</code>ï¼Œ<code>g</code>å°±ä»£è¡¨äº†çº¿ç¨‹å—</p>
<ul>
<li>ç­‰ä»·å…³ç³»ï¼š</li>
<li><code>g.sync()</code>â†”<code>__syncthreads()</code></li>
<li><code>g.group_index()</code>â†”<code>blockIdx</code></li>
<li><code>g.thread_index()</code>â†”<code>threadIdx</code></li>
</ul>
<p><code>tiled_partition()</code>å°†ä¸€ä¸ªçº¿ç¨‹å—åˆ†ä¸ºè‹¥å¹²ç‰‡(<code>tile</code>)ï¼Œæ¯ä¸€ç‰‡æ„æˆä¸€ä¸ªæ–°çš„çº¿ç¨‹ç»„ï¼Œå¤§å°åªèƒ½æ˜¯2ã€4ã€8ã€16ã€32</p>
<ul>
<li>æ¨¡æ¿åŒ–ï¼š<br><code>thread_block_tile&lt;32&gt; g32 = tiled_partition&lt;32&gt;(this_thread_block());</code><br><code>thread_block_tile&lt;4&gt; g4 = tiled_partition&lt;4&gt;(this_thread_block());</code><br>è¿™æ ·å®šä¹‰çš„çº¿ç¨‹ç»„ç§°ä¸º<strong>çº¿ç¨‹å—ç‰‡</strong>ï¼Œçº¿ç¨‹å—ç‰‡å‡½æ•°ä¸åŒçš„åœ°æ–¹ï¼š</li>
<li>çº¿ç¨‹ç»„å†…çš„æ‰€æœ‰çº¿ç¨‹éƒ½å¿…é¡»å‚ä¸ç›¸å…³å‡½æ•°çš„è¿ç®—</li>
<li>å®½åº¦å°±æ˜¯çº¿ç¨‹å—ç‰‡çš„å¤§å°</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">real y <span class="token operator">=</span> s_y<span class="token punctuation">[</span>tid<span class="token punctuation">]</span><span class="token punctuation">;</span>
thread_block_tile<span class="token operator">&lt;</span><span class="token number">32</span><span class="token operator">&gt;</span> g <span class="token operator">=</span> tiled_partition<span class="token operator">&lt;</span><span class="token number">32</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token function">this_thread_block</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&gt;&gt;=</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    y <span class="token operator">+=</span> g<span class="token punctuation">.</span><span class="token function">shfl_down</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>tid <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">atomicAdd</span><span class="token punctuation">(</span>d_y<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æŠŠçº¿ç¨‹åˆ’åˆ†32ä¸ªçº¿ç¨‹ä¸€ç»„çš„ï¼Œå…¶ä»–çš„ä¸æ´—ç‰Œå‡½æ•°çš„æ­¥éª¤å·®ä¸å¤šï¼Œåªæ˜¯ä½¿ç”¨çš„æ–¹æ³•ä¸ä¸€æ ·ï¼Œæ‰€ä»¥ä»–ä»¬ä¸¤ç§æ–¹æ³•çš„ç”¨æ—¶ä¹Ÿå·®ä¸å¤š</p>
<p>å•ç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240922220201.png?token=GHSAT0AAAAAAC7KAB5GZTRVMPHE7TOBLLYQZ6S7OGA" alt="275"><br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240922220210.png?token=GHSAT0AAAAAAC7KAB5GYCR2TKOIY7GYEIRKZ6S7OKA" alt="275"><br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240922220219.png?token=GHSAT0AAAAAAC7KAB5GDCCBMSSDH7PDKVMGZ6S7OLA" alt="275"><br>åŒç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240922220240.png?token=GHSAT0AAAAAAC7KAB5H4KRDTNAOOVVZVY26Z6S7OMA" alt="275"><br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240922220254.png?token=GHSAT0AAAAAAC7KAB5GL4LXS4DG4ZVUWQY4Z6S7ONA" alt="275"><br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240922220302.png?token=GHSAT0AAAAAAC7KAB5GCKGPHG66GXPZQT3AZ6S7ONQ" alt="275"></p>
<h2 id="10-5-æ•°ç»„è§„çº¦ç¨‹åºçš„è¿›ä¸€æ­¥ä¼˜åŒ–"><a href="#10-5-æ•°ç»„è§„çº¦ç¨‹åºçš„è¿›ä¸€æ­¥ä¼˜åŒ–" class="headerlink" title="10.5 æ•°ç»„è§„çº¦ç¨‹åºçš„è¿›ä¸€æ­¥ä¼˜åŒ–"></a>10.5 æ•°ç»„è§„çº¦ç¨‹åºçš„è¿›ä¸€æ­¥ä¼˜åŒ–</h2><h3 id="10-5-1-æé«˜çº¿ç¨‹åˆ©ç”¨ç‡"><a href="#10-5-1-æé«˜çº¿ç¨‹åˆ©ç”¨ç‡" class="headerlink" title="10.5.1 æé«˜çº¿ç¨‹åˆ©ç”¨ç‡"></a>10.5.1 æé«˜çº¿ç¨‹åˆ©ç”¨ç‡</h3><p>â€œå¦‚æœèƒ½å¤Ÿæé«˜å½’çº¦ä¹‹å‰æ‰€åšè®¡ç®—çš„æ¯”ä¾‹ï¼Œåˆ™åº”è¯¥å¯ä»¥ä»æ•´ä½“ä¸Šå‡å¯¹çº¿ç¨‹çš„åˆ©ç”¨ç‡â€¦ï¼Œå¯ä»¥åœ¨å½’çº¦ä¹‹å‰å°†å¤šä¸ªå…¨å±€å†…å­˜æ•°ç»„çš„æ•°æ®ç´¯åŠ åˆ°ä¸€ä¸ªå…±äº«å†…å­˜æ•°ç»„çš„ä¸€ä¸ªå…ƒç´ ä¸­â€</p>
<p>â€œä¸è¦è®©ä¸€ä¸ªçº¿ç¨‹å¤„ç†ç›¸é‚»çš„è‹¥å¹²æ•°æ®ï¼Œå› ä¸ºè¿™å¿…ç„¶å¯¼è‡´å…¨å±€å†…å­˜çš„éåˆå¹¶è®¿é—®â€ï¼Œå¦‚ä½•ç†è§£è¿™å¥è¯(è¿™å¥è¯æœ¬äººè¯»äº†å¥½ä¸€ä¼šæ‰ç†æ˜ç™½)ï¼š</p>
<ul>
<li>ä»€ä¹ˆæ˜¯åˆå¹¶è®¿é—®ï¼Ÿ<ul>
<li>$åˆå¹¶åº¦=\dfrac{çº¿ç¨‹æŸè¯·æ±‚çš„å­—èŠ‚æ•°}{ç”±è¯¥è¯·æ±‚å¯¼è‡´çš„æ‰€æœ‰æ•°æ®ä¼ è¾“å¤„ç†çš„å­—èŠ‚æ•°}$</li>
<li>åˆå¹¶è®¿é—®å°±æ˜¯åˆå¹¶åº¦100%çš„æƒ…å†µï¼Œæ³¨æ„ï¼šçº¿ç¨‹çš„ç»„ç»‡æƒ…å†µæ˜¯ä»¥çº¿ç¨‹æŸä¸ºå•ä½</li>
</ul>
</li>
<li>ä¸ºä»€ä¹ˆä¸€ä¸ªçº¿ç¨‹å¤„ç†ä¼šå¯¼è‡´éåˆå¹¶<ul>
<li>(ä»¥ä¸‹æ˜¯å¸¦æœ‰ä¸»è§‚çš„è§£é‡Š)ä¸€ä¸ªçº¿ç¨‹å¤„ç†ç›¸é‚»çš„æ•°æ®ï¼Œå¦‚</li>
<li><code>tid=0 -&gt; è®¿é—® d_x[0], d_x[1], d_x[2], d_x[3]</code></li>
<li><code>tid=1 -&gt; è®¿é—® d_x[4], d_x[5], d_x[6], d_x[7]</code></li>
<li>åœ¨ä¸€ä¸ªçº¿ç¨‹æŸå†…ï¼Œæ¯ä¸€æ—¶åˆ»æ¯ä¸ªçº¿ç¨‹è®¿é—®çš„æ•°æ®ä¸æ˜¯è¿ç»­çš„(<code>d_x[tid * 4]</code>)ï¼Œæ•°æ®çš„ä¼ è¾“çš„é¦–åœ°å€æŸä¸ªæœ€å°é¢—ç²’åº¦çš„å€æ•°</li>
<li>å‡è®¾éœ€è¦è¯·æ±‚çš„æ•°æ®ä¸º<code>d_x[0]~d_x[31]</code>ï¼Œæ¯ä¸ªå…ƒç´ å¤§å°ä¸º4å­—èŠ‚ï¼ŒæŸä¸ªæœ€å°é¢—ç²’åº¦ä¸º32</li>
<li>åœ¨ç¬¬ä¸€ä¸ªæ—¶åˆ»ä¸­ï¼Œ<code>tid = 0 -&gt; 0 ... tid = 7 -&gt; 28</code></li>
<li>åœ¨ç¬¬äºŒä¸ªæ—¶åˆ»ä¸­ï¼Œ<code>tid = 0 -&gt; 1 ... tid = 7 -&gt; 29</code></li>
<li>åœ¨ç¬¬ä¸‰ä¸ªæ—¶åˆ»ä¸­ï¼Œ<code>tid = 0 -&gt; 2 ... tid = 7 -&gt; 30</code></li>
<li>åœ¨ç¬¬å››ä¸ªæ—¶åˆ»ä¸­ï¼Œ<code>tid = 0 -&gt; 3 ... tid = 7 -&gt; 31</code></li>
<li>$åˆå¹¶åº¦=\dfrac{çº¿ç¨‹æŸè¯·æ±‚çš„å­—èŠ‚æ•°}{ç”±è¯¥è¯·æ±‚å¯¼è‡´çš„æ‰€æœ‰æ•°æ®ä¼ è¾“å¤„ç†çš„å­—èŠ‚æ•°}=\dfrac{128}{128*4}=\dfrac{1}{4}$ï¼Œ4æ˜¯ä»£è¡¨è¿›è¡Œäº†4æ¬¡ä»0<del>128å­—èŠ‚çš„è®¿é—®(å³`d_x[0]</del>d_x[31]`)</li>
</ul>
</li>
<li>æ€ä¹ˆæ ·è®¿é—®æ‰æ˜¯åˆå¹¶çš„ï¼Ÿ<ul>
<li>ç›¸é‚»çº¿ç¨‹è®¿é—®è¿ç»­çš„åœ°å€ï¼Œä¾‹å­è§ç¬¬ä¸ƒç« ç¬¬ä¸€èŠ‚çš„é¡ºåºçš„åˆå¹¶è®¿é—®</li>
</ul>
</li>
</ul>
<p>å•ç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240924211910.png?token=GHSAT0AAAAAAC7KAB5GP4ZZCVGJBWY72GUMZ6S7O7Q" alt="375"><br>åŒç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240924211937.png?token=GHSAT0AAAAAAC7KAB5GEZOHBDFLSLA5OVD2Z6S7PBQ" alt="375"><br>å¯ä»¥å‘ç°ä¼˜åŒ–ååœ¨æ—¶é—´å’Œç²¾åº¦ä¸Šéƒ½æœ‰æ‰€æå‡ï¼</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">reduce_cp<span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span>GRID_SIZE<span class="token punctuation">,</span> BLOCK_SIZE<span class="token punctuation">,</span> smem<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>d_x<span class="token punctuation">,</span> d_y<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>
reduce_cp<span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>real<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>d_y<span class="token punctuation">,</span> d_y<span class="token punctuation">,</span> GRID_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æœ‰GRID_SIZEä¸ªå—éœ€è¦å½’çº¦</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<ul>
<li>ç”¨<code>d_y[bid] = y;</code>ä»£æ›¿äº†<code>atomicAdd(d_y, y)</code></li>
<li>ä½¿ç”¨ä¸¤ä¸ªæ ¸å‡½æ•°å¯ä»¥è·å¾—æ›´åŠ ç²¾ç¡®çš„ç»“æœï¼Œè¿™æ˜¯å› ä¸ºä½¿ç”¨ä¸¤ä¸ªæ ¸å‡½æ•°æ—¶ï¼Œå°†æ•°ç»„<code>d_y</code>å½’çº¦åˆ°æœ€ç»ˆç»“æœçš„è®¡ç®—ä½¿ç”¨äº†æŠ˜åŠæ±‚å’Œï¼Œæ¯”ç›´æ¥ç´¯åŠ (ä½¿ç”¨åŸå­å‡½æ•°æˆ–å¤åˆ¶åˆ°ä¸»æœºå†ç´¯åŠ çš„æƒ…å†µ)æ›´ç¨³å¥</li>
</ul>
<h3 id="10-5-2-é¿å…åå¤åˆ†é…ä¸é‡Šæ”¾è®¾å¤‡å†…å­˜"><a href="#10-5-2-é¿å…åå¤åˆ†é…ä¸é‡Šæ”¾è®¾å¤‡å†…å­˜" class="headerlink" title="10.5.2 é¿å…åå¤åˆ†é…ä¸é‡Šæ”¾è®¾å¤‡å†…å­˜"></a>10.5.2 é¿å…åå¤åˆ†é…ä¸é‡Šæ”¾è®¾å¤‡å†…å­˜</h3><p>åœ¨10.5.1çš„<code>reduce()</code>å‡½æ•°ä¸­ï¼Œéœ€è¦ä¸ºæ•°ç»„<code>d_y</code>åˆ†é…ä¸é‡Šæ”¾è®¾å¤‡å†…å­˜ã€‚å®é™…ä¸Šï¼Œ<strong>è®¾å¤‡å†…å­˜çš„åˆ†é…ä¸é‡Šæ”¾æ˜¯æ¯”è¾ƒè€—æ—¶çš„</strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">real <span class="token function">reduce</span><span class="token punctuation">(</span><span class="token keyword">const</span> real<span class="token operator">*</span> d_x<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span> ymem <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>real<span class="token punctuation">)</span> <span class="token operator">*</span> GRID_SIZE<span class="token punctuation">;</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token function">CHECK</span><span class="token punctuation">(</span><span class="token function">cudaMalloc</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>d_y<span class="token punctuation">,</span> ymem<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åˆ†é…å†…å­˜</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token function">CHECK</span><span class="token punctuation">(</span><span class="token function">cudaFree</span><span class="token punctuation">(</span>d_y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é‡Šæ”¾å†…å­˜	</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è§£å†³æ–¹æ³•ï¼šä½¿ç”¨é™æ€å…¨å±€å†…å­˜ä»£æ›¿åŠ¨æ€å…¨å±€å†…å­˜ï¼Œå› ä¸ºé™æ€å†…å­˜åœ¨ç¼–è¯‘æœŸé—´å°±ä¼šåˆ†é…å¥½</p>
<ul>
<li>å®šä¹‰é™æ€å…¨å±€å†…å­˜å˜é‡ï¼š<code>__device__ real static_y[GRID_SIZE];</code></li>
<li>åœ¨ä¸æ”¹å˜æ ¸å‡½æ•°ä»£ç çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç”¨<code>cudaGetSymbolAddress()</code>è·å¾—ä¸€ä¸ªæŒ‡å‘è¯¥é™æ€å…¨å±€å†…å­˜çš„æŒ‡é’ˆ<pre class="line-numbers language-c" data-language="c"><code class="language-c">__device__ real static_y<span class="token punctuation">[</span>GRID_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>

real <span class="token function">reduce</span><span class="token punctuation">(</span><span class="token keyword">const</span> real<span class="token operator">*</span> d_x<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    real<span class="token operator">*</span> d_y<span class="token punctuation">;</span>
    <span class="token function">CHECK</span><span class="token punctuation">(</span><span class="token function">cudaGetSymbolAddress</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>d_y<span class="token punctuation">,</span> static_y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å°†æŒ‡å‘d_yçš„æŒ‡é’ˆæŒ‡å‘static_y</span>

    <span class="token keyword">const</span> <span class="token keyword">int</span> smem <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>real<span class="token punctuation">)</span> <span class="token operator">*</span> BLOCK_SIZE<span class="token punctuation">;</span>

    reduce_cp<span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span>GRID_SIZE<span class="token punctuation">,</span> BLOCK_SIZE<span class="token punctuation">,</span> smem<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>d_x<span class="token punctuation">,</span> d_y<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>
    reduce_cp<span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>real<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>d_y<span class="token punctuation">,</span> d_y<span class="token punctuation">,</span> GRID_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
    real h_y<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">CHECK</span><span class="token punctuation">(</span><span class="token function">cudaMemcpy</span><span class="token punctuation">(</span>h_y<span class="token punctuation">,</span> d_y<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>real<span class="token punctuation">)</span><span class="token punctuation">,</span> cudaMemcpyDeviceToHost<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
    <span class="token keyword">return</span> h_y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<code>cudaGetSymbolAddress(void** devPtr, const char* symbol);</code></li>
<li><code>void*8 devPtr</code>ï¼šæ˜¯ä¸€ä¸ªæŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆï¼Œå‡½æ•°ä¼šä¿®æ”¹è¿™ä¸ªæŒ‡é’ˆï¼Œä½¿å…¶æŒ‡å‘<strong>æŒ‡å®šç¬¦å·</strong>åœ¨è®¾å¤‡ä¸Šçš„åœ°å€</li>
<li><code>const char* symbol</code>ï¼šæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºä½ æƒ³è¦è·å–åœ°å€çš„ç¬¦å·åç§°(é€šå¸¸æ˜¯å…¨å±€å˜é‡æˆ–å¸¸é‡å˜é‡çš„åç§°ï¼Œéœ€è¦ä»¥<code>__device__</code>æˆ–<code>__constant__</code>å­˜å‚¨ç±»å®šä¹‰)</li>
<li>ä½¿ç”¨åœºæ™¯ï¼šåœ¨è®¾å¤‡ä¸­å®šä¹‰äº†ä¸€ä¸ªå…¨å±€å˜é‡æˆ–å¸¸é‡ï¼Œå¹¶å¸Œæœ›åœ¨å†…æ ¸æˆ–å…¶ä»–CUDAå‡½æ•°ä¸­ä½¿ç”¨</li>
<li>ç¤ºä¾‹ğŸ‘‡<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">// å®šä¹‰</span>
__device__ <span class="token keyword">float</span> static_y<span class="token punctuation">;</span>
<span class="token comment">// è·å–static_yçš„åœ°å€</span>
<span class="token keyword">float</span> <span class="token operator">*</span>d_y<span class="token punctuation">;</span>
<span class="token function">cudaGetSymbolAddress</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>d_y<span class="token punctuation">,</span> <span class="token string">"static_y"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<p>å•ç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240926190202.png?token=GHSAT0AAAAAAC7KAB5G23WGGCHJTDST4AZMZ6S7PMA" alt="375"><br>åŒç²¾åº¦ğŸ‘‡<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240926190218.png?token=GHSAT0AAAAAAC7KAB5HKYM2YMYF3XXGFLUAZ6S7PNA" alt="375"><br>ç”¨æ—¶æ¯”ä½¿ç”¨åŠ¨æ€å…¨å±€å†…å­˜æ›´çŸ­ï¼</p>
<h1 id="ç¬¬åä¸€ç« -CUDAæµ"><a href="#ç¬¬åä¸€ç« -CUDAæµ" class="headerlink" title="ç¬¬åä¸€ç«  CUDAæµ"></a>ç¬¬åä¸€ç«  CUDAæµ</h1><p>æ ¸å‡½æ•°å¤–éƒ¨çš„å¹¶è¡Œä¸»è¦æŒ‡ï¼š</p>
<ul>
<li>æ ¸å‡½æ•°è®¡ç®—ä¸æ•°æ®ä¼ è¾“ä¹‹é—´çš„å¹¶è¡Œ</li>
<li>ä¸»æœºè®¡ç®—ä¸æ•°æ®ä¼ è¾“ä¹‹é—´çš„å¹¶è¡Œ</li>
<li>ä¸åŒçš„æ•°æ®ä¼ è¾“ä¹‹é—´çš„å¹¶è¡Œ(cudaMemcpyå‡½æ•°ä¸­çš„ç¬¬å››ä¸ªå‚æ•°)</li>
<li>æ ¸å‡½æ•°è®¡ç®—ä¸ä¸»æœºè®¡ç®—ä¹‹é—´çš„å¹¶è¡Œ</li>
<li>ä¸åŒæ ¸å‡½æ•°ä¹‹é—´çš„å¹¶è¡Œ</li>
</ul>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œè¦è·å¾—è¾ƒé«˜çš„åŠ é€Ÿæ¯”ï¼Œå¦‚è¦<strong>å‡å°‘ä¸»æœºä¸è®¾å¤‡ä¹‹é—´çš„æ•°æ®ä¼ è¾“åŠä¸»æœºä¸­çš„è®¡ç®—</strong>ï¼Œ<strong>å°½é‡åœ¨è®¾å¤‡ä¸­å®Œæˆæ‰€æœ‰è®¡ç®—</strong></p>
<h2 id="11-1-CUDAæµæ¦‚è¿°"><a href="#11-1-CUDAæµæ¦‚è¿°" class="headerlink" title="11.1 CUDAæµæ¦‚è¿°"></a>11.1 CUDAæµæ¦‚è¿°</h2><p><strong>ä¸€ä¸ªCUDAæµæŒ‡çš„æ˜¯ç”±ä¸»æœºå‘å‡ºçš„åœ¨ä¸€ä¸ªè®¾å¤‡ä¸­æ‰§è¡Œçš„CUDAæ“ä½œ</strong>(å³å’ŒCUDAæœ‰å…³çš„æ“ä½œï¼Œå¦‚ä¸»æœº-è®¾å¤‡æ•°æ®ä¼ è¾“å’Œæ ¸å‡½æ•°æ‰§è¡Œ)<strong>åºåˆ—</strong></p>
<p>CUDAæµï¼š</p>
<ul>
<li>é»˜è®¤æµ(ç©ºæµ)</li>
<li>éé»˜è®¤æµ(éç©ºæµ)<ul>
<li>åœ¨ä¸»æœºç«¯äº§ç”Ÿå’Œé”€æ¯</li>
<li>ä¸€ä¸ªCUDAæµç”±ç±»å‹ä¸º<code>cudaStream_t</code>çš„å˜é‡è¡¨ç¤º</li>
<li>äº§ç”Ÿï¼š<code>cudaStreamCreate(cudaStream_t*)</code>ï¼Œè¾“å…¥å‚æ•°æ˜¯<code>cudaStream_t</code>ç±»å‹çš„æŒ‡é’ˆ</li>
<li>é”€æ¯ï¼š<code>cudaStreamDestroy(cudaStream_t*)</code>ï¼Œè¾“å…¥å‚æ•°<code>cudaStream_t</code>ç±»å‹çš„å˜é‡</li>
<li>æ£€æŸ¥ä¸€ä¸ªCUDAæµä¸­çš„æ‰€æœ‰æ“ä½œæ˜¯å¦éƒ½åœ¨è®¾å¤‡ä¸­æ‰§è¡Œå®Œæ¯•ï¼š<ul>
<li><code>cudaStreamSynchronize(cudaStream_t stream)</code>ï¼Œ<code>cudaStreamSynchronize()</code>ä¼šå¼ºåˆ¶é˜»å¡ä¸»æœºï¼Œç›´åˆ°CUDAæµstreamä¸­çš„æ‰€æœ‰æ“ä½œéƒ½è¢«æ‰§è¡Œå®Œæ¯•</li>
<li><code>cudaStreamQuery(cudaStream_t stream)</code>ï¼Œ<code>cudaStreamQuery()</code>ä¸ä¼šé˜»å¡ä¸»æœºï¼Œåªæ˜¯æ£€æŸ¥CUDAæµstreamä¸­çš„æ‰€æœ‰æ“ä½œæ˜¯å¦éƒ½æ‰§è¡Œå®Œæ¯•</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="11-2-åœ¨é»˜è®¤æµä¸­é‡å ä¸»æœºå’Œè®¾å¤‡è®¡ç®—"><a href="#11-2-åœ¨é»˜è®¤æµä¸­é‡å ä¸»æœºå’Œè®¾å¤‡è®¡ç®—" class="headerlink" title="11.2 åœ¨é»˜è®¤æµä¸­é‡å ä¸»æœºå’Œè®¾å¤‡è®¡ç®—"></a>11.2 åœ¨é»˜è®¤æµä¸­é‡å ä¸»æœºå’Œè®¾å¤‡è®¡ç®—</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token function">cudaMemcpy</span><span class="token punctuation">(</span>d_x<span class="token punctuation">,</span> h_x<span class="token punctuation">,</span> M<span class="token punctuation">,</span> cudaMemcpyHostToDevice<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä¸»æœºå‘å‡ºå‘½ä»¤åï¼Œéœ€ç­‰å¾…å‘½ä»¤æ‰§è¡Œå®Œæ¯•æ‰æ‰§è¡Œä¸‹ä¸€æ­¥ï¼Œåœ¨ç­‰å¾…çš„è¿‡ç¨‹ä¸­ä¸»æœºé—²ç½®</span>
<span class="token function">cudaMemcpy</span><span class="token punctuation">(</span>d_y<span class="token punctuation">,</span> h_y<span class="token punctuation">,</span> M<span class="token punctuation">,</span> cudaMemcpyHostToDevice<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä¸»æœºå‘å‡ºå‘½ä»¤åï¼Œéœ€ç­‰å¾…å‘½ä»¤æ‰§è¡Œå®Œæ¯•æ‰æ‰§è¡Œä¸‹ä¸€æ­¥ï¼Œåœ¨ç­‰å¾…çš„è¿‡ç¨‹ä¸­ä¸»æœºé—²ç½®</span>
sum<span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span>grid_size<span class="token punctuation">,</span> block_size<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>d_x<span class="token punctuation">,</span> d_y<span class="token punctuation">,</span> d_z<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä¸»æœºå‘å‡ºå‘½ä»¤åï¼Œä¸ä¼šç­‰å¾…è¯¥å‘½ä»¤æ‰§è¡Œå®Œæ¯•ï¼Œä¸»æœºç´§æ¥ç€ä¼šå‘å‡ºä¸‹ä¸€æ¡æŒ‡ä»¤</span>
<span class="token function">cudaMemcpy</span><span class="token punctuation">(</span>h_z<span class="token punctuation">,</span> d_z<span class="token punctuation">,</span> M<span class="token punctuation">,</span> cudaMemcpyDeviceToHost<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å› ä¸ºè¿™æ˜¯é»˜è®¤æµä¸­çš„CUDAæ“ä½œï¼Œå¿…é¡»ç­‰å¾…å‰ä¸€ä¸ªCUDAæ“ä½œæ‰§è¡Œå®Œæ¯•æ‰ä¼šæ‰§è¡Œè¿™æ¡å‘½ä»¤</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>ğŸ‘†CUDAæ“ä½œä¾‹å­(æ³¨é‡Šæ˜¯ä¸»æœºè§’åº¦)<br>ä»è®¾å¤‡è§’åº¦çœ‹ï¼šä¸Šé¢4ä¸ªCUDAæ“ä½œåœ¨é»˜è®¤çš„CUDAæµä¸­<strong>æŒ‰ä»£ç å‡ºç°çš„é¡ºåºä¾æ¬¡æ‰§è¡Œ</strong><br>ä»ä¸»æœºè§’åº¦çœ‹ï¼š<br>â‘ ä¸»æœºåœ¨å‘å‡ºæ ¸å‡½æ•°å‘½ä»¤çš„è°ƒç”¨åä¼šç«‹åˆ»å‘å‡ºä¸‹ä¸€ä¸ªå‘½ä»¤<br>â‘¡(1)å¦‚æœä¸‹ä¸€ä¸ªå‘½ä»¤æ˜¯æ•°æ®ä¼ è¾“ï¼Œä»è®¾å¤‡è§’åº¦çœ‹å¿…é¡»ç­‰å¾…æ ¸å‡½æ•°æ‰§è¡Œå®Œæ¯•(å®é™…ä¸Šä¸»æœºä¹Ÿåœ¨ç­‰æ‰§è¡Œå®Œæ¯•)<br>â‘¡(2)å¦‚æœä¸‹ä¸€ä¸ªå‘½ä»¤æ˜¯ä¸»æœºä¸­çš„æŸä¸ªè®¡ç®—ä»»åŠ¡ï¼Œé‚£ä¹ˆä¸»æœºä¼šåœ¨è®¾å¤‡æ‰§è¡Œæ ¸å‡½æ•°æ—¶åŒæ—¶è¿›è¡Œä¸€äº›è®¡ç®—ï¼Œè¿™æ ·ä¸»æœºå’Œè®¾å¤‡å°±å¯ä»¥åŒæ—¶è¿›è¡Œ(<strong>è®¾å¤‡å®Œå…¨ä¸çŸ¥é“åœ¨å®ƒæ‰§è¡Œæ ¸å‡½æ•°æ—¶ï¼Œä¸»æœºå·å·åœ°åšäº†äº›è®¡ç®—</strong>)</p>
<p>å®è·µ(ç»“æœå’Œä¹¦ä¸Šçš„ä¸ç¬¦åˆ)ï¼š</p>
<ul>
<li>é‡‡ç”¨å•ç²¾åº¦æµ®ç‚¹æ•°ï¼Œåœ¨æ•°æ®é‡ä¸€æ ·æ—¶ï¼Œ<strong>æ ¸å‡½æ•°<code>gpu_sum</code>æ¯”ä¸»æœºç«¯å‡½æ•°<code>cpu_sum</code>çº¦å¿«10å€</strong>ï¼Œå› æ­¤è®¾ç½®$ratio=\dfrac{è®¾å¤‡ç«¯å‡½æ•°æ‰€å¤„ç†çš„æ•°æ®é‡}{ä¸»æœºç«¯å‡½æ•°æ‰€å¤„ç†çš„æ•°æ®é‡}$ï¼Œä½¿å¾—<code>gpu_sum</code>å’Œ<code>cpu_sum</code>æ‰§è¡Œæ—¶é—´å·®ä¸å¤š</li>
<li>è¿™é‡Œçš„ç»“æœå’Œä¹¦ä¸Šçš„ä¸å¤ªç¬¦åˆ(æ€è€ƒ.jpg)</li>
</ul>
<p>ç»“æœ(ä¹¦ä¸Šçš„)ï¼š</p>
<ul>
<li>å½“ä¸»æœºå‡½æ•°å’Œè®¾å¤‡å‡½æ•°çš„è®¡ç®—é‡ç›¸å½“æ—¶ï¼Œå°†<strong>ä¸»æœºå‡½æ•°æ”¾åœ¨è®¾å¤‡å‡½æ•°ä¹‹å</strong>(GPU -&gt; CPU)å¯ä»¥è¾¾åˆ°ä¸»æœºå‡½æ•°ä¸è®¾å¤‡å‡½æ•°å¹¶å‘æ‰§è¡Œçš„æ•ˆæœï¼Œä»è€Œæœ‰æ•ˆåœ°éšè—ä¸»æœºå‡½æ•°çš„æ‰§è¡Œè¿‡ç¨‹</li>
<li>å¦‚æœä¸»æœºå‡½æ•°å’Œè®¾å¤‡å‡½æ•°è®¡ç®—æ—¶é—´å·®å¾ˆå¤šï¼ŒåŠ é€Ÿæ•ˆæœä¸æ˜¾è‘—</li>
</ul>
<h2 id="11-3-ç”¨éé»˜è®¤CUDAæµé‡å å¤šä¸ªæ ¸å‡½æ•°çš„æ‰§è¡Œ"><a href="#11-3-ç”¨éé»˜è®¤CUDAæµé‡å å¤šä¸ªæ ¸å‡½æ•°çš„æ‰§è¡Œ" class="headerlink" title="11.3 ç”¨éé»˜è®¤CUDAæµé‡å å¤šä¸ªæ ¸å‡½æ•°çš„æ‰§è¡Œ"></a>11.3 ç”¨éé»˜è®¤CUDAæµé‡å å¤šä¸ªæ ¸å‡½æ•°çš„æ‰§è¡Œ</h2><p>åŒä¸€ä¸ªCUDAæµä¸­çš„<strong>CUDAæ“ä½œåœ¨è®¾å¤‡ä¸­æ˜¯é¡ºåºæ‰§è¡Œçš„</strong>(éå¹¶è¡Œ)ï¼Œé‚£ä¹ˆåŒä¸€ä¸ªCUDAæµä¸­çš„<strong>æ ¸å‡½æ•°</strong>ä¹Ÿå¿…é¡»åœ¨è®¾å¤‡ä¸­<strong>é¡ºåºæ‰§è¡Œ</strong>ï¼Œå¦‚æœè¦å®ç°<strong>å¤šä¸ªæ ¸å‡½æ•°ä¹‹é—´çš„å¹¶è¡Œ</strong>å¿…é¡»ä½¿ç”¨<strong>å¤šä¸ªCUDAæµ</strong></p>
<p>æ ¸å‡½æ•°çš„è°ƒåº¦æ–¹å¼<br><code>my_kernel&lt;&lt;&lt;N_grid, N_block&gt;&gt;&gt;();</code> -&gt; åœ¨é»˜è®¤æµæ‰§è¡Œ<br><code>my_kernel&lt;&lt;&lt;N_grid, N_block, N_shared&gt;&gt;&gt;();</code> -&gt; åœ¨é»˜è®¤æµæ‰§è¡Œ<br><code>my_kernel&lt;&lt;&lt;N_grid, N_block, N_shared, stream_id&gt;&gt;&gt;();</code> -&gt; éç©ºæµæ‰§è¡Œ</p>
<ul>
<li><code>N_grid</code>æ˜¯ç½‘æ ¼å¤§å°</li>
<li><code>N_block</code>æ˜¯çº¿ç¨‹å—å¤§å°</li>
<li><code>N_shared</code>æ˜¯æ ¸å‡½æ•°ä¸­ä½¿ç”¨çš„<strong>åŠ¨æ€å…±äº«å†…å­˜</strong>çš„<strong>å­—èŠ‚æ•°</strong></li>
<li><code>stream_id</code>æ˜¯CUDAæµçš„ç¼–å·</li>
</ul>
<p>å¯èƒ½æ˜¯è®¾å¤‡ä¸åŒçš„é—®é¢˜ï¼Œå’Œä¹¦ä¸Šçš„ç»“æœä¸å¤ªä¸€æ ·<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/Pasted%20image%2020240928191804.png?token=GHSAT0AAAAAAC7KAB5GEZXCO6PRYACOM2NYZ6S7PYQ" alt="500"><br>ç»“æœ(ä¹¦ä¸Šçš„)ï¼š<br>CUDAæµå¹¶å‘å¤šä¸ªæ ¸å‡½æ•°å¯ä»¥æå‡GPUç¡¬ä»¶çš„åˆ©ç”¨ç‡ï¼Œå‡å°‘é—²ç½®çš„SMï¼Œä»è€Œä»æ•´ä½“ä¸Šè·å¾—æ€§èƒ½æå‡</p>
<h2 id="11-4-ç”¨éé»˜è®¤CUDAæµé‡å æ ¸å‡½æ•°çš„æ‰§è¡Œä¸æ•°æ®ä¼ é€’"><a href="#11-4-ç”¨éé»˜è®¤CUDAæµé‡å æ ¸å‡½æ•°çš„æ‰§è¡Œä¸æ•°æ®ä¼ é€’" class="headerlink" title="11.4 ç”¨éé»˜è®¤CUDAæµé‡å æ ¸å‡½æ•°çš„æ‰§è¡Œä¸æ•°æ®ä¼ é€’"></a>11.4 ç”¨éé»˜è®¤CUDAæµé‡å æ ¸å‡½æ•°çš„æ‰§è¡Œä¸æ•°æ®ä¼ é€’</h2><p>è‹¥éœ€è¦å®ç°æ ¸å‡½æ•°æ‰§è¡Œä¸æ•°æ®ä¼ è¾“çš„å¹¶å‘(é‡å )</p>
<ul>
<li>å¿…é¡»è®©è¿™ä¸¤ä¸ªæ“ä½œå¤„äºä¸åŒçš„éé»˜è®¤æµ</li>
<li>æ•°æ®ä¼ è¾“éœ€è¦ä½¿ç”¨å¼‚æ­¥ç‰ˆæœ¬<code>cudaMemcpyAsync()</code>å‡½æ•°<ul>
<li>å¼‚æ­¥ä¼ è¾“ç”±GPUä¸­çš„DMA(direct memory access)ç›´æ¥å­˜å‚¨è®¿é—®å™¨ï¼Œä¸éœ€è¦ä¸»æœºå‚ä¸<ul>
<li>DMAæä¾›åœ¨<strong>å¤–è®¾å’Œå­˜å‚¨å™¨ä¹‹é—´</strong>æˆ–è€…<strong>å­˜å‚¨å™¨å’Œå­˜å‚¨å™¨ä¹‹é—´</strong>çš„é«˜é€Ÿæ•°æ®ä¼ è¾“</li>
<li>æ•°æ®çš„å¤åˆ¶å’Œå­˜å‚¨æ•°æ®å¯¹äºCPUæ¥è¯´æ²¡é‚£ä¹ˆé‡è¦ï¼Œå¯ä»¥äº¤ç»™DMAï¼Œè§£å†³å¤§é‡æ•°æ®è½¬ç§»è¿‡åº¦æ¶ˆè€—CPUèµ„æºçš„é—®é¢˜</li>
</ul>
</li>
<li>å¦‚æœç”¨åŒæ­¥çš„æ•°æ®ä¼ è¾“å‡½æ•°<code>cudaMemcpy()</code>ï¼Œä¸»æœºå‘ä¸€ä¸ªæµå‘å‡ºæ•°æ®ä¼ è¾“çš„å‘½ä»¤å<strong>æ— æ³•ç«‹åˆ»è·å¾—æ§åˆ¶æƒ</strong>ï¼Œå¿…é¡»ç­‰å¾…æ•°æ®ä¼ è¾“å®Œæ¯•ï¼Œå³ä¸»æœºæ— æ³•åŒæ—¶å‘å¦ä¸€ä¸ªæµè°ƒç”¨æ ¸å‡½æ•°ï¼Œä¹Ÿå°±ä¸èƒ½å®ç°æ ¸å‡½æ•°ä¸æ•°æ®ä¼ è¾“çš„é‡å </li>
<li><code>cudaMemcpyAsync(void *dst, const void *src, size_t count, enum cudaMemcpyKind kind, cudaStream_t stream)</code>æ¯”<code>cudaMemcpy()</code>å¤šä¸€ä¸ªå‚æ•°ï¼Œæ˜¯æ‰€<strong>åœ¨æµçš„å˜é‡</strong></li>
<li>åœ¨ä½¿ç”¨å¼‚æ­¥çš„æ•°æ®ä¼ è¾“æ—¶ï¼Œéœ€è¦å°†ä¸»æœºå†…å­˜å®šä¹‰ä¸ºä¸å¯åˆ†é¡µå†…å­˜æˆ–è€…å›ºå®šå†…å­˜<ul>
<li>ä¸å¯åˆ†é¡µå†…å­˜ï¼šè‹¥å°†ä¸»æœºå†…å­˜å£°æ˜ä¸ºä¸å¯åˆ†é¡µå†…å­˜ï¼Œåˆ™åœ¨ç¨‹åºè¿è¡ŒæœŸé—´å…¶ç‰©ç†åœ°å€<strong>ä¿æŒä¸å˜</strong></li>
<li>ç³»ç»Ÿæ“ä½œæœ‰æƒåœ¨ä¸€ä¸ªç¨‹åºè¿è¡ŒæœŸé—´æ”¹å˜ç¨‹åºä¸­ä½¿ç”¨çš„<strong>å¯åˆ†é¡µä¸»æœºå†…å­˜</strong>çš„ç‰©ç†åœ°å€</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>ä¸å¯åˆ†é¡µ<strong>ä¸»æœºå†…å­˜</strong>çš„åˆ†é…å‡½æ•°</p>
<ul>
<li><code>cudaMallocHost(void **ptr, size_t size);</code></li>
<li><code>cudaHostAlloc(void **ptr, size_t size, size_t flags);</code>ï¼Œå¦‚æœç¬¬ä¸‰ä¸ªå‚æ•°å–é»˜è®¤å€¼<code>cudaHostAlllocDefault</code>ï¼Œåˆ™å’Œä¸Šé¢çš„å‡½æ•°ç­‰ä»·<br>ä¸å¯åˆ†é¡µ<strong>ä¸»æœºå†…å­˜</strong>çš„é‡Šæ”¾å‡½æ•°</li>
<li><code>cudaFreeHost(void *ptr);</code></li>
</ul>
<p>è¿™é‡Œçš„æ—¶é—´æ˜¯æŠŠå‰å‡ æ¬¡REPEATæ¬¡æ•°çš„æ—¶é—´ä¹ŸåŠ ä¸Šäº†</p>
<table>
<thead>
<tr>
<th></th>
<th>CUDAæµ=1</th>
<th>2</th>
<th>4</th>
<th>8</th>
<th>16</th>
<th>32</th>
<th>64</th>
</tr>
</thead>
<tbody><tr>
<td>REPEATæ¬¡æ•°=1</td>
<td>0.727245</td>
<td>0.813056</td>
<td>0.671984</td>
<td>0.633242</td>
<td>0.640717</td>
<td>0.732979</td>
<td>0.711456</td>
</tr>
<tr>
<td>2</td>
<td>1.48132</td>
<td>1.6044</td>
<td>1.29539</td>
<td>1.25809</td>
<td>1.2987</td>
<td>1.37727</td>
<td>1.40511</td>
</tr>
<tr>
<td>3</td>
<td>2.15654</td>
<td>2.40559</td>
<td>1.94911</td>
<td>1.89739</td>
<td>1.98509</td>
<td>2.0228</td>
<td>2.10539</td>
</tr>
<tr>
<td>4</td>
<td>2.90161</td>
<td>3.17943</td>
<td>2.62284</td>
<td>2.54855</td>
<td>2.64568</td>
<td>2.66245</td>
<td>2.8182</td>
</tr>
<tr>
<td>5</td>
<td>3.5848</td>
<td>3.97385</td>
<td>3.29006</td>
<td>3.16776</td>
<td>3.29783</td>
<td>3.32314</td>
<td>3.53272</td>
</tr>
<tr>
<td>6</td>
<td>4.2719</td>
<td>4.79479</td>
<td>3.97973</td>
<td>3.8308</td>
<td>3.96661</td>
<td>4.00003</td>
<td>4.19064</td>
</tr>
<tr>
<td>7</td>
<td>5.04011</td>
<td>5.60569</td>
<td>4.61964</td>
<td>4.49671</td>
<td>4.65433</td>
<td>4.62836</td>
<td>4.84917</td>
</tr>
<tr>
<td>8</td>
<td>5.90314</td>
<td>6.3983</td>
<td>5.27192</td>
<td>5.15115</td>
<td>5.28048</td>
<td>5.26508</td>
<td>5.52204</td>
</tr>
<tr>
<td>9</td>
<td>6.73892</td>
<td>7.15903</td>
<td>5.94195</td>
<td>5.7894</td>
<td>5.90922</td>
<td>5.90743</td>
<td>6.19399</td>
</tr>
<tr>
<td>10</td>
<td>7.55339</td>
<td>8.02287</td>
<td>6.58859</td>
<td>6.41499</td>
<td>6.53621</td>
<td>6.56247</td>
<td>6.8724</td>
</tr>
</tbody></table>
<p>çœ‹èµ·æ¥å¹¶è¡Œæ•ˆæœæ˜¯è¿˜ä¸é”™çš„ã€‚</p>
<h1 id="ç¬¬åå››ç« -CUDAæ ‡å‡†åº“çš„ä½¿ç”¨"><a href="#ç¬¬åå››ç« -CUDAæ ‡å‡†åº“çš„ä½¿ç”¨" class="headerlink" title="ç¬¬åå››ç«  CUDAæ ‡å‡†åº“çš„ä½¿ç”¨"></a>ç¬¬åå››ç«  CUDAæ ‡å‡†åº“çš„ä½¿ç”¨</h1><h2 id="14-2-Thruståº“"><a href="#14-2-Thruståº“" class="headerlink" title="14.2 Thruståº“"></a>14.2 Thruståº“</h2><ul>
<li>Thruståº“æ˜¯ä¸€ä¸ªå®ç°äº†<strong>ä¼—å¤šåŸºæœ¬å¹¶è¡Œç®—æ³•</strong>çš„C++æ¨¡æ¿åº“</li>
<li>è¯¥åº“ä¸­çš„æ‰€æœ‰ç±»å‹ä¸å‡½æ•°éƒ½åœ¨å‘½åç©ºé—´thrustä¸­å®šä¹‰ï¼Œæ‰€ä»¥ç”¨åˆ°<code>thrust::</code>å¼€å¤´</li>
<li>Thrustä¸­æœ‰ä¸¤ç§çŸ¢é‡ï¼š<ul>
<li><code>thrust::host_vector&lt;typename&gt;</code>ï¼Œå­˜å‚¨äºä¸»æœºä¸­</li>
<li><code>thrust::device_vector&lt;typename&gt;</code>ï¼Œå­˜å‚¨äºè®¾å¤‡ä¸­<ul>
<li><code>thrust::devive_vectot&lt;double&gt; x(10, 0);</code>ï¼Œå…ƒç´ ç±»å‹ä¸ºåŒç²¾åº¦æµ®ç‚¹æ•°(å…¨éƒ¨åˆå§‹åŒ–ä¸º0)ï¼Œé•¿åº¦ä¸º10</li>
</ul>
</li>
</ul>
</li>
<li>é™¤äº†<code>thrust::copy</code>ï¼ŒThrustç®—æ³•çš„å‚æ•°å¿…é¡»<strong>éƒ½</strong>æ¥è‡ªäºä¸»æœºçŸ¢é‡æˆ–<strong>éƒ½</strong>æ¥è‡ªäºè®¾å¤‡çŸ¢é‡ï¼Œå¦åˆ™ç¼–è¯‘å™¨ä¼šæŠ¥é”™</li>
</ul>
<h3 id="14-2-4-ä¾‹å­ï¼šå‰ç¼€å’Œ"><a href="#14-2-4-ä¾‹å­ï¼šå‰ç¼€å’Œ" class="headerlink" title="14.2.4 ä¾‹å­ï¼šå‰ç¼€å’Œ"></a>14.2.4 ä¾‹å­ï¼šå‰ç¼€å’Œ</h3><ol>
<li>ä½¿ç”¨<code>device_vector</code>æ¥å®ç°<pre class="line-numbers language-c" data-language="c"><code class="language-c">thrust<span class="token operator">::</span><span class="token function">device_vector</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token function">x</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
thrust<span class="token operator">::</span><span class="token function">device_vector</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token function">y</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ol>
<ul>
<li>æ‰«ææ“ä½œ<pre class="line-numbers language-c" data-language="c"><code class="language-c">thrust<span class="token operator">::</span><span class="token function">inclusive_scan</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<code>thrust::inclusive_scan(InputIterator begin, InputIterator end, OutputIterator result);</code><br>  <code>InputIterator begin</code> è¾“å…¥èŒƒå›´çš„èµ·å§‹è¿­ä»£å™¨ã€‚<br>  <code>InputIterator end</code>: è¾“å…¥èŒƒå›´çš„ç»“æŸè¿­ä»£å™¨ã€‚<br>  <code>OutputIterator result</code>: ç”¨äºå­˜å‚¨ç»“æœçš„è¾“å‡ºèŒƒå›´èµ·å§‹è¿­ä»£å™¨ã€‚<br>  è¿™é‡Œçš„è¿­ä»£å™¨å¯ä»¥ç†è§£ä¸ºæŒ‡é’ˆçš„æ¨å¹¿<br>ä¾‹å­ä¸­ä½¿ç”¨äº†<code>thrust::inclusive_scan(x.begin(), x.end(), y.begin());</code></li>
<li>è¾“å‡º<br><code>y</code>æ˜¯è®¾å¤‡çŸ¢é‡ï¼Œ<code>y[i]</code>ä¸æ˜¯æ™®é€šæ•´å‹çš„å˜é‡ï¼Œéœ€è¦å¼ºåˆ¶è½¬åŒ–ä¸ºæ•´å‹åæ‰èƒ½ç”¨<code>printf()</code>å‡½æ•°è¾“å‡ºã€‚ç”¨C++çš„è¾“å…¥/è¾“å‡ºæµå¯ä»¥ç›´æ¥è¾“å‡º<code>y[i]</code>è€Œä¸éœ€è¦å…ˆåšå¼ºåˆ¶ç±»å‹è½¬æ¢</li>
</ul>
<ol start="2">
<li>ç›´æ¥ç”¨è®¾å¤‡ä¸­çš„æ•°ç»„(æŒ‡é’ˆ)å®ç°</li>
</ol>
<ul>
<li><p>å®šä¹‰</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token function">cudaMalloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>x<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token operator">*</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">cudaMalloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>y<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token operator">*</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
<li><p>æ‰«ææ“ä½œ</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">thrust<span class="token operator">::</span><span class="token function">inclusive_scan</span><span class="token punctuation">(</span>thrust<span class="token operator">::</span>device<span class="token punctuation">,</span> x<span class="token punctuation">,</span> x <span class="token operator">+</span> N<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>å¯¹äºä½¿ç”¨è®¾å¤‡çŸ¢é‡çš„ç‰ˆæœ¬ï¼Œè¯¥å‡½æ•°ç”¨äº†ä¸€ä¸ªé¢å¤–çš„<strong>è¡¨ç¤ºæ‰§è¡Œç­–ç•¥çš„å‚æ•°</strong><code>thrust::device</code>ï¼Œéœ€è¦åŒ…å«å¤´æ–‡ä»¶<code>&lt;thrust/execution_policy.h&gt;</code></p>
</li>
<li><p>å¦‚æœå¤§é‡ä½¿ç”¨Thruståº“æä¾›çš„åŠŸèƒ½ï¼Œä½¿ç”¨è®¾å¤‡çŸ¢é‡</p>
</li>
<li><p>å¦‚æœå¶å°”ä½¿ç”¨Thruståº“æä¾›çš„åŠŸèƒ½ï¼Œä½¿ç”¨è®¾å¤‡æŒ‡é’ˆ</p>
</li>
</ul>
<h2 id="14-3-cuBLASåº“"><a href="#14-3-cuBLASåº“" class="headerlink" title="14.3 cuBLASåº“"></a>14.3 cuBLASåº“</h2><p>è¡Œä¸»åºå’Œåˆ—ä¸»åºï¼Œå‰è€…è¦æ±‚çŸ©é˜µçš„æ¯ä¸€è¡Œå…ƒç´ åœ¨å†…å­˜ä¸­æ˜¯è¿ç»­çš„ï¼Œåè€…ä»¥æ­¤ç±»æ¨</p>
<p>cuBLASåº“åŒ…å«3ä¸ªAPIï¼Œå…¶ä¸­ä¸€ä¸ªä¸º<code>cuBLAS API</code>ï¼Œå¯ä»¥å®ç°BLASä¸‰ä¸ªå±‚çº§çš„å‡½æ•°</p>
<ul>
<li>ç¬¬ä¸€å±‚å‡½æ•°å¤„ç†çŸ¢é‡ä¹‹é—´çš„è¿ç®—</li>
<li>ç¬¬äºŒå±‚å‡½æ•°å¤„ç†çŸ©é˜µå’ŒçŸ¢é‡ä¹‹é—´çš„è¿ç®—</li>
<li>ç¬¬ä¸‰å±‚å‡½æ•°å¤„ç†çŸ©é˜µä¹‹é—´çš„è¿ç®—</li>
</ul>
<h3 id="14-3-2-ä¾‹å­ï¼šçŸ©é˜µä¹˜æ³•"><a href="#14-3-2-ä¾‹å­ï¼šçŸ©é˜µä¹˜æ³•" class="headerlink" title="14.3.2 ä¾‹å­ï¼šçŸ©é˜µä¹˜æ³•"></a>14.3.2 ä¾‹å­ï¼šçŸ©é˜µä¹˜æ³•</h3><p><img src="https://raw.githubusercontent.com/Wabbybabb0/Note/main/%E5%AD%A6%E4%B9%A0/Infra/CUDA%20C/photo/249b3070465d0ba1c51fff0da2c2ac6.jpg?token=GHSAT0AAAAAAC7KAB5HZYT5A4HHQEF3X7YSZ6S7QAQ" alt="|400"><br>ä½¿ç”¨<code>cuBLAS</code>æ—¶ä½¿ç”¨<code>&lt;cublas_v2.h&gt;</code>ä½œä¸ºå¤´æ–‡ä»¶<br>åœ¨åˆå§‹åŒ–<code>h_A</code>ã€<code>h_B</code>ã€<code>h_C</code>æ—¶ç”¨ä¸€ç»´çŸ¢é‡æ¥è¡¨ç¤ºçŸ©é˜µ</p>
<ol>
<li>ä¸»æœºæ•°ç»„å’Œè®¾å¤‡æ•°ç»„çš„å¤åˆ¶</li>
</ol>
<ul>
<li>ä»ä¸»æœºæ•°ç»„å¤åˆ¶åˆ°è®¾å¤‡æ•°ç»„<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token class-name">cublasStatus_t</span> <span class="token function">cublasSetVector</span>
<span class="token punctuation">(</span>
	<span class="token keyword">int</span> n<span class="token punctuation">,</span>
	<span class="token keyword">int</span> elemSize<span class="token punctuation">,</span>
	cosnt <span class="token keyword">void</span> <span class="token operator">*</span>x<span class="token punctuation">,</span>
	<span class="token keyword">int</span> incx<span class="token punctuation">,</span>
	<span class="token keyword">void</span> <span class="token operator">*</span>y<span class="token punctuation">,</span>
	<span class="token keyword">int</span> incy
<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<code>n</code>ï¼šå¤åˆ¶çš„å…ƒç´ ä¸ªæ•°<br><code>elemSize</code>ï¼šæ¯ä¸ªå…ƒç´ çš„å­—èŠ‚æ•°<br><code>incx</code>/<code>incy</code>ï¼šè¡¨ç¤ºå¯¹æ•°ç»„x/yè¿›è¡Œè®¿é—®æ—¶æ¯incx/incyä¸ªæ•°æ®ä¸­å–ä¸€ä¸ª<br><code>x</code>ï¼šä¸»æœºæ•°ç»„<br><code>y</code>ï¼šè®¾å¤‡æ•°ç»„<br>ä¾‹ï¼š<code>cublasSetVector(MK, sizeof(double), h_A, 1, g_A, 1);</code></li>
<li>ä»è®¾å¤‡æ•°ç»„å¤åˆ¶åˆ°ä¸»æœºæ•°ç»„<br><code>cublasGetVector()</code>å…¶ä¸­å‚æ•°ç›¸åŒï¼Œé¡ºåºä¸åŒ<br>ä¾‹ï¼š<code>cublasGetVector(MK, sizeof(double), g_A, 1, h_A, 1);</code></li>
</ul>
<ol start="2">
<li>çŸ©é˜µä¹˜æ³•è®¡ç®—</li>
</ol>
<ul>
<li>å®šä¹‰ä¸€ä¸ª<code>cublasHandle</code>ç±»å‹çš„å˜é‡å¹¶ç”¨<code>cublasCreate()</code>å‡½æ•°åˆå§‹åŒ–</li>
<li>è°ƒç”¨<code>cublasDgemm()</code>å‡½æ•°åšçŸ©é˜µç›¸ä¹˜çš„è®¡ç®—<ul>
<li>æ˜¯ç¬¬ä¸‰å±‚çš„<code>cuBLAS</code>å‡½æ•°ä¹‹ä¸€</li>
<li><code>D</code>ï¼šdouble</li>
<li><code>gemm</code>ï¼šGEneral Matrix-Matrix multiplication</li>
<li>æ‰§è¡Œå¦‚ä¸‹è®¡ç®—<code>C = alpha * transa(A) * transb(B) + beta * C</code><ul>
<li><code>transa(A)</code>æ˜¯å¯¹çŸ©é˜µ<code>A</code>åšä¸€ä¸ªå˜æ¢ä¹‹åå¾—åˆ°çš„çŸ©é˜µï¼Œç»´åº¦æ˜¯<code>m Ã— k</code></li>
<li><code>transb(B)</code>æ˜¯å¯¹çŸ©é˜µ<code>B</code>åšä¸€ä¸ªå˜æ¢ä¹‹åå¾—åˆ°çš„çŸ©é˜µï¼Œç»´åº¦æ˜¯<code>k Ã— n</code></li>
<li><code>C</code>çš„ç»´åº¦æ˜¯<code>m Ã— n</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token function">cublasDgemm</span>
<span class="token punctuation">(</span>
	<span class="token class-name">cublasHandle_t</span> handle<span class="token punctuation">,</span>
	<span class="token class-name">cublasOperation_t</span> transa<span class="token punctuation">,</span>
	<span class="token class-name">cublasOperation_t</span> transb<span class="token punctuation">,</span>
	<span class="token keyword">int</span> m<span class="token punctuation">,</span>
	<span class="token keyword">int</span> n<span class="token punctuation">,</span>
	<span class="token keyword">int</span> k<span class="token punctuation">,</span>
	<span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">*</span>alpha<span class="token punctuation">,</span>
	<span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">*</span>A<span class="token punctuation">,</span>
	<span class="token keyword">int</span> lda<span class="token punctuation">,</span>
	<span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">*</span>B<span class="token punctuation">,</span>
	<span class="token keyword">int</span> ldb<span class="token punctuation">,</span>
	<span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">*</span>beta<span class="token punctuation">,</span>
	<span class="token keyword">double</span> <span class="token operator">*</span>C<span class="token punctuation">,</span>
	<span class="token keyword">int</span> ldc
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>cublasOperation_t transa</code>ä¸­<code>transa</code>ä¸ºï¼š</p>
<ul>
<li><code>cuBLAS_OP_N</code>ï¼Œ<code>transa(A)</code>ç­‰äº<code>A</code></li>
<li><code>cuBLAS_OP_T</code>ï¼Œ<code>transa(A)</code>ç­‰äº<code>A</code>çš„è½¬ç½®</li>
<li><code>cuBLAS_OP_C</code>ï¼Œ<code>transa(A)</code>ç­‰äº<code>A</code>çš„å…±è½­è½¬ç½®<br><code>lda</code>ã€<code>ldb</code>å’Œ<code>ldc</code>åˆ†åˆ«æ˜¯<code>transa(A)</code>ã€<code>transa(B)</code>å’Œ<code>C</code>çš„ä¸»ç»´åº¦ï¼Œä»–ä»¬éƒ½æ˜¯åˆ—ä¸»åºï¼Œæ‰€ä»¥ä»–ä»¬çš„ä¸»ç»´åº¦æ˜¯çŸ©é˜µçš„è¡Œæ•°</li>
</ul>
<p>æœ€åçš„ç»“æœ<code>h_C</code>æ˜¯åˆ—ä¸»åºçš„(10 13 28 40)ï¼Œæ‰“å°æ—¶éœ€è¦æ³¨æ„</p>
<h1 id="è¡¥å……Event"><a href="#è¡¥å……Event" class="headerlink" title="è¡¥å……Event"></a>è¡¥å……Event</h1><ul>
<li><strong>åˆ›å»ºäº‹ä»¶</strong>ï¼šé¦–å…ˆä½¿ç”¨ <code>cudaEventCreate()</code> åˆ›å»ºäº‹ä»¶å¯¹è±¡ã€‚</li>
<li><strong>è®°å½•äº‹ä»¶</strong>ï¼šåœ¨éœ€è¦è®°å½•çš„æ—¶é—´ç‚¹è°ƒç”¨ <code>cudaEventRecord(event, stream)</code>ã€‚</li>
<li><strong>è®¡ç®—æ—¶é—´</strong>ï¼šé€šè¿‡ <code>cudaEventElapsedTime()</code> è®¡ç®—ä¸¤ä¸ªäº‹ä»¶ä¹‹é—´çš„æ—¶é—´å·®ã€‚</li>
<li><strong>é”€æ¯äº‹ä»¶</strong>ï¼šæœ€åä½¿ç”¨ <code>cudaEventDestroy()</code> é”€æ¯äº‹ä»¶å¯¹è±¡ä»¥é‡Šæ”¾èµ„æºã€‚</li>
<li><strong>åŒæ­¥</strong>ï¼š<code>cudaEventSynchronize(stop)</code> ä¼šé˜»å¡ CPUï¼Œç›´åˆ° GPU ç¡®ä¿ä» <code>start</code> åˆ° <code>stop</code> ä¹‹é—´çš„æ‰€æœ‰æ“ä½œéƒ½å®Œæˆäº†ã€‚è¿™å¯¹äºæµ‹é‡å†…æ ¸å‡½æ•°æ‰§è¡Œæ—¶é—´æˆ–åœ¨ CPU ä¾§è¿›è¡ŒåŒæ­¥éå¸¸é‡è¦ã€‚</li>
<li><strong>æ£€æŸ¥äº‹ä»¶æ˜¯å¦å®Œæˆ</strong>ï¼š<code>cudaEventQuery(start)</code>å®ƒçš„ä¸»è¦åŠŸèƒ½æ˜¯<strong>æ£€æŸ¥æŒ‡å®šçš„ CUDA äº‹ä»¶æ˜¯å¦å·²ç»å®Œæˆ</strong>ï¼Œè€Œä¸éœ€è¦é˜»å¡ä¸»æœºçº¿ç¨‹ã€‚<code>cudaEventQuery</code> å¸¸ç”¨äºéœ€è¦é¢‘ç¹æ£€æŸ¥äº‹ä»¶çŠ¶æ€çš„åœºæ™¯ã€‚å’Œ <code>cudaEventSynchronize</code> ä¸åŒï¼Œ<code>cudaEventQuery</code> æ˜¯éé˜»å¡çš„ï¼Œä¸ä¼šè®© CPU ç­‰å¾… GPU ä»»åŠ¡å®Œæˆï¼Œè€Œåªæ˜¯æ£€æŸ¥ GPU çš„æ‰§è¡ŒçŠ¶æ€ã€‚å¦‚æœäº‹ä»¶è¿˜æœªå®Œæˆï¼Œå®ƒä¼šç«‹å³è¿”å› <code>cudaErrorNotReady</code>ï¼Œè®©ç¨‹åºå¯ä»¥ç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡ã€‚</li>
</ul>
<h1 id="è¡¥å……è¿è¡Œ"><a href="#è¡¥å……è¿è¡Œ" class="headerlink" title="è¡¥å……è¿è¡Œ"></a>è¡¥å……è¿è¡Œ</h1><p><code>$nvcc -arch=_75 add1.cu -o add1</code>ï¼Œé€‰æ‹©çœŸå®æ¶æ„è®¡ç®—èƒ½åŠ›<br><code>$nvcc -O3 -arch=_75 add1.cu -o add1</code>ï¼Œé€‰æ‹©æœ€æ¿€è¿›çš„ä¼˜åŒ–ï¼Œç”Ÿæˆæœ€å¿«çš„ä»£ç ï¼Œä½†å¯èƒ½ä¼šå¢åŠ ç¼–è¯‘æ—¶é—´å’ŒäºŒè¿›åˆ¶æ–‡ä»¶å¤§å°ã€‚(C++ç¨‹åºçš„æ€§èƒ½æ˜¾è‘—åœ°ä¾èµ–äºä¼˜åŒ–é€‰é¡¹)<br><code>$nvcc -O3 -arch=sm_75 -DUSE_DP add1.cu -o add1</code>ä½¿ç”¨<code>if</code>çš„é€‰é¡¹ï¼Œä¸å†™<code>-DUSE_DP</code>çš„è¯ä½¿ç”¨<code>else</code>çš„é€‰é¡¹</p>
<h1 id="è¡¥å……C-è¯­æ³•"><a href="#è¡¥å……C-è¯­æ³•" class="headerlink" title="è¡¥å……C++è¯­æ³•"></a>è¡¥å……C++è¯­æ³•</h1><p><code>void read_xy(std::vector&lt;real&gt;&amp; x, std::vector&lt;real&gt; y);</code>ï¼š</p>
<ul>
<li><code>std::vector</code>ï¼šC++çš„åŠ¨æ€æ•°ç»„ï¼Œå¤§å°æ˜¯åŠ¨æ€çš„</li>
<li><code>std::vector&lt;real&gt;&amp; x</code>ï¼šå¯¹äº<code>x</code>æ˜¯å¼•ç”¨ä¼ é€’ï¼Œåœ¨<code>read_xy</code>å‡½æ•°å†…éƒ¨å¯¹<code>x</code>çš„ä»»ä½•ä¿®æ”¹ï¼Œéƒ½ä¼šç›´æ¥å½±å“åˆ°ä»–ä»¬æœ¬èº«(è€Œä¸æ˜¯å‰¯æœ¬)ï¼Œå¯¹å¤–éƒ¨çš„<code>x</code>ä¹Ÿä¼šæœ‰å½±å“</li>
</ul>
<p><code>std::ifstream infile("xy.txt");</code></p>
<ul>
<li><code>std::ifstream</code>ï¼šè¡¨ç¤ºè¾“å…¥æ–‡ä»¶æµï¼Œç”¨äºä»æ–‡ä»¶è¯»å–æ•°æ®</li>
<li><code>infile</code>ï¼šç”¨æ¥æ‰“å¼€æ–‡ä»¶å¹¶è¯»å–å†…å®¹</li>
</ul>
<p><code>std::ofstream outfile("neighbor.txt");</code></p>
<ul>
<li><code>std::ofstream</code>ï¼šè¡¨ç¤ºè¾“å‡ºæ–‡ä»¶æµï¼Œå°†æ•°æ®å†™å…¥åˆ°æ–‡ä»¶ä¸­</li>
</ul>
<p><code>std::istringstream words(line);</code></p>
<ul>
<li><code>std::istringstream</code>ï¼šè¡¨ç¤ºè¾“å…¥å­—ç¬¦ä¸²æµï¼Œå¯ä»¥ä»ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­é€ä¸ªæå–æ•°æ®</li>
<li><code>words</code>ï¼šä»å­—ç¬¦ä¸²ä¸­æå–æ•°æ®</li>
<li>è¿™æ®µä»£ç ä½œç”¨ï¼šä½¿ç”¨<code>words</code>æ¥é€ä¸ªè¯»å–<code>line</code>ä¸­çš„å•è¯æˆ–æ•°æ®</li>
</ul>
]]></content>
      <categories>
        <category>é«˜æ€§èƒ½å¤„ç†</category>
      </categories>
      <tags>
        <tag>CUDA</tag>
        <tag>GPU</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸²å£é€šä¿¡</title>
    <url>/2022/10/11/chuan-kou-tong-xin/</url>
    <content><![CDATA[<h1 id="ä¸²å£é€šä¿¡"><a href="#ä¸²å£é€šä¿¡" class="headerlink" title="ä¸²å£é€šä¿¡"></a>ä¸²å£é€šä¿¡</h1><p><img src="/../../../../medias/blog_picture/51/32.png" alt="ç¡¬ä»¶ç”µè·¯"></p>
<h3 id="ç”µå¹³æ ‡å‡†"><a href="#ç”µå¹³æ ‡å‡†" class="headerlink" title="ç”µå¹³æ ‡å‡†"></a>ç”µå¹³æ ‡å‡†</h3><p>TTLï¼š+5Vè¡¨ç¤º1ï¼Œ0Vè¡¨ç¤º0</p>
<p><img src="E:\Users\Wabby\AppData\Roaming\Typora\typora-user-images\1665028662515.png" alt="1665028662515"></p>
<p>å¼‚æ­¥ï¼šAå‘äº†1sçš„1å’Œ1sçš„0ï¼Œé‚£Bå°±å¯ä»¥è¿ç»­ä¸¤æ¬¡0.5så‘1å’Œä¸¤æ¬¡0.5sçš„0</p>
<p><img src="/../../../../medias/blog_picture/51/33.png"></p>
<p><img src="/../../../../medias/blog_picture/51/34.png" alt="ä¸²å£å‚æ•°åŠæ—¶åºå›¾"></p>
<h3 id="æ£€éªŒä½-9ä½"><a href="#æ£€éªŒä½-9ä½" class="headerlink" title="æ£€éªŒä½(9ä½)"></a>æ£€éªŒä½(9ä½)</h3><p>å¥‡æ ¡éªŒ</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//æ”¶ï¼š0000 0011 1</span>
<span class="token comment">//å‘ï¼š0000 0011 1</span>
<span class="token comment">//ä½†æ˜¯å¦‚æœæ˜¯0000 1010 1å°±ä¹Ÿä¼šè¡¥1ï¼Œæ’é”™ç‡ä¸é«˜</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//æ”¶ï¼š1110 0000 0</span>
<span class="token comment">//å‘ï¼š1100 0000 0</span>
<span class="token comment">//è¿™æ—¶å°±æ˜¯é”™è¯¯çš„ï¼Œè¯´æ˜æ•°æ®å‡ºäº†é—®é¢˜</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>





<p><img src="/../../../../medias/blog_picture/51/35.png" alt="ä¸²å£æ¨¡å¼å›¾"></p>
<p>ä¸­é—´åœˆèµ·æ¥é‚£å—æ˜¯æ§åˆ¶æ³¢ç‰¹ç‡çš„</p>
<p>å‘é€å¯„å­˜å™¨ï¼š X=SBUF</p>
<p>æ¥æ”¶å¯„å­˜å™¨ï¼šSBUF=X</p>
<h2 id="é€šä¿¡åˆå®ç°"><a href="#é€šä¿¡åˆå®ç°" class="headerlink" title="é€šä¿¡åˆå®ç°"></a>é€šä¿¡åˆå®ç°</h2><p><strong>16ä½å®šæ—¶å™¨/è®¡æ—¶å™¨</strong>å’Œ<strong>8ä½è‡ªåŠ¨é‡è£…è½½</strong>çš„åŒºåˆ«</p>
<p>å°±æ˜¯åå…­ä½è®°çš„æ•°å¤šï¼Œä½†æ¯æ¬¡éƒ½éœ€è¦è‡ªå·±å†™çš„ä»£ç èµ‹åˆå€¼ï¼Œæµªè´¹æ—¶é—´ã€‚åŒå…«ä½å°±æ˜¯å°†åå…­ä½åˆ†å¼€ï¼Œä¸€ä¸ªè®¡æ•°ï¼Œå¦ä¸€ä¸ªå­˜æ”¾åˆå€¼ï¼Œæ¯æ¬¡è®¡æ•°å®ŒæˆåARä¼šè‡ªåŠ¨å°†å€¼èµ‹ç»™CNTï¼Œä¸ç”¨ä»£ç å¤„ç†ï¼Œæ¯”è¾ƒå¿«ï¼Œä½†åªæœ‰å…«ä½æ‰€ä»¥è®°çš„æ•°å°‘äº†ã€‚</p>
<h3 id="ä¸Šä»£ç "><a href="#ä¸Šä»£ç " class="headerlink" title="ä¸Šä»£ç "></a>ä¸Šä»£ç </h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Delay.h"</span></span>

<span class="token keyword">void</span> <span class="token function">UART_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//4800bps@11.0592MHz</span>
<span class="token punctuation">{</span>
	<span class="token comment">//ä¸²å£éƒ¨åˆ†</span>
	SCON <span class="token operator">=</span> <span class="token number">0x40</span><span class="token punctuation">;</span>		<span class="token comment">//8ä½æ•°æ®,å¯å˜æ³¢ç‰¹ç‡</span>
	PCON <span class="token operator">&amp;=</span> <span class="token number">0x7F</span><span class="token punctuation">;</span>	
	<span class="token comment">//å®šæ—¶å™¨1éƒ¨åˆ†ï¼ŒT1æ˜¯ä¸²å£ä¸“ç”¨çš„å®šæ—¶å™¨</span>
	TMOD <span class="token operator">&amp;=</span> <span class="token number">0x0F</span><span class="token punctuation">;</span>		<span class="token comment">//è®¾ç½®å®šæ—¶å™¨æ¨¡å¼</span>
	TMOD <span class="token operator">|=</span> <span class="token number">0x20</span><span class="token punctuation">;</span>		<span class="token comment">//è®¾ç½®å®šæ—¶å™¨æ¨¡å¼</span>
	TL1 <span class="token operator">=</span> <span class="token number">0xFA</span><span class="token punctuation">;</span>		<span class="token comment">//è®¾å®šå®šæ—¶åˆå€¼</span>
	TH1 <span class="token operator">=</span> <span class="token number">0xFA</span><span class="token punctuation">;</span>		<span class="token comment">//è®¾å®šå®šæ—¶å™¨é‡è£…å€¼</span>
	ET1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>		<span class="token comment">//ç¦æ­¢å®šæ—¶å™¨1ä¸­æ–­</span>
	TR1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>		<span class="token comment">//å¯åŠ¨å®šæ—¶å™¨1</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">UART_SendByte</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> Byte<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	SBUF<span class="token operator">=</span>Byte<span class="token punctuation">;</span><span class="token comment">//SBUFå†™å…¥,è¢«èµ‹å€¼</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>TI<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æœ¬æ¥TI=0ï¼Œä½†æ˜¯åœ¨æ•°æ®ä¼ è¾“å®Œæˆä¹‹åä¸²å£ä¼šè‡ªåŠ¨å°†1èµ‹ç»™TI,å› æ­¤éœ€è¦è½¯ä»¶è¿›è¡Œå¤ä½ã€‚</span>
	TI<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//è½¯ä»¶å¤ä½</span>
	
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">UART_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">UART_SendByte</span><span class="token punctuation">(</span><span class="token number">0x11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="â‘ ä¸²å£éƒ¨åˆ†SCON-serial-control-PCON-power-control"><a href="#â‘ ä¸²å£éƒ¨åˆ†SCON-serial-control-PCON-power-control" class="headerlink" title="â‘ ä¸²å£éƒ¨åˆ†SCON(serial control)&amp;PCON(power control)"></a>â‘ ä¸²å£éƒ¨åˆ†SCON(serial control)&amp;PCON(power control)</h4><p><img src="/../../../../medias/blog_picture/51/36.png"></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">SCON <span class="token operator">=</span> <span class="token number">0x40</span><span class="token punctuation">;</span>		<span class="token comment">//8ä½æ•°æ®,å¯å˜æ³¢ç‰¹ç‡</span>
PCON <span class="token operator">&amp;=</span> <span class="token number">0x7F</span><span class="token punctuation">;</span>	<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>



<h5 id="SM0-SM1"><a href="#SM0-SM1" class="headerlink" title="SM0&amp;SM1"></a>SM0&amp;SM1</h5><p><img src="/../../../../medias/blog_picture/51/37.png"></p>
<p><img src="/../../../../medias/blog_picture/51/38.png"></p>
<p><strong>RENç»™0/1éƒ½å¯ä»¥</strong></p>
<p><img src="/../../../../medias/blog_picture/51/39.png"></p>
<p><img src="/../../../../medias/blog_picture/51/40.png"></p>
<p><strong>SM2ï¼ŒTB8ï¼ŒRB8è·Ÿæ¨¡å¼1æ— å…³ï¼Œç»™0</strong></p>
<p><img src="/../../../../medias/blog_picture/51/41.png"></p>
<p>å°±æ˜¯å‘é€ç»“æŸåï¼Œç¡¬ä»¶ç»™T1ç½®1ï¼Œè¡¨ç¤ºå‘é€å®Œäº†ï¼Œç„¶åè¯·æ±‚ä¸­æ–­çš„æ—¶å€™TI=0ï¼Œå¿…é¡»ç”¨è½¯ä»¶å¤ä½æ˜¯æŒ‡è¦äººä¸ºåœ¨è½¯ä»¶ä¸­ä½¿TI=1																																												</p>
<p><strong>TI=0</strong> â€”å‘é€â€“å®Œæ¯•â€”-ç¡¬ä»¶â€“&gt; <strong>T1=1</strong> â€“è¯·æ±‚ä¸­æ–­â€“&gt; <strong>TI=1</strong> â€“ä¸»æœºå“åº”ä¸­æ–­â€”-è½¯ä»¶å¤ä½&gt; <strong>TI=0</strong></p>
<p>TIæœ€å¼€å§‹ä¸º0</p>
<p><img src="/../../../../medias/blog_picture/51/42.png"></p>
<p>å¯¹RIçš„ç†è§£å’ŒTIä¸€æ ·</p>
<p><strong>æ‰€ä»¥SCON=0100 0000 â€“&gt; 0x40</strong></p>
<h4 id="â‘¡PCONï¼Œç”¨æ³¢ç‰¹ç‡è®¡ç®—æå‡ºæ¥çš„"><a href="#â‘¡PCONï¼Œç”¨æ³¢ç‰¹ç‡è®¡ç®—æå‡ºæ¥çš„" class="headerlink" title="â‘¡PCONï¼Œç”¨æ³¢ç‰¹ç‡è®¡ç®—æå‡ºæ¥çš„"></a>â‘¡PCONï¼Œç”¨æ³¢ç‰¹ç‡è®¡ç®—æå‡ºæ¥çš„</h4><h3 id="å®šæ—¶å™¨éƒ¨åˆ†"><a href="#å®šæ—¶å™¨éƒ¨åˆ†" class="headerlink" title="å®šæ—¶å™¨éƒ¨åˆ†"></a>å®šæ—¶å™¨éƒ¨åˆ†</h3><p>è¦æ”¹ä¸ºå®šæ—¶å™¨1</p>
<p><img src="/../../../../medias/blog_picture/51/43.png"></p>
<p><img src="/../../../../medias/blog_picture/51/44.png"></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">TMOD <span class="token operator">&amp;=</span> <span class="token number">0x0F</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span> <span class="token number">0000</span> <span class="token number">1111</span>		
TMOD <span class="token operator">|=</span> <span class="token number">0x20</span><span class="token punctuation">;</span>    <span class="token operator">|</span> <span class="token number">0010</span> <span class="token number">0000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>



<h3 id="å°å°é—®é¢˜"><a href="#å°å°é—®é¢˜" class="headerlink" title="å°å°é—®é¢˜"></a>å°å°é—®é¢˜</h3><p>å½“æˆ‘æŠŠä¸‹é¢è¿™ä¸²</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">UART_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">UART_SendByte</span><span class="token punctuation">(</span><span class="token number">0x11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ”¹æˆ</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">UART_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">UART_SendByte</span><span class="token punctuation">(</span><span class="token number">0x11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“ä¸º0x11æ—¶æ­£å¸¸ä¸”ä¸æ–­è¾“å‡º11ï¼Œå½“ä¸º0x66æ—¶å¼‚å¸¸ä¸”ä¸æ–­è¾“å‡º96ï¼Œæ˜¯å› ä¸ºæ³¢ç‰¹ç‡çš„è¯¯å·®ï¼Œæ­¤æ—¶æˆ‘ä»¬è®©å®ƒç¿»æ…¢ç‚¹å°±å¯ä»¥æ­£å¸¸è¾“å‡ºäº†(è®©ä»–ç¨³å®šç‚¹)</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">UART_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">UART_SendByte</span><span class="token punctuation">(</span><span class="token number">0x11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è®©ä»–æ…¢æ…¢ç¿»</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<p><img src="/../../../../medias/blog_picture/51/45.png" alt="ä¸²å£å’Œä¸­æ–­ç³»ç»Ÿ"></p>
<p>æˆ‘ä»¬è¦å¯ç”¨ä¸²å£ä¸­æ–­ï¼Œè€Œä¸æ˜¯å®šæ—¶å™¨ä¸­æ–­ï¼Œå®šæ—¶å™¨ä¸­æ–­æ˜¯åˆ°ç‚¹äº†å°±ä¸­æ–­ï¼Œä¸²å£ä¸­æ–­æ˜¯æœ‰æ•°æ®è¿‡æ¥ä¸­æ–­ï¼Œæ‰€ä»¥è¦é…ç½®å®šæ—¶å™¨ä¸ä¸­æ–­å³ET1ç­‰äº0ï¼Œç„¶åå¼€å¯ä¸²å£ä¸­æ–­</p>
<h2 id="ä¸­æ–­æœåŠ¡å‡½æ•°"><a href="#ä¸­æ–­æœåŠ¡å‡½æ•°" class="headerlink" title="ä¸­æ–­æœåŠ¡å‡½æ•°"></a>ä¸­æ–­æœåŠ¡å‡½æ•°</h2><p>æ¨¡æ¿</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">UART_Rountine</span><span class="token punctuation">(</span><span class="token punctuation">)</span> interrupt <span class="token number">4</span><span class="token comment">//ä¸­æ–­æœåŠ¡å­å‡½æ•°</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>RI<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		
		RI<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¾‹å­</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">UART_Rountine</span><span class="token punctuation">(</span><span class="token punctuation">)</span> interrupt <span class="token number">4</span><span class="token comment">//ä¸­æ–­æœåŠ¡å­å‡½æ•°</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>RI<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">//åŒºåˆ†å‘é€å’Œæ¥æ”¶ï¼Œå‘é€å’Œæ¥æ”¶éƒ½ä¼šè§¦å‘ä¸­æ–­</span>
			 <span class="token comment">//è€Œä¸”äºŒè€…å ç”¨åŒä¸€ä¸ªé€šé“ï¼Œå†™è¿™ä¸ªæ˜¯ä¸ºäº†åˆ¤æ–­ï¼Œç„¶åæŠŠå‘é€å’Œæ¥å—åˆ†å¼€</span>
	<span class="token punctuation">{</span>
		P2<span class="token operator">=</span><span class="token operator">~</span>SBUF<span class="token punctuation">;</span>
		<span class="token function">UART_SendByte</span><span class="token punctuation">(</span>SBUF<span class="token punctuation">)</span><span class="token punctuation">;</span>
		RI<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="ç®—æ³¢ç‰¹ç‡"><a href="#ç®—æ³¢ç‰¹ç‡" class="headerlink" title="ç®—æ³¢ç‰¹ç‡"></a>ç®—æ³¢ç‰¹ç‡</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c">TL1 <span class="token operator">=</span> <span class="token number">0xFA</span><span class="token punctuation">;</span>		<span class="token comment">//è®¾å®šå®šæ—¶åˆå€¼</span>
TH1 <span class="token operator">=</span> <span class="token number">0xFA</span><span class="token punctuation">;</span>		<span class="token comment">//è®¾å®šå®šæ—¶å™¨é‡è£…å€¼</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>FAâ€“16è½¬10â€“&gt; 250</p>
<p>é‚£ä¹ˆä¸€ä¸ªTL1/TH1å¯¹åº”8byteï¼Œä¹Ÿå°±æ˜¯256ï¼Œå®šæ—¶å™¨æ¯éš”256-250=6Âµsæº¢å‡ºä¸€æ¬¡(æ¯è®¡6ä¸ªæ•°å°±æº¢å‡ºä¸€æ¬¡)ï¼Œ11.0529MHzæ™¶æŒ¯å¯¹åº”12Tæ¨¡å¼ä¸‹çš„0.924Âµsè®¡æ•°ä¸€æ¬¡</p>
<p>æº¢å‡ºçš„é¢‘ç‡=0.924/6=0.154MHz</p>
<p>0.154MHz/16=0.009625MHz</p>
<p>0.009625Ã—1000Ã—1000=9625ï¼Ÿ<strong>åº”è¯¥æ˜¯æ¥è¿‘4800çš„æ‰å¯¹</strong>â€¦â€¦â€¦upä¸»ç”¨çš„12MHzæ¥ç®—ï¼Œç®—åˆ°äº†4807</p>
]]></content>
      <categories>
        <category>51å•ç‰‡æœº</category>
      </categories>
      <tags>
        <tag>51å•ç‰‡æœº</tag>
        <tag>å¤§äº‘å±‹è€ƒæ ¸</tag>
      </tags>
  </entry>
  <entry>
    <title>æ“ä½œç¬¦</title>
    <url>/2023/01/13/cao-zuo-fu/</url>
    <content><![CDATA[<h2 id="ä¸€-æ“ä½œç¬¦"><a href="#ä¸€-æ“ä½œç¬¦" class="headerlink" title="ä¸€.æ“ä½œç¬¦"></a>ä¸€.æ“ä½œç¬¦</h2><p><strong>æ“ä½œç¬¦å‡½æ•°æ˜¯æ–¹æ³•å‡½æ•°çš„ç®€è®°æ³•</strong></p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">namespace CreatOperator
{
    class Program
    {
        static void Main(string[] args)
        {
            Person person1 = new Person();
            Person person2 = new Person();
            person1.Name = "Deer";
            person2.Name = "Deer's wife";
            List&lt;Person&gt; nation = Person.GetMarry(person1,person2);
            //ä¸Šé¢è¿™è¡Œæ”¹æˆ
            //List&lt;Person&gt; nation = person1 + person2;

            foreach (var p in nation)
            {
                Console.WriteLine(p.Name);
            }
        }
    }
    
    class Person
    {
        public string Name;

        public static List&lt;Person&gt;GetMarry(Person p1,Person p2)
        //ä¸Šé¢è¿™è¡Œæ”¹æˆ public static List&lt;Person&gt; operator+(Person p1,Person p2)
        {
            List&lt;Person&gt; people = new List&lt;Person&gt;();
            people.Add(p1);
            people.Add(p2);
            for (int i = 0; i &lt; 11; i++)
            {
                Person child = new Person();
                child.Name = p1.Name + "&amp;" + p2.Name + "s child";
                people.Add(child);
            }
            return people;
        }
    }
}

//ä¸¤ç§æ–¹æ³•çš„ç»“æœä¸€æ ·<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åªæœ‰åœ†æ‹¬å·æ¥æé«˜ä¼˜å…ˆçº§</p>
<h4 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h4><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">int[] myIntArray = new int[]{};//[]å¡«æ•°ç»„å¤§å°ï¼Œ{}(åˆå§‹åŒ–å™¨)å¡«å…·ä½“æ•°å€¼<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h4 id="typeof"><a href="#typeof" class="headerlink" title="typeof"></a>typeof</h4><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">Type t = typeof(int);
Console.WriteLine(t.Namespace);
Console.WriteLine(t.FullName);
Console.WriteLine(t.Name);
/**
System
System.Int32
Int32
*/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="default"><a href="#default" class="headerlink" title="default"></a>default</h4><p>è·å–ä¸€ä¸ªç±»å‹çš„é»˜è®¤å€¼</p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">int x = default(int);
Console.WriteLine(x);
//0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">Form myForm = default(Form);
Console.WriteLine(myForm==null);
//true<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">class Program
{
	static void Main(string[] args)
    {
        Level level = default(Level);
        Console.WriteLine(level);
    }
}
//â‘ 
enum Level
{
	Low,
	Mid,
	High
}
//Low

//â‘¡
enum Level
{
	Mid,
	Low,
	High
}
//Mid

//â‘¢
enum Level
{
	Mid = 1,
	Low = 0,
	High = 2
}
//Low

//â‘£
enum Level
{
	Low = 1,
	Mid = 2,
	High = 3
}
//0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="var"><a href="#var" class="headerlink" title="var"></a>var</h4><p>å£°æ˜éšå¼ç±»å‹å˜é‡</p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">int x = 100;//æ˜¾å¼

var y = 100;//éšå¼	æ ¹æ®èµ‹çš„å€¼â€œ100â€æ¥ç»™yåˆ¤æ–­ç±»å‹
Console.WriteLine(y.GetType().Name);
//Int32<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="new"><a href="#new" class="headerlink" title="new"></a>new</h4><ul>
<li>è°ƒç”¨å®ä¾‹æ„é€ å™¨</li>
</ul>
<p>å¸®åŠ©æˆ‘ä»¬åœ¨å†…å­˜å½“ä¸­<code>åˆ›å»ºç±»å‹çš„å®ä¾‹</code></p>
<p>æœ‰<code>()</code>æ—¶è¡¨ç¤º<code>è°ƒç”¨å®ƒçš„å®ä¾‹æ„é€ å™¨</code></p>
<p>å¦‚æœåœ¨newæ“ä½œç¬¦<code>å·¦è¾¹æœ‰èµ‹å€¼ç¬¦å·</code>çš„è¯ï¼Œé‚£ä¹ˆnewæ“ä½œç¬¦ä¼šæŠŠè‡ªå·±æ‹¿åˆ°çš„è¿™ä¸ª<code>å®ä¾‹çš„å†…å­˜åœ°å€</code>é€šè¿‡<code>èµ‹å€¼æ“ä½œç¬¦</code>äº¤ç»™è´Ÿè´£è®¿é—®è¿™ä¸ªå®ä¾‹çš„<code>å˜é‡</code></p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">Form myForm = new Form();
//myFormä¸ºè¯¥å®ä¾‹çš„å˜é‡<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>è°ƒç”¨å®ä¾‹çš„åˆå§‹åŒ–å™¨</li>
</ul>
<p>èŠ±æ‹¬å·<code>{}</code>å†…å¯ä»¥ä¸ºè¿™ä¸ªå®ä¾‹çš„å±æ€§è®¾ç½®å®ƒçš„å€¼ï¼Œå¯ä»¥é€šè¿‡<code>,</code>æ¥åŒæ—¶è®¾ç½®å¤šä¸ªå±</p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">Form myForm = new Form(){Text."Hello"};<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ğŸ‘†ğŸ‘‡</p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">Form myForm = new Form();
myForm.Text = "Hello"; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>ä¸€æ¬¡æ€§è®¿é—®ï¼Œæ²¡å¿…è¦åˆ›å»ºå˜é‡è®¿é—®å®ä¾‹</li>
</ul>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">new Form(){Text = "Hello"}.ShowDialog();<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ğŸ‘†ğŸ‘‡</p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">Form myForm = new Form();
myForm.Text = "Hello";
myForm.ShowDialog();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li>åŒ¿åç±»å‹åˆ›å»ºå¯¹è±¡</li>
</ul>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">var person = new{Name = "Mr.Okay", Age = 18};//è‡ªåŠ¨åˆ¤æ–­ç±»å‹
Console.WriteLine(person.Age);
Console.WriteLine(person.Name);
Console.WriteLine(person.GetType().Name);
//Mr.Okay
//18
//&lt;&gt;f__AnonymousType0`2
//ç±»å‹çš„è§£é‡Šï¼š
//&lt;&gt;f__AnonymousTypeæ˜¯çº¦å®šçš„ä¸€ä¸ªå‰ç¼€
//0æŒ‡çš„æ˜¯åœ¨ç¨‹åºä¸­åˆ›å»ºçš„ç¬¬ä¸€ä¸ª
//`2æŒ‡çš„æ˜¯è¿™ä¸ªç±»å‹æ˜¯ä¸€ä¸ªæ³›å‹ç±»ï¼Œæ„æˆè¿™ä¸ªç±»å‹æ—¶éœ€è¦ä¸¤ä¸ªç±»å‹æ¥æ„æˆå®ƒï¼Œä¸€ä¸ªæ˜¯stringï¼Œä¸€ä¸ªæ˜¯int<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>å­ç±»éšè—çˆ¶ç±»(å…³é”®å­—)(äº†è§£å³å¯)</li>
</ul>
<h4 id="checked-unchecked"><a href="#checked-unchecked" class="headerlink" title="checked&amp;unchecked"></a>checked&amp;unchecked</h4><p>æ£€æŸ¥æ˜¯å¦å¼‚å¸¸</p>
<h4 id="å–éæ“ä½œç¬¦"><a href="#å–éæ“ä½œç¬¦" class="headerlink" title="!å–éæ“ä½œç¬¦"></a>!å–éæ“ä½œç¬¦</h4><p>å®é™…åº”ç”¨ï¼Œæ£€æŸ¥</p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">namespace CreatOperator
{
    class Program
    {
        static void Main(string[] args)
        {
            Student stu = new Student(null);
            Console.WriteLine(stu.Name);
        }
    }

    class Student
    {
        public string Name;
        public Student(string initName)
        {
            if(!string.IsNullOrEmpty(initName))
            {
                this.Name = initName;
            }
            else 
            {
                throw new ArgumentException("initName cannot be null or empty");
            }
        }
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="T-xå¼ºåˆ¶è½¬æ¢ç±»å‹æ“ä½œç¬¦"><a href="#T-xå¼ºåˆ¶è½¬æ¢ç±»å‹æ“ä½œç¬¦" class="headerlink" title="(T)xå¼ºåˆ¶è½¬æ¢ç±»å‹æ“ä½œç¬¦"></a>(T)xå¼ºåˆ¶è½¬æ¢ç±»å‹æ“ä½œç¬¦</h4><h2 id="äºŒ-æ•°æ®ç±»å‹è½¬æ¢"><a href="#äºŒ-æ•°æ®ç±»å‹è½¬æ¢" class="headerlink" title="äºŒ.æ•°æ®ç±»å‹è½¬æ¢"></a>äºŒ.æ•°æ®ç±»å‹è½¬æ¢</h2><h4 id="convert"><a href="#convert" class="headerlink" title="convert"></a>convert</h4><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">string str1 = Console.ReadLine();
string str2 = Console.ReadLine();
int x = Convert.ToInt32(str1);
int y = Convert.ToInt32(str2);
Console.WriteLine(str1 + str2);
Console.WriteLine(x + y);

//12
//34
//1234
//46s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="éšå¼ç±»å‹è½¬æ¢"><a href="#éšå¼ç±»å‹è½¬æ¢" class="headerlink" title="éšå¼ç±»å‹è½¬æ¢"></a>éšå¼ç±»å‹è½¬æ¢</h4><ul>
<li>ä¸ä¸¢å¤±ç²¾åº¦çš„è½¬æ¢</li>
</ul>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">int x = int.MaxValue;
long y = x;
Console.WriteLine(y);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>C#è¯­è¨€æ•°æ®æ–‡æ¡£6.1.2æœ‰éšå¼æ•°å€¼è½¬æ¢</p>
<p><img src="/../../../../medias/blog_picture/C#/5.png"></p>
<ul>
<li>å­ç±»å‘çˆ¶ç±»çš„è½¬æ¢</li>
</ul>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">namespace CreatOperator
{
    class Program
    {
        static void Main(string[] args)
        {
            Teacher t = new Teacher();
            Human h = t;//hä»åªæœ‰Eatå’ŒAnimal
            Animal a = h;//è®¿é—®çš„æ˜¯Animalï¼Œå¼•ç”¨ä¸äº†å®ä¾‹hï¼Œåªæœ‰Eat
            a.Eat();
        }
    }
	//çˆ¶ç±»
    class Animal
    {
        public void Eat()
        {
            Console.WriteLine("Eating");
        }
    }
	//å­ç±»
    class Human:Animal
    {
        public void Think()
        {
            Console.WriteLine("Who am I?");
        }
    }
	//å­ç±»çš„å­ç±»
    class Teacher : Human
    {
        public void Teach()
        {
            Console.WriteLine("I teach programming.");
        }
    }

}
//Eating<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<ul>
<li>è£…ç®±</li>
</ul>
<h4 id="æ˜¾å¼ç±»å‹è½¬æ¢"><a href="#æ˜¾å¼ç±»å‹è½¬æ¢" class="headerlink" title="æ˜¾å¼ç±»å‹è½¬æ¢"></a>æ˜¾å¼ç±»å‹è½¬æ¢</h4><ul>
<li>æœ‰å¯èƒ½ä¸¢å¤±ç²¾åº¦çš„è½¬æ¢<strong>cast</strong>(é“¸é€ )</li>
</ul>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">Console.WriteLine(ushort.MaxValue);
uint x = 65536;
ushort y = (ushort)x;//å¼ºåˆ¶æŠŠè¾ƒå¤§çš„å€¼è£…åˆ°å°çš„ç©ºé—´é‡Œ
Console.WriteLine(y);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>æ‹†ç®±</li>
<li>convert<ul>
<li>æ•°å€¼ç±»å‹å¾€å­—ç¬¦ä¸²ç±»å‹è½¬æ¢</li>
</ul>
</li>
</ul>
<h4 id="ç±»å‹è½¬æ¢æ“ä½œç¬¦"><a href="#ç±»å‹è½¬æ¢æ“ä½œç¬¦" class="headerlink" title="ç±»å‹è½¬æ¢æ“ä½œç¬¦"></a>ç±»å‹è½¬æ¢æ“ä½œç¬¦</h4><p>æ˜¾å¼ç±»å‹è½¬æ¢æ˜¯ä¸€ä¸ªç›®æ ‡ç±»å‹çš„å®ä¾‹çš„æ„é€ å™¨ï¼Œå†™åœ¨è¢«è½¬æ¢çš„è¿™ä¸ªæ•°æ®ç±»å‹é‡Œ</p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">namespace CreatOperator
{
    class Program
    {
        static void Main(string[] args)
        {
            Stone stone = new Stone();
            stone.Age = 5000;
            Monkey wukongSun = (Monkey)stone;
            //ç›®æ ‡æ˜¯æŠŠä¸€ä¸ªStoneç±»å‹çš„è½¬å˜ä¸ºMonkeyç±»å‹çš„
            Console.WriteLine(wukongSun.Age);
        }
    }
    class Stone
    {
        public int Age;
        //æ˜¾å¼ç±»å‹è½¬æ¢æ˜¯ä¸€ä¸ªç›®æ ‡ç±»å‹çš„å®ä¾‹çš„æ„é€ å™¨ï¼Œå†™åœ¨è¢«è½¬æ¢çš„è¿™ä¸ªæ•°æ®ç±»å‹é‡Œ
        //Monkey(Stone stone)å°±æ˜¯ä¸€ä¸ªæ„é€ å™¨
        public static explicit operator Monkey(Stone stone)
        {
            Monkey m = new Monkey();
            m.Age = stone.Age / 500;//æ„å»ºMonkeyå’ŒStoneçš„å…³ç³»
            return m;
        }
    }

    class Monkey
    {
        public int Age;
    }
}
//10<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¯¹æ¯”éšå¼ç±»å‹è½¬æ¢</p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">namespace CreatOperator
{
    class Program
    {
        static void Main(string[] args)
        {
            Stone stone = new Stone();
            stone.Age = 5000;
            Monkey wukongSun = stone;		//æ­¤å¤„å»æ‰äº†(Monkey)stoneçš„(Monkey)
            Console.WriteLine(wukongSun.Age);
        }
    }
    class Stone
    {
        public int Age;
        public static implicit operator Monkey(Stone stone)//æ­¤å¤„å°†"explicit"æ”¹ä¸º"implicit"
        {
            Monkey m = new Monkey();
            m.Age = stone.Age / 500;
            return m;
        }
    }

    class Monkey
    {
        public int Age;
    }
}
//10<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="is"><a href="#is" class="headerlink" title="is"></a>is</h4><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">Stone stone = new Stone();
var result = stone is Stone;//æ£€éªŒçš„æ˜¯å˜é‡æ‰€å¼•ç”¨çš„å®ä¾‹
Console.WriteLine(result.GetType().FullName);
Console.WriteLine(result);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="Nullableå¯ç©ºç±»å‹"><a href="#Nullableå¯ç©ºç±»å‹" class="headerlink" title="Nullable<>å¯ç©ºç±»å‹"></a>Nullable&lt;&gt;å¯ç©ºç±»å‹</h4><p>ä¾‹å­ï¼šä¸€ä¸ªåŒå­¦æ²¡äº¤ä½œä¸šï¼Œä½†æ˜¯ä¸æ˜¯é‚£ç§åšçš„æå·®çš„0åˆ†ï¼Œæƒ³ç»™ä»–ç©ºç€</p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">Nullable&lt;int&gt; x = null;//æ²¡äº¤ä½œä¸š
x = 100;//äº¤äº†ä½œä¸š<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>ğŸ‘†ğŸ‘‡</p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">int?x = null;
x = 100;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>ä½†æ˜¯å¦‚æœè¿™ä¸ªåŒå­¦ä¸€ç›´æ²¡äº¤ä½œä¸šï¼ŒæœŸæœ«éœ€è¦å½•å…¥æˆç»©æ—¶ç»™0åˆ†</p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">int?x = null;
int y = x??0;//èµ‹0åˆ†<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>



<h4 id="ifelseçš„ç®€å†™"><a href="#ifelseçš„ç®€å†™" class="headerlink" title="?:(ifelseçš„ç®€å†™)"></a>?:(ifelseçš„ç®€å†™)</h4><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">int x = 80;
string str = string.Empty;
str = (x &gt;= 60)?"Pass":"Failed";<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ğŸ‘†ğŸ‘‡</p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">int x = 80;
string str;
if(x&gt;60)
{
    str = "Pass";
}
else
{
    str = "Failed";
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

]]></content>
      <tags>
        <tag>é—²ç€æ²¡äº‹å¹²</tag>
        <tag>C#</tag>
      </tags>
  </entry>
  <entry>
    <title>å®šæ—¶å™¨å’Œå®šæ—¶å™¨æ—¶é’Ÿ</title>
    <url>/2022/10/10/ding-shi-qi-he-ding-shi-qi-shi-zhong/</url>
    <content><![CDATA[<h1 id="å®šæ—¶å™¨"><a href="#å®šæ—¶å™¨" class="headerlink" title="å®šæ—¶å™¨"></a>å®šæ—¶å™¨</h1><p><img src="/../../../../medias/blog_picture/51/46.png" alt="å®šæ—¶å™¨æ¡†å›¾"></p>
<p><img src="/../../../../medias/blog_picture/51/47.png"></p>
<p>æŒ‰è§†é¢‘ä¸­çš„å»ç†è§£ï¼Œupä¸»çš„æ¿å­æ™¶æŒ¯ä¸º12MHzï¼Œå¦‚æœåˆ†é¢‘æ¥äº†Ã·12çš„çº¿è·¯ï¼Œé‚£ä¹ˆä¼ ç»™è®¡æ•°å™¨çš„å°±ä¼šæ˜¯1Âµsè®¡æ•°ä¸€æ¬¡(è®¡ç®—:<strong>1/(12MHz/12)=1/1*10^9s=1Âµs</strong>)</p>
<p>CTé€‰æ‹©å¼€å…³ï¼šé‚£é‡Œç»™<strong>1</strong>æ˜¯<strong>counterè®¡æ•°å™¨</strong>  ç»™<strong>0</strong>æ˜¯<strong>timerå®šæ—¶å™¨</strong></p>
<p>GATEé‚£é‡Œï¼šä¸‰è§’æ˜¯å¼‚é—¨(1â€“&gt;0  0â€”&gt;1)ï¼Œç¬¬äºŒä¸ªæ˜¯æˆ–é—¨(åªæœ‰00æƒ…å†µç»™0ï¼Œå…¶ä½™ç»™1)ï¼Œç¬¬ä¸‰ä¸ªæ˜¯ä¸é—¨<strong>è·ŸCçš„å¼‚æˆ–ä¸çš„ä¸æ„æ€å·®ä¸å¤š</strong></p>
<p><img src="/../../../../medias/blog_picture/51/48.png"></p>
<h2 id="å®æ“"><a href="#å®æ“" class="headerlink" title="å®æ“"></a>å®æ“</h2><h3 id="1-TMOD-TIME-MODE"><a href="#1-TMOD-TIME-MODE" class="headerlink" title="1.TMOD(TIME_MODE)"></a>1.TMOD(TIME_MODE)</h3><p><img src="/../../../../medias/blog_picture/51/49.png"></p>
<p>ç”±äºTMODä¸å¯å¯»å€ï¼Œæ‰€ä»¥è¦<strong>æ•´ä½“</strong>è¡¨ç¤º</p>
<p>(å¯¹äº**(ä¸)å¯å¯»å€<strong>çš„ç†è§£ï¼Œ</strong>å¯å¯»å€<strong>åƒä¹‹å‰çš„ç‚¹LEDç¯ï¼Œç›´æ¥P2=0x01&lt;==&gt;P2_1=1ç„¶åP2_2~8=0ï¼Œ</strong>ä¸å¯å¯»å€**å°±æ˜¯åªèƒ½ä¸€å¨åœ°è¡¨ç¤ºï¼Œå°±åƒP2=0x00è¿™æ ·)</p>
<p><strong>ç›®çš„</strong>ï¼šæˆ‘ä»¬è¦å®ç°<strong>å®šæ—¶å™¨0</strong>è¿è¡Œä¸”è¿›å…¥<strong>æ¨¡å¼1</strong></p>
<h4 id="â‘ M0-M1"><a href="#â‘ M0-M1" class="headerlink" title="â‘ M0&amp;M1"></a>â‘ M0&amp;M1</h4><p><img src="/../../../../medias/blog_picture/51/50.png"></p>
<p>æ‰€ä»¥<strong>M0â€“&gt;1</strong>ï¼Œ<strong>M1â€“&gt;0</strong></p>
<h4 id="â‘¡C-T"><a href="#â‘¡C-T" class="headerlink" title="â‘¡C/T"></a>â‘¡C/T</h4><p><img src="/../../../../medias/blog_picture/51/51.png"></p>
<p>å› ä¸ºæ˜¯å®šæ—¶å™¨ <strong>C/Tâ€“&gt;0</strong></p>
<h4 id="â‘¢GATE"><a href="#â‘¢GATE" class="headerlink" title="â‘¢GATE"></a>â‘¢GATE</h4><p><img src="/../../../../medias/blog_picture/51/52.png"></p>
<p>è¦è®©TR0å‚ä¸æ§åˆ¶ï¼Œæ‰€ä»¥<strong>GATEâ€“&gt;0</strong></p>
<p><strong>é™„GATEçš„è¿è¡Œæ¨¡å¼</strong></p>
<p><img src="/../../../../medias/blog_picture/51/53.png"></p>
<h4 id="å› æ­¤"><a href="#å› æ­¤" class="headerlink" title="å› æ­¤"></a>å› æ­¤</h4><pre class="line-numbers language-C" data-language="C"><code class="language-C">TMOD=0X01;//0000 0001<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="TMODçš„ä¼˜åŒ–"><a href="#TMODçš„ä¼˜åŒ–" class="headerlink" title="TMODçš„ä¼˜åŒ–"></a>TMODçš„ä¼˜åŒ–</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c">TMOD <span class="token operator">&amp;=</span> <span class="token number">0xF0</span><span class="token punctuation">;</span>		<span class="token comment">//è®¾ç½®å®šæ—¶å™¨æ¨¡å¼       0xF0--&gt;1111 0000</span>
TMOD <span class="token operator">|=</span> <span class="token number">0x01</span><span class="token punctuation">;</span>      <span class="token comment">//                    0x01--&gt;0000 0001</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>ç”±äºTMODæ˜¯<strong>åŒæ—¶æ§åˆ¶å®šæ—¶å™¨0å’Œå®šæ—¶å™¨1</strong>ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨æ§åˆ¶å®šæ—¶å™¨0çš„æ—¶å€™ï¼Œ<strong>ä¸å½±å“åˆ°å¯èƒ½æ­£åœ¨å·¥ä½œçš„å®šæ—¶å™¨1</strong>ï¼Œäºæ˜¯ç”¨åˆ°äº†ä»¥ä¸‹æ“ä½œ</p>
<p>e.g.</p>
<p>åŸTMOD=1010 0011â€”æˆ‘ä»¬å¸Œæœ›æŠŠå®ƒè½¬æ¢ä¸ºâ€”&gt;1010 0001</p>
<p><strong>1stâ€”â€”-1010 0011 &amp; 1111 0000 =1010 0000</strong></p>
<p><strong>ç†è§£</strong>ï¼š<strong>n &amp; 1 <strong>æ—¶ï¼Œnä¸ºå‡ å°±è¿”å›å‡ (æ­¤æ—¶ä¸å½±å“å®šæ—¶å™¨1)ï¼›</strong>n &amp; 0 <strong>æ—¶ï¼Œå…¨ä¸º0(æœ‰ç‚¹</strong>åˆå§‹åŒ–</strong>å®šæ—¶å™¨0çš„æ„Ÿè§‰)</p>
<p><strong>2ndâ€”â€”1010 0000 | 0000 0001 =1010 0001</strong></p>
<p><strong>ç†è§£</strong>ï¼š<strong>n | 0 <strong>æ—¶ï¼Œnä¸ºå‡ å°±è¿”å›å‡ (è¿˜æ˜¯ä¸å½±å“å®šæ—¶å™¨1)ï¼›</strong>0 | n</strong> æ—¶ï¼Œnä¸ºå‡ ä¹Ÿè¿”å›å‡ (næ˜¯äººå·¥å†³å®šçš„ï¼Œè¿™æ—¶å¯ä»¥è‡ªè¡Œæ“æ§å®šæ—¶å™¨0äº†)</p>
<h3 id="2-TCON"><a href="#2-TCON" class="headerlink" title="2.TCON"></a>2.TCON</h3><p><img src="/../../../../medias/blog_picture/51/54.png"></p>
<h4 id="â‘ TR0"><a href="#â‘ TR0" class="headerlink" title="â‘ TR0"></a>â‘ TR0</h4><p><img src="/../../../../medias/blog_picture/51/55.png"></p>
<p><strong>çœæµ</strong>ï¼šGATE=0 &amp;&amp; TR0=1æ—¶å…è®¸T0è®¡æ•°ï¼Œå¼€å§‹å·¥ä½œ</p>
<pre class="line-numbers language-none"><code class="language-none">TR0=1;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h4 id="â‘¡TF0"><a href="#â‘¡TF0" class="headerlink" title="â‘¡TF0"></a>â‘¡TF0</h4><p><img src="/../../../../medias/blog_picture/51/56.png"></p>
<p><strong>çœæµ</strong>ï¼šTF0=1æ—¶å°±äº§ç”Ÿä¸­æ–­ï¼Œæ‰€ä»¥è¦=0ï¼Œé˜²æ­¢åˆšé…ç½®å¥½å°±äº§ç”Ÿä¸­æ–­</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">TF0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h4 id="â‘¢TH0-TL0"><a href="#â‘¢TH0-TL0" class="headerlink" title="â‘¢TH0&amp;TL0"></a>â‘¢TH0&amp;TL0</h4><p><img src="/../../../../medias/blog_picture/51/57.png"></p>
<p>æ¥è‡ªå¼¹å¹•å¤§ä½¬ï¼šä¸¤ä¸ªå¯„å­˜å™¨TH0ã€TL0ä¸º<strong>äºŒè¿›åˆ¶å…«ä½</strong>(2^8)ï¼Œ<strong>å•ç‹¬</strong>å¯è®¡256æ¬¡ï¼Œ<strong>ä½å…«ä½è®¡æ»¡256æ¬¡åé«˜å…«ä½è¿›1</strong>ï¼Œæ‰€ä»¥<strong>é™¤ä»¥256</strong>å¯å¾—<strong>é«˜å…«ä½</strong>å¾—æ¬¡æ•°ï¼Œ<strong>å–ä½™</strong>å°±æ˜¯<strong>ä½å…«ä½</strong>çš„æ¬¡æ•°ï¼Œåˆå¹¶åœ¨ä¸€èµ·å°±æ˜¯æ‰€èµ‹çš„åˆå§‹å€¼</p>
<p>æ¥è‡ªUPä¸»ï¼š<strong>123</strong>è¦æ”¾åˆ°ä¸¤ä¸ª<strong>å®¹é‡</strong>ä¸º100çš„ç›’å­é‡Œï¼Œ<strong>é«˜ä½æ¬¡</strong>çš„ç›’å­å­˜å‚¨â€”<strong>123/100=1</strong>ï¼Œ<strong>ä½ä½æ¬¡</strong>çš„ç›’å­å­˜å‚¨â€”<strong>123%100=23</strong>ï¼Œ<strong>åˆå¹¶</strong>ä¹‹åå°±æ˜¯123(åˆå§‹å€¼)</p>
<p><strong>å¯¹åº”é¡¹ç›®ï¼Œå°±æ˜¯ä¸¤ä¸ªå®¹é‡ä¸º256çš„å°ç›’å­è¦å­˜å‚¨64535è¿™ä¸ªåºç„¶å¤§ç‰©</strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">TH0<span class="token operator">=</span><span class="token number">64535</span><span class="token operator">/</span><span class="token number">256</span><span class="token punctuation">;</span><span class="token comment">//highï¼Œæ‹¿å‡ºé«˜å…«ä½</span>
TL0<span class="token operator">=</span><span class="token number">64535</span><span class="token operator">%</span><span class="token number">256</span><span class="token punctuation">;</span><span class="token comment">//lowï¼Œæ‹¿å‡ºä½å…«ä½</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>



<h4 id="â‘£ET0-EA-PT0"><a href="#â‘£ET0-EA-PT0" class="headerlink" title="â‘£ET0&amp;EA&amp;PT0"></a>â‘£ET0&amp;EA&amp;PT0</h4><p><img src="/../../../../medias/blog_picture/51/58.png"></p>
<p>æŠŠé€šé“æ‰“é€š</p>
<pre class="line-numbers language-C" data-language="C"><code class="language-C">ET0=1;
EA=1;
PT0=0;//è™½ç„¶é»˜è®¤PT0ä¸º0ï¼Œä½†è¿˜æ˜¯è¯´æ˜ä¸€ä¸‹æ¯”è¾ƒå¥½<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>



<h2 id="3-Time0-c"><a href="#3-Time0-c" class="headerlink" title="3.Time0.c"></a>3.Time0.c</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>

<span class="token comment">/**
  * @brief  å®šæ—¶å™¨0åˆå§‹åŒ–ï¼Œ1ms@11.0592MH
  * @param  æ— 
  * @retval æ— 
  */</span>
<span class="token keyword">void</span> <span class="token function">Timer0Init</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>		<span class="token comment">//1æ¯«ç§’@11.0592MHz</span>
<span class="token punctuation">{</span>
	TMOD <span class="token operator">&amp;=</span> <span class="token number">0xF0</span><span class="token punctuation">;</span>		<span class="token comment">//è®¾ç½®å®šæ—¶å™¨æ¨¡å¼       0xF0--&gt;1111 0000</span>
	TMOD <span class="token operator">|=</span> <span class="token number">0x01</span><span class="token punctuation">;</span>     <span class="token comment">//                     0x0x--&gt;0000 0001</span>
	TL0 <span class="token operator">=</span> <span class="token number">0x66</span><span class="token punctuation">;</span>		<span class="token comment">//è®¾ç½®å®šæ—¶åˆå€¼</span>
	TH0 <span class="token operator">=</span> <span class="token number">0xFC</span><span class="token punctuation">;</span>		<span class="token comment">//è®¾ç½®å®šæ—¶åˆå€¼</span>
    <span class="token comment">/**
    64535/256=252
    252--10è¿›åˆ¶è½¬16è¿›åˆ¶--&gt;FC
    
    64535%256=23
    23--10è¿›åˆ¶è½¬16è¿›åˆ¶--&gt;17
    ä½†æ˜¯æˆ‘ä»¬è¿™ä¸ªæœ‰0.04%çš„åå·®ï¼Œæ‰€ä»¥...é—®é¢˜...åº”è¯¥ä¸å¤§å§...
    */</span>
	TF0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>		<span class="token comment">//æ¸…é™¤TF0æ ‡å¿—</span>
	TR0 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>		<span class="token comment">//å®šæ—¶å™¨0å¼€å§‹è®¡æ—¶</span>
	ET0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>          <span class="token comment">//å…è®¸ä¸­æ–­</span>
	EA<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	PT0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
å®šæ—¶å™¨ä¸­æ–­å‡½æ•°æ¨¡æ¿
void Timer0_Routine() interrupt 1
{
	static unsigned int T0Count;//ä¸ºäº†ä¸ä¸¢å¤±è¿™ä¸ªæ•°å­—
	TL0 = 0x66;		//è®¾ç½®å®šæ—¶åˆå€¼
	TH0 = 0xFC;		//è®¾ç½®å®šæ—¶åˆå€¼
	T0Count++;
	if(T0Count&gt;=1000)
	{
		//è¿™é‡Œè¦å†™å…·ä½“å®ç°ä»€ä¹ˆ
		T0Count=0;
	}
}
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¯¹å®šæ—¶å™¨ä¸­æ–­å‡½æ•°æ¨¡æ¿çš„ç†è§£ï¼š</p>
<p>é¦–å…ˆï¼Œä¸­æ–­ç¨‹åºæœ¬èº«å¯è§†ä¸ºä¸€ä¸ªwhileå¾ªç¯ï¼Œä¼šä¸€ç›´æ‰§è¡Œè¿™ä¸ªå‡½æ•°</p>
<p>å…¶æ¬¡ï¼Œå¯¹äºç§’æ•°ï¼Œè¿™ä¸ªè®¡æ—¶å™¨(TH0 TL0)<strong>æœ€é«˜å¯è¾¾åˆ°65535Âµs</strong>ï¼Œæˆ‘ä»¬è®¾ç½®å®šæ—¶åˆå€¼æ—¶ï¼Œç”¨çš„æ˜¯64535ï¼Œå®ƒ<strong>è·ç¦»65535è¿˜æœ‰1000æ‰å³å°†æº¢å‡ºå½’é›¶</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬è®©è®¡æ—¶å™¨è®¡æ—¶1000Âµs(=1ms)ï¼Œ**æ¯è¿‡1msï¼ŒT0Count++**ï¼Œå½“å®ƒåŠ äº†1000æ¬¡ï¼Œæ­¤æ—¶å·²ç»è¿‡å»1000ms(=1s)</p>
<p>æœ€åï¼Œè¿›å…¥ifæ‰§è¡Œå…·ä½“å®ç°ï¼Œç„¶åæŠŠT0Countå½’é›¶ï¼Œè¿›å…¥ä¸‹ä¸€æ¬¡ä¸­æ–­ç¨‹åº(å¾ªç¯)</p>
<h3 id="4-æ–°å­¦ä¸¤ä¸ªå‡½æ•°"><a href="#4-æ–°å­¦ä¸¤ä¸ªå‡½æ•°" class="headerlink" title="4.æ–°å­¦ä¸¤ä¸ªå‡½æ•°"></a>4.æ–°å­¦ä¸¤ä¸ªå‡½æ•°</h3><p><strong>è¦ç”¨åˆ°#include&lt;INTRINS.H&gt;å¤´æ–‡ä»¶</strong></p>
<h4 id="crolå‡½æ•°-crorå‡½æ•°-å¤´å°¾éƒ½è¦"><a href="#crolå‡½æ•°-crorå‡½æ•°-å¤´å°¾éƒ½è¦" class="headerlink" title="crolå‡½æ•°&amp;crorå‡½æ•°(..å¤´å°¾éƒ½è¦_.."></a>crolå‡½æ•°&amp;crorå‡½æ•°(..å¤´å°¾éƒ½è¦_..</h4><p>å¾ªç¯ç§»ä½</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">char</span> a<span class="token operator">=</span><span class="token number">0x80</span><span class="token punctuation">;</span>
a<span class="token operator">=</span><span class="token function">_crol_</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//aä¸º0x01ï¼Œå¾ªç¯å›å»å¼€å¤´äº†</span>
<span class="token comment">//å¦‚æœæ˜¯&lt;&lt;çš„è¯ï¼Œç§»åˆ°è¾¹ç•Œå°±æº¢å‡ºè¶Šç•Œ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="5-æœ€ç»ˆå‘ˆç°"><a href="#5-æœ€ç»ˆå‘ˆç°" class="headerlink" title="5.æœ€ç»ˆå‘ˆç°"></a>5.æœ€ç»ˆå‘ˆç°</h3><h4 id="main-c"><a href="#main-c" class="headerlink" title="main.c"></a>main.c</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Timer0.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Key.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;INTRINS.H&gt;</span></span>


<span class="token keyword">unsigned</span> <span class="token keyword">char</span> KeyNum<span class="token punctuation">,</span>LEDMode<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	P2<span class="token operator">=</span><span class="token number">0xFE</span><span class="token punctuation">;</span><span class="token comment">//P2æ˜¯LEDæ¨¡å—å™¢ï¼Œä¸€ç«¯æ¥äº†VCCï¼Œé‚£ä¹ˆåªæœ‰ç»™P2_nèµ‹å€¼ä¸º0çš„æ—¶å€™æ‰äº®ï¼Œ0xFEè½¬äºŒè¿›åˆ¶ä¸º1111 1110</span>
	<span class="token function">Timer0Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		KeyNum<span class="token operator">=</span><span class="token function">Key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>KeyNum<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>KeyNum<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				LEDMode<span class="token operator">++</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>LEDMode<span class="token operator">&gt;=</span><span class="token number">2</span><span class="token punctuation">)</span>LEDMode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//å®šæ—¶å™¨å’Œä¸»ç¨‹åºçš„è€¦åˆæ€§æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥ç›´æ¥æ”¾åˆ°ä¸»å‡½æ•°ä½¿ç”¨</span>
<span class="token keyword">void</span> <span class="token function">Timer0_Routine</span><span class="token punctuation">(</span><span class="token punctuation">)</span> interrupt <span class="token number">1</span>
<span class="token punctuation">{</span>
	<span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> T0Count<span class="token punctuation">;</span><span class="token comment">//ä¸ºäº†ä¸ä¸¢å¤±è¿™ä¸ªæ•°å­—</span>
	TL0 <span class="token operator">=</span> <span class="token number">0x66</span><span class="token punctuation">;</span>		<span class="token comment">//è®¾ç½®å®šæ—¶åˆå€¼</span>
	TH0 <span class="token operator">=</span> <span class="token number">0xFC</span><span class="token punctuation">;</span>		<span class="token comment">//è®¾ç½®å®šæ—¶åˆå€¼</span>
	T0Count<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>T0Count<span class="token operator">&gt;=</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token comment">//0.5säº®ä¸€æ¬¡</span>
	<span class="token punctuation">{</span>
		T0Count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>LEDMode<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
			P2<span class="token operator">=</span><span class="token function">_crol_</span><span class="token punctuation">(</span>P2<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>LEDMode<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
			P2<span class="token operator">=</span><span class="token function">_cror_</span><span class="token punctuation">(</span>P2<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é’ˆå¯¹<strong>æµæ°´</strong>æ•ˆæœï¼Œæˆ‘ä»¬æ·»åŠ äº†è¿™äº›</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">if</span><span class="token punctuation">(</span>T0Count<span class="token operator">&gt;=</span><span class="token number">500</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		T0Count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>LEDMode<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>           
			P2<span class="token operator">=</span><span class="token function">_crol_</span><span class="token punctuation">(</span>P2<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¾€å·¦æµ</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>LEDMode<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
			P2<span class="token operator">=</span><span class="token function">_cror_</span><span class="token punctuation">(</span>P2<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¾€å³æµ</span>
	<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é…åˆä¸»å‡½æ•°é£Ÿç”¨</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">char</span> KeyNum<span class="token punctuation">,</span>LEDMode<span class="token punctuation">;</span> <span class="token comment">//ä¸€å¼€å§‹åˆå§‹åŒ–äº†KeyNumå’ŒLEDModeï¼Œè¿™ä¸¤ä¸ªç©æ„åˆå§‹å€¼éƒ½ä¸º0</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>é‚£ä¹ˆï¼Œå½“å¼€å…³è¢«æŒ‰ä¸‹çš„æ—¶å€™ï¼Œ<strong>LEDMode==0</strong>ï¼Œå¼€å§‹å¾€å·¦æµï¼Œå¯¹åº”ä¸‹é¢è¿™å¥</p>
<pre class="line-numbers language-none"><code class="language-none">if(LEDMode==0)           
	P2=_crol_(P2,1);//å¾€å·¦æµ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>ç„¶åæ¥æ”¶KeyNumï¼Œå½“æˆ‘ä¸æŒ‰P3_1æ—¶ï¼ŒLEDModeå°±ä¸€ç›´ä¸º0ï¼Œä¸€ç›´å¾€å·¦æµ</p>
<p>æˆ‘æŒ‰ä¸‹P3_1æ—¶ï¼Œé…åˆKey.cé£Ÿç”¨ï¼Œæ­¤æ—¶<strong>è¿”å›KeyNumber=1</strong></p>
<h4 id="Key-c"><a href="#Key-c" class="headerlink" title="Key.c"></a>Key.c</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Delay.h"</span></span>

<span class="token comment">/**
  * @brief  è·å–ç‹¬ç«‹æŒ‰é”®é”®ç 
  * @param  æ— 
  * @retval æŒ‰ä¸‹æŒ‰é”®çš„é”®ç ï¼ŒèŒƒå›´ï¼š0~4ï¼Œæ— æŒ‰é”®æŒ‰ä¸‹æ—¶è¿”å›å€¼ä¸º0
  */</span>
<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token function">Key</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> KeyNumber<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	
	<span class="token keyword">if</span><span class="token punctuation">(</span>P3_1<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P3_1<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment">//ä»‹é‡Œä»‹é‡Œï¼</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P3_0<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P3_0<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P3_2<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P3_2<span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P3_3<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P3_3<span class="token operator">==</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span><span class="token punctuation">}</span>

	
	<span class="token keyword">return</span> KeyNumber<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>KeyNum==1</strong>åï¼Œæ‰§è¡Œ</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">if</span><span class="token punctuation">(</span>KeyNum<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	LEDMode<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>LEDMode<span class="token operator">&gt;=</span><span class="token number">2</span><span class="token punctuation">)</span>LEDMode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ—¶å€™LEDMode++ï¼Œ<strong>LEDMode==1</strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">if</span><span class="token punctuation">(</span>LEDMode<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
	P2<span class="token operator">=</span><span class="token function">_cror_</span><span class="token punctuation">(</span>P2<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¾€å³æµ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>å†æ¬¡æŒ‰ä¸‹P3_1æ—¶ï¼ŒLEDMode++ï¼Œ<strong>LEDMode==2</strong>ï¼Œç„¶åæ‰§è¡Œifè®©LEDModeå½’é›¶</p>
<h1 id="å®šæ—¶å™¨æ—¶é’Ÿ"><a href="#å®šæ—¶å™¨æ—¶é’Ÿ" class="headerlink" title="å®šæ—¶å™¨æ—¶é’Ÿ"></a>å®šæ—¶å™¨æ—¶é’Ÿ</h1><h3 id="main-c-1"><a href="#main-c-1" class="headerlink" title="main.c"></a>main.c</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Delay.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"LCD1602.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Timer0.h"</span></span>

<span class="token keyword">unsigned</span> <span class="token keyword">char</span> Sec<span class="token punctuation">,</span>Min<span class="token punctuation">,</span>Hour<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">LCD_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Timer0Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">LCD_ShowString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"Clock:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">LCD_ShowString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"  :  :"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">LCD_ShowNum</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Hour<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">LCD_ShowNum</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span>Min<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">LCD_ShowNum</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span>Sec<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">Timer0_Routine</span><span class="token punctuation">(</span><span class="token punctuation">)</span> interrupt <span class="token number">1</span>
<span class="token punctuation">{</span>
	<span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> T0Count<span class="token punctuation">;</span><span class="token comment">//ä¸ºäº†ä¸ä¸¢å¤±è¿™ä¸ªæ•°å­—</span>
	TL0 <span class="token operator">=</span> <span class="token number">0x66</span><span class="token punctuation">;</span>		<span class="token comment">//è®¾ç½®å®šæ—¶åˆå€¼</span>
	TH0 <span class="token operator">=</span> <span class="token number">0xFC</span><span class="token punctuation">;</span>		<span class="token comment">//è®¾ç½®å®šæ—¶åˆå€¼</span>
	T0Count<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>T0Count<span class="token operator">&gt;=</span><span class="token number">1000</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		T0Count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
		Sec<span class="token operator">++</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>Sec<span class="token operator">&gt;=</span><span class="token number">60</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			Sec<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
			Min<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>Min<span class="token operator">&gt;=</span><span class="token number">60</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				Min <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
				Hour<span class="token operator">++</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>Hour<span class="token operator">&gt;=</span><span class="token number">24</span><span class="token punctuation">)</span>
				<span class="token punctuation">{</span>
					Hour<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªï¼Œä¸éš¾ç†è§£ï¼Œdddd</p>
]]></content>
      <categories>
        <category>51å•ç‰‡æœº</category>
      </categories>
      <tags>
        <tag>51å•ç‰‡æœº</tag>
        <tag>å¤§äº‘å±‹è€ƒæ ¸</tag>
      </tags>
  </entry>
  <entry>
    <title>æ’åºç®—æ³•</title>
    <url>/2023/02/07/pai-xu/</url>
    <content><![CDATA[<h1 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h1><h3 id="ä¸€-å†’æ³¡æ’åºbubbleSort"><a href="#ä¸€-å†’æ³¡æ’åºbubbleSort" class="headerlink" title="ä¸€.å†’æ³¡æ’åºbubbleSort"></a>ä¸€.å†’æ³¡æ’åºbubbleSort</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> size <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&gt;</span> a<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				<span class="token keyword">int</span> temp <span class="token operator">=</span> a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
				a<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				a<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="äºŒ-é€‰æ‹©æ’åº"><a href="#äºŒ-é€‰æ‹©æ’åº" class="headerlink" title="äºŒ.é€‰æ‹©æ’åº"></a>äºŒ.é€‰æ‹©æ’åº</h3><p>æ¯æ¬¡æŠŠæœ€å°çš„æ‰¾å‡ºæ¥è·Ÿç¬¬ä¸€ä¸ªæ•°å€¼æ¢ä½ç½®</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">9</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> temp<span class="token punctuation">;</span>
	<span class="token keyword">int</span> min<span class="token punctuation">;</span>
	<span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		min <span class="token operator">=</span> i<span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>min<span class="token punctuation">]</span> <span class="token operator">&gt;</span> a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
				min <span class="token operator">=</span> j<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>min <span class="token operator">!=</span> i<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			temp <span class="token operator">=</span> a<span class="token punctuation">[</span>min<span class="token punctuation">]</span><span class="token punctuation">;</span>
			a<span class="token punctuation">[</span>min<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
			a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="ä¸‰-å¿«é€Ÿæ’åº"><a href="#ä¸‰-å¿«é€Ÿæ’åº" class="headerlink" title="ä¸‰.å¿«é€Ÿæ’åº"></a>ä¸‰.å¿«é€Ÿæ’åº</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">quickSort</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> low<span class="token punctuation">,</span> <span class="token keyword">int</span> high<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">findPos</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> low<span class="token punctuation">,</span> <span class="token keyword">int</span> high<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> i<span class="token punctuation">;</span>
	<span class="token function">quickSort</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">quickSort</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> low<span class="token punctuation">,</span> <span class="token keyword">int</span> high<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> pos<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>low <span class="token operator">&lt;</span> high<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		pos <span class="token operator">=</span> <span class="token function">findPos</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> low <span class="token punctuation">,</span>high<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">quickSort</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> low<span class="token punctuation">,</span> pos <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">quickSort</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> pos <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> high<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">findPos</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> low<span class="token punctuation">,</span> <span class="token keyword">int</span> high<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> val <span class="token operator">=</span> a<span class="token punctuation">[</span>low<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>low <span class="token operator">&lt;</span> high<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>low <span class="token operator">&lt;</span> high <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">[</span>high<span class="token punctuation">]</span> <span class="token operator">&gt;=</span> val<span class="token punctuation">)</span>
			<span class="token operator">--</span>high<span class="token punctuation">;</span>
		a<span class="token punctuation">[</span>low<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>high<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>low <span class="token operator">&lt;</span> high <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">[</span>low<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> val<span class="token punctuation">)</span>
			<span class="token operator">++</span>low<span class="token punctuation">;</span>
		a<span class="token punctuation">[</span>high<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>low<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	a<span class="token punctuation">[</span>low<span class="token punctuation">]</span> <span class="token operator">=</span> val<span class="token punctuation">;</span>
	<span class="token keyword">return</span> low<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="å››-æ’å…¥æ’åº-äºŒåˆ†æ³•"><a href="#å››-æ’å…¥æ’åº-äºŒåˆ†æ³•" class="headerlink" title="å››.æ’å…¥æ’åº+äºŒåˆ†æ³•"></a>å››.æ’å…¥æ’åº+äºŒåˆ†æ³•</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> temp<span class="token punctuation">;</span>
	<span class="token keyword">int</span> low<span class="token punctuation">,</span> high<span class="token punctuation">,</span>mid<span class="token punctuation">;</span>
	<span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		temp <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		low <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
		high <span class="token operator">=</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
		mid <span class="token operator">=</span> <span class="token punctuation">(</span>high <span class="token operator">+</span> low<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">!=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> high <span class="token operator">!=</span> low<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			mid <span class="token operator">=</span> <span class="token punctuation">(</span>high <span class="token operator">+</span> low<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">&gt;</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
				high <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">&lt;</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
				low <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">==</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> i<span class="token punctuation">;</span> j <span class="token operator">&gt;=</span> mid <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				temp <span class="token operator">=</span> a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
				a<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				a<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			a<span class="token punctuation">[</span>mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>high <span class="token operator">==</span> low<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>low<span class="token punctuation">]</span> <span class="token operator">&lt;</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> i<span class="token punctuation">;</span> j <span class="token operator">&gt;</span> low<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span>
				<span class="token punctuation">{</span>
					temp <span class="token operator">=</span> a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
					a<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
					a<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				a<span class="token punctuation">[</span>low <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>high<span class="token punctuation">]</span> <span class="token operator">&gt;</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> i<span class="token punctuation">;</span> j <span class="token operator">&gt;=</span> high <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span>
				<span class="token punctuation">{</span>
					temp <span class="token operator">=</span> a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
					a<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
					a<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				a<span class="token punctuation">[</span>high<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

]]></content>
      <categories>
        <category>Cè¯­è¨€</category>
      </categories>
      <tags>
        <tag>Cè¯­è¨€</tag>
        <tag>é—²ç€æ²¡äº‹å¹²</tag>
      </tags>
  </entry>
  <entry>
    <title>æœ€åˆçš„ç¬”è®°</title>
    <url>/2022/10/02/zui-chu-de-bi-ji/</url>
    <content><![CDATA[<h1 id="2-1ç‚¹äº®ä¸€ä¸ªLED"><a href="#2-1ç‚¹äº®ä¸€ä¸ªLED" class="headerlink" title="2-1ç‚¹äº®ä¸€ä¸ªLED"></a>2-1ç‚¹äº®ä¸€ä¸ªLED</h1><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;INTRINS.H&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">Delay500ms</span><span class="token punctuation">(</span><span class="token punctuation">)</span>		<span class="token comment">//@11.0592MHz</span>
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">;</span>

	<span class="token function">_nop_</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	i <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
	j <span class="token operator">=</span> <span class="token number">129</span><span class="token punctuation">;</span>
	k <span class="token operator">=</span> <span class="token number">119</span><span class="token punctuation">;</span>
	<span class="token keyword">do</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">do</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>	P2 <span class="token operator">=</span> <span class="token number">0xFE</span><span class="token punctuation">;</span><span class="token comment">//å¯¹åº”1111 1110å³åªæœ‰D1äº®</span>
		<span class="token function">Delay500ms</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//äº®äº†åç­‰500ms</span>
		P2 <span class="token operator">=</span> <span class="token number">0xFF</span><span class="token punctuation">;</span><span class="token comment">//å¯¹åº” 1111 1111 å³éƒ½ä¸äº®</span>
		<span class="token function">Delay500ms</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ä¸äº®åç­‰500ms</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/../../../../medias/blog_picture/51/25.png" alt="LEDæ¨¡å—"></p>
<p>è§£é‡Šï¼šä¸ºä»€ä¹ˆ1ä¸äº®0äº®ï¼Œæ˜¯å› ä¸ºLEDä¸€ç«¯æ¥äº†VCCé«˜ç”µå¹³ï¼Œåˆ™å¦ä¸€ç«¯åº”è¯¥ç»™ä½ç”µå¹³å³0ï¼Œæ‰æœ‰ç”µæµè¾“å‡º</p>
<h1 id="2-3æµæ°´ç¯"><a href="#2-3æµæ°´ç¯" class="headerlink" title="2-3æµæ°´ç¯"></a>2-3æµæ°´ç¯</h1><h2 id="â‘ "><a href="#â‘ " class="headerlink" title="â‘ "></a>â‘ </h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;REGX52.H&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;INTRINS.H&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">Delay500ms</span><span class="token punctuation">(</span><span class="token punctuation">)</span>		<span class="token comment">//@11.0592MHz</span>
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">;</span>

	<span class="token function">_nop_</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	i <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
	j <span class="token operator">=</span> <span class="token number">129</span><span class="token punctuation">;</span>
	k <span class="token operator">=</span> <span class="token number">119</span><span class="token punctuation">;</span>
	<span class="token keyword">do</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">do</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		P2 <span class="token operator">=</span> <span class="token number">0xFE</span><span class="token punctuation">;</span><span class="token comment">//1111 1110</span>
		<span class="token function">Delay500ms</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		P2 <span class="token operator">=</span> <span class="token number">0xFD</span><span class="token punctuation">;</span><span class="token comment">//1111 1101</span>
		<span class="token function">Delay500ms</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		P2 <span class="token operator">=</span> <span class="token number">0xFB</span><span class="token punctuation">;</span><span class="token comment">//1111 1011</span>
		<span class="token function">Delay500ms</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		P2 <span class="token operator">=</span> <span class="token number">0xF7</span><span class="token punctuation">;</span><span class="token comment">//1111 0111</span>
		<span class="token function">Delay500ms</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		P2 <span class="token operator">=</span> <span class="token number">0xEF</span><span class="token punctuation">;</span><span class="token comment">//1110 1111</span>
		<span class="token function">Delay500ms</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		P2 <span class="token operator">=</span> <span class="token number">0xDF</span><span class="token punctuation">;</span><span class="token comment">//1101 1111</span>
		<span class="token function">Delay500ms</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		P2 <span class="token operator">=</span> <span class="token number">0xBF</span><span class="token punctuation">;</span><span class="token comment">//1011 1111</span>
		<span class="token function">Delay500ms</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		P2 <span class="token operator">=</span> <span class="token number">0x7F</span><span class="token punctuation">;</span><span class="token comment">//0111 1111</span>
		<span class="token function">Delay500ms</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="â‘¡"><a href="#â‘¡" class="headerlink" title="â‘¡"></a>â‘¡</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">Delay1ms</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> xms<span class="token punctuation">)</span>		<span class="token comment">//@11.0592MHz</span>
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
<span class="token comment">/*
*å¯¹whileå¾ªç¯çš„ç†è§£:è¿™ä¸ªDelay1msæ˜¯é’ˆå¯¹1msçš„ï¼Œå½“ä¸‹é¢ç¨‹åºéœ€è¦nä¸ª1msï¼Œå°±ä¼šå¾ªç¯næ¬¡1mså»¶æ—¶çš„ç¨‹åº
*/</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>xms<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
		j <span class="token operator">=</span> <span class="token number">199</span><span class="token punctuation">;</span>
		<span class="token keyword">do</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
		xms<span class="token operator">--</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//ä¸Šé¢è‡ªå®šä¹‰å‡½æ•°</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
		<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			P2 <span class="token operator">=</span> <span class="token number">0xFE</span><span class="token punctuation">;</span><span class="token comment">//1111 1110</span>
			<span class="token function">Delay1ms</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			P2 <span class="token operator">=</span> <span class="token number">0xFD</span><span class="token punctuation">;</span><span class="token comment">//1111 1101</span>
			<span class="token function">Delay1ms</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			P2 <span class="token operator">=</span> <span class="token number">0xFB</span><span class="token punctuation">;</span><span class="token comment">//1111 1011</span>
			<span class="token function">Delay1ms</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			P2 <span class="token operator">=</span> <span class="token number">0xF7</span><span class="token punctuation">;</span><span class="token comment">//1111 0111</span>
			<span class="token function">Delay1ms</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			P2 <span class="token operator">=</span> <span class="token number">0xEF</span><span class="token punctuation">;</span><span class="token comment">//1110 1111</span>
			<span class="token function">Delay1ms</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			P2 <span class="token operator">=</span> <span class="token number">0xDF</span><span class="token punctuation">;</span><span class="token comment">//1101 1111</span>
			<span class="token function">Delay1ms</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			P2 <span class="token operator">=</span> <span class="token number">0xBF</span><span class="token punctuation">;</span><span class="token comment">//1011 1111</span>
			<span class="token function">Delay1ms</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			P2 <span class="token operator">=</span> <span class="token number">0x7F</span><span class="token punctuation">;</span><span class="token comment">//0111 1111</span>
			<span class="token function">Delay1ms</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="3-1ç‹¬ç«‹æŒ‰é”®æ§åˆ¶LEDç¯äº®ç­"><a href="#3-1ç‹¬ç«‹æŒ‰é”®æ§åˆ¶LEDç¯äº®ç­" class="headerlink" title="3-1ç‹¬ç«‹æŒ‰é”®æ§åˆ¶LEDç¯äº®ç­"></a>3-1ç‹¬ç«‹æŒ‰é”®æ§åˆ¶LEDç¯äº®ç­</h1><p><img src="/../../../../medias/blog_picture/51/26.png" alt="ç‹¬ç«‹æŒ‰é”®"></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>
<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>	
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>P3_1 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">//P_3å¯¹åº”ç¬¬ä¸€ä¸ªç‹¬ç«‹æŒ‰é”®ï¼Œè¡¨ç¤ºæŒ‰ä¸‹è¯¥æŒ‰é”®æ—¶ï¼Œæ‰§è¡Œä¸‹é¢è¯­å¥</span>
		<span class="token punctuation">{</span>
			P2_0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{</span>
			P2_0 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">Delay</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> xms<span class="token punctuation">)</span>		<span class="token comment">//@11.0592MHz</span>
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>xms<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
		j <span class="token operator">=</span> <span class="token number">199</span><span class="token punctuation">;</span>
		<span class="token keyword">do</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>	
	xms<span class="token operator">--</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>P3_1 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">while</span><span class="token punctuation">(</span>P3_1 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœè¿˜æŒ‰ç€ï¼Œå°±ä¸æ‰§è¡Œä¸‹é¢çš„ï¼Œè¿›å…¥æ­»å¾ªç¯</span>
			<span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			P2_0 <span class="token operator">=</span> <span class="token operator">~</span>P2_0<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token number">3.3</span>ç‹¬ç«‹æŒ‰é”®æ§åˆ¶LEDæ˜¾ç¤ºäºŒè¿›åˆ¶
â‘ 
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">Delay</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> xms<span class="token punctuation">)</span>		<span class="token comment">//@11.0592MHz</span>
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>xms<span class="token operator">--</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
		j <span class="token operator">=</span> <span class="token number">199</span><span class="token punctuation">;</span>
		<span class="token keyword">do</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> LEDNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>

		<span class="token keyword">if</span><span class="token punctuation">(</span>P3_1 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">while</span><span class="token punctuation">(</span>P3_1 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">//P2 1111 1111 (åˆå§‹åŒ–)</span>
			P2<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//P2æº¢å‡ºå˜ä¸º0000 0000</span>
			P2<span class="token operator">=</span><span class="token operator">~</span>P2<span class="token punctuation">;</span><span class="token comment">//å–å1111 1111</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
â‘¡
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">Delay</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> xms<span class="token punctuation">)</span>		<span class="token comment">//@11.0592MHz</span>
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>xms<span class="token operator">--</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
		j <span class="token operator">=</span> <span class="token number">199</span><span class="token punctuation">;</span>
		<span class="token keyword">do</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> LEDNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>

		<span class="token keyword">if</span><span class="token punctuation">(</span>P3_1 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">while</span><span class="token punctuation">(</span>P3_1 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			
			LEDNum<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//åˆå§‹æ—¶LEDNumä¸º0000 0000ï¼Ÿ</span>
			P2<span class="token operator">=</span><span class="token operator">~</span>LEDNum<span class="token punctuation">;</span><span class="token comment">//å–å</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¯¹äº<strong>æŒ‰é”®æ¶ˆæŠ–ï¼Œæ£€æµ‹æ¾æ‰‹</strong>çš„ç†è§£ï¼š</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">if</span><span class="token punctuation">(</span>P3_1 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">//å¦‚æœæŒ‰äº†P3_1</span>
		<span class="token punctuation">{</span>
			<span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å…ˆå»¶æ—¶20msï¼Œè·³è¿‡æŠ–åŠ¨é˜¶æ®µ(æ¶ˆæŠ–)</span>
			<span class="token keyword">while</span><span class="token punctuation">(</span>P3_1 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœè¿˜æŒ‰ç€P3_1ï¼Œåˆ™è¿›å…¥whileçš„ç©ºå¾ªç¯ï¼Œæ²¡æœ‰ä»»ä½•æ‰§è¡Œä»»åŠ¡</span>
			<span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ¾å¼€æ‰‹åï¼Œè·³å‡ºwhileå¾ªç¯ï¼Œå†æ¬¡è¿›å…¥æŠ–åŠ¨é˜¶æ®µ(æ¶ˆæŠ–)</span>
	<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h1 id="3-4ç‹¬ç«‹æŒ‰é”®æ§åˆ¶LEDä½ç§»"><a href="#3-4ç‹¬ç«‹æŒ‰é”®æ§åˆ¶LEDä½ç§»" class="headerlink" title="3-4ç‹¬ç«‹æŒ‰é”®æ§åˆ¶LEDä½ç§»"></a>3-4ç‹¬ç«‹æŒ‰é”®æ§åˆ¶LEDä½ç§»</h1><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>

<span class="token keyword">unsigned</span> <span class="token keyword">char</span> LEDNum<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">Delay</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> xms<span class="token punctuation">)</span>		
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>xms<span class="token operator">--</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
		j <span class="token operator">=</span> <span class="token number">199</span><span class="token punctuation">;</span>
		<span class="token keyword">do</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	P2 <span class="token operator">=</span> <span class="token operator">~</span><span class="token number">0x01</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>P3_1 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
<span class="token comment">//æŠŠP2 =~0x01; æŒªè¿‡æ¥ä¹Ÿä¸€æ ·</span>
			<span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">while</span><span class="token punctuation">(</span>P3_1 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			
			LEDNum<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//å®ç°æ¯æ¬¡å³ç§»ï¼Œ++å‡ æ¬¡å°±å³ç§»å‡ ä¸‹</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>LEDNum <span class="token operator">&gt;=</span> <span class="token number">8</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				LEDNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			P2 <span class="token operator">=</span><span class="token operator">~</span><span class="token punctuation">(</span><span class="token number">0x01</span><span class="token operator">&lt;&lt;</span>LEDNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>P3_0 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				<span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">while</span><span class="token punctuation">(</span>P3_0 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			
			<span class="token keyword">if</span><span class="token punctuation">(</span>LEDNum <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">//å³æ­¤æ—¶äº®çš„ç¯ä¸ºD1ï¼ŒP2ä¸º0000 0001ï¼Œå½“num=7åï¼Œ0x01&lt;&lt;LEDNum&lt;==&gt;0000 0001çš„1å¾€å·¦ç§»åŠ¨7ä½ï¼Œå³1000 0000ï¼Œäº®çš„æ˜¯D8ï¼Œå·¦ç§»æˆåŠŸ</span>
			<span class="token punctuation">{</span>
				LEDNum <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span>
			<span class="token punctuation">{</span>
				LEDNum<span class="token operator">--</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token comment">//å®ç°æ¯æ¬¡å·¦ç§»ï¼Œ++å‡ æ¬¡å°±å·¦ç§»å‡ ä¸‹</span>
			<span class="token punctuation">}</span>
			P2 <span class="token operator">=</span><span class="token operator">~</span><span class="token punctuation">(</span><span class="token number">0x01</span><span class="token operator">&lt;&lt;</span>LEDNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="4-1é™æ€æ•°ç ç®¡ä½ç§»"><a href="#4-1é™æ€æ•°ç ç®¡ä½ç§»" class="headerlink" title="4-1é™æ€æ•°ç ç®¡ä½ç§»"></a>4-1é™æ€æ•°ç ç®¡ä½ç§»</h1><p>å…±é˜´æï¼Œäº®çš„ä¸º1(å…±é˜´æâ€“é«˜ç”µå¹³)</p>
<p>1011 1110ä¸ºæ®µç (æ˜¾ç¤º6)</p>
<p>å…±é˜³æï¼Œäº®çš„ä¸º0(å…±é˜³æâ€“ä½ç”µå¹³)</p>
<p>æ®µç ä¸º0100 0001 </p>
<p>å…±é˜´æ:</p>
<p>å½“åªéœ€è¦äº®ç¬¬ä¸‰ä¸ªæ•°å­—æ—¶ï¼Œç¬¬124çš„å…±é˜´æå¤„è¿æ¥é«˜ç”µå¹³(ç»™1)ï¼Œè€Œç¬¬3çš„å…±é˜´æç»™0ï¼Œåˆ™åªæœ‰ç¬¬ä¸‰ä¸ªç¯ä¼šäº®ï¼Œè‡³äºæ€ä¹ˆäº®ï¼Œçœ‹ä¸Šé¢ä¸¤ä¸ªä¾‹å­</p>
<p>ps:å››ç»„A/B/Câ€¦.éƒ½æ¥åœ¨åŒä¸€ä¸ª1174211053é‚£é‡Œ(å…±ç”¨å¼•è„šï¼Œå››ä¸ªæ•°å­—åªèƒ½æ˜¯ä¸€æ ·çš„  )</p>
<p>74HC245ä¸ºåŒå‘æ•°æ®ç¼“å†²å™¨ï¼šVDDå’ŒGNDä¸ºç”µæºï¼ŒOEä¸ºèŠ¯ç‰‡ä½¿èƒ½ç«¯,A0ä¸B0å¯¹åº”â€¦.</p>
<p>DIRâ€“&gt;directionï¼Œæ•°æ®è¯»å–æ–¹å‘</p>
<p>å½“LEæ¥VCCæ—¶ï¼ŒA0ä¼ æ•°æ®ç»™B0</p>
<p>é«˜ç”µå¹³é©±åŠ¨èƒ½åŠ›å¼±ï¼Œä½ç”µå¹³é©±åŠ¨èƒ½åŠ›å¼ºï¼Œæ‰€ä»¥è¿™ä¸ªç¼“å†²å™¨å¯ä»¥å¢å¼ºä¿¡å·ï¼Œä½¿æ•°ç ç®¡æ›´äº®</p>
<p><strong>//ä»¥ä¸Šæ˜¯ä¹‹å‰æ²¡åœ¨typoraå†™çš„ç¬”è®°ï¼Œä¸å†åšè¿‡å¤šçš„è¡¥å……å’Œä¿®æ”¹</strong></p>
<h1 id="4-1é™æ€æ•°ç ç®¡ä½ç§»-1"><a href="#4-1é™æ€æ•°ç ç®¡ä½ç§»-1" class="headerlink" title="4-1é™æ€æ•°ç ç®¡ä½ç§»"></a>4-1é™æ€æ•°ç ç®¡ä½ç§»</h1><p><strong>ç›®çš„ï¼šå®ç°ç¬¬ä¸‰ä¸ªæ•°ç ç®¡äº®èµ·</strong></p>
<p><img src="/../../../../medias/blog_picture/51/27.png" alt="æ•°ç ç®¡"></p>
<p><strong>ç¬¬ä¸‰ä¸ªç¯</strong>å¯¹åº”çš„æ˜¯<strong>LED6</strong></p>
<p><img src="/../../../../medias/blog_picture/51/28.png" alt="138è¯‘ç å™¨"></p>
<p><strong>P2_4 P2_3 P2_2â€”â€“&gt;Y5â€”â€“&gt;LED6</strong></p>
<p>æ ¹æ®åè¿›åˆ¶è½¬äºŒè¿›åˆ¶ï¼ŒY5çš„5è½¬ä¸ºäºŒè¿›åˆ¶æ˜¯101ï¼Œåˆ™æœ‰</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">P2_4 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
P2_3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
P2_2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><img src="/../../../../medias/blog_picture/51/29.png" alt="æ•°ç ç®¡"></p>
<p>æ­¤æ—¶è¦è®©LED6äº®èµ·6ï¼Œåˆ™acdefgä¸º1(å…±é˜´æ)<strong>å› ä¸ºä»–ä»¬åé¢æ¥åˆ°äº†GND(ä½ç”µå¹³)ï¼Œè¦ç»™ä»–é«˜ç”µå¹³å¯¹åº”)<strong>ï¼Œå¯¹åº”åˆ°P0å£åˆ™æ˜¯(è¦</strong>ä»ä¸‹å¾€ä¸Š</strong>è¯»ï¼Œå³ä»<strong>P0_7</strong>è¯»åˆ°<strong>P0_0</strong>)<strong>0111 1101</strong>äºŒè¿›åˆ¶è½¬åå…­è¿›åˆ¶ï¼Œåˆ™ä¸º0x7D</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//ä¸‹é¢çš„ä¸‰æ­¥æ“ä½œæ˜¯è®©P2æ¥å£å¯¹åº”åˆ°Y5ï¼Œâ€œ101â€æ˜¯å› ä¸º5(10è¿›åˆ¶)è½¬ä¸ºäºŒè¿›åˆ¶æ—¶å¯¹åº”çš„å€¼æ˜¯101</span>
	P2_4 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	P2_3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	P2_2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment">//P0è¿™çœ‹ä»£ç å‰é¢çš„è§£é‡Š</span>
	P0 <span class="token operator">=</span> <span class="token number">0x7D</span><span class="token punctuation">;</span><span class="token comment">//ä¸ºäº†è®©ç¬¬ä¸‰ä¸ªä½ç½®çš„ç¯äº®èµ·</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="ä½¿ç”¨æ•°ç»„å®ç°"><a href="#ä½¿ç”¨æ•°ç»„å®ç°" class="headerlink" title="ä½¿ç”¨æ•°ç»„å®ç°"></a>ä½¿ç”¨æ•°ç»„å®ç°</h2><p><code>å¯¹äºNumber</code></p>
<p><img src="/../../../../medias/blog_picture/51/30.png" alt="æ˜¾ç¤ºçš„å­—æ¯è½¬ä¸º2è¿›åˆ¶æ¨ç®—"></p>
<p><strong>é™æ€æ˜¾ç¤º(åªèƒ½æœ‰ä¸€ä¸ªæ•°å­—)</strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>

<span class="token keyword">unsigned</span> <span class="token keyword">char</span> NixieTable<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0x3F</span><span class="token punctuation">,</span><span class="token number">0x06</span><span class="token punctuation">,</span><span class="token number">0x5B</span><span class="token punctuation">,</span><span class="token number">0x4F</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x6D</span><span class="token punctuation">,</span><span class="token number">0x7D</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0x7F</span><span class="token punctuation">,</span><span class="token number">0x6F</span><span class="token punctuation">,</span><span class="token number">0x5E</span><span class="token punctuation">,</span><span class="token number">0x6E</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//0~9--&gt;0~9 10-d 11-y</span>

<span class="token comment">//è‡ªå®šä¹‰å‡½æ•°</span>
<span class="token keyword">void</span> <span class="token function">Nixie</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> Location<span class="token punctuation">,</span>Number<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">switch</span><span class="token punctuation">(</span>Location<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token comment">//å•ç‰‡æœºä¸Šç¬¬ä¸€ä¸ªä½ç½®çš„ç¯å¯¹åº”çš„æ˜¯LED8</span>
        <span class="token comment">//è¿™é‡Œç”¨138è¯‘ç å™¨å®ç°ï¼Œå–å€¼é¡ºåºCBA</span>
		<span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token comment">//111-8-ç¬¬ä¸€ç›ç¯</span>
		<span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token comment">//110-7-ç¬¬äºŒç›ç¯</span>
		<span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">6</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">7</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">8</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	P0<span class="token operator">=</span>NixieTable<span class="token punctuation">[</span>Number<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//åœ¨è¯¥ä½ç½®ä¸Šäº®èµ·çš„æ•°å­—</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>

		<span class="token function">Nixie</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ä½ç½®(ç¬¬å‡ ä¸ªæ•°ç ç®¡)ï¼Œæ•°å­—(å¦‚æœæ˜¯å­—æ¯çš„è¯ï¼Œé‚£å°±æ˜¯æ‰€è¦çš„å­—æ¯å¯¹åº”æ•°ç»„çš„ä½ç½®çš„ä½æ¬¡)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸‰ä½å¯¹åº”138è¯‘ç å™¨çš„ABCå£</p>
<p><img src="/../../../../medias/blog_picture/51/31.png" alt="138è¯‘ç å™¨"></p>
<p><strong>åŠ¨æ€æ˜¾ç¤º(å¤šä¸ªæ•°å­—ï¼Œéœ€è¦æ¶ˆå½±)</strong></p>
<p>æ¶ˆå½±</p>
<p>ä½é€‰ æ®µé€‰ ä½é€‰ æ®µé€‰**(è¿›è¡Œä¸‹ä¸€æ¬¡ä½é€‰æ—¶ï¼Œæ®µé€‰æ²¡æœ‰æ”¹å˜)**</p>
<p>æ”¹æˆï¼šä½é€‰ æ®µé€‰ <strong>æ¸…é›¶</strong> ä½é€‰ æ®µé€‰</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>

<span class="token keyword">unsigned</span> <span class="token keyword">char</span> NixieTable<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0x3F</span><span class="token punctuation">,</span><span class="token number">0x06</span><span class="token punctuation">,</span><span class="token number">0x5B</span><span class="token punctuation">,</span><span class="token number">0x4F</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x6D</span><span class="token punctuation">,</span><span class="token number">0x7D</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0x7F</span><span class="token punctuation">,</span><span class="token number">0x6F</span><span class="token punctuation">,</span><span class="token number">0x5E</span><span class="token punctuation">,</span><span class="token number">0x6E</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//0~9--&gt;0~9 10-d 11-y</span>

<span class="token keyword">void</span> <span class="token function">Delay</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> xms<span class="token punctuation">)</span>		<span class="token comment">//@11.0592MHz</span>
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>

	<span class="token keyword">while</span><span class="token punctuation">(</span>xms<span class="token operator">--</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
		j <span class="token operator">=</span> <span class="token number">199</span><span class="token punctuation">;</span>
		<span class="token keyword">do</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token function">Nixie</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> Location<span class="token punctuation">,</span>Number<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">switch</span><span class="token punctuation">(</span>Location<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token comment">//1st light--&gt; LED8</span>
		<span class="token comment">//8th light--&gt; LED1</span>
		<span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">6</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">7</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">8</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	P0<span class="token operator">=</span>NixieTable<span class="token punctuation">[</span>Number<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æŠŠè¿™å¥è¯åˆ æ‰çš„è¯å°±æ²¡é‚£ä¹ˆäº®ï¼Œåº”è¯¥æ˜¯è®©ä¸€ä¸ªä½ç½®ä¸Šçš„æ•°æ®ç®¡äº®å®Œ1msåè¿…é€Ÿæ¸…é›¶ï¼Œç„¶åå†äº®ä¸‹ä¸€ä¸ªï¼Œä¸‰ä¸ªç®¡éƒ½äº®å®Œåªéœ€è¦3msï¼Œä¸”ä¸­é—´æœ‰æ¸…é›¶è¿‡ç¨‹ï¼Œæ‰€ä»¥è§†è§‰ä¸Šçœ‹åˆ°çš„æ—¶ä¸‰ç®¡ç¯åŒæ—¶äº®</span>
	P0 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span><span class="token comment">//æ¸…é›¶è¿‡ç¨‹ï¼Œä¸è®©åˆ«çš„æ•°ç ç®¡çäº®</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>

		<span class="token function">Nixie</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">Nixie</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">Nixie</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">Nixie</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">Nixie</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



]]></content>
      <categories>
        <category>51å•ç‰‡æœº</category>
      </categories>
      <tags>
        <tag>51å•ç‰‡æœº</tag>
        <tag>å¤§äº‘å±‹è€ƒæ ¸</tag>
      </tags>
  </entry>
  <entry>
    <title>è¯»å†™æ–‡ä»¶</title>
    <url>/2023/02/10/wen-jian/</url>
    <content><![CDATA[<h3 id="ä¸€-æ–‡ä»¶çš„å½“å‰ä½ç½®æŒ‡é’ˆ"><a href="#ä¸€-æ–‡ä»¶çš„å½“å‰ä½ç½®æŒ‡é’ˆ" class="headerlink" title="ä¸€.æ–‡ä»¶çš„å½“å‰ä½ç½®æŒ‡é’ˆ"></a>ä¸€.æ–‡ä»¶çš„å½“å‰ä½ç½®æŒ‡é’ˆ</h3><p>æ–‡ä»¶ç»“æ„ç±»å‹<strong>FILE</strong></p>
<p>å…¶ä¸­FILE(ç»“æ„ä½“)åŒ…å«</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span>_ptr<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>ptr</strong>è¡¨ç¤ºå½“å‰çš„ä½ç½®æŒ‡é’ˆï¼ŒæŒ‡å‘å½“å‰çš„è¯»å†™ä½ç½®</p>
<h3 id="äºŒ-è·Ÿè¸ªæ–‡ä»¶çš„å½“å‰ä½ç½®æŒ‡é’ˆ"><a href="#äºŒ-è·Ÿè¸ªæ–‡ä»¶çš„å½“å‰ä½ç½®æŒ‡é’ˆ" class="headerlink" title="äºŒ.è·Ÿè¸ªæ–‡ä»¶çš„å½“å‰ä½ç½®æŒ‡é’ˆ"></a>äºŒ.è·Ÿè¸ªæ–‡ä»¶çš„å½“å‰ä½ç½®æŒ‡é’ˆ</h3><h4 id="ftellå‡½æ•°"><a href="#ftellå‡½æ•°" class="headerlink" title="ftellå‡½æ•°"></a>ftellå‡½æ•°</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">long</span> <span class="token function">ftell</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>filepointer<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å¦‚æœæ“ä½œæˆåŠŸï¼Œè¿”å›filepointeræ–‡ä»¶åœ°å½“å‰ä½ç½®æŒ‡é’ˆï¼Œ<code>å³ç›¸å¯¹äºæ–‡ä»¶å¼€å¤´çš„ä½ç§»é‡(å­—èŠ‚æ•°)</code></p>
<p>å¦åˆ™è¿”å›-1L</p>
<h4 id="feofå‡½æ•°"><a href="#feofå‡½æ•°" class="headerlink" title="feofå‡½æ•°"></a>feofå‡½æ•°</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">feof</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>filepointer<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æµ‹è¯•filepointeræ–‡ä»¶åœ°ä½ç½®æŒ‡é’ˆæ˜¯å¦æŒ‡å‘æ–‡ä»¶çš„æœ«å°¾</p>
<p>å¦‚æœfilepointeræ–‡ä»¶çš„ä½ç½®æŒ‡é’ˆå·²æŒ‡å‘æ–‡ä»¶çš„æœ«å°¾ï¼Œåˆ™è¿”å›é€»è¾‘çœŸï¼Œå¦åˆ™è¿”å›é€»è¾‘å‡</p>
<h3 id="ä¸‰-å®šä½æ–‡ä»¶çš„å½“å‰ä½ç½®æŒ‡é’ˆ"><a href="#ä¸‰-å®šä½æ–‡ä»¶çš„å½“å‰ä½ç½®æŒ‡é’ˆ" class="headerlink" title="ä¸‰.å®šä½æ–‡ä»¶çš„å½“å‰ä½ç½®æŒ‡é’ˆ"></a>ä¸‰.å®šä½æ–‡ä»¶çš„å½“å‰ä½ç½®æŒ‡é’ˆ</h3><h4 id="rewindå‡½æ•°"><a href="#rewindå‡½æ•°" class="headerlink" title="rewindå‡½æ•°"></a>rewindå‡½æ•°</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">rewind</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>filepointer<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>rewindå‡½æ•°å°†filepointeræ–‡ä»¶çš„å½“å‰ä½ç½®æŒ‡é’ˆå¼ºè¡Œå®šä½åˆ°æ–‡ä»¶çš„å¼€å¤´</p>
<h4 id="fseekå‡½æ•°"><a href="#fseekå‡½æ•°" class="headerlink" title="fseekå‡½æ•°"></a>fseekå‡½æ•°</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">fseek</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>filepointer<span class="token punctuation">,</span> <span class="token keyword">long</span> offest<span class="token punctuation">,</span> <span class="token keyword">int</span> origin<span class="token punctuation">)</span>
<span class="token comment">//filepointeræ˜¯æ–‡ä»¶æŒ‡é’ˆ</span>
<span class="token comment">/**
*offsetæ˜¯åç§»é‡ï¼Œç±»å‹ä¸ºlong int
æ–‡ä»¶å¼€å¤´------SEEK_SET--0
æ–‡ä»¶å½“å‰ä½ç½®---SEEK_CUR--1
æ–‡ä»¶æœ«å°¾------SEEK_END--2
//originæ˜¯èµ·å§‹ä½ç½®ï¼Œç±»å‹ä¸ºint</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>fseekå°†filepointeræ–‡ä»¶çš„å½“å‰ä½ç½®æŒ‡é’ˆç§»åŠ¨åˆ°<code>è·ç¦»originçš„offsetä½ç½®å¤„</code></p>
<p>offset&gt;0ï¼Œè¡¨ç¤ºæ–°ä½ç½®åœ¨originåï¼Œåä¹‹äº¦ç„¶</p>
<p>è‹¥æ“ä½œæˆåŠŸåˆ™è¿”å›0ï¼Œå¦åˆ™è¿”å›é0</p>
<h3 id="å››-æ–‡ä»¶çš„æ‰“å¼€ä¸å…³é—­"><a href="#å››-æ–‡ä»¶çš„æ‰“å¼€ä¸å…³é—­" class="headerlink" title="å››.æ–‡ä»¶çš„æ‰“å¼€ä¸å…³é—­"></a>å››.æ–‡ä»¶çš„æ‰“å¼€ä¸å…³é—­</h3><h4 id="fopen-å‡½æ•°"><a href="#fopen-å‡½æ•°" class="headerlink" title="fopen()å‡½æ•°"></a>fopen()å‡½æ•°</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c">FILE <span class="token operator">*</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>filename<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>mode<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//filenameæ˜¯è¦æ‰“å¼€çš„æ–‡ä»¶åï¼Œæ–‡ä»¶åå‰å¯ä»¥å¸¦è·¯å¾„</span>
<span class="token comment">//modeæ˜¯æ‰“å¼€æ–¹å¼</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœæ–‡ä»¶æ‰“å¼€æˆåŠŸï¼Œåˆ™è¿”å›æŒ‡å‘è¯¥æ–‡ä»¶çš„æŒ‡é’ˆ</p>
<p>å¦‚æœæ–‡ä»¶æ‰“å¼€å¤±è´¥ï¼Œåˆ™è¿”å›ç©ºæŒ‡é’ˆNULL</p>
<p>e.g.</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">FILE <span class="token operator">*</span>fp<span class="token punctuation">;</span>
fp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"f1.txt"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ¨èå†™æ³•</span>
<span class="token comment">//r:æ–‡ä»¶ä¸€å®šè¦å·²å­˜åœ¨</span>
fp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"c:\\aaa\\f1.txt"</span><span class="token punctuation">,</span> <span class="token string">"w+"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ä¸æ¨èå†™æ³•</span>
<span class="token comment">//w+:è‹¥æ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºæ–‡ä»¶ï¼Œå¯è¯»å¯å†™</span>
<span class="token keyword">char</span> filename<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"file\\f1.txt"</span><span class="token punctuation">;</span>
<span class="token comment">//å­˜å‚¨åˆ°å½“å‰ç›®å½•çš„fileå­ç›®å½•ä¸‹</span>
fp <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">"a+"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//a+:è‹¥æ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºæ–‡ä»¶ï¼Œå¯è¯»å¯å†™</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="fclose-å‡½æ•°"><a href="#fclose-å‡½æ•°" class="headerlink" title="fclose()å‡½æ•°"></a>fclose()å‡½æ•°</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">fclose</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>filepointer<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å¦‚æœæ­£å¸¸å…³é—­ï¼Œè¿”å›0ï¼Œå¦åˆ™è¿”å›é0</p>
<h3 id="äº”-æ–‡ä»¶è¯»å†™"><a href="#äº”-æ–‡ä»¶è¯»å†™" class="headerlink" title="äº”.æ–‡ä»¶è¯»å†™"></a>äº”.æ–‡ä»¶è¯»å†™</h3><h4 id="fgetcå‡½æ•°â€”å­—ç¬¦æ–¹å¼æ–‡ä»¶è¯»å†™"><a href="#fgetcå‡½æ•°â€”å­—ç¬¦æ–¹å¼æ–‡ä»¶è¯»å†™" class="headerlink" title="fgetcå‡½æ•°â€”å­—ç¬¦æ–¹å¼æ–‡ä»¶è¯»å†™"></a>fgetcå‡½æ•°â€”å­—ç¬¦æ–¹å¼æ–‡ä»¶è¯»å†™</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">fgetc</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>filepointer<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>fgetcä»filepointeræ–‡ä»¶çš„<code>å½“å‰ä½ç½®</code>è¯»å‡ºä¸€ä¸ªå­—ç¬¦ï¼ŒåŒæ—¶å°†æ–‡ä»¶çš„<code>ä½ç½®æŒ‡é’ˆ_ptr</code>åç§»ä¸€ä¸ªå­—èŠ‚ã€‚è¯»å‡ºçš„å­—èŠ‚ä¸€èˆ¬è¦ä¿å­˜åˆ°ä¸€ä¸ªå­—ç¬¦å‹å˜é‡ä¸­</p>
<p>å¦‚æœè¯»å–æˆåŠŸï¼Œè¿”å›<strong>è¯»å–çš„å­—èŠ‚å€¼</strong>ï¼›</p>
<p>å¦‚æœè¯»åˆ°æ–‡ä»¶å°¾æˆ–å‡ºé”™ï¼Œè¿”å›<strong>EOF</strong></p>
<h4 id="fgetså‡½æ•°â€”å­—ç¬¦ä¸²æ–¹å¼æ–‡ä»¶è¯»å†™"><a href="#fgetså‡½æ•°â€”å­—ç¬¦ä¸²æ–¹å¼æ–‡ä»¶è¯»å†™" class="headerlink" title="fgetså‡½æ•°â€”å­—ç¬¦ä¸²æ–¹å¼æ–‡ä»¶è¯»å†™"></a>fgetså‡½æ•°â€”å­—ç¬¦ä¸²æ–¹å¼æ–‡ä»¶è¯»å†™</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">fgets</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">,</span> FILE <span class="token operator">*</span>filepointer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//*stræ˜¯è¯»å‡ºçš„å­—ç¬¦ä¸²è¦å­˜æ”¾çš„åœ°æ–¹</span>
<span class="token comment">//n:è¯»å–é•¿åº¦ä¸ºn-1ï¼Œåœ¨æœ«å°¾åŠ ä¸Š'\0'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>è¯»å–æˆåŠŸï¼Œè¿”å›æŒ‡å‘å­—ç¬¦ä¸²çš„æŒ‡é’ˆ</p>
<p>å¤±è´¥æˆ–å‡ºé”™ï¼Œè¿”å›NULL</p>
<h4 id="fprintfå‡½æ•°å’Œfscanfå‡½æ•°â€”æ ¼å¼åŒ–è¯»å–"><a href="#fprintfå‡½æ•°å’Œfscanfå‡½æ•°â€”æ ¼å¼åŒ–è¯»å–" class="headerlink" title="fprintfå‡½æ•°å’Œfscanfå‡½æ•°â€”æ ¼å¼åŒ–è¯»å–"></a>fprintfå‡½æ•°å’Œfscanfå‡½æ•°â€”æ ¼å¼åŒ–è¯»å–</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">fscanf</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>filepointer<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>format<span class="token punctuation">[</span><span class="token punctuation">,</span>adress<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>filepointer<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>format<span class="token punctuation">[</span><span class="token punctuation">,</span>adress<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>e.g.</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> x<span class="token punctuation">;</span>
<span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">;</span>
<span class="token function">fscanf</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span><span class="token string">"%d%s"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>x<span class="token punctuation">,</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ä»æ–‡ä»¶ä¸­è¯»å–</span>

<span class="token keyword">int</span> y<span class="token punctuation">;</span>
<span class="token keyword">float</span> y <span class="token operator">=</span><span class="token number">5.8</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span><span class="token string">"%d,%6.2f"</span><span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å†™å…¥æ–‡ä»¶ä¸­</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¤±è´¥è¿”å›EOF</p>
<h4 id="fwriteå‡½æ•°å’Œfreadå‡½æ•°â€”äºŒè¿›åˆ¶æ–¹å¼æ–‡ä»¶è¯»å†™"><a href="#fwriteå‡½æ•°å’Œfreadå‡½æ•°â€”äºŒè¿›åˆ¶æ–¹å¼æ–‡ä»¶è¯»å†™" class="headerlink" title="fwriteå‡½æ•°å’Œfreadå‡½æ•°â€”äºŒè¿›åˆ¶æ–¹å¼æ–‡ä»¶è¯»å†™"></a>fwriteå‡½æ•°å’Œfreadå‡½æ•°â€”äºŒè¿›åˆ¶æ–¹å¼æ–‡ä»¶è¯»å†™</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">,</span><span class="token keyword">unsigned</span> size<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> n<span class="token punctuation">,</span> FILE <span class="token operator">*</span>filepointer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//ptr:æ•°æ®å­˜å‚¨ä½ç½®</span>
<span class="token comment">//size:æ•°æ®æ‰€å å­—èŠ‚æ•°</span>
<span class="token comment">//n:å†™å…¥nä¸ªæ•°æ®</span>
<span class="token comment">//filepointer:å‘è¿™ä¸ªæ–‡ä»¶å†™</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>freadåŒç†</p>
]]></content>
      <categories>
        <category>Cè¯­è¨€</category>
      </categories>
      <tags>
        <tag>Cè¯­è¨€</tag>
        <tag>é—²ç€æ²¡äº‹å¹²</tag>
      </tags>
  </entry>
  <entry>
    <title>ç‚¹é˜µå±</title>
    <url>/2022/10/12/dian-zhen-ping/</url>
    <content><![CDATA[<h1 id="ç‚¹é˜µå±"><a href="#ç‚¹é˜µå±" class="headerlink" title="ç‚¹é˜µå±"></a>ç‚¹é˜µå±</h1><p>è·Ÿæ•°ç ç®¡åŸç†æœ‰ä¸€äº›ç±»ä¼¼</p>
<p><img src="/../../../../medias/blog_picture/51/4.png" alt="æ˜¾ç¤ºåŸç†"></p>
<p><img src="/../../../../medias/blog_picture/51/5.png" alt="è¡Œä¸åˆ—çš„æ§åˆ¶å…³ç³»"></p>
<p>åœˆèµ·æ¥éƒ¨åˆ†ç”¨æ¥æ§åˆ¶<strong>è¡Œ</strong>æˆ–<strong>åˆ—</strong></p>
<p><img src="/../../../../medias/blog_picture/51/6.png" alt="å¼€å‘æ¿å¼•è„šå¯¹åº”å…³ç³»"></p>
<p>åˆ—ç›´æ¥ç»™P0èµ‹å€¼æ¥æ§åˆ¶</p>
<p>ä½†æ˜¯è¡Œè¦ç”¨åˆ°74HC595</p>
<p>æå‡ºï¼šè‹¥æ˜¯å•ç‰‡æœºä¸Šåªæœ‰è¿™ä¸ªLEDç‚¹é˜µå±ï¼Œå…¶ä»–éƒ½ä¸è¦ï¼Œå¯ä¸å¯ä»¥æŠŠD1-D7çš„æ¥åœ¨P1å£ä¸Š</p>
<p>å›ç­”ï¼šä¸è¡Œï¼Œå› ä¸ºå•ç‰‡æœºçš„IOå£æ˜¯å¼±ä¸Šæ‹‰ç‰¹æ€§</p>
<p>å¼±ä¸Šæ‹‰ï¼šè¾“å‡º**ä½ç”µå¹³(ç›´æ¥æ¥GND)<strong>æ—¶ç”µæµå¯ä»¥å¾ˆå¤§ï¼Œè¾“å‡º</strong>é«˜ç”µå¹³(ç›¸å½“äºæ¥äº†ä¸€ä¸ªç”µé˜»å†æ¥VCC)**æ—¶ç”µæµå¾ˆå°</p>
<p><img src="/../../../../medias/blog_picture/51/7.png" alt="IOå£">ç”¨åˆ°ä¸‰æç®¡ï¼Œæ¥IOå£å°±å¯ä»¥</p>
<p>IOå£ä½ç”µå¹³ï¼ŒVCCç›´æ¥é€šåˆ°4é‚£ï¼ŒIOèµ·æ§åˆ¶ä½œç”¨ï¼Œè‡ªå·±å¹²ä¸åŠ¨ä¸å¹²æ´»è€ŒæŒ‡ä½¿åˆ«äººå¹²æ´»</p>
<p>IOå£ç»™é«˜ç”µå¹³çš„æ—¶å€™å°±ä¼šæˆªæ­¢ï¼Œç›¸å½“äºæ²¡æœ‰æ¥</p>
<h2 id="IOå£æ‰©å±•"><a href="#IOå£æ‰©å±•" class="headerlink" title="IOå£æ‰©å±•"></a>IOå£æ‰©å±•</h2><h3 id="OE-output-enableè¾“å‡ºä½¿èƒ½"><a href="#OE-output-enableè¾“å‡ºä½¿èƒ½" class="headerlink" title="OE(output enableè¾“å‡ºä½¿èƒ½)"></a>OE(output enableè¾“å‡ºä½¿èƒ½)</h3><p><img src="/../../../../medias/blog_picture/51/8.png" alt="OE"></p>
<h3 id="å¯„å­˜å™¨æ—¶é’Ÿï¼ŒRCLK-register-clock"><a href="#å¯„å­˜å™¨æ—¶é’Ÿï¼ŒRCLK-register-clock" class="headerlink" title="å¯„å­˜å™¨æ—¶é’Ÿï¼ŒRCLK(register clock)"></a>å¯„å­˜å™¨æ—¶é’Ÿï¼ŒRCLK(register clock)</h3><p>ä¸Šæ–¹æœ‰â€”ï¼Œè¡¨ç¤ºå®ƒè¦æ¥ä½ç”µå¹³ï¼Œæ‰€ä»¥JOEé‚£è¦å’ŒGNDçŸ­æ¥ï¼Œæ‰èƒ½æœ‰è¾“å‡º</p>
<p><img src="/../../../../medias/blog_picture/51/9.png" alt="RCLK"></p>
<h3 id="SRCLRä¸²è¡Œæ¸…é›¶ç«¯"><a href="#SRCLRä¸²è¡Œæ¸…é›¶ç«¯" class="headerlink" title="SRCLRä¸²è¡Œæ¸…é›¶ç«¯"></a>SRCLRä¸²è¡Œæ¸…é›¶ç«¯</h3><p>æ¥äº†VCCä»£è¡¨å®ƒä¸æ¸…ç©º</p>
<p><img src="/../../../../medias/blog_picture/51/10.png" alt="SRCLR"></p>
<h3 id="SRCLKä¸²è¡Œæ—¶é’Ÿ"><a href="#SRCLKä¸²è¡Œæ—¶é’Ÿ" class="headerlink" title="SRCLKä¸²è¡Œæ—¶é’Ÿ"></a>SRCLKä¸²è¡Œæ—¶é’Ÿ</h3><p>ä¸Šå‡æ²¿æ˜¯PWMæ³¢çš„ä»ä½ç”µå¹³åˆ°é«˜ç”µå¹³çš„ä¸€ç¬é—´</p>
<p><img src="/../../../../medias/blog_picture/51/11.png" alt="SRCLK"></p>
<h3 id="SERä¸²è¡Œæ•°æ®"><a href="#SERä¸²è¡Œæ•°æ®" class="headerlink" title="SERä¸²è¡Œæ•°æ®"></a>SERä¸²è¡Œæ•°æ®</h3><p><img src="/../../../../medias/blog_picture/51/12.png" alt="SER"></p>
<p>ä¸»è¦ç”¨è¿™ä¸‰ä¸ªå¼•è„šæ§åˆ¶å…«ä¸ªè¾“å‡º</p>
<p><img src="/../../../../medias/blog_picture/51/13.png" alt="ä¸‰ä¸ªå¼•è„šæ§åˆ¶å…«ä¸ªè¾“å‡º"></p>
<h3 id="ä¸²è¡Œvså¹¶è¡Œ"><a href="#ä¸²è¡Œvså¹¶è¡Œ" class="headerlink" title="ä¸²è¡Œvså¹¶è¡Œ"></a>ä¸²è¡Œvså¹¶è¡Œ</h3><p><img src="/../../../../medias/blog_picture/51/14.png" alt="ä¸²è¡Œæ˜¯è¿™æ ·å­ä¸€ä¸ªä¸€ä¸ªå‡ºå»çš„"></p>
<p>å¹¶è¡Œæ˜¯ç”¨é‚£å…«ä¸ªè¾“å‡ºç«¯åŒæ—¶è¾“å‡º</p>
<h3 id="ä¸²è¡Œè¾“å…¥-å¹¶è¡Œè¾“å‡º"><a href="#ä¸²è¡Œè¾“å…¥-å¹¶è¡Œè¾“å‡º" class="headerlink" title="ä¸²è¡Œè¾“å…¥ å¹¶è¡Œè¾“å‡º"></a>ä¸²è¡Œè¾“å…¥ å¹¶è¡Œè¾“å‡º</h3><p>æ¯ä¸Šå‡æ²¿ç§»ä½ï¼Œä»SERè¿›çš„æ•°æ®å°±å‘ä¸‹æ²¿ç§»ä½ï¼ŒSERCLKé«˜ç”µå¹³çš„æ—¶å€™ç§»è¿›ï¼Œæ•°æ®ä¸€ä½ä¸€ä½åœ°å¾€å‰èµ°ï¼Œç­‰æœ‰äº†å…«ä½æ•°æ®ä¹‹ååŒæ—¶æ¬è¿‡å»è¾“å‡ºç¼“å­˜é‚£ï¼Œä¸²è¡Œé‚£é‡Œæ¯è¾“å…¥ä¸€ä½ï¼ŒSERæ¸…é›¶ï¼Œæ•°æ®ä¸‹ç§»</p>
<p><img src="/../../../../medias/blog_picture/51/15.png" alt="74HC595"></p>
<p>å½“å¯„å­˜å™¨æ»¡ä½åï¼Œç»™RCLKé«˜ç”µå¹³ï¼ŒæŠŠæ•°æ®æ¬è¿åˆ°è¾“å‡ºç¼“å­˜é‚£</p>
<h3 id="å¤šç‰‡çº§è”"><a href="#å¤šç‰‡çº§è”" class="headerlink" title="å¤šç‰‡çº§è”"></a>å¤šç‰‡çº§è”<img src="/../../../../medias/blog_picture/51/16.png" alt="å¤šç‰‡çº§è”"></h3><p>åœ¨å¯„å­˜å™¨çš„æ•°æ®ä¼ åˆ°QHâ€™ï¼Œç„¶åå¤šç‰‡çº§è”åˆ°ä¸‹ä¸€ä¸ªSERï¼Œå½“æ‰€æœ‰æ•°æ®å°±ä½äº†ï¼Œæ¥ä¸€ä¸ªä¸Šå‡æ²¿é”å­˜ï¼Œæ‰€æœ‰æ•°æ®éƒ½ç›¸åº”åœ°è¾“å‡ºï¼Œå®ç°äº†IOå£çš„æ‰©å±•ï¼Œä½†æ˜¯é€Ÿç‡ä¼šæœ‰æ‰€å‡æ…¢(æ—¶é—´æ¢æ—¶ç©º)</p>
<h2 id="sfrå’Œsbitå¯ä½å¯»å€-ä¸å¯ä½å¯»å€"><a href="#sfrå’Œsbitå¯ä½å¯»å€-ä¸å¯ä½å¯»å€" class="headerlink" title="sfrå’Œsbit	å¯ä½å¯»å€/ä¸å¯ä½å¯»å€"></a>sfrå’Œsbit	å¯ä½å¯»å€/ä¸å¯ä½å¯»å€</h2><p>sfrï¼šç‰¹æ®ŠåŠŸèƒ½å¯„å­˜å™¨å£°æ˜(å£°æ˜å¯„å­˜å™¨åœ°å€)	ç›¸å½“äºæŠŠæŸä¸ªå…ƒä»¶çš„æ“ä½œåœ°å€èµ‹ç»™ä¸€ä¸ªè‡ªå®šä¹‰çš„å˜é‡åï¼ŒæŠŠç›¸åº”çš„åç§°å’Œåœ°å€ç»™å£°æ˜å‡ºæ¥ï¼Œæˆ‘ä»¬æ‰èƒ½æ“ä½œé‚£ä¸ªåç§°</p>
<p>sbitï¼šç‰¹æ®Šä½å£°æ˜(å£°æ˜åœ°å€çš„æŸä¸€ä½)</p>
<p><img src="/../../../../medias/blog_picture/51/17.png" alt="C51çš„sfrã€sbit"></p>
<p>å¯ä½å¯»å€å’Œä¸å¯ä½å¯»å€å°±ç±»æ¯”äºCè¯­è¨€çš„æ•°ç»„ï¼Œå¯ä½å¯»å€çš„å°±æ˜¯æ•°ç»„çš„é¦–åœ°å€ï¼Œä¸æ˜¯é¦–åœ°å€çš„å°±ä¸èƒ½ä½å¯»å€</p>
<h2 id="ä¸Šä»£ç -ç¬‘è„¸"><a href="#ä¸Šä»£ç -ç¬‘è„¸" class="headerlink" title="ä¸Šä»£ç (ç¬‘è„¸)"></a>ä¸Šä»£ç (ç¬‘è„¸)</h2><h3 id="main-c"><a href="#main-c" class="headerlink" title="main.c"></a>main.c</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Delay.h"</span></span>

<span class="token comment">//ç»™IOå£æ”¹å</span>
sbit RCK<span class="token operator">=</span>P3<span class="token operator">^</span><span class="token number">5</span><span class="token punctuation">;</span>	<span class="token comment">//RCLK,åº”è¯¥æ˜¯èµ‹å€¼çš„æ—¶å€™ç”¨_ï¼Œç»™åœ°å€çš„æ—¶å€™ç”¨^ï¼Œè¿™é‡Œæ˜¯è®©rclkç›´æ¥æ‰¾åˆ°p3_5çš„åœ°å€æ‰€ä»¥ç”¨^</span>
sbit SCK<span class="token operator">=</span>P3<span class="token operator">^</span><span class="token number">6</span><span class="token punctuation">;</span>	<span class="token comment">//SRCLK</span>
sbit SER<span class="token operator">=</span>P3<span class="token operator">^</span><span class="token number">4</span><span class="token punctuation">;</span>	<span class="token comment">//SER</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MATRIX_LED_PORT</span> <span class="token expression">P0</span><span class="token comment">//å¦‚æœä»¥åè‡ªå·±ç„Šæ¿å­ç©æ¥å£ä¸å¯¹ï¼Œç›´æ¥æ”¹ä¸Šé¢sbitï¼Œä¸ç”¨å†åœ¨ä¸‹é¢æ”¹äº†</span></span>

<span class="token comment">/**
  * @brief  74HC595å†™å…¥ä¸€ä¸ªå­—èŠ‚
  * @param  è¦å†™å…¥çš„å­—èŠ‚
  * @retval æ— 
  */</span>

<span class="token keyword">void</span> <span class="token function">_74JHC595_WriteByte</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> Byte<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> i<span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">8</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		SER<span class="token operator">=</span>Byte<span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token number">0x80</span><span class="token operator">&gt;&gt;</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//0x80--&gt;1000 0000</span>
		SCK<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//ç»™é«˜ç”µå¹³å½¢æˆä¸Šå‡æ²¿ä¼ å…¥æ•°æ®</span>
		SCK<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//ç½®é›¶ä¸ºä¸‹ä¸€æ¬¡ä¼ å…¥åšå‡†å¤‡</span>
	<span class="token punctuation">}</span>
	RCK<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//é«˜ç”µå¹³ï¼Œå½¢æˆä¸Šå‡æ²¿é”å­˜</span>
	RCK<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//ç½®é›¶</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* @brief  LEDç‚¹é˜µå±æ˜¾ç¤ºä¸€åˆ—æ•°æ®
* @param  Column è¦é€‰æ‹©çš„åˆ—ï¼ŒèŒƒå›´0~7ï¼Œ0åœ¨æœ€å·¦è¾¹
* @param  Data é€‰æ‹©åˆ—æ˜¾ç¤ºçš„æ•°æ®ï¼Œé«˜ä½åœ¨ä¸Šï¼Œ1ä¸ºäº®ï¼Œ0ä¸ºç­
* @retval æ— 
  */</span>

<span class="token keyword">void</span> <span class="token function">MatrixLED_ShowColumn</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> Cloumn<span class="token punctuation">,</span>Data<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">_74JHC595_WriteByte</span><span class="token punctuation">(</span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ”¾æ•°æ®</span>
	MATRIX_LED_PORT<span class="token operator">=</span><span class="token operator">~</span><span class="token punctuation">(</span><span class="token number">0x80</span><span class="token operator">&gt;&gt;</span>Cloumn<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ä½é€‰ï¼›é€‰æ‹©åˆ—ï¼Œç„¶åæŠŠæ•°æ®0xAAä¼ åˆ°LEDåˆ—ä¸­ï¼›</span>
	<span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å»¶æ—¶</span>
	MATRIX_LED_PORT<span class="token operator">=</span><span class="token number">0xFF</span><span class="token punctuation">;</span><span class="token comment">//ä½æ¸…é›¶ï¼Œä¸‹ä¸€æ­¥æ˜¯æ®µé€‰ï¼Œè¿™æ ·ä¸‹æ¬¡æ®µé€‰å°±ä¸ä¼šä¸²ä½åˆ°ä¸Šä¸€ä¸ªä½é€‰äº†</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	SCK<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//å› ä¸ºä¸Šç”µé»˜è®¤é«˜ç”µå¹³,å…ˆç½®0ï¼Œæ‰èƒ½ç»™é«˜ç”µå¹³ï¼›éœ€è¦ä¸€ä¸ªä¸Šå‡æ²¿æ‰èƒ½ä¼ å…¥æ•°æ®</span>
	RCK<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//åˆå§‹åŒ–ä¸ºä½ç”µå¹³</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">MatrixLED_ShowColumn</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x3C</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">MatrixLED_ShowColumn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0x42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">MatrixLED_ShowColumn</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0xA9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">MatrixLED_ShowColumn</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0x85</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">MatrixLED_ShowColumn</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">0x85</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">MatrixLED_ShowColumn</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0xA9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">MatrixLED_ShowColumn</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">0x42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">MatrixLED_ShowColumn</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">0x3C</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="æŠ -ç†-è§£-å¼€æŠ ï¼ï¼ï¼"><a href="#æŠ -ç†-è§£-å¼€æŠ ï¼ï¼ï¼" class="headerlink" title="æŠ  ç† è§£      å¼€æŠ ï¼ï¼ï¼"></a>æŠ  ç† è§£      å¼€æŠ ï¼ï¼ï¼</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">8</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		SER<span class="token operator">=</span>Byte<span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token number">0x80</span><span class="token operator">&gt;&gt;</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//0x80--&gt;1000 0000</span>
		SCK<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//ç»™é«˜ç”µå¹³å½¢æˆä¸Šå‡æ²¿ä¼ å…¥æ•°æ®</span>
		SCK<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//ç½®é›¶ä¸ºä¸‹ä¸€æ¬¡ä¼ å…¥åšå‡†å¤‡</span>
	<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>SERæ˜¯ä¸€ä½è€ŒByteæ˜¯8ä½ï¼Œæ¶‰åŠåˆ°ä½å¯¹é½é—®é¢˜</p>
<p>ç†è§£ï¼šå‡å¦‚Byteæ˜¯0x55(0101 0101)</p>
<p>i=0	(0x80&gt;&gt;i)=1000 0000</p>
<p>SER=<strong>0</strong>101 0101 &amp; <strong>1</strong>000 0000 =<strong>0</strong>000 0000â€”â€”-æ ¹æ®é<strong>0</strong>å³1ï¼ŒSERä¸º<strong>0</strong></p>
<p>i=1	(0x80&gt;&gt;i)=0100 0000</p>
<p>SER=0<strong>1</strong>01 0101 &amp; 0<strong>1</strong>00 0000 =0<strong>1</strong>00 0000â€”â€”-æ ¹æ®é0å³<strong>1</strong>ï¼ŒSERä¸º<strong>1</strong></p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>i=7	(0x80&gt;&gt;i)=0000 0001</p>
<p>SER=0101 010<strong>1</strong> &amp; 0000 0001 =0000 0001â€”â€”-æ ¹æ®é0å³<strong>1</strong>ï¼ŒSERä¸º<strong>1</strong></p>
<p><img src="/../../../../medias/blog_picture/51/18.png" alt="æœ€åå˜æˆè¿™æ ·"></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">SCK<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//ç»™é«˜ç”µå¹³å½¢æˆä¸Šå‡æ²¿ä¼ å…¥æ•°æ®</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/../../../../medias/blog_picture/51/19.png" alt="."></p>
<p>æ®µé€‰ ä½é€‰ <strong>å»¶æ—¶</strong> <strong>ä½æ¸…é›¶</strong> æ®µé€‰ ä½é€‰</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/**
* @brief  LEDç‚¹é˜µå±æ˜¾ç¤ºä¸€åˆ—æ•°æ®
* @param  Column è¦é€‰æ‹©çš„åˆ—ï¼ŒèŒƒå›´0~7ï¼Œ0åœ¨æœ€å·¦è¾¹
* @param  Data é€‰æ‹©åˆ—æ˜¾ç¤ºçš„æ•°æ®ï¼Œé«˜ä½åœ¨ä¸Šï¼Œ1ä¸ºäº®ï¼Œ0ä¸ºç­
* @retval æ— 
*/</span>

<span class="token keyword">void</span> <span class="token function">MatrixLED_ShowColumn</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> Cloumn<span class="token punctuation">,</span>Data<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">_74JHC595_WriteByte</span><span class="token punctuation">(</span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ”¾æ•°æ®</span>
	MATRIX_LED_PORT<span class="token operator">=</span><span class="token operator">~</span><span class="token punctuation">(</span><span class="token number">0x80</span><span class="token operator">&gt;&gt;</span>Cloumn<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ä½é€‰ï¼›é€‰æ‹©åˆ—ï¼Œç„¶åæŠŠæ•°æ®0xAAä¼ åˆ°LEDåˆ—ä¸­ï¼›</span>
	<span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å»¶æ—¶</span>
	MATRIX_LED_PORT<span class="token operator">=</span><span class="token number">0xFF</span><span class="token punctuation">;</span><span class="token comment">//ä½æ¸…é›¶ï¼Œä¸‹ä¸€æ­¥æ˜¯æ®µé€‰ï¼Œè¿™æ ·ä¸‹æ¬¡æ®µé€‰å°±ä¸ä¼šä¸²ä½åˆ°ä¸Šä¸€ä¸ªä½é€‰äº†</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-c" data-language="c"><code class="language-c">MATRIX_LED_PORT<span class="token operator">=</span><span class="token operator">~</span><span class="token punctuation">(</span><span class="token number">0x80</span><span class="token operator">&gt;&gt;</span>Cloumn<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¿™é‡Œå–åæ˜¯ä¸ºäº†è®©1è¡¨ç¤ºäº®ï¼Œ0è¡¨ç¤ºç­ï¼ŒåŒæ—¶&gt;&gt;è¡¥ä½è¡¥çš„æ˜¯0</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="ä¸Šä»£ç -Hello-æ»šå±"><a href="#ä¸Šä»£ç -Hello-æ»šå±" class="headerlink" title="ä¸Šä»£ç (Hello!æ»šå±)"></a>ä¸Šä»£ç (Hello!æ»šå±)</h2><h3 id="main-c-1"><a href="#main-c-1" class="headerlink" title="main.c"></a>main.c</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Delay.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"MatrixLED.h"</span></span>

<span class="token comment">//code æŠŠAnimationçš„æ•°æ®æ”¾åœ¨flashé‡Œ(å†…å­˜å¤§)ï¼ŒæŠŠrunçš„ç©ºé—´è…¾å‡ºæ¥åšå…¶ä»–äº‹æƒ…ï¼Œç¼ºç‚¹æ˜¯Animationçš„æ•°æ®ä¸èƒ½å†æ›´æ”¹äº†(åªèƒ½è¯»å–ä¸èƒ½å†™å…¥)</span>
<span class="token keyword">unsigned</span> <span class="token keyword">char</span> code Animation<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span>
	<span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span>
	<span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x0E</span><span class="token punctuation">,</span><span class="token number">0x15</span><span class="token punctuation">,</span>
	<span class="token number">0x15</span><span class="token punctuation">,</span><span class="token number">0x15</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x7E</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span>
	<span class="token number">0x7E</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x0E</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x0E</span><span class="token punctuation">,</span>
	<span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x7D</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span>
	<span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> i<span class="token punctuation">,</span>Offset<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>Count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//offsetåç§»é‡</span>
	<span class="token function">MartrixLED_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">8</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">MatrixLED_ShowColumn</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>Animation<span class="token punctuation">[</span>i<span class="token operator">+</span>Offset<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		Count<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//ä¸èƒ½ç”¨Delay,ä¸ç„¶ä¼šå‡ºç°é—ªå±ç°è±¡</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>Count<span class="token operator">&gt;</span><span class="token number">10</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			Count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
			Offset<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>Offset<span class="token operator">&gt;</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token comment">//å†™è¿™ä¸ªä¸ºäº†ä¸è®©Offsetæº¢å‡ºäº§ç”Ÿä¹±ç </span>
			<span class="token punctuation">{</span>
				Offset<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//ç›¸å½“äºæ‰«äº†10éåç§»å‘ä¸‹ä¸€å¸§</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>â‘ å…ˆè§£é‡Šä¸»å‡½æ•°çš„for</strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">8</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">MatrixLED_ShowColumn</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>Animation<span class="token punctuation">[</span>i<span class="token operator">+</span>Offset<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>	<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ª<strong>MatrixLED_ShowColumn</strong>æ˜¯æ”¾æ•°æ®ï¼Œå®‰æ’æ¯ä¸€åˆ—çš„ï¼Œiè¡¨ç¤ºåˆ—ï¼ŒAnimation[]æ˜¯æ•°ç»„ï¼Œ<strong>i+Offset</strong>æ˜¯è¦æŠŠ<strong>ä¸€å¹•ä¸­çš„å…«åˆ—</strong>éƒ½æ‰“å‡ºæ¥</p>
<p><strong>â‘¡if</strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">Count<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//ä¸èƒ½ç”¨Delay,ä¸ç„¶ä¼šå‡ºç°é—ªå±ç°è±¡</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>Count<span class="token operator">&gt;</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	Count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	Offset<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>Offset<span class="token operator">&gt;</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token comment">//å†™è¿™ä¸ªä¸ºäº†ä¸è®©Offsetæº¢å‡ºäº§ç”Ÿä¹±ç </span>
	<span class="token punctuation">{</span>
		Offset<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç”¨Countæ¥è®¡æ—¶ï¼Œå½“Count&gt;10åï¼Œ<strong>Offset++ï¼Œå±å¹•ä¸­çš„ç”»é¢å¼€å§‹å¾€å³ç§»ï¼Œæ¯æ¬¡ç§»åŠ¨ä¸€åˆ—ï¼Œ</strong>Offset&gt;40ï¼Œè¿™ä¸ª40=<strong>8*6(å…¨éƒ¨)â€”8(ç¬¬ä¸€å¹•çš„ä¸éœ€è¦ç§»åŠ¨)</strong></p>
<p><strong>â‘¢æœ‰16ä¸ª0x00</strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">char</span> code Animation<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">{</span>
	<span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è®©**Hçš„å·¦è¾¹çš„|<strong>ä»æœ€åä¸€åˆ—å‡ºç°ï¼Œè®©</strong>!**ä»ç¬¬ä¸€åˆ—ç¦»å¼€</p>
<h3 id="MatrixLED-c-æ˜¯ä¸Šä¸€ä¸ªä¸»å‡½æ•°é‡Œæ‰’æ‹‰ä¸‹æ¥çš„"><a href="#MatrixLED-c-æ˜¯ä¸Šä¸€ä¸ªä¸»å‡½æ•°é‡Œæ‰’æ‹‰ä¸‹æ¥çš„" class="headerlink" title="MatrixLED.c(æ˜¯ä¸Šä¸€ä¸ªä¸»å‡½æ•°é‡Œæ‰’æ‹‰ä¸‹æ¥çš„)"></a>MatrixLED.c(æ˜¯ä¸Šä¸€ä¸ªä¸»å‡½æ•°é‡Œæ‰’æ‹‰ä¸‹æ¥çš„)</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Delay.h"</span></span>

<span class="token comment">//ç»™IOå£æ”¹å</span>
sbit RCK<span class="token operator">=</span>P3<span class="token operator">^</span><span class="token number">5</span><span class="token punctuation">;</span>	<span class="token comment">//RCLK,åº”è¯¥æ˜¯èµ‹å€¼çš„æ—¶å€™ç”¨_ï¼Œç»™åœ°å€çš„æ—¶å€™ç”¨^ï¼Œè¿™é‡Œæ˜¯è®©rclkç›´æ¥æ‰¾åˆ°p3_5çš„åœ°å€æ‰€ä»¥ç”¨^</span>
sbit SCK<span class="token operator">=</span>P3<span class="token operator">^</span><span class="token number">6</span><span class="token punctuation">;</span>	<span class="token comment">//SRCLK</span>
sbit SER<span class="token operator">=</span>P3<span class="token operator">^</span><span class="token number">4</span><span class="token punctuation">;</span>	<span class="token comment">//SER</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MATRIX_LED_PORT</span> <span class="token expression">P0</span><span class="token comment">//å¦‚æœä»¥åè‡ªå·±ç„Šæ¿å­ç©æ¥å£ä¸å¯¹ï¼Œç›´æ¥æ”¹ä¸Šé¢sbitï¼Œä¸ç”¨å†åœ¨ä¸‹é¢æ”¹äº†</span></span>

<span class="token comment">/**
  * @brief  74HC595å†™å…¥ä¸€ä¸ªå­—èŠ‚
  * @param  è¦å†™å…¥çš„å­—èŠ‚
  * @retval æ— 
  */</span>

<span class="token keyword">void</span> <span class="token function">_74JHC595_WriteByte</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> Byte<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> i<span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">8</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		SER<span class="token operator">=</span>Byte<span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token number">0x80</span><span class="token operator">&gt;&gt;</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//0x80--&gt;1000 0000</span>
		SCK<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//ç»™é«˜ç”µå¹³å½¢æˆä¸Šå‡æ²¿ä¼ å…¥æ•°æ®</span>
		SCK<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//ç½®é›¶ä¸ºä¸‹ä¸€æ¬¡ä¼ å…¥åšå‡†å¤‡</span>
	<span class="token punctuation">}</span>
	RCK<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//é«˜ç”µå¹³ï¼Œå½¢æˆä¸Šå‡æ²¿é”å­˜</span>
	RCK<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//ç½®é›¶</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
  * @brief  ç‚¹é˜µå±åˆå§‹åŒ–
  * @param  æ— 
  * @retval æ— 
  */</span>
<span class="token keyword">void</span> <span class="token function">MartrixLED_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	SCK<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//å› ä¸ºä¸Šç”µé»˜è®¤é«˜ç”µå¹³,å…ˆç½®0ï¼Œæ‰èƒ½ç»™é«˜ç”µå¹³ï¼›éœ€è¦ä¸€ä¸ªä¸Šå‡æ²¿æ‰èƒ½ä¼ å…¥æ•°æ®</span>
	RCK<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//åˆå§‹åŒ–ä¸ºä½ç”µå¹³</span>
<span class="token punctuation">}</span>


<span class="token comment">/**
* @brief  LEDç‚¹é˜µå±æ˜¾ç¤ºä¸€åˆ—æ•°æ®
* @param  Column è¦é€‰æ‹©çš„åˆ—ï¼ŒèŒƒå›´0~7ï¼Œ0åœ¨æœ€å·¦è¾¹
* @param  Data é€‰æ‹©åˆ—æ˜¾ç¤ºçš„æ•°æ®ï¼Œé«˜ä½åœ¨ä¸Šï¼Œ1ä¸ºäº®ï¼Œ0ä¸ºç­
* @retval æ— 
  */</span>

<span class="token keyword">void</span> <span class="token function">MatrixLED_ShowColumn</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> Cloumn<span class="token punctuation">,</span>Data<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">_74JHC595_WriteByte</span><span class="token punctuation">(</span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ”¾æ•°æ®</span>
	MATRIX_LED_PORT<span class="token operator">=</span><span class="token operator">~</span><span class="token punctuation">(</span><span class="token number">0x80</span><span class="token operator">&gt;&gt;</span>Cloumn<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ä½é€‰ï¼›é€‰æ‹©åˆ—ï¼Œç„¶åæŠŠæ•°æ®0xAAä¼ åˆ°åˆ—ä¸­ï¼›</span>
	<span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å»¶æ—¶</span>
	MATRIX_LED_PORT<span class="token operator">=</span><span class="token number">0xFF</span><span class="token punctuation">;</span><span class="token comment">//ä½æ¸…é›¶ï¼Œä¸‹ä¸€æ­¥æ˜¯æ®µé€‰ï¼Œè¿™æ ·ä¸‹æ¬¡æ®µé€‰å°±ä¸ä¼šä¸²ä½åˆ°ä¸Šä¸€ä¸ªä½é€‰äº†</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="MatrixLED-h"><a href="#MatrixLED-h" class="headerlink" title="MatrixLED.h"></a>MatrixLED.h</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">__MATRIXLED_H__</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">__MATRIXLED_H__</span></span>

<span class="token keyword">void</span> <span class="token function">MatrixLED_ShowColumn</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> Cloumn<span class="token punctuation">,</span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">MartrixLED_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



]]></content>
      <categories>
        <category>51å•ç‰‡æœº</category>
      </categories>
      <tags>
        <tag>51å•ç‰‡æœº</tag>
        <tag>å¤§äº‘å±‹è€ƒæ ¸</tag>
      </tags>
  </entry>
  <entry>
    <title>æ ˆ</title>
    <url>/2022/11/20/zhan/</url>
    <content><![CDATA[<h1 id="ä¸€-æ ˆå’Œå †"><a href="#ä¸€-æ ˆå’Œå †" class="headerlink" title="ä¸€.æ ˆå’Œå †"></a>ä¸€.æ ˆå’Œå †</h1><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">double</span> <span class="token operator">*</span>q<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>*q</strong>å°±æ˜¯<strong>æ ˆ</strong>é‡Œçš„ï¼Œ<strong>200</strong>æ˜¯å †é‡Œçš„</p>
<p>åŠ¨æ€åˆ†é…çš„éƒ½åœ¨å †é‡Œåˆ†é…ï¼Œç”±ç¨‹åºå‘˜æ‰‹åŠ¨åˆ†é…</p>
<p>é™æ€åˆ†é…çš„éƒ½åœ¨æ ˆé‡Œåˆ†é…ï¼Œç”±ç³»ç»Ÿè‡ªåŠ¨åˆ†é…</p>
<h2 id="æ ˆï¼š"><a href="#æ ˆï¼š" class="headerlink" title="æ ˆï¼š"></a>æ ˆï¼š</h2><p>1.å®šä¹‰ï¼š</p>
<ul>
<li>å®ç°â€œå…ˆè¿›åå‡ºâ€çš„å­˜å‚¨ç»“æ„</li>
</ul>
<p>2.åˆ†ç±»ï¼š</p>
<ul>
<li>é™æ€æ ˆ </li>
<li>åŠ¨æ€æ ˆï¼šå†…æ ¸å°±æ˜¯é“¾è¡¨</li>
</ul>
<p>3.ç®—æ³•</p>
<ul>
<li>å‡ºæ ˆ</li>
<li>å‹æ ˆ</li>
</ul>
<p>4.å˜é‡</p>
<ul>
<li>pTop</li>
<li>pBottom</li>
</ul>
<p><strong>æ ˆç©º</strong>ï¼špTop==pBottom</p>
<p>5.åº”ç”¨</p>
<ul>
<li>å‡½æ•°è°ƒç”¨</li>
<li>ä¸­æ–­</li>
<li>è¡¨è¾¾å¼æ±‚å€¼</li>
<li>å†…å­˜åˆ†é…</li>
<li>ç¼“å†²å¤„ç†</li>
<li>è¿·å®«</li>
</ul>
<h1 id="äºŒ-ä»£ç "><a href="#äºŒ-ä»£ç " class="headerlink" title="äºŒ.ä»£ç "></a>äºŒ.ä»£ç </h1><h2 id="1-ä¸¤ä¸ªç»“æ„ä½“çš„çš„å®šä¹‰"><a href="#1-ä¸¤ä¸ªç»“æ„ä½“çš„çš„å®šä¹‰" class="headerlink" title="1.ä¸¤ä¸ªç»“æ„ä½“çš„çš„å®šä¹‰"></a>1.ä¸¤ä¸ªç»“æ„ä½“çš„çš„å®šä¹‰</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Node</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> data<span class="token punctuation">;</span>
	<span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token operator">*</span>pNext<span class="token punctuation">;</span>
<span class="token punctuation">}</span>NODE<span class="token punctuation">,</span><span class="token operator">*</span>PNODE<span class="token punctuation">;</span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Stack</span><span class="token punctuation">{</span>
	PNODE pTop<span class="token punctuation">;</span>
	PNODE pBottom<span class="token punctuation">;</span>
<span class="token punctuation">}</span>STACK<span class="token punctuation">,</span><span class="token operator">*</span>PSTACK<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ğŸ‘‰å¯¹äºStackçš„ç†è§£ï¼š</p>
<p>Stackè¿™ä¸ªç»“æ„ä½“é‡Œæœ‰ä¸¤ä¸ªæˆå‘˜â€”â€”<strong>åå­—å«pTopå’ŒpBottomã€ç±»å‹ä¸ºNODEæŒ‡é’ˆ</strong></p>
<h2 id="2-åˆå§‹åŒ–"><a href="#2-åˆå§‹åŒ–" class="headerlink" title="2.åˆå§‹åŒ–"></a>2.åˆå§‹åŒ–</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span>PSTACK pS<span class="token punctuation">)</span>						<span class="token comment">//ä¼ å‚ï¼šæ ˆçš„åœ°å€</span>
<span class="token punctuation">{</span>
	pS<span class="token operator">-&gt;</span>pTop<span class="token operator">=</span><span class="token punctuation">(</span>PNODE<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>NODE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//ç»™æ ˆé¡¶ç”³è¯·å†…å­˜ç©ºé—´</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>pS<span class="token operator">-&gt;</span>pTop<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"å†…å­˜åˆ†é…å¤±è´¥ï¼\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{</span>
		pS<span class="token operator">-&gt;</span>pBottom<span class="token operator">=</span>pS<span class="token operator">-&gt;</span>pTop<span class="token punctuation">;</span>				<span class="token comment">//æ­¤æ—¶pTå’ŒpBæŒ‡å‘åŒä¸€ä¸ªå†…å­˜</span>
		pS<span class="token operator">-&gt;</span>pTop<span class="token operator">-&gt;</span>pNext<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>				<span class="token comment">//è®©pTå’ŒpBæŒ‡å‘åŒä¸€ä¸ªèŠ‚ç‚¹ä¸”è¯¥èŠ‚ç‚¹çš„æŒ‡é’ˆåŸŸå­˜æ”¾çš„æ˜¯NULLï¼Œè¯¥èŠ‚ç‚¹ä½œä¸ºä¸€ä¸ªå¤´ç»“ç‚¹ã€‚</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="3-å‹æ ˆ"><a href="#3-å‹æ ˆ" class="headerlink" title="3.å‹æ ˆ"></a>3.å‹æ ˆ</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span>PSTACK pS<span class="token punctuation">,</span><span class="token keyword">int</span> val<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	PNODE pNew<span class="token operator">=</span><span class="token punctuation">(</span>PNODE<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>NODE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">//ä¸ºæ–°èŠ‚ç‚¹ç”³è¯·ç©ºé—´</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>pNew<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"å†…å­˜åˆ†é…å¤±è´¥ï¼\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{</span>
		pNew<span class="token operator">-&gt;</span>data<span class="token operator">=</span>val<span class="token punctuation">;</span>
		pNew<span class="token operator">-&gt;</span>pNext<span class="token operator">=</span>pS<span class="token operator">-&gt;</span>pTop<span class="token punctuation">;</span>			
		pS<span class="token operator">-&gt;</span>pTop<span class="token operator">=</span>pNew<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-c" data-language="c"><code class="language-c">pNew<span class="token operator">-&gt;</span>pNext<span class="token operator">=</span>pS<span class="token operator">-&gt;</span>pTop<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ğŸ‘†ç†è§£ï¼š</p>
<p>ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œ**pNew-&gt;pNext=pS-&gt;pTop;<strong>å’Œ</strong>pNew-&gt;pNext=pS-&gt;pBottom;**éƒ½å¯ä»¥ <code>ç†è§£ä¸ºæ’å…¥çš„æ–°èŠ‚ç‚¹çš„æŒ‡é’ˆåŸŸå’ŒpTã€pBæ˜¯ä¸€æ ·çš„ï¼Œå³æŒ‡å‘ä¸€æ ·ï¼Œéƒ½æŒ‡å‘å¤´ç»“ç‚¹</code></p>
<p><strong>ä½†æ˜¯ä»ç¬¬äºŒä¸ªèŠ‚ç‚¹å¼€å§‹</strong>ï¼Œä»–çš„æŒ‡é’ˆåŸŸå­˜æ”¾çš„åº”è¯¥å¾—æ˜¯ä¸Šä¸€ä¸ªèŠ‚ç‚¹çš„åœ°å€ï¼Œå¯¹åº”å›¾ä¸Šçš„å°±æ˜¯<code>å³è¾¹è“è‰²çš„ç®­å¤´åº”è¯¥==å·¦è¾¹è¢«è“è‰²xè¦†ç›–çš„çº¢è‰²ç®­å¤´</code>ï¼Œå³<strong>pNew-&gt;pNext=pS-&gt;pTop;</strong></p>
<h2 id="4-éå†"><a href="#4-éå†" class="headerlink" title="4.éå†"></a>4.éå†</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">traverse</span><span class="token punctuation">(</span>PSTACK pS<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	PNODE p<span class="token operator">=</span>pS<span class="token operator">-&gt;</span>pTop<span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>p<span class="token operator">!=</span>pS<span class="token operator">-&gt;</span>pBottom<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span>p<span class="token operator">-&gt;</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> 
		p<span class="token operator">=</span>p<span class="token operator">-&gt;</span>pNext<span class="token punctuation">;</span> 
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="5-å‡ºæ ˆ"><a href="#5-å‡ºæ ˆ" class="headerlink" title="5.å‡ºæ ˆ"></a>5.å‡ºæ ˆ</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">pop</span><span class="token punctuation">(</span>PSTACK pS<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>pS<span class="token operator">-&gt;</span>pTop<span class="token operator">==</span>pS<span class="token operator">-&gt;</span>pBottom<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"æ ˆä¸ºç©ºï¼\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{</span>
		PNODE a<span class="token operator">=</span>pS<span class="token operator">-&gt;</span>pTop<span class="token punctuation">;</span>
		pS<span class="token operator">-&gt;</span>pTop<span class="token operator">=</span>pS<span class="token operator">-&gt;</span>pTop<span class="token operator">-&gt;</span>pNext<span class="token punctuation">;</span>
		<span class="token function">free</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
		a<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªåº”è¯¥ä¹Ÿå¾ˆå¥½ç†è§£ï¼šåˆ é™¤aæŒ‡å‘çš„èŠ‚ç‚¹ï¼ŒpTopè´Ÿè´£å¾€ä¸‹èµ°ï¼Œé˜²æ­¢å› ä¸ºåˆ æ‰ä¸Šé¢çš„èŠ‚ç‚¹è€Œä¸¢å¤±ä¸‹é¢çš„èŠ‚ç‚¹çš„åœ°å€</p>
<h2 id="6-æ¸…ç©º"><a href="#6-æ¸…ç©º" class="headerlink" title="6.æ¸…ç©º"></a>6.æ¸…ç©º</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span>PSTACK pS<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>pS<span class="token operator">-&gt;</span>pTop<span class="token operator">==</span>pS<span class="token operator">-&gt;</span>pBottom<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"æ ˆä¸ºç©ºï¼\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{</span>
		PNODE p<span class="token operator">=</span>pS<span class="token operator">-&gt;</span>pTop<span class="token punctuation">;</span>
		<span class="token keyword">while</span><span class="token punctuation">(</span>p<span class="token operator">!=</span>pS<span class="token operator">-&gt;</span>pBottom<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			pS<span class="token operator">-&gt;</span>pTop<span class="token operator">=</span>p<span class="token operator">-&gt;</span>pNext<span class="token punctuation">;</span>
			<span class="token function">free</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
			p<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
			p<span class="token operator">=</span>pS<span class="token operator">-&gt;</span>pTop<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¤§è‡´æ€è·¯å’Œå‡ºæ ˆç›¸ä¼¼ï¼Œå°±æ˜¯å¤šäº†ä¸ªå¾ªç¯ï¼Œå†è°ƒæ¢ä¸€ä¸‹è¯­å¥é¡ºåºå³å¯</p>
<h2 id="7-å®Œæ•´ä»£ç "><a href="#7-å®Œæ•´ä»£ç " class="headerlink" title="7.å®Œæ•´ä»£ç "></a>7.å®Œæ•´ä»£ç </h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;malloc.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdbool.h&gt;</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Node</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> data<span class="token punctuation">;</span>
	<span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token operator">*</span>pNext<span class="token punctuation">;</span>
<span class="token punctuation">}</span>NODE<span class="token punctuation">,</span><span class="token operator">*</span>PNODE<span class="token punctuation">;</span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Stack</span><span class="token punctuation">{</span>
	PNODE pTop<span class="token punctuation">;</span>
	PNODE pBottom<span class="token punctuation">;</span>
<span class="token punctuation">}</span>STACK<span class="token punctuation">,</span><span class="token operator">*</span>PSTACK<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span>PSTACK<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span>PSTACK<span class="token punctuation">,</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">traverse</span><span class="token punctuation">(</span>PSTACK<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">pop</span><span class="token punctuation">(</span>PSTACK<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span>PSTACK<span class="token punctuation">)</span><span class="token punctuation">;</span>
bool <span class="token function">empty</span><span class="token punctuation">(</span>PSTACK<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	STACK S<span class="token punctuation">;</span>
	<span class="token function">init</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>S<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>S<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">traverse</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token function">pop</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nå‡ºæ ˆåç»“æœä¸ºï¼›\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">traverse</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token function">clear</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">traverse</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>S<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"æ¸…é™¤æˆåŠŸï¼\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"æ¸…é™¤å¤±è´¥ï¼\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span>PSTACK pS<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	pS<span class="token operator">-&gt;</span>pTop<span class="token operator">=</span><span class="token punctuation">(</span>PNODE<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>NODE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>pS<span class="token operator">-&gt;</span>pTop<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"å†…å­˜åˆ†é…å¤±è´¥ï¼\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{</span>
		pS<span class="token operator">-&gt;</span>pBottom<span class="token operator">=</span>pS<span class="token operator">-&gt;</span>pTop<span class="token punctuation">;</span>
		pS<span class="token operator">-&gt;</span>pTop<span class="token operator">-&gt;</span>pNext<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span>PSTACK pS<span class="token punctuation">,</span><span class="token keyword">int</span> val<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	PNODE pNew<span class="token operator">=</span><span class="token punctuation">(</span>PNODE<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>NODE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>pNew<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"å†…å­˜åˆ†é…å¤±è´¥ï¼\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{</span>
		pNew<span class="token operator">-&gt;</span>data<span class="token operator">=</span>val<span class="token punctuation">;</span>
		pNew<span class="token operator">-&gt;</span>pNext<span class="token operator">=</span>pS<span class="token operator">-&gt;</span>pTop<span class="token punctuation">;</span>			
		pS<span class="token operator">-&gt;</span>pTop<span class="token operator">=</span>pNew<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">traverse</span><span class="token punctuation">(</span>PSTACK pS<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	PNODE p<span class="token operator">=</span>pS<span class="token operator">-&gt;</span>pTop<span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>p<span class="token operator">!=</span>pS<span class="token operator">-&gt;</span>pBottom<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span>p<span class="token operator">-&gt;</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> 
		p<span class="token operator">=</span>p<span class="token operator">-&gt;</span>pNext<span class="token punctuation">;</span> 
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">pop</span><span class="token punctuation">(</span>PSTACK pS<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>pS<span class="token operator">-&gt;</span>pTop<span class="token operator">==</span>pS<span class="token operator">-&gt;</span>pBottom<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"æ ˆä¸ºç©ºï¼\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{</span>
		PNODE a<span class="token operator">=</span>pS<span class="token operator">-&gt;</span>pTop<span class="token punctuation">;</span>
		pS<span class="token operator">-&gt;</span>pTop<span class="token operator">=</span>pS<span class="token operator">-&gt;</span>pTop<span class="token operator">-&gt;</span>pNext<span class="token punctuation">;</span>
		<span class="token function">free</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
		a<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

bool <span class="token function">empty</span><span class="token punctuation">(</span>PSTACK pS<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>pS<span class="token operator">-&gt;</span>pTop<span class="token operator">==</span>pS<span class="token operator">-&gt;</span>pBottom<span class="token punctuation">)</span>
		<span class="token keyword">return</span> true<span class="token punctuation">;</span>
	<span class="token keyword">else</span>
		<span class="token keyword">return</span> false<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span>PSTACK pS<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>pS<span class="token operator">-&gt;</span>pTop<span class="token operator">==</span>pS<span class="token operator">-&gt;</span>pBottom<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"æ ˆä¸ºç©ºï¼\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{</span>
		PNODE p<span class="token operator">=</span>pS<span class="token operator">-&gt;</span>pTop<span class="token punctuation">;</span>
		<span class="token keyword">while</span><span class="token punctuation">(</span>p<span class="token operator">!=</span>pS<span class="token operator">-&gt;</span>pBottom<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			pS<span class="token operator">-&gt;</span>pTop<span class="token operator">=</span>p<span class="token operator">-&gt;</span>pNext<span class="token punctuation">;</span>
			<span class="token function">free</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
			p<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
			p<span class="token operator">=</span>pS<span class="token operator">-&gt;</span>pTop<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

]]></content>
      <categories>
        <category>Cè¯­è¨€</category>
      </categories>
      <tags>
        <tag>Cè¯­è¨€</tag>
        <tag>æ ˆ</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¨¡å—åŒ–ç¼–ç¨‹</title>
    <url>/2022/10/02/mo-kuai-hua-bian-cheng/</url>
    <content><![CDATA[<h1 id="5-1æ¨¡å—åŒ–ç¼–ç¨‹"><a href="#5-1æ¨¡å—åŒ–ç¼–ç¨‹" class="headerlink" title="5-1æ¨¡å—åŒ–ç¼–ç¨‹"></a>5-1æ¨¡å—åŒ–ç¼–ç¨‹</h1><p><img src="/../../../../medias/blog_picture/51/1.png" alt="æ¨¡å—åŒ–ç¼–ç¨‹æ¡†å›¾"></p>
<p><img src="/../../../../medias/blog_picture/51/2.png" alt="æ¨¡å—åŒ–ç¼–ç¨‹æ³¨æ„äº‹é¡¹"></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Delay.h"</span></span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Delayå‡½æ•°çš„å£°æ˜å°±åœ¨ç¬¬ä¸€è¡Œé‚£</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/../../../../medias/blog_picture/51/3.png" alt="Cé¢„ç¼–è¯‘"></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">_DELAY_H_</span><span class="token comment">//å¦‚æœæ²¡æœ‰å®šä¹‰å°±æ‰§è¡Œç¼–è¯‘(ç¬¬ä¸€æ¬¡æ²¡æœ‰å®šä¹‰æ‰å‚ä¸ç¼–è¯‘å®šä¹‰)é˜²æ­¢å¤šæ¬¡ç¼–è¯‘</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_DELAY_H_</span></span>

<span class="token keyword">void</span> <span class="token function">Delay</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> xms<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="å®ä¾‹æ“ä½œ"><a href="#å®ä¾‹æ“ä½œ" class="headerlink" title="å®ä¾‹æ“ä½œ"></a>å®ä¾‹æ“ä½œ</h2><h3 id="main-c"><a href="#main-c" class="headerlink" title="main.c"></a>main.c</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>
<span class="token comment">//è°ƒç”¨å‡½æ•°</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Delay.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Nixie.h"</span></span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">Nixie</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">Nixie</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">Nixie</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Delay-c"><a href="#Delay-c" class="headerlink" title="Delay.c"></a>Delay.c</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Delay</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> xms<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>xms<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
		j <span class="token operator">=</span> <span class="token number">199</span><span class="token punctuation">;</span>
		<span class="token keyword">do</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>	
	xms<span class="token operator">--</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Delay-h"><a href="#Delay-h" class="headerlink" title="Delay.h"></a>Delay.h</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">__DELAY_H__</span><span class="token comment">//å¦‚æœæ²¡æœ‰å®šä¹‰è¿‡è¿™ä¸ªå‡½æ•°</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">__DELAY_H__</span><span class="token comment">//åˆ™å¼€å§‹å®šä¹‰</span></span>

<span class="token keyword">void</span> <span class="token function">Delay</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> xms<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å£°æ˜</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Nixie-c"><a href="#Nixie-c" class="headerlink" title="Nixie.c"></a>Nixie.c</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span><span class="token comment">//å› ä¸ºåœ¨å£°æ˜æ—¶ç”¨åˆ°äº†P0 P2è¿™ç§æ²¡æœ‰è¢«è¯´æ˜çš„é‡ï¼Œæ‰€ä»¥è¦å¼•å…¥è¿™ä¸ªå¤´æ–‡ä»¶è¯´æ˜</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Delay.h"</span></span>

<span class="token keyword">unsigned</span> <span class="token keyword">char</span> NixieTable<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0x3F</span><span class="token punctuation">,</span><span class="token number">0x06</span><span class="token punctuation">,</span><span class="token number">0x5B</span><span class="token punctuation">,</span><span class="token number">0x4F</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x6D</span><span class="token punctuation">,</span><span class="token number">0x7D</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0x7F</span><span class="token punctuation">,</span><span class="token number">0x6F</span><span class="token punctuation">,</span><span class="token number">0x5E</span><span class="token punctuation">,</span><span class="token number">0x6E</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">Nixie</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> Location<span class="token punctuation">,</span>Number<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">switch</span><span class="token punctuation">(</span>Location<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		
		<span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token comment">//111-8</span>
		<span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token comment">//110-7</span>
		<span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">6</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">7</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">8</span><span class="token operator">:</span>P2_4 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>P2_3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> P2_2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	P0<span class="token operator">=</span>NixieTable<span class="token punctuation">[</span>Number<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	P0 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Nixie-h"><a href="#Nixie-h" class="headerlink" title="Nixie.h"></a>Nixie.h</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">__NIXIE_H__</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">__NIXIE_H__</span></span>

<span class="token keyword">void</span> <span class="token function">Nixie</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> Location<span class="token punctuation">,</span>Number<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



]]></content>
      <categories>
        <category>51å•ç‰‡æœº</category>
      </categories>
      <tags>
        <tag>51å•ç‰‡æœº</tag>
        <tag>å¤§äº‘å±‹è€ƒæ ¸</tag>
      </tags>
  </entry>
  <entry>
    <title>çŸ©é˜µé”®ç›˜</title>
    <url>/2022/10/10/ju-zhen-jian-pan/</url>
    <content><![CDATA[<h1 id="6-1çŸ©é˜µé”®ç›˜"><a href="#6-1çŸ©é˜µé”®ç›˜" class="headerlink" title="6-1çŸ©é˜µé”®ç›˜"></a>6-1çŸ©é˜µé”®ç›˜</h1><p><img src="/../../../../medias/blog_picture/51/20.png" alt="çŸ©é˜µæŒ‰é”®"></p>
<p><img src="/../../../../medias/blog_picture/51/21.png" alt="èŠ¯ç‰‡å¼•è„š"></p>
<p>å‰å››æ ¹çº¿(P17~P14)åˆ¤æ–­è¡Œï¼Œç»™0ç›¸å½“äºæ¥åœ°**(ç”±ä¸Šé¢è¿™å¹…å›¾æˆ‘ä»¬çŸ¥é“P1çš„ä¸€ç«¯å·²ç»æ¥åœ¨äº†VCCï¼Œæ‰€ä»¥è¦è®©P1_xè¿è¡Œï¼Œè¦ç»™å®ƒä½ç”µå¹³ï¼Œå³0)**ï¼Œæ­¤æ—¶ioå£ä¸ºä½ç”µå¹³</p>
<p>åå››æ ¹(P13~P10)åˆ¤æ–­è¯¥è¡Œå¯¹åº”çš„æŸä¸€ä¸ªæŒ‰é”®</p>
<h2 id="ä¸‹é¢çš„ä»£ç ä¸»è¦æ˜¯å®ç°æ§åˆ¶çŸ©é˜µé”®ç›˜ï¼Œå¹¶æŠŠæŒ‰ä¸‹å»çš„é”®ä½å¯¹åº”çš„æ•°å­—åœ¨LCD1602ä¸Šæ˜¾ç¤ºå‡ºæ¥"><a href="#ä¸‹é¢çš„ä»£ç ä¸»è¦æ˜¯å®ç°æ§åˆ¶çŸ©é˜µé”®ç›˜ï¼Œå¹¶æŠŠæŒ‰ä¸‹å»çš„é”®ä½å¯¹åº”çš„æ•°å­—åœ¨LCD1602ä¸Šæ˜¾ç¤ºå‡ºæ¥" class="headerlink" title="ä¸‹é¢çš„ä»£ç ä¸»è¦æ˜¯å®ç°æ§åˆ¶çŸ©é˜µé”®ç›˜ï¼Œå¹¶æŠŠæŒ‰ä¸‹å»çš„é”®ä½å¯¹åº”çš„æ•°å­—åœ¨LCD1602ä¸Šæ˜¾ç¤ºå‡ºæ¥"></a>ä¸‹é¢çš„ä»£ç ä¸»è¦æ˜¯å®ç°æ§åˆ¶çŸ©é˜µé”®ç›˜ï¼Œå¹¶æŠŠæŒ‰ä¸‹å»çš„é”®ä½å¯¹åº”çš„æ•°å­—åœ¨LCD1602ä¸Šæ˜¾ç¤ºå‡ºæ¥</h2><p>ps:å¸¸è§çš„Delayå°±ä¸æ”¾å‡ºæ¥äº†ï¼Œæ‡‚å¾—éƒ½æ‡‚</p>
<p>matrixçŸ©é˜µ</p>
<h3 id="MatrixKey-h"><a href="#MatrixKey-h" class="headerlink" title="MatrixKey.h"></a>MatrixKey.h</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">__MATRIXKEY_H__</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">__MATRIXKEY_H__</span></span>

<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token function">MatrixKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="MatrixKey-c"><a href="#MatrixKey-c" class="headerlink" title="MatrixKey.c"></a>MatrixKey.c</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Delay.h"</span></span>

<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token function">MatrixKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> KeyNumber<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	
	P1<span class="token operator">=</span><span class="token number">0xFF</span><span class="token punctuation">;</span><span class="token comment">//æœ‰ç‚¹ç›¸å½“äºåˆå§‹åŒ–</span>
	P1_3<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P1_7<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P1_7<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P1_6<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P1_6<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P1_5<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P1_5<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P1_4<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P1_4<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">13</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	
	P1<span class="token operator">=</span><span class="token number">0xFF</span><span class="token punctuation">;</span>
	P1_2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P1_7<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P1_7<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P1_6<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P1_6<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P1_5<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P1_5<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P1_4<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P1_4<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	
	P1<span class="token operator">=</span><span class="token number">0xFF</span><span class="token punctuation">;</span>
	P1_1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P1_7<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P1_7<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P1_6<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P1_6<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P1_5<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P1_5<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P1_4<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P1_4<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	
	P1<span class="token operator">=</span><span class="token number">0xFF</span><span class="token punctuation">;</span>
	P1_0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P1_7<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P1_7<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P1_6<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P1_6<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P1_5<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P1_5<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P1_4<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P1_4<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">;</span><span class="token punctuation">}</span>

	<span class="token keyword">return</span> KeyNumber<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬å¯ä»¥å‘ç°è¿™ä¸ªå‡½æ•°ä»£ç æ˜¯ç”±<strong>å››ç»„æ¨¡æ¿ä¸€æ ·</strong>çš„å°ä»£ç ç»„æˆçš„ï¼Œä¸‹é¢å°†æ‹ä¸€ç»„å‡ºæ¥è§£é‡Š</p>
<p><img src="/../../../../medias/blog_picture/51/22.png" alt="çŸ©é˜µæŒ‰é”®"></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">P1<span class="token operator">=</span><span class="token number">0xFF</span><span class="token punctuation">;</span><span class="token comment">//è®©æ‰€æœ‰çš„P1å£éƒ½ä¸º1ï¼Œå°±æ˜¯ä¸å¯¹ä»–ä»¬è¿›è¡Œæ“ä½œï¼Œè®©ä»–ä»¬å¤„äºstandbyçŠ¶æ€</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-c" data-language="c"><code class="language-c">P1_3<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//"å”¤é†’"åˆ—ï¼Œæˆ‘ä»¬å…ˆæ§åˆ¶P1_3,è®©ä»–ä¸º0ï¼Œå¤„äºè¿è¡ŒçŠ¶æ€--â‘ </span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//ç„¶åé€ä¸ªåˆ¤æ–­ç”¨æˆ·æŒ‰ä¸‹äº†å“ªä¸ªé”®ä½+æŒ‰é”®æ¶ˆæŠ–ï¼Œæ£€æµ‹æ¾æ‰‹ï¼Œèµ‹ç›¸åº”çš„å€¼ç»™KeyNumber</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P1_7<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P1_7<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment">//--â‘¡</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P1_6<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P1_6<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment">//--â‘¢</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P1_5<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P1_5<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment">//--â‘£</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P1_4<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P1_4<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">13</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment">//--â‘¤</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="main-c"><a href="#main-c" class="headerlink" title="main.c"></a>main.c</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Delay.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"LCD1602.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"MatrixKey.h"</span></span>

<span class="token keyword">unsigned</span> <span class="token keyword">char</span> KeyNum<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">LCD_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                       <span class="token comment">//åˆå§‹åŒ–</span>
	<span class="token function">LCD_ShowString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"Martix:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//ä»ç¬¬ä¸€è¡Œç¬¬ä¸€åˆ—å¼€å§‹è¾“å…¥</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		KeyNum<span class="token operator">=</span><span class="token function">MatrixKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			  <span class="token comment">//æŠŠè¿”å›çš„KeyNumberèµ‹å€¼ç»™KeyNum</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>KeyNum<span class="token punctuation">)</span>					  
		<span class="token punctuation">{</span>
			<span class="token function">LCD_ShowNum</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>KeyNum<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æˆ‘ä»¬è¦åœ¨è¿™å¥è¯ä¸­æ‰èƒ½è®©ç¯äº®èµ·æ¥ï¼Œå…³é”®åœ¨äºè®©KeyNumä¸º0çš„æ—¶å€™æ ¹æœ¬è¯»ä¸åˆ°è¿™å¥è¯</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>**å¯¹äºifçš„è§£é‡Š       iiiiiiimportant!!!!!!    **</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		KeyNum<span class="token operator">=</span><span class="token function">MatrixKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			  <span class="token comment">//æŠŠè¿”å›çš„KeyNumberèµ‹å€¼ç»™KeyNum</span>
     	<span class="token function">LCD_ShowNum</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>KeyNum<span class="token punctuation">.</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>â€‹	å¦‚æœæ²¡æœ‰<strong>if</strong>ï¼Œå…ˆè¿›å…¥<strong>while(1)<strong>å¾ªç¯ä¸­ï¼Œé‚£ä¹ˆå½“ç”¨æˆ·</strong>æŒ‰ä¸‹S1</strong>çš„æ—¶å€™ï¼Œ<strong>Matrixå‡½æ•°</strong>è¿”å›<strong>KeyNumber</strong>çš„å€¼ç»™ä¸»å‡½æ•°çš„<strong>KeyNum</strong>ï¼Œæ­¤æ—¶<strong>KeyNumä¸º1</strong>ï¼ŒLCD1602<strong>è¿…é€Ÿåœ°æ˜¾ç¤ºâ€œ1â€</strong>(å¾ˆå¿«å•Šï¼è‚‰çœ¼æ ¹æœ¬çœ‹ä¸è§çš„é‚£ç§)ï¼Œéšå³<strong>è·³å‡ºæ­¤æ¬¡çš„while(1)å¾ªç¯å¹¶è¿›å…¥ä¸‹ä¸€æ¬¡while(1)å¾ªç¯</strong>ï¼Œå› ä¸ºä¸‹ä¸€åˆ»ç”¨æˆ·ä¸å¯èƒ½é€Ÿé€ŸæŒ‰ä¸‹æŸä¸ªé”®ä½ï¼Œæ‰€ä»¥è¿™æ—¶å€™<strong>Matrixå‡½æ•°</strong>ä¸­åˆå§‹åŒ–çš„é‚£å¥</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">char</span> KeyNumber<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å°±ä¼šç›´æ¥è¢«è¿”å›åˆ°ä¸»å‡½æ•°çš„<strong>KeyNum</strong>ä¸­ï¼Œå³<strong>KeyNumä¸º0</strong>ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬çœ‹åˆ°çš„ç°è±¡æ˜¯ï¼Œæ— è®ºæ€ä¹ˆæŒ‰éƒ½åªä¼šæ˜¾ç¤º0ï¼Œå…¶å®æœ‰æ˜¾ç¤ºè¿‡1çš„ï¼Œä½†æ˜¯å¤ªå¿«äº†ï¼Œçœ‹ä¸è§ã€‚</p>
<p>â€‹	é‚£ä¹ˆï¼Œæˆ‘ä»¬åŠ äº†**if(KeyNum)**åï¼Œå½“é»˜è®¤ä¸º0çš„æ—¶å€™ï¼Œifåˆ¤æ–­ä¸ºå‡ï¼Œå°±ä¸ä¼šå‡ºç°0ï¼Œå› ä¸ºä¸º0çš„æ—¶å€™ï¼Œæ ¹æœ¬ä¸ä¼šè¿›å…¥åˆ°LCD_ShowNumä¸­æ‰§è¡Œï¼Œæ‰€ä»¥ä¸€ç›´æ˜¾ç¤ºçš„æ˜¯æŒ‰ä¸‹å»çš„é”®ä½çš„è¾£ä¸ªæ•°å­—ã€‚</p>
<h2 id="å¼ºè¿«ç—‡-ä¸“ä¸šæ³¨é‡Š"><a href="#å¼ºè¿«ç—‡-ä¸“ä¸šæ³¨é‡Š" class="headerlink" title="å¼ºè¿«ç—‡+ä¸“ä¸šæ³¨é‡Š"></a>å¼ºè¿«ç—‡+ä¸“ä¸šæ³¨é‡Š</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/**
  * @brief  ç®€ä»‹
  * @param  å‚æ•°1
  * @param  å‚æ•°2
  * @param  å‚æ•°n
  * @retval è¿”å›å€¼
  */</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h1 id="6-2-çŸ©é˜µé”®ç›˜å¯†ç é”"><a href="#6-2-çŸ©é˜µé”®ç›˜å¯†ç é”" class="headerlink" title="6-2 çŸ©é˜µé”®ç›˜å¯†ç é”"></a>6-2 çŸ©é˜µé”®ç›˜å¯†ç é”</h1><p><strong>ä»¥ä¸‹ä»£ç æ˜¯åœ¨6-1çš„åŸºç¡€ä¸Šä¿®æ”¹çš„</strong>ï¼Œæ‰€ä»¥ä¸å†æ”¾å‡ºMatrixå‡½æ•°ï¼Œç›´æ¥ä¸Šmain.c</p>
<p>ps:æ³¨é‡Šä¸ä¼šæ”¹ä¸­æ–‡å“ˆå“ˆå“ˆæ‰“å‡ºæ¥å…¨æ˜¯â€?â€ï¼Œå› æ­¤ä»¥åçš„<strong>æ³¨é‡Š</strong>éƒ½æ˜¯<strong>å…¨(å¡‘æ–™/å·¥åœ°)è‹±åˆ¶</strong></p>
<h2 id="main-c-1"><a href="#main-c-1" class="headerlink" title="main.c"></a>main.c</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Delay.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"LCD1602.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"MatrixKey.h"</span></span>

<span class="token comment">//åˆå§‹å®šä¹‰æœªèµ‹åˆå€¼æ—¶é»˜è®¤èµ‹å€¼ä¸º0</span>
<span class="token keyword">unsigned</span> <span class="token keyword">char</span> KeyNum<span class="token punctuation">;</span>
<span class="token keyword">unsigned</span> <span class="token keyword">int</span> Password<span class="token punctuation">,</span>Count<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">LCD_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">LCD_ShowString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"Password:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		KeyNum<span class="token operator">=</span><span class="token function">MatrixKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>KeyNum<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>KeyNum<span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment">//if S1~S10keys are pressed ,input password</span>
			<span class="token punctuation">{</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>Count<span class="token operator">&lt;</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment">//if the time of inout &lt; 4 </span>
				<span class="token punctuation">{</span>
					Password<span class="token operator">*=</span><span class="token number">10</span><span class="token punctuation">;</span><span class="token comment">//password RL </span>
					Password<span class="token operator">+=</span>KeyNum<span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span><span class="token comment">//consider the situation of when user press s10 then output 0 ,and get one password</span>
					Count<span class="token operator">++</span><span class="token punctuation">;</span>  <span class="token comment">//metering +1</span>
				<span class="token punctuation">}</span>
				<span class="token function">LCD_ShowNum</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Password<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//when finishe the enter,updata the display</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>KeyNum<span class="token operator">==</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token comment">//if press S11---&gt;confirm</span>
			<span class="token punctuation">{</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>Password<span class="token operator">==</span><span class="token number">2345</span><span class="token punctuation">)</span>  <span class="token comment">//if the password == the correct password</span>
				<span class="token punctuation">{</span>								
					<span class="token function">LCD_ShowString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token string">"OK"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					Password<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//the password zero clearing</span>
					Count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">//metering zero clearing</span>
					<span class="token function">LCD_ShowNum</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Password<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//updata the display0</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">else</span>
				<span class="token punctuation">{</span>
					<span class="token function">LCD_ShowSrting</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token string">"ERR"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					Password<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//the password zero clearing</span>
					Count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">//metering zero clearing</span>
					<span class="token function">LCD_ShowNum</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Password<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//updata the display</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>KeyNum<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token comment">//if press S12---&gt; cancel</span>
			<span class="token punctuation">{</span>
				Password<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//the password zero clearing</span>
				Count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">//metering zero clearing</span>
				<span class="token function">LCD_ShowNum</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Password<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//updata the display				</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬ä¸€èŠ‚ä¸€èŠ‚åœ°çœ‹ï¼Œä»¥ä¸‹ä»ç”¨æˆ·æŒ‰ä¸‹æŸä¸ªé”®ä½å¼€å§‹ï¼Œå³ä»**if(KeyNum)**å¼€å§‹å¾€ä¸‹çœ‹</p>
<h3 id="è¾“å…¥Password"><a href="#è¾“å…¥Password" class="headerlink" title="è¾“å…¥Password"></a>è¾“å…¥Password</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">if</span><span class="token punctuation">(</span>KeyNum<span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment">//if S1~S10keys are pressed ,input password</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>Count<span class="token operator">&lt;</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment">//if the time of inout &lt; 4 </span>
	<span class="token punctuation">{</span>
		Password<span class="token operator">*=</span><span class="token number">10</span><span class="token punctuation">;</span><span class="token comment">//password RL </span>
		Password<span class="token operator">+=</span>KeyNum<span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span><span class="token comment">//consider the situation of when user press s10 then ouput 0 ,and get one password</span>
		Count<span class="token operator">++</span><span class="token punctuation">;</span>  <span class="token comment">//metering +1</span>
	<span class="token punctuation">}</span>
	<span class="token function">LCD_ShowNum</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Password<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//updata the display</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™é‡Œçš„è®¾å®šæ˜¯ï¼Œ<strong>æŒ‰ä¸‹S1~S10æ—¶</strong>ï¼Œå¯¹åº”1~0ï¼Œè¿™é‡Œç”¨åˆ°çš„å¾ˆå¦™çš„ä¸€æ‹›æ˜¯</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">Password<span class="token operator">*=</span><span class="token number">10</span><span class="token punctuation">;</span>
Password<span class="token operator">+=</span>KeyNum<span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>Passwordè‡ªÃ—10ï¼Œåˆ™ç›¸å½“äº<strong>æ‰€æœ‰æ•°å­—å¾€å·¦ç§»åŠ¨ä¸€ä½</strong>ï¼Œ<strong>å¾…è¾“å…¥çš„æ•°å­—ç”±0å æ®</strong></p>
<p>å†è¾“å…¥çš„æ•°å­—<strong>ä¸€å®šæ˜¯ä»ä¸ªä½å¼€å§‹</strong>ï¼Œç„¶ååœ¨æŒ‰ä¸‹ä¸‹ä¸€ä¸ªæŒ‰é”®æ—¶ï¼Œå¾€å·¦ç§»åŠ¨ï¼Œå°±ï¼Œ<strong>å¾ˆå¦™å•Šï¼</strong></p>
<p>ç„¶åå†è®¾å®šåªèƒ½è¾“å…¥4æ¬¡ï¼Œå™¢å¯¹äº†ï¼Œæˆ‘ä»¬<strong>åœ¨ä¸€å¼€å§‹è®¾ç½®äº†å…¨å±€å˜é‡</strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">int</span> Password<span class="token punctuation">,</span>Count<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æ‰€ä»¥Passwordå’ŒCount<strong>åˆå§‹å€¼éƒ½æ˜¯0</strong>ï¼Œå› æ­¤<strong>Count&lt;4</strong>å³<strong>è¾“å…¥å››æ¬¡</strong></p>
<h3 id="ç¡®è®¤é”®"><a href="#ç¡®è®¤é”®" class="headerlink" title="ç¡®è®¤é”®"></a>ç¡®è®¤é”®</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">if</span><span class="token punctuation">(</span>KeyNum<span class="token operator">==</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token comment">//if press S11---&gt;confirm</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>Password<span class="token operator">==</span><span class="token number">2345</span><span class="token punctuation">)</span>  <span class="token comment">//if the password == the correct password</span>
	<span class="token punctuation">{</span>								
		<span class="token function">LCD_ShowString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token string">"OK"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		Password<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//the password zero clearing</span>
		Count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">//metering zero clearing</span>
		<span class="token function">LCD_ShowNum</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Password<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//updata the display</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{</span>
		<span class="token function">LCD_ShowSrting</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token string">"ERR"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		Password<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//the password zero clearing</span>
		Count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">//metering zero clearing</span>
		<span class="token function">LCD_ShowNum</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Password<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//updata the display</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é¦–å…ˆï¼Œæˆ‘ä»¬<strong>çº¦å®šäº†2345æ˜¯æ­£ç¡®å¯†ç </strong>ï¼Œå½“è¾“å…¥äº†2345æ—¶æŒ‰ä¸‹S11ä¼š<strong>å‡ºç°â€OKâ€</strong></p>
<p>ç„¶åï¼Œå°±æ˜¯è¾“å…¥å®Œæ¯•å<strong>ä¸€åˆ‡å½’é›¶</strong>ï¼Œå³è®©ç”¨æˆ·<strong>å†æ¬¡è¾“å…¥(æ— è®ºè¾“å…¥æ­£ç¡®ä¸å¦)</strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">Password<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//the password zero clearing</span>
Count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">//metering zero clearing</span>
<span class="token function">LCD_ShowNum</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Password<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//updata the display</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å…ˆè®©Passwordé‡ç½®ä¸º0</p>
<p>ç„¶åè®¡æ•°Countä¹Ÿä¸º0</p>
<p>ä¸€åˆ‡éƒ½å›åˆ°æœ€å¼€å§‹çš„æ ·å­ï¼Œå³å…¨å±€å˜é‡åˆå§‹åŒ–çš„æ ·å­</p>
<h3 id="å–æ¶ˆé”®"><a href="#å–æ¶ˆé”®" class="headerlink" title="å–æ¶ˆé”®"></a>å–æ¶ˆé”®</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">if</span><span class="token punctuation">(</span>KeyNum<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token comment">//if press S12---&gt; cancel</span>
<span class="token punctuation">{</span>
	Password<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//the password zero clearing</span>
	Count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">//metering zero clearing</span>
	<span class="token function">LCD_ShowNum</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Password<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//updata the display				</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æœ‰äº†ä¸Šé¢çš„è§£é‡Šï¼Œè¿™ä¸ªåº”è¯¥ä¸éš¾ç†è§£å§</p>
<h1 id="å…³äºLCD1602-c"><a href="#å…³äºLCD1602-c" class="headerlink" title="å…³äºLCD1602.c"></a>å…³äºLCD1602.c</h1><p><img src="/../../../../medias/blog_picture/51/23.png" alt="LCD1602å†…éƒ¨æ˜¾ç¤ºåœ°å€"></p>
<p><img src="/../../../../medias/blog_picture/51/24.png" alt="ä¸¾ä¾‹è¯´æ˜"></p>
]]></content>
      <categories>
        <category>51å•ç‰‡æœº</category>
      </categories>
      <tags>
        <tag>51å•ç‰‡æœº</tag>
        <tag>å¤§äº‘å±‹è€ƒæ ¸</tag>
      </tags>
  </entry>
  <entry>
    <title>ç›®æ ‡æ£€æµ‹(ç¯å¢ƒé…ç½®)</title>
    <url>/2023/12/04/mu-biao-jian-ce/</url>
    <content><![CDATA[<p>é™„æœ¬èœé¸¡åœ¨windowsä¸Šè¿è¡ŒæˆåŠŸçš„(é€šè¿‡ç”µè„‘æ‘„åƒå¤´çš„)yolo<a href="https://github.com/Wabbybabb0/yolov5-5.0_hat_person">ç›®æ ‡æ£€æµ‹</a></p>
<p><strong>é…ç½®ç¯å¢ƒçš„æ—¶å€™æƒ³æ¸…æ¥šæ”¾åœ¨å“ªä¸ªç›˜ï¼Œç‰¹åˆ«æ˜¯è™šæ‹Ÿæœºï¼Œæ”¾Cç›˜å¾ˆå¯èƒ½ä¼šg</strong></p>
<p>ç›®å‰å› ä¸ºèŠ¯ç‰‡é—®é¢˜å¡ä½äº†ï¼Œè¿˜ä¼šæŒç»­æ›´æ–°çš„â€¦.(ä¹Ÿè®¸æ˜¯24å¹´ï¼Ÿ)</p>
<h1 id="1-é¡¹ç›®ä»£ç ç»“æ„æ•´"><a href="#1-é¡¹ç›®ä»£ç ç»“æ„æ•´" class="headerlink" title="1 é¡¹ç›®ä»£ç ç»“æ„æ•´"></a>1 é¡¹ç›®ä»£ç ç»“æ„æ•´</h1><ul>
<li>dataï¼šä¸»è¦æ˜¯å­˜æ”¾ä¸€äº›è¶…å‚æ•°çš„é…ç½®æ–‡ä»¶ï¼ˆè¿™äº›æ–‡ä»¶ï¼ˆyamlæ–‡ä»¶ï¼‰æ˜¯ç”¨æ¥é…ç½®è®­ç»ƒé›†å’Œæµ‹è¯•é›†è¿˜æœ‰éªŒè¯é›†çš„è·¯å¾„çš„ï¼Œå…¶ä¸­è¿˜åŒ…æ‹¬ç›®æ ‡æ£€æµ‹çš„ç§ç±»æ•°å’Œç§ç±»çš„åç§°ï¼‰ï¼›è¿˜æœ‰ä¸€äº›å®˜æ–¹æä¾›æµ‹è¯•çš„å›¾ç‰‡ã€‚å¦‚æœæ˜¯è®­ç»ƒè‡ªå·±çš„æ•°æ®é›†çš„è¯ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¿®æ”¹å…¶ä¸­çš„yamlæ–‡ä»¶ã€‚ä½†æ˜¯è‡ªå·±çš„æ•°æ®é›†ä¸å»ºè®®æ”¾åœ¨è¿™ä¸ªè·¯å¾„ä¸‹é¢ï¼Œè€Œæ˜¯å»ºè®®æŠŠæ•°æ®é›†æ”¾åˆ°yolov5é¡¹ç›®çš„åŒçº§ç›®å½•ä¸‹é¢ã€‚</li>
<li>modelsï¼šé‡Œé¢ä¸»è¦æ˜¯ä¸€äº›ç½‘ç»œæ„å»ºçš„é…ç½®æ–‡ä»¶å’Œå‡½æ•°ï¼Œå…¶ä¸­åŒ…å«äº†è¯¥é¡¹ç›®çš„å››ä¸ªä¸åŒçš„ç‰ˆæœ¬ï¼Œåˆ†åˆ«ä¸ºæ˜¯sã€mã€lã€xã€‚ä»åå­—å°±å¯ä»¥çœ‹å‡ºï¼Œè¿™å‡ ä¸ªç‰ˆæœ¬çš„å¤§å°ã€‚ä»–ä»¬çš„æ£€æµ‹æµ‹åº¦åˆ†åˆ«éƒ½æ˜¯ä»å¿«åˆ°æ…¢ï¼Œä½†æ˜¯ç²¾ç¡®åº¦åˆ†åˆ«æ˜¯ä»ä½åˆ°é«˜ã€‚è¿™å°±æ˜¯æ‰€è°“çš„é±¼å’Œç†ŠæŒä¸å¯å…¼å¾—ã€‚å¦‚æœè®­ç»ƒè‡ªå·±çš„æ•°æ®é›†çš„è¯ï¼Œå°±éœ€è¦ä¿®æ”¹è¿™é‡Œé¢ç›¸å¯¹åº”çš„yamlæ–‡ä»¶æ¥è®­ç»ƒè‡ªå·±æ¨¡å‹ã€‚</li>
<li>utilsï¼šå­˜æ”¾çš„æ˜¯å·¥å…·ç±»çš„å‡½æ•°ï¼Œé‡Œé¢æœ‰losså‡½æ•°ï¼Œmetricså‡½æ•°ï¼Œplotså‡½æ•°ç­‰ç­‰ã€‚</li>
<li>weightsï¼šæ”¾ç½®è®­ç»ƒå¥½çš„æƒé‡å‚æ•°ã€‚</li>
<li>detect.pyï¼šåˆ©ç”¨è®­ç»ƒå¥½çš„æƒé‡å‚æ•°è¿›è¡Œç›®æ ‡æ£€æµ‹ï¼Œå¯ä»¥è¿›è¡Œå›¾åƒã€è§†é¢‘å’Œæ‘„åƒå¤´çš„æ£€æµ‹ã€‚</li>
<li>train.pyï¼šè®­ç»ƒè‡ªå·±çš„æ•°æ®é›†çš„å‡½æ•°ã€‚</li>
<li>test.pyï¼šæµ‹è¯•è®­ç»ƒçš„ç»“æœçš„å‡½æ•°ã€‚</li>
<li>requirements.txtï¼šè¿™æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œé‡Œé¢å†™ç€ä½¿ç”¨yolov5é¡¹ç›®çš„ç¯å¢ƒä¾èµ–åŒ…çš„ä¸€äº›ç‰ˆæœ¬ï¼Œå¯ä»¥åˆ©ç”¨è¯¥æ–‡æœ¬å¯¼å…¥ç›¸åº”ç‰ˆæœ¬çš„åŒ…ã€‚</li>
</ul>
<h1 id="2-ä»githubä¸Šæ‹‰å–çš„åŒ…"><a href="#2-ä»githubä¸Šæ‹‰å–çš„åŒ…" class="headerlink" title="2 ä»githubä¸Šæ‹‰å–çš„åŒ…"></a>2 ä»githubä¸Šæ‹‰å–çš„åŒ…</h1><h2 id="2-1-æœ€å¥½åˆ›å»ºä¸€ä¸ªæ–°çš„è™šæ‹Ÿç¯å¢ƒï¼Œå› ä¸ºyoloå¯¹ä¸€äº›åº“æœ‰ç‰ˆæœ¬è¦æ±‚"><a href="#2-1-æœ€å¥½åˆ›å»ºä¸€ä¸ªæ–°çš„è™šæ‹Ÿç¯å¢ƒï¼Œå› ä¸ºyoloå¯¹ä¸€äº›åº“æœ‰ç‰ˆæœ¬è¦æ±‚" class="headerlink" title="2.1 æœ€å¥½åˆ›å»ºä¸€ä¸ªæ–°çš„è™šæ‹Ÿç¯å¢ƒï¼Œå› ä¸ºyoloå¯¹ä¸€äº›åº“æœ‰ç‰ˆæœ¬è¦æ±‚"></a>2.1 æœ€å¥½åˆ›å»ºä¸€ä¸ªæ–°çš„è™šæ‹Ÿç¯å¢ƒï¼Œå› ä¸º<code>yolo</code>å¯¹ä¸€äº›åº“æœ‰ç‰ˆæœ¬è¦æ±‚</h2><p><a href="https://www.bilibili.com/video/BV1cD4y1H7Tk/?spm_id_from=333.337.search-card.all.click&amp;vd_source=1e1c4d48c6129699686897a835e568ea">åˆ›å»ºè™šæ‹Ÿç¯å¢ƒâ€“bç«™è§†é¢‘æ•™ç¨‹</a>ï¼Œè§†é¢‘è¯„è®ºåŒºç½®é¡¶å¤„ä¸‹æœ‰pdfè®²ä¹‰ï¼Œå¯ä¸‹è½½ã€‚ä¸æƒ³çœ‹è§†é¢‘çš„å¯ä»¥ç›´æ¥ç‚¹<a href="https://pan.baidu.com/s/1Xnhv-NSmtggYqKlg3uAlMg#list/path=%2F">è®²ä¹‰é“¾æ¥</a><br>å…¶ä¸­ï¼š</p>
<ul>
<li>æ³¨æ„<code>NVIDA</code>ã€<code>CUDA</code>ã€<code>pytorch</code>çš„å‹å·æ˜¯å¦äº’ç›¸å…¼å®¹</li>
<li>æ³¨æ„ç½‘ç»œé—®é¢˜ï¼Œæœ‰æ—¶å€™å…³æ‰æ¢¯å­ä¼šå¥½ç‚¹</li>
<li>æºçš„é—®é¢˜ï¼Œæ‰¾åˆ°ä¸€ä¸ªé˜¿é‡Œäº‘æ¯”è¾ƒå¥½ç”¨çš„ï¼š<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pip config <span class="token builtin class-name">set</span> global.index-url https://mirrors.aliyun.com/pypi/simple 

pip config <span class="token builtin class-name">set</span> install.trusted-host mirrors.aliyun.com<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li>
<li>è®°å½•é€”ä¸­ç”¨åˆ°çš„<code>whl</code>è·¯å¾„<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pip <span class="token function">install</span> D:<span class="token punctuation">\</span>whl<span class="token punctuation">\</span>torch-1.12.0+cu116-cp39-cp39-win_amd64.whl
pip <span class="token function">install</span> D:<span class="token punctuation">\</span>whl<span class="token punctuation">\</span>torchvision-0.13.0+cu116-cp39-cp39-win_amd64.whl
pip <span class="token function">install</span> D:<span class="token punctuation">\</span>whl<span class="token punctuation">\</span>torchaudio-0.12.0+cu116-cp39-cp39-win_amd64.whl<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li>
</ul>
<h2 id="2-2-ä¿®æ”¹ä»£ç æ—¶çš„ä¸€äº›æ³¨æ„äº‹é¡¹"><a href="#2-2-ä¿®æ”¹ä»£ç æ—¶çš„ä¸€äº›æ³¨æ„äº‹é¡¹" class="headerlink" title="2.2 ä¿®æ”¹ä»£ç æ—¶çš„ä¸€äº›æ³¨æ„äº‹é¡¹"></a>2.2 ä¿®æ”¹ä»£ç æ—¶çš„ä¸€äº›æ³¨æ„äº‹é¡¹</h2><ol>
<li><code>train.py</code>ã€<code>dectect.py</code>å¯ä»¥é¢å‘CSDNç¼–ç¨‹</li>
</ol>
<ul>
<li>e.g.æŠ¥é”™No module named â€˜yamlâ€˜  ï¼Œåœ¨ç»ˆç«¯è¾“å…¥å¦‚ä¸‹æŒ‡ä»¤<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pip <span class="token function">install</span> pyyaml<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li>æ³¨æ„æ˜¯åœ¨ç»ˆç«¯å¤„ä¸‹è½½è¿˜æ˜¯åœ¨<code>Anaconda Prompt</code>å¤„ä¸‹è½½</li>
<li>æ³¨æ„<code>conda install</code>è¿˜æ˜¯<code>pip install</code>ï¼Œæ³¨æ„å…ˆæ¿€æ´»è™šæ‹Ÿç¯å¢ƒå†å®‰è£…åŒ…<code>conda activate xxx</code></li>
</ul>
<ol start="2">
<li>æ³¨æ„è·¯å¾„é—®é¢˜ï¼š<ol>
<li>ç»å¯¹è·¯å¾„ï¼šåœ¨<code>train.py</code>ä¸­çš„ä¸‰è¡Œä»£ç é‡Œæœ€å¥½ä½¿ç”¨ç»å¯¹è·¯å¾„<img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/yolo_picture/Pasted%20image%2020231205120324.png"></li>
<li>ç›¸å¯¹è·¯å¾„ï¼šåœ¨<code>detect.py</code>ä¸­çš„<code>weights</code>ï¼Œåœ¨æˆ‘ä½¿ç”¨ç»å¯¹è·¯å¾„çš„æ—¶å€™æ˜¯æ— æ³•å®ç°æƒ³è¦çš„æ•ˆæœçš„ï¼Œä½†æ˜¯æ›´æ”¹ä¸º<code>weights/best.pt</code>(ä½¿ç”¨æœ€ä½³æ¨¡å‹åšæµ‹è¯•)æ—¶å¯ä»¥æ­£å¸¸è¿è¡Œ</li>
</ol>
</li>
</ol>
<h1 id="3-é…ç½®VMwareå’ŒUbuntu"><a href="#3-é…ç½®VMwareå’ŒUbuntu" class="headerlink" title="3 é…ç½®VMwareå’ŒUbuntu"></a>3 é…ç½®VMwareå’ŒUbuntu</h1><p>ä¸‹é¢æ˜¯ä¸¤ä¸ªå®‰è£…æ•™ç¨‹ï¼Œå¯ä»¥ç»“åˆé£Ÿç”¨ï¼š</p>
<h2 id="3-1VMwareè™šæ‹Ÿæœºå®‰è£…Linuxæ•™ç¨‹ï¼š"><a href="#3-1VMwareè™šæ‹Ÿæœºå®‰è£…Linuxæ•™ç¨‹ï¼š" class="headerlink" title="3.1VMwareè™šæ‹Ÿæœºå®‰è£…Linuxæ•™ç¨‹ï¼š"></a>3.1<a href="https://blog.csdn.net/weixin_52799373/article/details/124324077">VMwareè™šæ‹Ÿæœºå®‰è£…Linuxæ•™ç¨‹</a>ï¼š</h2><p>(ä»¥ä¸‹æ˜¯è¯¥æ•™ç¨‹çš„è™šæ‹Ÿæœºå’Œisoé€‰æ‹©ï¼Œå¯æ ¹æ®ä¸ªäººéœ€è¦è¿›è¡Œæ›´æ”¹ï¼Œä½†æ˜¯é…ç½®è¿‡ç¨‹å¤§å·®ä¸å·®)</p>
<ol>
<li>è™šæ‹Ÿæœºï¼šVMware16 pro</li>
<li>Linuxç³»ç»Ÿisoé•œåƒï¼šCentOS-7.5-x86_64</li>
</ol>
<h2 id="3-2-VMwareè™šæ‹Ÿæœºå®‰è£…Ubuntu20-04è¯¦ç»†å›¾æ–‡æ•™ç¨‹"><a href="#3-2-VMwareè™šæ‹Ÿæœºå®‰è£…Ubuntu20-04è¯¦ç»†å›¾æ–‡æ•™ç¨‹" class="headerlink" title="3.2 VMwareè™šæ‹Ÿæœºå®‰è£…Ubuntu20.04è¯¦ç»†å›¾æ–‡æ•™ç¨‹"></a>3.2 <a href="https://blog.csdn.net/weixin_41805734/article/details/120698714">VMwareè™šæ‹Ÿæœºå®‰è£…Ubuntu20.04è¯¦ç»†å›¾æ–‡æ•™ç¨‹</a></h2><p>(ä»¥ä¸‹æ˜¯è¯¥æ•™ç¨‹çš„è™šæ‹Ÿæœºå’Œisoé€‰æ‹©ï¼Œå¯æ ¹æ®ä¸ªäººéœ€è¦è¿›è¡Œæ›´æ”¹ï¼Œä½†æ˜¯é…ç½®è¿‡ç¨‹å¤§å·®ä¸å·®)</p>
<ol>
<li>è™šæ‹Ÿæœºï¼šVMware16</li>
<li>Linuxç³»ç»Ÿisoé•œåƒï¼šUbuntu20.04</li>
</ol>
<h2 id="3-3-ä¸€äº›è¯´æ˜"><a href="#3-3-ä¸€äº›è¯´æ˜" class="headerlink" title="3.3 ä¸€äº›è¯´æ˜"></a>3.3 ä¸€äº›è¯´æ˜</h2><p>æ­£å¦‚ä¸Šé¢ä¸€ä½åšä¸»æ‰€è¯´â€œä¸å¿…åˆ»æ„ç”¨æ—§ç‰ˆâ€</p>
<ol>
<li><p>å…³äºè™šæ‹Ÿæœºï¼šå¯é€‰æ‹©VMware 17ï¼Œ<a href="https://www.vmware.com/cn/products/workstation-player/workstation-player-evaluation.html">VMwareå®˜æ–¹ç½‘ç«™</a></p>
</li>
<li><p>å…³äºisoé•œåƒï¼šæ–°æ‰‹æ¨èä¸‹Ubuntuï¼Œå¯ä»¥å»<a href="https://ubuntu.com/download/desktop">Ubuntuå®˜æ–¹ç½‘ç«™</a><br> è¿™é‡Œé™„ä¸Š<a href="http://mirrors.aliyun.com/ubuntu-releases/20.04/">Ubuntu20.04</a>çš„é“¾æ¥(æ˜¯å›½å†…é•œåƒæºï¼Œä¸‹è½½ä¼šå¿«äº›)!<img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/yolo_picture/1701762736537.png"></p>
</li>
<li><p>è®¾ç½®å†…æ ¸å’Œå†…å­˜æ—¶å¯ä»¥æœ€å¥½è®¾ç½®å¥½ä¹‹åå°±ä¸æ”¹äº†ï¼Œå› ä¸ºä¿®æ”¹å†…å­˜æˆ–ç¡¬ç›˜å¤§å°ä¹‹åé‡å¯å¯èƒ½ä¼šbæºƒï¼Œæœ¬äººåœ¨ä¸‹å›¾ä¿®æ”¹ç¡¬ç›˜å¤§å°ä¹‹åæ— æ³•å†æ‰“å¼€è™šæ‹Ÿæœº<img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/yolo_picture/Pasted%20image%2020231205155730.png"></p>
</li>
</ol>
<h2 id="3-4-å®¿ä¸»æœºä¸è™šæ‹Ÿæœºäº’ä¼ æ–‡ä»¶"><a href="#3-4-å®¿ä¸»æœºä¸è™šæ‹Ÿæœºäº’ä¼ æ–‡ä»¶" class="headerlink" title="3.4 å®¿ä¸»æœºä¸è™šæ‹Ÿæœºäº’ä¼ æ–‡ä»¶"></a>3.4 å®¿ä¸»æœºä¸è™šæ‹Ÿæœºäº’ä¼ æ–‡ä»¶</h2><p><a href="https://blog.51cto.com/u_15309736/5424668">windowsä¸»æœºå’Œubuntuäº’ä¼ æ–‡ä»¶çš„4ç§æ–¹æ³•</a><br>æœ¬äººé€‰æ‹©ç¬¬äºŒä¸ªæ–¹æ³•ï¼š</p>
<ol>
<li>ubuntuå®‰è£…FTPæœåŠ¡<br> åœ¨ubuntuç»ˆç«¯è¾“å…¥å¦‚ä¸‹å‘½ä»¤<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> vsftpd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li>å®‰è£…å®Œåæ£€æŸ¥<code>/etc /vsftpd.conf</code>é…ç½®æ–‡ä»¶<br>è¾“å…¥å¦‚ä¸‹å‘½ä»¤æ‰“å¼€é…ç½®æ–‡ä»¶ï¼šï¼ˆæ³¨æ„æ­¤å¤„åœ¨ç½‘å€ä¸Šè¾“å…¥çš„æ˜¯<code>sudo vi</code>ï¼Œä½†æ˜¯æœ¬äººä¸å¤ªä¼šä½¿ç”¨<code>vi</code>ç¼–è¾‘å™¨ï¼Œä¹Ÿæ‰¾ä¸åˆ°<code>vi</code>ç¼–è¾‘å™¨çš„ä½¿ç”¨æ–¹æ³•ï¼Œå› æ­¤ä½¿ç”¨äº†<code>vim</code>ï¼Œ<code>vim</code>ç¼–è¾‘å™¨çš„çš„æŒ‡ä»¤åœ¨ä¸‹æ–‡4.9æœ‰æåˆ°ï¼‰<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/bsftpd.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li>windowså®‰è£…å’Œé…ç½®FIleZilla<br>ç‚¹å‡»<a href="https://www.filezilla.cn/download">FileZillaä¸‹è½½ä¸­å¿ƒ</a>ä¸‹è½½å®¢æˆ·ç«¯</li>
<li>FileZillaè½¯ä»¶é…ç½®ï¼š<br>æ‰“å¼€FileZillaè½¯ä»¶ï¼Œé€‰æ‹©ï¼šæ–‡ä»¶-&gt;ç«™ç‚¹ç®¡ç†å™¨-&gt;ç‚¹å‡»æ–°å¢ç«™ç‚¹ï¼Œç„¶åé…ç½®è¿æ¥å‚æ•°ï¼Œå¦‚ä¸‹å›¾ï¼š<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/yolo_picture/1701834260705.png"><br>ä¸»æœºå¤„è¾“å…¥çš„æ˜¯ubuntuçš„IPv4åœ°å€ï¼ŒæŸ¥æ‰¾æ–¹å¼å¦‚ä¸‹ï¼š</li>
</ol>
<ul>
<li>ç‚¹å‡»è®¾ç½®<br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/yolo_picture/1701834357072.png"></li>
<li><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/yolo_picture/1701834466524.png"></li>
<li><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/yolo_picture/1701834503573.png"></li>
</ul>
<ol start="5">
<li>å¯ä»¥çœ‹åˆ°ubuntuä¸‹çš„æ–‡ä»¶(å³è¾¹)<br>![](<a href="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/yolo_picture/Pasted">https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/yolo_picture/Pasted</a> image 20231206114943.png)</li>
</ol>
<h1 id="4-Ubuntu22-04é…ç½®anaconda"><a href="#4-Ubuntu22-04é…ç½®anaconda" class="headerlink" title="4 Ubuntu22.04é…ç½®anaconda"></a>4 Ubuntu22.04é…ç½®anaconda</h1><h2 id="4-1-é…ç½®è¿‡ç¨‹"><a href="#4-1-é…ç½®è¿‡ç¨‹" class="headerlink" title="4.1 é…ç½®è¿‡ç¨‹"></a>4.1 é…ç½®è¿‡ç¨‹</h2><p><a href="https://www.xtuos.com/6527.html">å‚è€ƒæ¥æº</a></p>
<ol>
<li><p>é¦–å…ˆï¼Œé€šè¿‡åœ¨ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œç¡®ä¿æ‰€æœ‰ç³»ç»ŸåŒ…éƒ½æ˜¯æœ€æ–°çš„ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> update
<span class="token function">sudo</span> <span class="token function">apt</span> upgrade
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token function">wget</span> apt-transport-https gnupg2 software-properties-common<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>åœ¨ Ubuntu 22.04 ä¸Šå®‰è£… Anaconda Pythonã€‚<br>é»˜è®¤æƒ…å†µä¸‹ï¼ŒAnaconda åœ¨ Ubuntu 22.04 åŸºç¡€å­˜å‚¨åº“ä¸­ä¸å¯ç”¨ã€‚ç°åœ¨è¿è¡Œä»¥ä¸‹å‘½ä»¤å°† Anaconda çš„æœ€æ–°ç¨³å®šç‰ˆæœ¬ä¸‹è½½åˆ°æ‚¨çš„ Ubuntu ç³»ç»Ÿï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> https://repo.anaconda.com/archive/Anaconda3-2022.05-Linux-x86_64.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/yolo_picture/Pasted%20image%2020231205114818.png"><br>ä¸‹è½½Anacondaå®‰è£…ç¨‹åºåï¼Œç°åœ¨ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿è¡Œè„šæœ¬ï¼š</p>
</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">bash</span> Anaconda3-2022.05-Linux-x86_64.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æŒ‰ç…§å‘å¯¼è¯´æ˜å®Œæˆ Anaconda å®‰è£…è¿‡ç¨‹(å¯ä»¥ä¸€è·¯æŒ‰â€Enterâ€)</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Welcome to Anaconda3 <span class="token number">2022.05</span>

In order to <span class="token builtin class-name">continue</span> the installation process, please review the license
agreement.
Please, press ENTER to <span class="token builtin class-name">continue</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸‹ä¸€æ­¥æ˜¯æŒ‡æ˜å®‰è£…è·¯å¾„ï¼Œé»˜è®¤æŒ‡å‘æ ¹ç›®å½•ã€‚å¦‚æœæ‚¨å…·æœ‰ root è®¿é—®æƒé™ï¼Œåˆ™å¯ä»¥å°†å…¶ä¿ç•™åœ¨é‚£é‡Œï¼Œä½†æ‚¨ä¹Ÿå¯ä»¥å°†å…¶å®‰è£…åœ¨æ‚¨å¸æˆ·çš„ HOME ç›®å½•ä¸­ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Anaconda3 will now be installed into this location:
/root/anaconda3

- Press ENTER to confirm the location
- Press CTRL-C to abort the installation
- Or specify a different location below

<span class="token punctuation">[</span>/root/anaconda3<span class="token punctuation">]</span> <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ³¨æ„åœ°å€æ˜¯ï¼š<code>/home/wabbybabbo(ä½ è‡ªå·±çš„ç”¨æˆ·å)/anaconda3</code><br><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/yolo_picture/Pasted%20image%2020231205201819.png"></p>
<ol start="3">
<li><p>å®‰è£… Anaconda åï¼Œä¸‹ä¸€æ­¥æ˜¯é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥ä½¿ç”¨â€œ â€æ–‡ä»¶ä¸­æ·»åŠ çš„ç¯å¢ƒè®¾ç½®ï¼š<code>.bashrc</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">source</span> ~/.bashrc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>éªŒè¯Anacondaå®‰è£…ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">conda list<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>å¦‚æœè¦æ›´æ–°è¿è¡Œçš„æ•´ä¸ªç¯å¢ƒ(éå¿…è¦)</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">conda update-all<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>æŸ¥çœ‹è™šæ‹Ÿæœºä¸Šçš„è™šæ‹Ÿç¯å¢ƒæœ‰å“ªäº›</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">conda info <span class="token parameter variable">--envs</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>å¯ä»¥çœ‹åˆ°è¿™æ—¶å€™æœ‰ä¸€ä¸ªåä¸º<code>base</code>çš„è™šæ‹Ÿç¯å¢ƒ<img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/yolo_picture/Pasted%20image%2020231205155441.png"></p>
</li>
</ol>
<h2 id="4-2-å…¶ä»–æŒ‡ä»¤"><a href="#4-2-å…¶ä»–æŒ‡ä»¤" class="headerlink" title="4.2 å…¶ä»–æŒ‡ä»¤"></a>4.2 å…¶ä»–æŒ‡ä»¤</h2><h3 id="4-2-1-unbutuä¸€äº›æŒ‡ä»¤"><a href="#4-2-1-unbutuä¸€äº›æŒ‡ä»¤" class="headerlink" title="4.2.1 unbutuä¸€äº›æŒ‡ä»¤"></a>4.2.1 unbutuä¸€äº›æŒ‡ä»¤</h3><p><a href="https://blog.csdn.net/zjc910997316/article/details/82983251">æ¥æº</a></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> www  <span class="token comment"># åˆ°wwwç›®å½•ï¼›  </span>
<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>   <span class="token comment"># åˆ°ä¸Šä¸€çº§ç›®å½•ï¼›  </span>
<span class="token builtin class-name">cd</span> -    <span class="token comment"># è¿”å›åˆ°ä¸Šæ¬¡çš„ç›®å½•ï¼Œç±»ä¼¼windowsè¿”å› ï¼›  </span>
<span class="token builtin class-name">cd</span> /    <span class="token comment"># å›åˆ°æ ¹ç›®å½•ã€‚</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-2-2-Linux-vimç¼–è¾‘å™¨çš„æŒ‡ä»¤"><a href="#4-2-2-Linux-vimç¼–è¾‘å™¨çš„æŒ‡ä»¤" class="headerlink" title="4.2.2 Linux vimç¼–è¾‘å™¨çš„æŒ‡ä»¤"></a>4.2.2 Linux vimç¼–è¾‘å™¨çš„æŒ‡ä»¤</h3><p><a href="https://blog.csdn.net/xie_xiansheng/article/details/78134626">æ¥æº</a></p>
<ul>
<li>ç¼–å†™ï¼šæŒ‰<code>a</code></li>
<li>é€€å‡ºï¼šå…ˆæŒ‰<code>ESC</code>é”®ï¼Œè·³åˆ°å‘½ä»¤æ¨¡å¼ï¼Œå†æ ¹æ®é€‰æ‹©è¾“å…¥ä¸‹é¢çš„(è®°å¾—è¾“å…¥å†’å·)<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">:w      <span class="token comment"># ä¿å­˜æ–‡ä»¶ä½†ä¸é€€å‡ºvi</span>
:w <span class="token function">file</span> <span class="token comment"># å°†ä¿®æ”¹å¦å¤–ä¿å­˜åˆ°fileä¸­ï¼Œä¸é€€å‡ºvi</span>
:w<span class="token operator">!</span>     <span class="token comment"># å¼ºåˆ¶ä¿å­˜ï¼Œä¸æ¨å‡ºvi</span>
:wq     <span class="token comment"># ä¿å­˜æ–‡ä»¶å¹¶é€€å‡ºvi</span>
:wq<span class="token operator">!</span>    <span class="token comment"># å¼ºåˆ¶ä¿å­˜æ–‡ä»¶ï¼Œå¹¶é€€å‡ºvi</span>
:q      <span class="token comment"># ä¸ä¿å­˜æ–‡ä»¶ï¼Œé€€å‡ºvi</span>
:q<span class="token operator">!</span>     <span class="token comment"># ä¸ä¿å­˜æ–‡ä»¶ï¼Œå¼ºåˆ¶é€€å‡ºvi</span>
:e<span class="token operator">!</span>     <span class="token comment"># æ”¾å¼ƒæ‰€æœ‰ä¿®æ”¹ï¼Œä»ä¸Šæ¬¡ä¿å­˜æ–‡ä»¶å¼€å§‹å†ç¼–è¾‘</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<h3 id="4-2-3-è¿›å…¥å’Œé€€å‡ºconda-baseç¯å¢ƒ"><a href="#4-2-3-è¿›å…¥å’Œé€€å‡ºconda-baseç¯å¢ƒ" class="headerlink" title="4.2.3 è¿›å…¥å’Œé€€å‡ºconda baseç¯å¢ƒ"></a>4.2.3 è¿›å…¥å’Œé€€å‡º<code>conda base</code>ç¯å¢ƒ</h3><p>è¿›å…¥<code>conda base</code>ç¯å¢ƒï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">source</span> ~/anaconda3/bin/activate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>é€€å‡º<code>conda base</code>ç¯å¢ƒï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">conda deactivate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/yolo_picture/Pasted%20image%2020231205205557.png"></p>
<h1 id="5-yoloæ¨¡å‹éƒ¨ç½²åˆ°orangepi-3"><a href="#5-yoloæ¨¡å‹éƒ¨ç½²åˆ°orangepi-3" class="headerlink" title="5 yoloæ¨¡å‹éƒ¨ç½²åˆ°orangepi 3"></a>5 yoloæ¨¡å‹éƒ¨ç½²åˆ°orangepi 3</h1><p>é™„ä¸Šä¸¤ä¸ªå‚è€ƒç½‘ç«™ï¼š<a href="https://blog.csdn.net/m0_55217834/article/details/130583886"># é¦™æ©™æ´¾5 RK3588 yolov5æ¨¡å‹è½¬æ¢rknnåŠéƒ¨ç½²è¸©å‘å…¨è®°å½• orangepi 5</a>ã€<a href="http://years.love/yolov5.html">linuxæ¿ä¸Šè¿è¡Œyolov5 ç›®æ ‡æ£€æµ‹</a></p>
<h2 id="5-1-æ‰€è°“çš„yolov5ç›®å½•"><a href="#5-1-æ‰€è°“çš„yolov5ç›®å½•" class="headerlink" title="5.1 æ‰€è°“çš„yolov5ç›®å½•"></a>5.1 æ‰€è°“çš„yolov5ç›®å½•</h2><p><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/yolo_picture/Pasted%20image%2020231205161134.png"><br> è¿™ä¸ª<strong>yolov5ç›®å½•</strong>åœ¨æœ¬äººçš„ç”µè„‘ä¸Šï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯è¿™æ ·çš„<img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/yolo_picture/Pasted%20image%2020231205161233.png"></p>
<h2 id="5-2-è·¯å¾„é—®é¢˜"><a href="#5-2-è·¯å¾„é—®é¢˜" class="headerlink" title="5.2 è·¯å¾„é—®é¢˜"></a>5.2 è·¯å¾„é—®é¢˜</h2><p> <code>weight</code>å’Œ<code>data/coco128</code>æ”¹æˆè‡ªå·±çš„weightå’Œdataçš„è·¯å¾„</p>
<h2 id="5-3-ç”Ÿæˆçš„-onnxæ–‡ä»¶"><a href="#5-3-ç”Ÿæˆçš„-onnxæ–‡ä»¶" class="headerlink" title="5.3 ç”Ÿæˆçš„.onnxæ–‡ä»¶"></a>5.3 ç”Ÿæˆçš„<code>.onnx</code>æ–‡ä»¶</h2><p> ç”Ÿæˆçš„yolov5n.onnxæ–‡ä»¶åœ¨æœ¬äººç”µè„‘ä¸Šçš„ä½ç½®åœ¨è¿™é‡Œï¼Œåä¸º<code>best.onnx</code><img src="https://raw.githubusercontent.com/Wabbybabb0/Blog_picture/main/yolo_picture/Pasted%20image%2020231205161724.png"></p>
<h2 id="5-4-åœ¨Ubuntuåˆ›å»ºè™šæ‹Ÿç¯å¢ƒ"><a href="#5-4-åœ¨Ubuntuåˆ›å»ºè™šæ‹Ÿç¯å¢ƒ" class="headerlink" title="5.4 åœ¨Ubuntuåˆ›å»ºè™šæ‹Ÿç¯å¢ƒ"></a>5.4 åœ¨Ubuntuåˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</h2><ol start="4">
<li>åˆ›å»ºåä¸º<code>rknn</code>çš„è™šæ‹Ÿç¯å¢ƒæ—¶è¾“å…¥<code>conda create -name rknn python=3.9</code>æŠ¥é”™äº†ï¼Œä½†æ˜¯è¾“å…¥<code>conda create -n rknn python=3.9</code>å°±ä¸ä¼šï¼Œå¾ˆå¥‡æ€ª</li>
</ol>
<h2 id="5-5-Ubuntuè§£å‹ç¼©"><a href="#5-5-Ubuntuè§£å‹ç¼©" class="headerlink" title="5.5 Ubuntuè§£å‹ç¼©"></a>5.5 Ubuntuè§£å‹ç¼©</h2><p><a href="https://blog.csdn.net/songbinxu/article/details/80435665">å‚è€ƒç½‘å€</a><br>æœ¬äººç”¨åˆ°çš„æ˜¯</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">unzip</span> FileName.zip <span class="token comment"># è§£å‹</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å†ä¹‹åçš„è·Ÿç€ä¸Šé¢çš„ä¸¤ä¸ªåšå®¢èµ°ï¼ŒåŸºæœ¬ä¸Šæ²¡ä»€ä¹ˆå‘äº†</p>
<h1 id="6-é‡åˆ°çš„å…¶ä»–é—®é¢˜"><a href="#6-é‡åˆ°çš„å…¶ä»–é—®é¢˜" class="headerlink" title="6 é‡åˆ°çš„å…¶ä»–é—®é¢˜"></a>6 é‡åˆ°çš„å…¶ä»–é—®é¢˜</h1><p>åœ¨å¼€æœºæ—¶é»‘å±ä¸”é‡åˆ°äº†ï¼š<br><a href="https://blog.csdn.net/qq_38132831/article/details/77932173">SMbus Host Controller not enabled</a></p>
]]></content>
      <categories>
        <category>äººå·¥æ™ºèƒ½</category>
      </categories>
      <tags>
        <tag>äººå·¥æ™ºèƒ½</tag>
        <tag>Linux</tag>
        <tag>Ubuntu</tag>
      </tags>
  </entry>
  <entry>
    <title>Calculatorç®€æ˜“è®¡ç®—å™¨</title>
    <url>/2022/10/13/jian-yi-ji-suan-qi/</url>
    <content><![CDATA[<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;windows.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;math.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string.h&gt;</span></span>

<span class="token keyword">int</span> o_top <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//ç¬¦å·æ ˆå¤´</span>
<span class="token keyword">int</span> num_top <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//æ•°å­—æ ˆå¤´ </span>

<span class="token keyword">char</span> o_s<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//ç¬¦å·æ ˆ </span>
<span class="token keyword">int</span> num_s<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//æ•°å­—æ ˆ </span>

<span class="token keyword">int</span> <span class="token function">jop</span><span class="token punctuation">(</span><span class="token keyword">char</span> o<span class="token punctuation">)</span><span class="token comment">//åˆ¤æ–­ç¬¦å·ç­‰çº§ judge_operator_priority</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> <span class="token char">'('</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> <span class="token char">'+'</span> <span class="token operator">||</span> o <span class="token operator">==</span> <span class="token char">'-'</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> <span class="token char">'*'</span> <span class="token operator">||</span> o <span class="token operator">==</span> <span class="token char">'/'</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token number">3</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> <span class="token char">'^'</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//æ“ä½œç¬¦å‡ºæ ˆ </span>
<span class="token keyword">void</span> <span class="token function">o_push</span><span class="token punctuation">(</span><span class="token keyword">char</span> o<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	o_top<span class="token operator">++</span><span class="token punctuation">;</span>
	o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span> <span class="token operator">=</span> o<span class="token punctuation">;</span>
	<span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//æ“ä½œæ•°å‡ºæ ˆ </span>
<span class="token keyword">void</span> <span class="token function">num_push</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	num_top<span class="token operator">++</span><span class="token punctuation">;</span>
	num_s<span class="token punctuation">[</span>num_top<span class="token punctuation">]</span> <span class="token operator">=</span> n<span class="token punctuation">;</span>
	<span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//è‡ªå®šä¹‰ä¸¤å…ƒè¿ç®—</span>
<span class="token comment">//è¯´æ˜:operand1å…ˆè¿›åå‡ºï¼Œoperand2åè¿›å…ˆå‡ºï¼Œæ‰€ä»¥è¿ç®—çš„è¡¨è¾¾å¼åº”è¯¥ä¸º&lt;operand1&gt;&lt;oeprator&gt;&lt;operand2&gt; </span>
<span class="token keyword">int</span> <span class="token function">math</span><span class="token punctuation">(</span><span class="token keyword">int</span> n1<span class="token punctuation">,</span> <span class="token keyword">int</span> n2<span class="token punctuation">,</span> <span class="token keyword">char</span> o<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> <span class="token char">'+'</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> n1 <span class="token operator">+</span> n2<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> <span class="token char">'-'</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> n1 <span class="token operator">-</span> n2<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> <span class="token char">'*'</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> n1 <span class="token operator">*</span> n2<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> <span class="token char">'/'</span> <span class="token operator">&amp;&amp;</span> n2 <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> n1 <span class="token operator">/</span> n2<span class="token punctuation">;</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> <span class="token char">'/'</span> <span class="token operator">&amp;&amp;</span> n2 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"å‡ºé”™ï¼\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> <span class="token char">'^'</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token function">pow</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"WBç‰ˆè®¡ç®—å™¨ç”±äºæŠ€æœ¯åŸå› ï¼Œä»…æ”¯æŒä»¥ä¸‹è¿ç®—....\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//	Sleep(1500);</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"1.å¸¦æ‹¬å·çš„+-*/è¿ç®—\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//	Sleep(1500);</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"2.è¿›åˆ¶è½¬æ¢è®¡ç®—\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//	Sleep(1500);</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ç°åœ¨ï¼Œè¯·ä½ è¾“å…¥â€œ1â€æˆ–â€œ2â€è¿›è¡Œè¿ç®—:\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">int</span> choice<span class="token punctuation">;</span>
	<span class="token function">scanf_s</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>choice<span class="token punctuation">)</span><span class="token punctuation">;</span>


	<span class="token comment">/*
	å½“ç”¨æˆ·è¾“å…¥1æ—¶ï¼Œè¿›å…¥4+1è¿ç®—
	*/</span>

	<span class="token comment">/*
	æµ…è°ˆè§„åˆ™ï¼š
	1.æ“ä½œç¬¦æ ˆæ ˆé¡¶ä¸ºç©º æˆ– æ ˆé¡¶æ“ä½œç¬¦ä¼˜å…ˆçº§&lt;å½“å‰æ“ä½œç¬¦ æ—¶ï¼Œå½“å‰æ“ä½œç¬¦å…¥æ ˆ
	2.æ ˆé¡¶æ“ä½œç¬¦ä¼˜å…ˆçº§&gt;ç›®å‰æ“ä½œç¬¦ ä¸” æ•°æ®æ ˆè‡³å°‘æœ‰2ä¸ªæ“ä½œæ•° ä¸” æ ˆé¡¶ä¸ä¸º( æ—¶ï¼Œæ ˆé¡¶æ“ä½œç¬¦å‡ºæ ˆ
	3.whlieå¾ªç¯æ¬¡æ•°æ˜¯&lt;è€Œä¸æ˜¯&lt;= çš„åŸå› :æœ€åå‡ºç°x1(ç”±è¿™ä¸ªwhileå¾ªç¯è®¡ç®—å¾—åˆ°çš„æ•°æ®)o x2(åŸè¡¨è¾¾å¼æœ€åçš„æ“ä½œæ•°)
	4.æ¯æ¬¡è¿ç®—å(è°ƒç”¨äº†mathå‡½æ•°å)ï¼Œå°†è¯¥æ¬¡è¿ç®—ç»“æœæ”¾å›æ ˆä¸­(è¡¥åˆ°æ ˆé¡¶ä¸‹é¢é‚£ä¸ª)ï¼Œç„¶åå†å£°æ˜æ ˆé¡¶è®¾å…¶ä¸º0ï¼Œè¿›è¡Œæ ˆé¡¶--ï¼Œä½¿æ ˆé¡¶å›åˆ°å«æœ‰æœ‰æ•ˆæ•°æ®é‚£
	*/</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>choice <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•ç®—å¼</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Please enter the equation(no space):\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token function">gets</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> size<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'('</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				<span class="token function">o_push</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				i<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;=</span> <span class="token char">'0'</span> <span class="token operator">&amp;&amp;</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token char">'9'</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				<span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
				<span class="token keyword">while</span> <span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;=</span> <span class="token char">'0'</span> <span class="token operator">&amp;&amp;</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token char">'9'</span> <span class="token operator">&amp;&amp;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">)</span>
				<span class="token punctuation">{</span>
					t <span class="token operator">=</span> t <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					i<span class="token operator">++</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token function">num_push</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token comment">//+ -</span>
			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'+'</span> <span class="token operator">||</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'-'</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>o_top <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token function">jop</span><span class="token punctuation">(</span>num_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
				<span class="token punctuation">{</span>
					<span class="token function">o_push</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">jop</span><span class="token punctuation">(</span>o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">||</span> <span class="token function">jop</span><span class="token punctuation">(</span>o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span> <span class="token operator">||</span> <span class="token function">jop</span><span class="token punctuation">(</span>o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span>
				<span class="token punctuation">{</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>o_top <span class="token operator">&gt;=</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> num_top <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token function">jop</span><span class="token punctuation">(</span>o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span>
					<span class="token punctuation">{</span>
						<span class="token keyword">int</span> n1 <span class="token operator">=</span> num_s<span class="token punctuation">[</span>num_top <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
						<span class="token keyword">int</span> n2 <span class="token operator">=</span> num_s<span class="token punctuation">[</span>num_top<span class="token punctuation">]</span><span class="token punctuation">;</span>
						num_s<span class="token punctuation">[</span>num_top <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">math</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">,</span> o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						num_s<span class="token punctuation">[</span>num_top<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
						o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
						num_top<span class="token operator">--</span><span class="token punctuation">;</span> o_top<span class="token operator">--</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token function">o_push</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				i<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token comment">//* /</span>
			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'*'</span> <span class="token operator">||</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'/'</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>o_top <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token function">jop</span><span class="token punctuation">(</span>o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">||</span> <span class="token function">jop</span><span class="token punctuation">(</span>o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
				<span class="token punctuation">{</span>
					<span class="token function">o_push</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">jop</span><span class="token punctuation">(</span>o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">||</span> <span class="token function">jop</span><span class="token punctuation">(</span>o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span>
				<span class="token punctuation">{</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>o_top <span class="token operator">&gt;=</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> num_top <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token function">jop</span><span class="token punctuation">(</span>o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span>
					<span class="token punctuation">{</span>
						<span class="token keyword">int</span> n1 <span class="token operator">=</span> num_s<span class="token punctuation">[</span>num_top <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
						<span class="token keyword">int</span> n2 <span class="token operator">=</span> num_s<span class="token punctuation">[</span>num_top<span class="token punctuation">]</span><span class="token punctuation">;</span>
						num_s<span class="token punctuation">[</span>num_top <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">math</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">,</span> o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						num_s<span class="token punctuation">[</span>num_top<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
						o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
						num_top<span class="token operator">--</span><span class="token punctuation">;</span> o_top<span class="token operator">--</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token function">o_push</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				i<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token comment">// ^ </span>
			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'^'</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>o_top <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token function">jop</span><span class="token punctuation">(</span>o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">||</span> <span class="token function">jop</span><span class="token punctuation">(</span>o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">||</span> <span class="token function">jop</span><span class="token punctuation">(</span>o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span>
				<span class="token punctuation">{</span>
					<span class="token function">o_push</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">jop</span><span class="token punctuation">(</span>o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span>
				<span class="token punctuation">{</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>o_top <span class="token operator">&gt;=</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> num_top <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token function">jop</span><span class="token punctuation">(</span>o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span>
					<span class="token punctuation">{</span>
						<span class="token keyword">int</span> n1 <span class="token operator">=</span> num_s<span class="token punctuation">[</span>num_top <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
						<span class="token keyword">int</span> n2 <span class="token operator">=</span> num_s<span class="token punctuation">[</span>num_top<span class="token punctuation">]</span><span class="token punctuation">;</span>
						num_s<span class="token punctuation">[</span>num_top <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">math</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">,</span> o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						num_s<span class="token punctuation">[</span>num_top<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
						o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
						num_top<span class="token operator">--</span><span class="token punctuation">;</span> o_top<span class="token operator">--</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token function">o_push</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				i<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token comment">// )</span>
			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">')'</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				<span class="token keyword">do</span> <span class="token punctuation">{</span>
					<span class="token keyword">int</span> n1 <span class="token operator">=</span> num_s<span class="token punctuation">[</span>num_top <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
					<span class="token keyword">int</span> n2 <span class="token operator">=</span> num_s<span class="token punctuation">[</span>num_top<span class="token punctuation">]</span><span class="token punctuation">;</span>
					num_s<span class="token punctuation">[</span>num_top <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">math</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">,</span> o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					num_s<span class="token punctuation">[</span>num_top<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
					o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
					num_top<span class="token operator">--</span><span class="token punctuation">;</span> o_top<span class="token operator">--</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">jop</span><span class="token punctuation">(</span>o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> o_top <span class="token operator">&gt;=</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> num_top <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
				o_top<span class="token operator">--</span><span class="token punctuation">;</span>
				i<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//æœ€ååªå‰©ä¸‹ä¸¤ä¸ªæ“ä½œæ•°å’Œä¸€ä¸ªæ“ä½œç¬¦ï¼Œç›´æ¥äºŒå…ƒè¿ç®— </span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>o_top <span class="token operator">&gt;=</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> num_top <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">int</span> n1 <span class="token operator">=</span> num_s<span class="token punctuation">[</span>num_top <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> n2 <span class="token operator">=</span> num_s<span class="token punctuation">[</span>num_top<span class="token punctuation">]</span><span class="token punctuation">;</span>
			num_s<span class="token punctuation">[</span>num_top <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">math</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">,</span> o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			num_s<span class="token punctuation">[</span>num_top<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			o_s<span class="token punctuation">[</span>o_top<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
			num_top<span class="token operator">--</span><span class="token punctuation">;</span> o_top<span class="token operator">--</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> num_s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">/*
	å½“ç”¨æˆ·è¾“å…¥2æ—¶ï¼Œè¿›è¡Œè¿›åˆ¶è½¬æ¢
	*/</span>

	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>choice <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token comment">/*
		*  nè¿›åˆ¶è½¬10è¿›åˆ¶
		*/</span>
		<span class="token keyword">int</span> pr<span class="token punctuation">;</span><span class="token comment">//previous,å…ˆå‰çš„è¿›åˆ¶ </span>
		<span class="token keyword">int</span> fn<span class="token punctuation">;</span><span class="token comment">//finalï¼Œæœ€åçš„è¿›åˆ¶</span>
		<span class="token keyword">int</span> size<span class="token punctuation">;</span><span class="token comment">//ç”¨äºæµ‹é‡é•¿åº¦ </span>
		<span class="token keyword">int</span> i<span class="token punctuation">;</span>
		<span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">char</span> ch<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"0"</span><span class="token punctuation">;</span>

		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"å³å°†è¾“å…¥ä¸‰ä¸ªæ•°å­—ï¼Œè¾“å…¥æ¯ä¸ªæ•°å­—åï¼ŒæŒ‰å›è½¦è½¬è·³ä¸‹ä¸€ä¸ªè¾“å…¥å†…å®¹......\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥åŸè¿›åˆ¶ï¼š"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">scanf_s</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>pr<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥åŸæ•°æ®ï¼š"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">scanf_s</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥æƒ³è¦è½¬æ¢æˆçš„æ•°æ®çš„è¿›åˆ¶ï¼š"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">scanf_s</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>

		size <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">int</span> temp1 <span class="token operator">=</span> <span class="token function">pow</span><span class="token punctuation">(</span>pr<span class="token punctuation">,</span> size <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> temp2 <span class="token operator">=</span> ch<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">switch</span> <span class="token punctuation">(</span>ch<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
			<span class="token keyword">case</span> <span class="token char">'A'</span><span class="token operator">:</span>
				sum <span class="token operator">+=</span> <span class="token punctuation">(</span>temp2 <span class="token operator">-</span> <span class="token number">55</span><span class="token punctuation">)</span> <span class="token operator">*</span> temp1<span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token keyword">case</span> <span class="token char">'B'</span><span class="token operator">:</span>
				sum <span class="token operator">+=</span> <span class="token punctuation">(</span>temp2 <span class="token operator">-</span> <span class="token number">55</span><span class="token punctuation">)</span> <span class="token operator">*</span> temp1<span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token keyword">case</span> <span class="token char">'C'</span><span class="token operator">:</span>
				sum <span class="token operator">+=</span> <span class="token punctuation">(</span>temp2 <span class="token operator">-</span> <span class="token number">55</span><span class="token punctuation">)</span> <span class="token operator">*</span> temp1<span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token keyword">case</span> <span class="token char">'D'</span><span class="token operator">:</span>
				sum <span class="token operator">+=</span> <span class="token punctuation">(</span>temp2 <span class="token operator">-</span> <span class="token number">55</span><span class="token punctuation">)</span> <span class="token operator">*</span> temp1<span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token keyword">case</span> <span class="token char">'E'</span><span class="token operator">:</span>
				sum <span class="token operator">+=</span> <span class="token punctuation">(</span>temp2 <span class="token operator">-</span> <span class="token number">55</span><span class="token punctuation">)</span> <span class="token operator">*</span> temp1<span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token keyword">case</span> <span class="token char">'F'</span><span class="token operator">:</span>
				sum <span class="token operator">+=</span> <span class="token punctuation">(</span>temp2 <span class="token operator">-</span> <span class="token number">55</span><span class="token punctuation">)</span> <span class="token operator">*</span> temp1<span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token keyword">default</span><span class="token operator">:</span>
				sum <span class="token operator">+=</span> <span class="token punctuation">(</span>temp2 <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">*</span> temp1<span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token comment">/*
		*	10è¿›åˆ¶è½¬nè¿›åˆ¶
		*/</span>

		<span class="token keyword">char</span> ans<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"0"</span><span class="token punctuation">;</span><span class="token comment">//ç­”æ¡ˆå­˜æ”¾ </span>
		<span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

		<span class="token keyword">while</span> <span class="token punctuation">(</span>sum <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">switch</span> <span class="token punctuation">(</span>sum <span class="token operator">%</span> fn<span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
			<span class="token keyword">case</span> <span class="token number">10</span><span class="token operator">:</span>
				ans<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'A'</span><span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token keyword">case</span> <span class="token number">11</span><span class="token operator">:</span>
				ans<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'B'</span><span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token keyword">case</span> <span class="token number">12</span><span class="token operator">:</span>
				ans<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'C'</span><span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token keyword">case</span> <span class="token number">13</span><span class="token operator">:</span>
				ans<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'D'</span><span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token keyword">case</span> <span class="token number">14</span><span class="token operator">:</span>
				ans<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'E'</span><span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token keyword">case</span> <span class="token number">15</span><span class="token operator">:</span>
				ans<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'F'</span><span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token keyword">default</span><span class="token operator">:</span>
				ans<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>sum <span class="token operator">%</span> fn<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			j<span class="token operator">++</span><span class="token punctuation">;</span>
			sum <span class="token operator">/=</span> fn<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		j<span class="token operator">--</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> j <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%c"</span><span class="token punctuation">,</span> ans<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

]]></content>
      <categories>
        <category>Cè¯­è¨€</category>
      </categories>
      <tags>
        <tag>å¤§äº‘å±‹è€ƒæ ¸</tag>
        <tag>Cè¯­è¨€</tag>
      </tags>
  </entry>
  <entry>
    <title>èœ‚é¸£å™¨</title>
    <url>/2022/10/18/feng-ming-qi/</url>
    <content><![CDATA[<h1 id="èœ‚é¸£å™¨"><a href="#èœ‚é¸£å™¨" class="headerlink" title="èœ‚é¸£å™¨"></a>èœ‚é¸£å™¨</h1><p><img src="/../../../../medias/blog_picture/51/64.png"></p>
<p>æ— æºèœ‚é¸£å™¨ä¸èƒ½ä¸€ç›´é€šç”µæµï¼Œå®ƒå†…éƒ¨ç½®äº†çº¿åœˆï¼Œè¦ç»™ä»–äº¤æµéœ‡è¡</p>
<p><img src="/../../../../medias/blog_picture/51/65.png"></p>
<p>VCCé«˜ç”µå¹³ï¼Œåªæœ‰èœ‚é¸£å™¨æ¥å£å¤„ä¸º0æ‰èƒ½é©±åŠ¨ï¼›ç™½è‰²ä¸‰è§’æ˜¯éé—¨ï¼Œå·¦è¾¹ç»™1/0å³è¾¹å0/1</p>
<p><img src="/../../../../medias/blog_picture/51/66.png"></p>
<h2 id="ç»å…¸ä¸Šä»£ç "><a href="#ç»å…¸ä¸Šä»£ç " class="headerlink" title="ç»å…¸ä¸Šä»£ç "></a>ç»å…¸ä¸Šä»£ç </h2><h4 id="main-c"><a href="#main-c" class="headerlink" title="main.c"></a>main.c</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Delay.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Key.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Nixie.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Buzzer.h"</span></span>

<span class="token keyword">unsigned</span> <span class="token keyword">char</span> KeyNum<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		KeyNum<span class="token operator">=</span><span class="token function">Key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>KeyNum<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">Buzzer_Time</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">Nixie</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>KeyNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="Key-c"><a href="#Key-c" class="headerlink" title="Key.c"></a>Key.c</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Delay.h"</span></span>

<span class="token comment">/**
  * @brief  è·å–ç‹¬ç«‹æŒ‰é”®é”®ç 
  * @param  æ— 
  * @retval æŒ‰ä¸‹æŒ‰é”®çš„é”®ç ï¼ŒèŒƒå›´ï¼š0~4ï¼Œæ— æŒ‰é”®æŒ‰ä¸‹æ—¶è¿”å›å€¼ä¸º0
  */</span>
<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token function">Key</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> KeyNumber<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	
	<span class="token keyword">if</span><span class="token punctuation">(</span>P3_1<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P3_1<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P3_0<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P3_0<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P3_2<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P3_2<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>P3_3<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>P3_3<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>KeyNumber<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	
	<span class="token keyword">return</span> KeyNumber<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="Nixie-c"><a href="#Nixie-c" class="headerlink" title="Nixie.c"></a>Nixie.c</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Delay.h"</span>	<span class="token comment">//åŒ…å«Delayå¤´æ–‡ä»¶</span></span>

<span class="token comment">//æ•°ç ç®¡æ®µç è¡¨</span>
<span class="token keyword">unsigned</span> <span class="token keyword">char</span> NixieTable<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0x3F</span><span class="token punctuation">,</span><span class="token number">0x06</span><span class="token punctuation">,</span><span class="token number">0x5B</span><span class="token punctuation">,</span><span class="token number">0x4F</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x6D</span><span class="token punctuation">,</span><span class="token number">0x7D</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0x7F</span><span class="token punctuation">,</span><span class="token number">0x6F</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//æ•°ç ç®¡æ˜¾ç¤ºå­å‡½æ•°</span>
<span class="token keyword">void</span> <span class="token function">Nixie</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> Location<span class="token punctuation">,</span>Number<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">switch</span><span class="token punctuation">(</span>Location<span class="token punctuation">)</span>		<span class="token comment">//ä½ç è¾“å‡º</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>P2_4<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>P2_3<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>P2_2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>P2_4<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>P2_3<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>P2_2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>P2_4<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>P2_3<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>P2_2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>P2_4<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>P2_3<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>P2_2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span>P2_4<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>P2_3<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>P2_2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">6</span><span class="token operator">:</span>P2_4<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>P2_3<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>P2_2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">7</span><span class="token operator">:</span>P2_4<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>P2_3<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>P2_2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">8</span><span class="token operator">:</span>P2_4<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>P2_3<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>P2_2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	P0<span class="token operator">=</span>NixieTable<span class="token punctuation">[</span>Number<span class="token punctuation">]</span><span class="token punctuation">;</span>	<span class="token comment">//æ®µç è¾“å‡º</span>

<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="Buzzer-c"><a href="#Buzzer-c" class="headerlink" title="Buzzer.c"></a>Buzzer.c</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Delay.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;INTRINS.H&gt;</span></span>

<span class="token comment">//èœ‚é¸£å™¨ç«¯å£ï¼š</span>
sbit Buzzer<span class="token operator">=</span>P2<span class="token operator">^</span><span class="token number">5</span><span class="token punctuation">;</span>

<span class="token comment">/**
  * @brief  èœ‚é¸£å™¨ç§æœ‰å»¶æ—¶å‡½æ•°ï¼Œå»¶æ—¶500ms
  * @param  æ— 
  * @retval æ— 
  */</span>
<span class="token keyword">void</span> <span class="token function">Buzzer_Delay500us</span><span class="token punctuation">(</span><span class="token punctuation">)</span>		<span class="token comment">//@11.0592MHzï¼Œä¸“é—¨ä¸ºèœ‚é¸£å™¨å†™äº†ä¸€ä¸ª</span>
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> i<span class="token punctuation">;</span>
	
	<span class="token function">_nop_</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	i <span class="token operator">=</span> <span class="token number">227</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
  * @brief  èœ‚é¸£å™¨å‘å£°
  * @param  msï¼Œå‘å£°çš„æ—¶é•¿
  * @retval æ— 
  */</span>
<span class="token keyword">void</span> <span class="token function">Buzzer_Time</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> ms<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token comment">//åŸæ¥çš„Delayæœ€å°æ˜¯1ms(åŠä¸ªå‘¨æœŸ)ï¼Œé‚£ä¹ˆ1ä¸ªå‘¨æœŸæ˜¯2msï¼Œèƒ½è¾¾åˆ°çš„èœ‚é¸£å™¨æœ€å¤§é¢‘ç‡æ˜¯1/2*0.1^3=500Hzï¼Œèœ‚é¸£å™¨æ ‡å‡†æç¤ºéŸ³æ˜¯1000Hz</span>
	<span class="token comment">//æ ¹æ®f=1/Tï¼ŒDelay(æ¨¡å—ï¼Œä¸å»ºè®®ä¿®æ”¹)çš„åº”è¯¥è¦æ›´å°ï¼Œä½†æ˜¯1å·²ç»æ˜¯æœ€å°çš„</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>ms<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//ç”¨forå¾ªç¯æ˜¯ä¸ºäº†è®©èœ‚é¸£å™¨å“çš„ä¹…ä¸€ç‚¹</span>
        <span class="token comment">//*2çš„åŸå› ï¼šç°åœ¨çš„msä»£è¡¨500usï¼Œä¸ä¹˜äºŒï¼Œå®ƒåªå“ms/2æ¯«ç§’ï¼Œä¹˜ä»¥äºŒæ‰æ˜¯å“msæ¯«ç§’</span>
	<span class="token punctuation">{</span>
		Buzzer<span class="token operator">=</span><span class="token operator">!</span>Buzzer<span class="token punctuation">;</span><span class="token comment">//å‘å£°éœ€è¦ç¿»è½¬ä¸¤æ¬¡ioå£</span>
		<span class="token function">Buzzer_Delay500us</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åŠä¸ªå‘¨æœŸ500usï¼Œä¸€ä¸ªå‘¨æœŸ1000usï¼Œé¢‘ç‡1000Hz=1/1000*0.1^6</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>	<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="Buzzer-h"><a href="#Buzzer-h" class="headerlink" title="Buzzer.h"></a>Buzzer.h</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">__Buzzer_H__</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">__Buzzer_H__</span></span>

sbit Buzzer<span class="token operator">=</span>P2<span class="token operator">^</span><span class="token number">5</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">Buzzer_Time</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> ms<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="éŸ³ä¹"><a href="#éŸ³ä¹" class="headerlink" title="éŸ³ä¹"></a>éŸ³ä¹</h2><p>éŸ³ç¬¦â€“&gt;é¢‘ç‡(Hz)â€“&gt;å‘¨æœŸ(us)â€“&gt;å‘¨æœŸ/2(us)â€“&gt;å–æ•´â€“&gt;<strong>é‡è£…æ•°å€¼(ç”¨åˆ°å®šæ—¶å™¨)</strong></p>
<p><strong>å‘¨æœŸ</strong>=1/é¢‘ç‡</p>
<p><strong>å‘¨æœŸ/2</strong>ï¼šåŠä¸ªå‘¨æœŸç¿»è½¬ä¸€æ¬¡</p>
<p>å‘¨æœŸ/2-å°æ•°ç‚¹=<strong>å–æ•´</strong></p>
<p>65535-å–æ•´=<strong>é‡è£…æ•°å€¼</strong></p>
<h4 id="ç”¨å®šæ—¶å™¨æ“æ§é¢‘ç‡"><a href="#ç”¨å®šæ—¶å™¨æ“æ§é¢‘ç‡" class="headerlink" title="ç”¨å®šæ—¶å™¨æ“æ§é¢‘ç‡"></a>ç”¨å®šæ—¶å™¨æ“æ§é¢‘ç‡</h4><h4 id="main-c-1"><a href="#main-c-1" class="headerlink" title="main.c"></a>main.c</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Delay.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Time0.h"</span></span>

sbit Buzzer<span class="token operator">=</span>P2<span class="token operator">^</span><span class="token number">5</span><span class="token punctuation">;</span>

<span class="token keyword">unsigned</span> <span class="token keyword">int</span> FreqTable<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">63628</span><span class="token punctuation">,</span><span class="token number">63731</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//å­˜æ”¾æ¯ä¸ªéŸ³çš„é‡è½½æ•°å€¼</span>

<span class="token keyword">unsigned</span> <span class="token keyword">char</span> FreqSelect<span class="token punctuation">;</span><span class="token comment">//å¯¹äºæ•°ç»„FreqTableä¸­æ¯ä¸ªæ•°æ®å¯¹åº”çš„Index</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">Timer0Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		FreqSelect<span class="token operator">++</span><span class="token punctuation">;</span>
		<span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åœ¨ä¸­æ–­é‡Œæ¯ä¸ª500msè‡ªåŠ¨åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªéŸ³</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">Timer0_Routine</span><span class="token punctuation">(</span><span class="token punctuation">)</span> interrupt <span class="token number">1</span><span class="token comment">//å®šæ—¶å™¨åˆå§‹åŒ–æ¯éš”1msè¿›è¡Œä¸€æ¬¡ï¼Œæ‰€ä»¥æ¯éš”1msä¸­æ–­ä¸€æ¬¡</span>
<span class="token punctuation">{</span>
	TL0 <span class="token operator">=</span> FreqTable<span class="token punctuation">[</span>FreqSelect<span class="token punctuation">]</span><span class="token operator">%</span><span class="token number">256</span><span class="token punctuation">;</span>		<span class="token comment">//è®¾ç½®å®šæ—¶åˆå€¼</span>
	TH0 <span class="token operator">=</span> FreqTable<span class="token punctuation">[</span>FreqSelect<span class="token punctuation">]</span><span class="token operator">/</span><span class="token number">256</span><span class="token punctuation">;</span>		<span class="token comment">//è®¾ç½®å®šæ—¶åˆå€¼</span>
	<span class="token comment">//è·Ÿå­å‡½æ•°é‡Œçš„è®¾ç½®ä¸åŒåœ¨äºï¼Œä¹‹åçš„æº¢å‡ºéƒ½æ˜¯è¿™é‡Œç®¡ç†çš„ï¼Œå­å‡½æ•°é‚£åªç®¡ç†ä¸€æ¬¡</span>
	Buzzer<span class="token operator">=</span><span class="token operator">!</span>Buzzer<span class="token punctuation">;</span> <span class="token comment">//ç›´æ¥ç¿»è½¬ï¼Œä¸€ä¸ªå‘¨æœŸæ˜¯2*1ms(ç¿»è½¬ä¸¤æ¬¡æ‰æ˜¯ä¸€ä¸ªå‘¨æœŸ)ï¼Œé¢‘ç‡=1/2*1*0.1^3=500Hz</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="Timer0-c"><a href="#Timer0-c" class="headerlink" title="Timer0.c"></a>Timer0.c</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;REGX52.H&gt;</span></span>

<span class="token comment">/**
  * @brief  å®šæ—¶å™¨0åˆå§‹åŒ–ï¼Œ1ms@11.0592MH
  * @param  æ— 
  * @retval æ— 
  */</span>
<span class="token keyword">void</span> <span class="token function">Timer0Init</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>		<span class="token comment">//1æ¯«ç§’@11.0592MHz</span>
<span class="token punctuation">{</span>
	TMOD <span class="token operator">&amp;=</span> <span class="token number">0xF0</span><span class="token punctuation">;</span>		<span class="token comment">//è®¾ç½®å®šæ—¶å™¨æ¨¡å¼</span>
	TMOD <span class="token operator">|=</span> <span class="token number">0x01</span><span class="token punctuation">;</span>
	TL0 <span class="token operator">=</span> <span class="token number">0x66</span><span class="token punctuation">;</span>		<span class="token comment">//è®¾ç½®å®šæ—¶åˆå€¼</span>
	TH0 <span class="token operator">=</span> <span class="token number">0xFC</span><span class="token punctuation">;</span>		<span class="token comment">//è®¾ç½®å®šæ—¶åˆå€¼</span>
	<span class="token comment">//TH0å’ŒTL0æ— å…³ç´§è¦ï¼Œä»–ä»¬åªå†³å®šç¬¬ä¸€æ¬¡ä¸­æ–­æ—¶é—´ï¼Œå› ä¸ºæº¢å‡ºä¹‹åä»–ä»¬ä¸æ¸…é›¶ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥ä¸æ”¹ï¼Œåªæ”¹ä¸»å‡½æ•°é‡Œçš„</span>
	TF0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>		<span class="token comment">//æ¸…é™¤TF0æ ‡å¿—</span>
	TR0 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>		<span class="token comment">//å®šæ—¶å™¨0å¼€å§‹è®¡æ—¶</span>
	ET0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>          <span class="token comment">//å…è®¸ä¸­æ–­</span>
	EA<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	PT0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
å®šæ—¶å™¨ä¸­æ–­å‡½æ•°æ¨¡æ¿
void Timer0_Routine() interrupt 1
{
	static unsigned int T0Count;//ä¸ºäº†ä¸ä¸¢å¤±è¿™ä¸ªæ•°å­—
	TL0 = 0x66;		//è®¾ç½®å®šæ—¶åˆå€¼
	TH0 = 0xFC;		//è®¾ç½®å®šæ—¶åˆå€¼
	T0Count++;
	if(T0Count&gt;=1000)
	{
		T0Count=0;
	}
}
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

]]></content>
      <categories>
        <category>51å•ç‰‡æœº</category>
      </categories>
      <tags>
        <tag>51å•ç‰‡æœº</tag>
        <tag>å¤§äº‘å±‹è€ƒæ ¸</tag>
      </tags>
  </entry>
  <entry>
    <title>ç±»å’Œå‘½åç©ºé—´</title>
    <url>/2023/01/10/lei-he-ming-ming-kong-jian/</url>
    <content><![CDATA[<h2 id="ä¸€-ç±»"><a href="#ä¸€-ç±»" class="headerlink" title="ä¸€.ç±»"></a>ä¸€.ç±»</h2><p>æ˜¯å¯¹<code>ç°å®ä¸–ç•Œäº‹ç‰©</code>è¿›è¡Œ<strong>æŠ½è±¡</strong>æ‰€å¾—åˆ°çš„ç»“æœ</p>
<h4 id="1-ç±»å’Œå¯¹è±¡çš„å…³ç³»ğŸ‘‡"><a href="#1-ç±»å’Œå¯¹è±¡çš„å…³ç³»ğŸ‘‡" class="headerlink" title="1.ç±»å’Œå¯¹è±¡çš„å…³ç³»ğŸ‘‡"></a>1.ç±»å’Œå¯¹è±¡çš„å…³ç³»ğŸ‘‡</h4><ul>
<li><p><code>å¯¹è±¡</code>ä¹Ÿå«<code>å®ä¾‹</code>ï¼Œæ˜¯<code>ç±»</code>ç»è¿‡â€œå®ä¾‹åŒ–â€åå¾—åˆ°çš„å†…å­˜ä¸­æ˜¯å®ä½“</p>
<ul>
<li>e.g. â€œé£æœºâ€å’Œâ€œä¸€æ¶é£æœºâ€ï¼Œå‰è€…æ˜¯æ¦‚å¿µï¼Œåè€…æ˜¯å®ä½“</li>
<li>e.g. è“å›¾å’Œå»ºç­‘</li>
</ul>
</li>
<li><p><code>å®ä¾‹åŒ–</code>ï¼Œä½¿ç”¨<code>new</code>æ“ä½œç¬¦åˆ›å»ºç±»çš„å®ä¾‹</p>
<ul>
<li><pre><code class="c#">new + ç±»å();//å®ä¾‹åŒ–æ ¼å¼
<pre class="line-numbers language-none"><code class="language-none">
* ```c#
  (new Form()).ShowDialog();//å®ä¾‹åŒ–ä¾‹å­<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</code></pre>
</li>
</ul>
</li>
<li><p>å¼•ç”¨å˜é‡ä¸å®ä¾‹çš„å…³ç³»</p>
<ul>
<li><pre><code class="c#">
</code></pre>
</li>
</ul>
<p>  Form myForm;				//å¼•ç”¨å˜é‡	å°æœ‹å‹<br>  myForm = new Form();		//å®ä¾‹åŒ–	 =å°æœ‹å‹ç‰µç€æ°”çƒ<br>  myForm.Text = â€œMy Form!â€;	//æ ‡é¢˜æ–‡æœ¬<br>  myForm.ShowDialog();		//æ˜¾ç¤ºè¡¨å•</p>
<pre><code>
* å¼•ç”¨å˜é‡ä¸å®ä¾‹çš„å…³ç³»å¯ä»¥è§†ä½œå°æœ‹å‹å’Œæ°”çƒçš„å…³ç³»
</code></pre>
</li>
</ul>
<h4 id="2-ç±»çš„ä¸‰å¤§æˆå‘˜"><a href="#2-ç±»çš„ä¸‰å¤§æˆå‘˜" class="headerlink" title="2.ç±»çš„ä¸‰å¤§æˆå‘˜"></a>2.ç±»çš„ä¸‰å¤§æˆå‘˜</h4><ul>
<li><strong>å±æ€§Property</strong><ul>
<li>å­˜å‚¨æ•°æ®ï¼Œç»„åˆèµ·æ¥è¡¨ç¤ºç±»æˆ–å¯¹è±¡å½“å‰çš„çŠ¶æ€</li>
<li>e.g. èº«é«˜å¾ˆé«˜ï¼Œè´¢å¯Œå……è£•ï¼Œé•¿ç›¸ä¸é”™ï¼Œç»„åˆä¸ºé«˜å¯Œå¸…</li>
</ul>
</li>
<li><strong>æ–¹æ³•Method</strong><ul>
<li>è¡¨ç¤ºç±»æˆ–å¯¹è±¡â€œèƒ½åšä»€ä¹ˆâ€</li>
</ul>
</li>
<li><strong>äº‹ä»¶Event</strong></li>
</ul>
<h3 id="3-é™æ€æˆå‘˜ä¸å®ä¾‹æˆå‘˜"><a href="#3-é™æ€æˆå‘˜ä¸å®ä¾‹æˆå‘˜" class="headerlink" title="3.é™æ€æˆå‘˜ä¸å®ä¾‹æˆå‘˜"></a>3.é™æ€æˆå‘˜ä¸å®ä¾‹æˆå‘˜</h3><ul>
<li><strong>é™æ€Static</strong>æˆå‘˜è¡¨ç¤ºå®ƒæ˜¯<code>ç±»çš„æˆå‘˜</code></li>
<li><strong>å®ä¾‹</strong>æˆå‘˜è¡¨ç¤ºå®ƒæ˜¯<code>å¯¹è±¡çš„æˆå‘˜</code></li>
<li><strong>ç»‘å®šBing</strong>æŒ‡çš„æ˜¯ç¼–è¯‘å™¨å¦‚ä½•æŠŠä¸€ä¸ªæˆå‘˜ä¸ç±»æˆ–å¯¹è±¡å…³è”èµ·æ¥<ul>
<li>**.**æˆå‘˜è®¿é—®æ“ä½œç¬¦</li>
</ul>
</li>
</ul>
<h2 id="äºŒ-åç§°ç©ºé—´"><a href="#äºŒ-åç§°ç©ºé—´" class="headerlink" title="äºŒ.åç§°ç©ºé—´"></a>äºŒ.åç§°ç©ºé—´</h2><p>æŠŠç±»ç”¨è‰¯å¥½çš„ç»“æ„ç»„åˆåœ¨ä¸€èµ·ï¼Œä»¥æ ‘å½¢ç»“æ„ç»„ç»‡ç±»</p>
<p><strong>åŒ…ï¼šæŸå¸‚	â†’	ç±»åº“ï¼šå›¾ä¹¦é¦†	â†’	åç§°ç©ºé—´ï¼šä¹¦æ¶	â†’	ç±»ï¼šä¹¦	â†’	æ–¹æ³•ï¼šç›®å½•</strong></p>
<h2 id="ä¸‰-ç±»åº“"><a href="#ä¸‰-ç±»åº“" class="headerlink" title="ä¸‰.ç±»åº“"></a>ä¸‰.ç±»åº“</h2><p>ç±»åº“çš„å¼•ç”¨</p>
<ul>
<li><p>DLLå¼•ç”¨(æ— æºä»£ç ï¼Œé»‘ç›’ç±»åº“)</p>
<ul>
<li><p>åœ¨<strong>è§£å†³æ–¹æ¡ˆ</strong>ä¸­çš„<strong>ä¾èµ–é¡¹</strong>å³é”®<strong>æ·»åŠ é¡¹ç›®å¼•ç”¨</strong>ä¸­å¯ä»¥æ·»åŠ ä»¥<code>dll</code>ä¸ºåç¼€çš„æ–‡ä»¶ä½œä¸ºç±»åº“å¼•ç”¨</p>
</li>
<li><p>NuGet</p>
<ul>
<li>åªæœ‰DLLæ²¡æœ‰æºä»£ç å¾ˆå±é™©ï¼Œæ¯”å¦‚å¼•ç”¨äº†ä¸€ä¸ª<code>ç±»åº“</code>ï¼Œä½†æ˜¯è¿™ä¸ª<code>ç±»åº“</code>ä¸­ä¸€äº›ä»£ç è¿˜æœ‰ä¸€äº›<code>åº•å±‚çš„ä¸œè¥¿</code>æ²¡æœ‰å¼•ç”¨è¿›æ¥å¯¼è‡´æŠ¥é”™</li>
</ul>
</li>
</ul>
</li>
<li><p>é¡¹ç›®å¼•ç”¨(æœ‰æºä»£ç ï¼Œç™½ç›’ç±»åº“)</p>
<ul>
<li>åŒä¸Šï¼Œä½†æ˜¯æ˜¯åœ¨<code>ç¨‹åºé›†ä¸­</code></li>
</ul>
</li>
</ul>
<p><img src="/../../../../medias/blog_picture/C#/1.png"></p>
]]></content>
      <categories>
        <category>C#</category>
      </categories>
      <tags>
        <tag>é—²ç€æ²¡äº‹å¹²</tag>
        <tag>C#</tag>
      </tags>
  </entry>
  <entry>
    <title>é˜Ÿåˆ—</title>
    <url>/2022/11/22/dui-lie/</url>
    <content><![CDATA[<h1 id="ä¸€-æ¦‚å¿µ"><a href="#ä¸€-æ¦‚å¿µ" class="headerlink" title="ä¸€.æ¦‚å¿µ"></a>ä¸€.æ¦‚å¿µ</h1><h2 id="1-å‰front-årear"><a href="#1-å‰front-årear" class="headerlink" title="1.å‰front årear"></a>1.å‰front årear</h2><ul>
<li><p>å‡ºé˜Ÿï¼Œä»å¤´å‡º</p>
</li>
<li><p>å…¥é˜Ÿï¼Œä»å°¾å…¥</p>
</li>
</ul>
<h2 id="2-åˆ†ç±»"><a href="#2-åˆ†ç±»" class="headerlink" title="2.åˆ†ç±»"></a>2.åˆ†ç±»</h2><p>é“¾å¼é˜Ÿåˆ—ï¼Œé™æ€é˜Ÿåˆ—ï¼Œå¾ªç¯é˜Ÿåˆ—</p>
<ul>
<li>é“¾å¼é˜Ÿåˆ—â€“ç”¨é“¾è¡¨å®ç°</li>
<li>é™æ€é˜Ÿåˆ—â€“ç”¨æ•°ç»„å®ç°ï¼Œé€šå¸¸éƒ½å¿…é¡»æ˜¯å¾ªç¯é˜Ÿåˆ—</li>
</ul>
<h2 id="3-é—®é¢˜"><a href="#3-é—®é¢˜" class="headerlink" title="3.é—®é¢˜"></a>3.é—®é¢˜</h2><h3 id="â‘ é™æ€é˜Ÿåˆ—ä¸ºä»€ä¹ˆå¿…é¡»æ˜¯å¾ªç¯é˜Ÿåˆ—"><a href="#â‘ é™æ€é˜Ÿåˆ—ä¸ºä»€ä¹ˆå¿…é¡»æ˜¯å¾ªç¯é˜Ÿåˆ—" class="headerlink" title="â‘ é™æ€é˜Ÿåˆ—ä¸ºä»€ä¹ˆå¿…é¡»æ˜¯å¾ªç¯é˜Ÿåˆ—"></a>â‘ é™æ€é˜Ÿåˆ—ä¸ºä»€ä¹ˆ<strong>å¿…é¡»æ˜¯å¾ªç¯é˜Ÿåˆ—</strong></h3><p>râ†’							râ†’		</p>
<p>â€‹		d								d</p>
<p>â€‹		c						fâ†’	c</p>
<p>â€‹		b		==&gt;			  	b</p>
<p>fâ†’   a							 	a</p>
<p>ğŸ‘†aå’Œbå‡ºé˜Ÿä¹‹åï¼Œå¯¹äºæ•°ç»„aæ¥è¯´ï¼Œa[0]ã€a[1]è¿™ä¸¤ä¸ªç©ºé—´å°±è¢«æµªè´¹äº†ï¼Œå› ä¸ºfå’Œrä¸€ç›´åœ¨å¾€ä¸Šç§»åŠ¨ï¼Œæ‰€ä»¥ç›¸å½“äºa[0]ã€a[1]ä¸èƒ½å†ä½¿ç”¨äº†ã€‚ç”¨ä¼ ç»Ÿæ•°ç»„æ¥å®ç°é˜Ÿåˆ—ï¼Œæ— è®ºæ˜¯å…¥é˜Ÿè¿˜æ˜¯å‡ºé˜Ÿï¼Œå‚æ•°éƒ½åªèƒ½å¢ä¸èƒ½å‡</p>
<h3 id="â‘¡å¾ªç¯é˜Ÿåˆ—éœ€è¦å‡ ä¸ªå‚æ•°åŠå„ä¸ªå‚æ•°çš„å«ä¹‰"><a href="#â‘¡å¾ªç¯é˜Ÿåˆ—éœ€è¦å‡ ä¸ªå‚æ•°åŠå„ä¸ªå‚æ•°çš„å«ä¹‰" class="headerlink" title="â‘¡å¾ªç¯é˜Ÿåˆ—éœ€è¦å‡ ä¸ªå‚æ•°åŠå„ä¸ªå‚æ•°çš„å«ä¹‰"></a>â‘¡å¾ªç¯é˜Ÿåˆ—éœ€è¦<strong>å‡ ä¸ªå‚æ•°</strong>åŠå„ä¸ª<strong>å‚æ•°çš„å«ä¹‰</strong></h3><ul>
<li><p>éœ€è¦<strong>2ä¸ª</strong>å‚æ•°æ¥ç¡®å®š <strong>front</strong> <strong>rear</strong></p>
</li>
<li><p>2ä¸ªå‚æ•°åœ¨ä¸åŒåœºåˆæœ‰<strong>ä¸åŒçš„çš„å®šä¹‰</strong></p>
<ul>
<li><p>åœºåˆï¼š</p>
<blockquote>
<p> 1ï¼‰é˜Ÿåˆ—åˆå§‹åŒ–</p>
<p>â€‹		frontå’Œrearçš„å€¼éƒ½æ˜¯<strong>é›¶</strong></p>
<p>2ï¼‰é˜Ÿåˆ—éç©º</p>
<p>â€‹		frontä»£è¡¨çš„æ˜¯é˜Ÿåˆ—çš„<strong>ç¬¬ä¸€ä¸ªå…ƒç´ </strong></p>
<p>â€‹		rearä»£è¡¨çš„æ˜¯é˜Ÿåˆ—çš„<strong>æœ€åä¸€ä¸ªæœ‰æ•ˆå…ƒç´ çš„ä¸‹ä¸€ä¸ª</strong></p>
<p>3ï¼‰é˜Ÿåˆ—ç©º</p>
<p>â€‹		frontå’Œrearçš„<strong>å€¼ç›¸ç­‰</strong>ï¼Œä½†ä¸ä¸€å®šæ˜¯é›¶</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h3 id="â‘¢å¾ªç¯é˜Ÿåˆ—å‡ºã€å…¥é˜Ÿä¼ªç®—æ³•è®²è§£"><a href="#â‘¢å¾ªç¯é˜Ÿåˆ—å‡ºã€å…¥é˜Ÿä¼ªç®—æ³•è®²è§£" class="headerlink" title="â‘¢å¾ªç¯é˜Ÿåˆ—å‡ºã€å…¥é˜Ÿä¼ªç®—æ³•è®²è§£"></a>â‘¢å¾ªç¯é˜Ÿåˆ—<strong>å‡ºã€å…¥é˜Ÿä¼ªç®—æ³•</strong>è®²è§£</h3><h4 id="1-å…¥é˜Ÿ"><a href="#1-å…¥é˜Ÿ" class="headerlink" title="1.å…¥é˜Ÿ"></a>1.å…¥é˜Ÿ</h4><ul>
<li><p>å°†å€¼å­˜å…¥ræ‰€ä»£è¡¨çš„ä½ç½®</p>
</li>
<li><p>r=(r+1)%æ•°ç»„çš„é•¿åº¦</p>
</li>
</ul>
<h4 id="2-å‡ºé˜Ÿ"><a href="#2-å‡ºé˜Ÿ" class="headerlink" title="2.å‡ºé˜Ÿ"></a>2.å‡ºé˜Ÿ</h4><ul>
<li>f=(f+1)%æ•°ç»„çš„é•¿åº¦</li>
</ul>
<h3 id="â‘£å¦‚ä½•åˆ¤æ–­å¾ªç¯é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºã€å·²æ»¡"><a href="#â‘£å¦‚ä½•åˆ¤æ–­å¾ªç¯é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºã€å·²æ»¡" class="headerlink" title="â‘£å¦‚ä½•åˆ¤æ–­å¾ªç¯é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºã€å·²æ»¡"></a>â‘£å¦‚ä½•åˆ¤æ–­å¾ªç¯é˜Ÿåˆ—æ˜¯å¦ä¸º<strong>ç©ºã€å·²æ»¡</strong></h3><h4 id="1-ç©º"><a href="#1-ç©º" class="headerlink" title="1.ç©º"></a>1.ç©º</h4><ul>
<li>f=r</li>
</ul>
<h4 id="2-æ»¡"><a href="#2-æ»¡" class="headerlink" title="2.æ»¡"></a>2.æ»¡</h4><ul>
<li><p>â… å¤šå¢åŠ ä¸€ä¸ªæ ‡è¯†å‚æ•°(é€šå¸¸ä¸ç”¨è¿™ä¸ª)</p>
</li>
<li><p>â…¡å°‘ç”¨ä¸€ä¸ªå…ƒç´ ã€‚æœ¬æ¥å¯ä»¥æ”¾nä¸ªå…ƒç´ ï¼Œ<strong>å®šä¹‰n-1ä¸ªæ˜¯æ»¡çš„</strong>(é€šå¸¸ä½¿ç”¨è¿™ç§æ–¹å¼)</p>
<ul>
<li><p>å¦‚ä½•åˆ¤æ–­é˜Ÿåˆ—å·²æ»¡ï¼šrå’Œfçš„å€¼ç´§æŒ¨ç€ï¼Œåˆ™é˜Ÿåˆ—å·²æ»¡</p>
</li>
<li><pre><code class="c">if((r+1)%æ•°ç»„çš„é•¿åº¦==f)
    //å·²æ»¡
else
    //ä¸æ»¡
<pre class="line-numbers language-none"><code class="language-none">

# äºŒ.ä»£ç 

```c
#include&lt;stdio.h&gt;
#include&lt;stdbool.h&gt;
#include&lt;malloc.h&gt;
#include&lt;stdlib.h&gt;

typedef struct Queue{
	int *pBase;
	int front;
	int rear;
}QUEUE,*PQUEUE;

void init(PQUEUE);			//åˆå§‹åŒ– 
bool fullQueue(PQUEUE);		//åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦æ»¡ 
bool enQueue(PQUEUE,int);	//å…¥é˜Ÿ 
bool emptyQueue(PQUEUE);	//åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º
void traverse(PQUEUE);		//éå†
bool outQueue(PQUEUE,int*);	//å‡ºé˜Ÿ 

int main()
{
	//int val;
	int *pVal=(int*)malloc(sizeof(int)*4);
	 
	
	QUEUE Q;
	init(&amp;Q);
	enQueue(&amp;Q,1);
	enQueue(&amp;Q,2);
	enQueue(&amp;Q,3);
	enQueue(&amp;Q,4);
	enQueue(&amp;Q,5);
	enQueue(&amp;Q,6);
	enQueue(&amp;Q,7);
	
	traverse(&amp;Q);
	
	if(outQueue(&amp;Q,pVal))
		printf("å‡ºé˜Ÿçš„æ•°å­—æ˜¯:%d\n",*pVal);
	//if (outQueue(&amp;Q,&amp;val))
		//printf("å‡ºé˜Ÿçš„æ•°å­—æ˜¯%d\n",val);
	else
		printf("å‡ºé˜Ÿå¤±è´¥ï¼\n"); 
	
	traverse(&amp;Q);
	free(pVal);
	pVal=NULL;
	
	return 0;
}

void init(PQUEUE pQ)
{
	pQ-&gt;pBase=(int*)malloc(sizeof(int)*6);
	pQ-&gt;front=0;
	pQ-&gt;rear=0;
}

bool fullQueue(PQUEUE pQ)
{
	if((pQ-&gt;rear+1)%6==pQ-&gt;front)
		return true;
	else
		return false;
}

bool enQueue(PQUEUE pQ,int val)
{
	if(fullQueue(pQ))
		return false;
	else
	{
		pQ-&gt;pBase[pQ-&gt;rear]=val;
		pQ-&gt;rear=(pQ-&gt;rear+1)%6;
	}
}

bool emptyQueue(PQUEUE pQ)
{
	if(pQ-&gt;rear==pQ-&gt;front)
		return true;
	else
		return false;
}

void traverse(PQUEUE pQ)
{
	if(emptyQueue(pQ))
	{
		printf("é˜Ÿåˆ—ä¸ºç©º\n");
		exit(-1);
	}
	else
	{
		int i=pQ-&gt;front;
		while(pQ-&gt;rear!=i)
		{
			printf("%d",pQ-&gt;pBase[i]); 
			i=(i+1)%6;
		}
		printf("\n");
	}
	return;
}

bool outQueue(PQUEUE pQ,int *pVal)
{
	if(emptyQueue(pQ))
		return false;
	else
	{
		*pVal=pQ-&gt;pBase[pQ-&gt;front];
		pQ-&gt;front=(pQ-&gt;front+1)%6;
		return true;
	}
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</code></pre>
</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>Cè¯­è¨€</category>
      </categories>
      <tags>
        <tag>Cè¯­è¨€</tag>
        <tag>é˜Ÿåˆ—</tag>
      </tags>
  </entry>
  <entry>
    <title>é“¾è¡¨</title>
    <url>/2022/11/18/lian-biao/</url>
    <content><![CDATA[<h1 id="ä¸€-typedef"><a href="#ä¸€-typedef" class="headerlink" title="ä¸€.typedef"></a>ä¸€.typedef</h1><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Student</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> sid<span class="token punctuation">;</span>
    <span class="token keyword">int</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>ST<span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">Student</span> student<span class="token punctuation">;</span><span class="token comment">//&lt;==&gt;ST student;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Student</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> sid<span class="token punctuation">;</span>
    <span class="token keyword">int</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token operator">*</span>PST<span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">Student</span> <span class="token operator">*</span>p<span class="token punctuation">;</span><span class="token comment">//&lt;==&gt;PST *p;</span>
<span class="token comment">//PST&lt;==&gt;struct Student *</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-C" data-language="C"><code class="language-C">typedef struct Student{
    int sid;
    int age;
}*PST,ST;
//æ•ˆæœæ˜¯ä¸Šé¢çš„æ•´åˆ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="äºŒ-é“¾è¡¨"><a href="#äºŒ-é“¾è¡¨" class="headerlink" title="äºŒ.é“¾è¡¨"></a>äºŒ.é“¾è¡¨</h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1.å®šä¹‰"></a>1.å®šä¹‰</h2><ul>
<li>nä¸ªèŠ‚ç‚¹ç¦»æ•£åˆ†é…</li>
<li>æ‰¹æ¬¡é€šè¿‡æŒ‡é’ˆç›¸è¿</li>
<li>æ¯éš”èŠ‚ç‚¹åªæœ‰ä¸€ä¸ªå‰é©±èŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹åªæœ‰ä¸€ä¸ªåç»­èŠ‚ç‚¹</li>
<li>é¦–èŠ‚ç‚¹æ²¡æœ‰å‰é©±èŠ‚ç‚¹ï¼Œå°¾èŠ‚ç‚¹æ²¡æœ‰åç»­èŠ‚ç‚¹</li>
<li>[ç¦»æ•£å­˜å‚¨]</li>
</ul>
<h2 id="2-ä¸“ä¸šæœ¯è¯­"><a href="#2-ä¸“ä¸šæœ¯è¯­" class="headerlink" title="2.ä¸“ä¸šæœ¯è¯­"></a>2.ä¸“ä¸šæœ¯è¯­</h2><ul>
<li>é¦–èŠ‚ç‚¹ï¼šç¬¬ä¸€ä¸ªæœ‰æ•ˆçš„èŠ‚ç‚¹</li>
<li>å°¾èŠ‚ç‚¹ï¼šæœ€åä¸€ä¸ªæœ‰æ•ˆèŠ‚ç‚¹</li>
<li>å¤´ç»“ç‚¹ï¼šç¬¬ä¸€ä¸ªæœ‰æ•ˆèŠ‚ç‚¹ä¹‹å‰çš„èŠ‚ç‚¹<ul>
<li>æ²¡æœ‰å­˜æ”¾æœ‰æ•ˆæ•°æ®</li>
</ul>
</li>
<li>å¤´æŒ‡é’ˆï¼šæŒ‡å‘å¤´èŠ‚ç‚¹çš„æŒ‡é’ˆå˜é‡</li>
<li>å°¾æŒ‡é’ˆï¼šæŒ‡å‘å°¾èŠ‚ç‚¹çš„æŒ‡é’ˆå˜é‡</li>
</ul>
<h2 id="3-ç¡®å®šä¸€ä¸ªé“¾è¡¨éœ€è¦çš„å‚æ•°"><a href="#3-ç¡®å®šä¸€ä¸ªé“¾è¡¨éœ€è¦çš„å‚æ•°" class="headerlink" title="3.ç¡®å®šä¸€ä¸ªé“¾è¡¨éœ€è¦çš„å‚æ•°"></a>3.ç¡®å®šä¸€ä¸ªé“¾è¡¨éœ€è¦çš„å‚æ•°</h2><p><strong>åªéœ€è¦ä¸€ä¸ªå¤´æŒ‡é’ˆ</strong></p>
<p>ğŸ‘‰ä¸ºä»€ä¹ˆä¸ç”¨å¤´ç»“ç‚¹</p>
<ul>
<li><p>å› ä¸ºå¤´ç»“ç‚¹çš„æ•°æ®ç±»å‹å’Œåé¢æœ‰æ•°æ®åŸŸçš„èŠ‚ç‚¹çš„æ•°æ®ç±»å‹æ˜¯ä¸€æ ·çš„(è™½ç„¶å¤´ç»“ç‚¹æ²¡æœ‰æ•°æ®åŸŸï¼Œä½†æ˜¯ä»–ä¼šæœ‰åƒåœ¾å€¼ï¼Œä¼šå å†…å­˜)</p>
</li>
<li><p>å¤´æŒ‡é’ˆåªå å››ä¸ªå­—èŠ‚æ¥å­˜æ”¾å¤´ç»“ç‚¹çš„åœ°å€</p>
</li>
</ul>
<h2 id="4-èŠ‚ç‚¹"><a href="#4-èŠ‚ç‚¹" class="headerlink" title="4.èŠ‚ç‚¹"></a>4.èŠ‚ç‚¹</h2><ul>
<li>éƒ½è¦æœ‰ä¸€ä¸ªæŒ‡é’ˆåŸŸå’Œæ•°æ®åŸŸ</li>
<li>ç»“æ„ä½“çš„æŸä¸€ä¸ªæˆå‘˜æŒ‡å‘çš„æ˜¯è·Ÿå®ƒä¸€æ‘¸ä¸€æ ·çš„æ•°æ®ç±»å‹çš„æ•°æ®</li>
<li>è¦ä¸ºåˆ›å»ºçš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ç”³è¯·ç©ºé—´</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">struct</span> <span class="token class-name">Node</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> data<span class="token punctuation">;</span><span class="token comment">//æ•°æ®åŸŸ</span>
    <span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token operator">*</span>pNext<span class="token punctuation">;</span><span class="token comment">//æŒ‡é’ˆåŸŸ</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="5-åˆ†ç±»"><a href="#5-åˆ†ç±»" class="headerlink" title="5.åˆ†ç±»"></a>5.åˆ†ç±»</h2><ul>
<li>å•é“¾è¡¨</li>
<li>åŒé“¾è¡¨ï¼šæ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸¤ä¸ªæŒ‡é’ˆåŸŸ</li>
<li>å¾ªç¯é“¾è¡¨ï¼šèƒ½é€šè¿‡ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹æ‰¾åˆ°å…¶ä»–èŠ‚ç‚¹</li>
<li>éå¾ªç¯é“¾è¡¨</li>
</ul>
<h1 id="ä¸‰-ä½œç”¨"><a href="#ä¸‰-ä½œç”¨" class="headerlink" title="ä¸‰.ä½œç”¨"></a>ä¸‰.ä½œç”¨</h1><h2 id="1-åˆ›å»º-åˆå§‹åŒ–"><a href="#1-åˆ›å»º-åˆå§‹åŒ–" class="headerlink" title="1.åˆ›å»º/åˆå§‹åŒ–"></a>1.åˆ›å»º/åˆå§‹åŒ–</h2><ul>
<li>éœ€è¦ç”¨åˆ°çš„å˜é‡ï¼šæœ€åˆåˆ›å»ºçš„é“¾è¡¨çš„é•¿åº¦<strong>len</strong>ã€æ¯ä¸ªç»“æ„ä½“æ•°æ®åŸŸçš„æ•°æ®<strong>val</strong>ã€å¤´èŠ‚ç‚¹<strong>pHead</strong>ã€å°¾èŠ‚ç‚¹<strong>pTail</strong></li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> len<span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token comment">//xxxxxxx</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-c" data-language="c"><code class="language-c">pNew<span class="token operator">-&gt;</span>data<span class="token operator">=</span>val<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>pTail=pHead<ul>
<li>å¯ä»¥ç†è§£ä¸ºç”¨å°¾æŒ‡é’ˆæ˜¯é’ˆçº¿ï¼ŒæŠŠåŸæœ‰é“¾è¡¨æœ€åä¸€ä¸ªèŠ‚ç‚¹å’Œæ–°åŠ å…¥çš„èŠ‚ç‚¹è¿æ¥èµ·æ¥</li>
</ul>
</li>
</ul>
<h2 id="2-æ’å…¥"><a href="#2-æ’å…¥" class="headerlink" title="2.æ’å…¥"></a>2.æ’å…¥</h2><ul>
<li><p>éœ€è¦ç”¨åˆ°çš„å‚æ•°ï¼šå¤´ç»“ç‚¹ï¼Œæ–°æ’å…¥çš„ç»“æ„ä½“çš„ä½ç½®ï¼Œæ–°æ’å…¥çš„ç»“æ„ä½“çš„æ•°æ®åŸŸä¸­çš„æ•°å€¼</p>
</li>
<li><p>éœ€è¦è€ƒè™‘çš„é—®é¢˜ï¼šè¦æ€ä¹ˆé€šè¿‡è¾“å…¥çš„<strong>pos</strong>æ‰¾åˆ°è¦<strong>æŒ‡å‘æ–°æ’å…¥ç»“æ„ä½“ä½ç½®çš„ç»“æ„ä½“æŒ‡é’ˆ</strong></p>
</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">PNODE p<span class="token operator">=</span>pHead<span class="token punctuation">;</span>
<span class="token keyword">while</span><span class="token punctuation">(</span>p<span class="token operator">!=</span><span class="token constant">NULL</span> <span class="token operator">&amp;&amp;</span> i<span class="token operator">&lt;</span>pos<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>	<span class="token comment">//i&lt;p-1å°±æ˜¯è®©pæŒ‡å‘è¦æ’å…¥ä½ç½®çš„ä¸Šä¸€ä¸ªç»“æ„ä½“ </span>
	<span class="token punctuation">{</span>
		p<span class="token operator">=</span>p<span class="token operator">-&gt;</span>pNext<span class="token punctuation">;</span>
		i<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token comment">/*
æ¡ä»¶â‘ ï¼šç¡®ä¿æ˜¯åœ¨ä¸€ä¸ªä¸æ˜¯ç©ºçš„ç»“æ„ä½“åæ’å…¥çš„
æ¡ä»¶â‘¡ï¼špè¦æŒ‡å‘å³å°†è¦æ’å…¥çš„ä½ç½®çš„å‰ä¸€ä¸ªç»“æ„ä½“
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬è¦é€šè¿‡éå†çš„æ–¹å¼æ‰¾åˆ°ç›®æ ‡ç»“æ„ä½“ï¼Œå‡è®¾æˆ‘ä»¬è¦æ’å…¥åˆ°pos=3</p>
<ul>
<li><strong>i&lt;pos=1</strong>è¿™é‡Œ i=0æ—¶ p=ç¬¬ä¸€ä¸ªæœ‰æ•ˆç»“æ„ä½“</li>
<li>i=1æ—¶ï¼Œp=ç¬¬äºŒä¸ªæœ‰æ•ˆç»“æ„ä½“</li>
<li>i=2ä¸ç¬¦åˆå¾ªç¯æ¡ä»¶</li>
<li>æ‰€ä»¥whileç»“æŸåï¼Œpå°±æ˜¯ç¬¬äºŒä¸ªæœ‰æ•ˆç»“æ„ä½“çš„æŒ‡é’ˆå˜é‡</li>
</ul>
<h2 id="3-åˆ é™¤"><a href="#3-åˆ é™¤" class="headerlink" title="3.åˆ é™¤"></a>3.åˆ é™¤</h2><ul>
<li><p>åˆ é™¤æ˜¯é€šè¿‡ä¿®æ”¹å‰ä¸€ä¸ªç»“æ„ä½“æŒ‡é’ˆçš„æŒ‡å‘æ¥åˆ é™¤çš„</p>
</li>
<li><p>æ‰€ä»¥åˆ é™¤çš„ä½ç½®çš„å‰ä¸€ä¸ªæŒ‡é’ˆçš„æŒ‡å‘ä¸èƒ½æ˜¯NULL</p>
</li>
<li><p>å¦‚æœè¦åˆ é™¤çš„å¯¹è±¡çš„ä¸‹ä¸€ä¸ªå·²ç»æ˜¯NULLäº†ï¼Œé‚£ä¹ˆå°±ä¸ä¼šç»§ç»­éå†ä¸‹å» </p>
</li>
<li><p><strong>vsæ’å…¥</strong>ï¼Œå¦‚æœè¦æ’å…¥çš„ä½ç½®æ˜¯æœ€åä¸€ä¸ªï¼Œå³p-&gt;</p>
</li>
</ul>
<h1 id="å››-å…¨éƒ¨ä»£ç "><a href="#å››-å…¨éƒ¨ä»£ç " class="headerlink" title="å››.å…¨éƒ¨ä»£ç "></a>å››.å…¨éƒ¨ä»£ç </h1><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;malloc.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdbool.h&gt;</span></span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Node</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> data<span class="token punctuation">;</span>
	<span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token operator">*</span>pNext<span class="token punctuation">;</span>
<span class="token punctuation">}</span>NODE<span class="token punctuation">,</span><span class="token operator">*</span>PNODE<span class="token punctuation">;</span>

<span class="token comment">//å‡½æ•°å£°æ˜</span>
PNODE <span class="token function">creatList</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">traverseList</span><span class="token punctuation">(</span>PNODE pHead<span class="token punctuation">)</span><span class="token punctuation">;</span>
bool <span class="token function">isEmpty</span><span class="token punctuation">(</span>PNODE pHead<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">lengthList</span><span class="token punctuation">(</span>PNODE pHead<span class="token punctuation">)</span><span class="token punctuation">;</span>
bool <span class="token function">insertList</span><span class="token punctuation">(</span>PNODE pHead<span class="token punctuation">,</span><span class="token keyword">int</span> pos<span class="token punctuation">,</span><span class="token keyword">int</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
bool <span class="token function">deleteList</span><span class="token punctuation">(</span>PNODE pHead<span class="token punctuation">,</span><span class="token keyword">int</span> pos<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">*</span>pVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">sortList</span><span class="token punctuation">(</span>PNODE pHead<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">lengthList</span><span class="token punctuation">(</span>PNODE pHead<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> val<span class="token punctuation">;</span>
	PNODE pHead<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
	
	pHead<span class="token operator">=</span><span class="token function">creatList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token comment">//traverseList(pHead);</span>
<span class="token comment">/*	
	if(isEmpty(pHead))
		printf("é“¾è¡¨ä¸ºç©ºï¼\n");
	else
		printf("é“¾è¡¨ä¸ç©ºï¼\n");
	return 0;
*/</span>
<span class="token comment">/*
	int len=lengthList(pHead);	
	printf("é•¿é“¾è¡¨çš„é•¿åº¦æ˜¯%d",len);	
*/</span>
	
	<span class="token comment">//sortList(pHead);</span>
	<span class="token comment">//traverseList(pHead);</span>
	
	<span class="token comment">//insertList(pHead,4,23);</span>
	<span class="token comment">//traverseList(pHead);</span>
	
	<span class="token function">deleteList</span><span class="token punctuation">(</span>pHead<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">traverseList</span><span class="token punctuation">(</span>pHead<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

PNODE <span class="token function">creatList</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> len<span class="token punctuation">;</span>
	<span class="token keyword">int</span> i<span class="token punctuation">;</span>
	<span class="token keyword">int</span> val<span class="token punctuation">;</span>

	PNODE pHead<span class="token operator">=</span><span class="token punctuation">(</span>PNODE<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>NODE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>pHead<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"å†…å­˜åˆ†é…å¤±è´¥ï¼\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	PNODE pTail<span class="token operator">=</span>pHead<span class="token punctuation">;</span>
	pTail<span class="token operator">-&gt;</span>pNext<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
	
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥æ‚¨éœ€è¦ç”Ÿæˆçš„é“¾è¡¨èŠ‚ç‚¹çš„ä¸ªæ•°ï¼šlen="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%è¯·è¾“å…¥ç¬¬%dä¸ªèŠ‚ç‚¹çš„å€¼"</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		PNODE pNew<span class="token operator">=</span><span class="token punctuation">(</span>PNODE<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>NODE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>pNew<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"å†…å­˜åˆ†é…å¤±è´¥ï¼\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		pNew<span class="token operator">-&gt;</span>data<span class="token operator">=</span>val<span class="token punctuation">;</span>
		pTail<span class="token operator">-&gt;</span>pNext<span class="token operator">=</span>pNew<span class="token punctuation">;</span>
		pNew<span class="token operator">-&gt;</span>pNext<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
		pTail<span class="token operator">=</span>pNew<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> pHead<span class="token punctuation">;</span>
<span class="token punctuation">}</span> 

<span class="token keyword">void</span> <span class="token function">traverseList</span><span class="token punctuation">(</span>PNODE pHead<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	PNODE p<span class="token operator">=</span>pHead<span class="token operator">-&gt;</span>pNext<span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>p<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>	
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\t"</span><span class="token punctuation">,</span>p<span class="token operator">-&gt;</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
		p<span class="token operator">=</span>p<span class="token operator">-&gt;</span>pNext<span class="token punctuation">;</span>
	<span class="token punctuation">}</span> 
<span class="token punctuation">}</span>

bool <span class="token function">isEmpty</span><span class="token punctuation">(</span>PNODE pHead<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token operator">==</span>pHead<span class="token operator">-&gt;</span>pNext<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">return</span> true<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
		<span class="token keyword">return</span> false<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">lengthList</span><span class="token punctuation">(</span>PNODE pHead<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	PNODE p<span class="token operator">=</span>pHead<span class="token operator">-&gt;</span>pNext<span class="token punctuation">;</span>
	<span class="token keyword">int</span> len<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	
	<span class="token keyword">while</span><span class="token punctuation">(</span>p<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token operator">++</span>len<span class="token punctuation">;</span>
		p<span class="token operator">=</span>p<span class="token operator">-&gt;</span>pNext<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> len<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">sortList</span><span class="token punctuation">(</span>PNODE pHead<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	PNODE p<span class="token operator">=</span>pHead<span class="token operator">-&gt;</span>pNext<span class="token punctuation">;</span>
	PNODE q<span class="token punctuation">;</span>
	
	<span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> temp<span class="token punctuation">;</span>
	<span class="token keyword">int</span> len<span class="token operator">=</span><span class="token function">lengthList</span><span class="token punctuation">(</span>pHead<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>q<span class="token operator">=</span>p<span class="token operator">-&gt;</span>pNext<span class="token punctuation">;</span>j<span class="token operator">&lt;</span>len<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>p<span class="token operator">-&gt;</span>data <span class="token operator">&gt;</span> q<span class="token operator">-&gt;</span>data<span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				temp<span class="token operator">=</span>p<span class="token operator">-&gt;</span>data<span class="token punctuation">;</span>
				p<span class="token operator">-&gt;</span>data<span class="token operator">=</span>q<span class="token operator">-&gt;</span>data<span class="token punctuation">;</span>
				q<span class="token operator">-&gt;</span>data<span class="token operator">=</span>temp<span class="token punctuation">;</span>	
			<span class="token punctuation">}</span>
			q<span class="token operator">=</span>q<span class="token operator">-&gt;</span>pNext<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		p<span class="token operator">=</span>p<span class="token operator">-&gt;</span>pNext<span class="token punctuation">;</span>
	<span class="token punctuation">}</span> 
	<span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

bool <span class="token function">insertList</span><span class="token punctuation">(</span>PNODE pHead<span class="token punctuation">,</span><span class="token keyword">int</span> pos<span class="token punctuation">,</span><span class="token keyword">int</span> val<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	PNODE p<span class="token operator">=</span>pHead<span class="token punctuation">;</span>
	
	<span class="token keyword">while</span><span class="token punctuation">(</span>p<span class="token operator">!=</span><span class="token constant">NULL</span> <span class="token operator">&amp;&amp;</span> i<span class="token operator">&lt;</span>pos<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>	<span class="token comment">//i&lt;p-1å°±æ˜¯è®©pæŒ‡å‘è¦æ’å…¥ä½ç½®çš„ä¸Šä¸€ä¸ªç»“æ„ä½“ </span>
	<span class="token punctuation">{</span>
		p<span class="token operator">=</span>p<span class="token operator">-&gt;</span>pNext<span class="token punctuation">;</span>
		i<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">&gt;</span>pos<span class="token operator">-</span><span class="token number">1</span><span class="token operator">||</span><span class="token constant">NULL</span><span class="token operator">==</span>p<span class="token punctuation">)</span>
		<span class="token keyword">return</span> false<span class="token punctuation">;</span>
	
	PNODE pNew<span class="token operator">=</span><span class="token punctuation">(</span>PNODE<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>NODE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>pNew<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"åˆ†é…å¤±è´¥ï¼\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> 
	pNew<span class="token operator">-&gt;</span>data<span class="token operator">=</span>val<span class="token punctuation">;</span>
	PNODE q<span class="token operator">=</span>p<span class="token operator">-&gt;</span>pNext<span class="token punctuation">;</span>
	p<span class="token operator">-&gt;</span>pNext<span class="token operator">=</span>pNew<span class="token punctuation">;</span>
	pNew<span class="token operator">-&gt;</span>pNext<span class="token operator">=</span>q<span class="token punctuation">;</span>
	<span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> 

bool <span class="token function">deleteList</span><span class="token punctuation">(</span>PNODE pHead<span class="token punctuation">,</span><span class="token keyword">int</span> pos<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">*</span>pVal<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	PNODE p<span class="token operator">=</span>pHead<span class="token punctuation">;</span>
	
	<span class="token keyword">while</span><span class="token punctuation">(</span>p<span class="token operator">-&gt;</span>pNext<span class="token operator">!=</span><span class="token constant">NULL</span> <span class="token operator">&amp;&amp;</span> i<span class="token operator">&lt;</span>pos<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>	<span class="token comment">//i&lt;p-1å°±æ˜¯è®©pæŒ‡å‘è¦åˆ é™¤ä½ç½®çš„ä¸Šä¸€ä¸ªç»“æ„ä½“ </span>
	<span class="token punctuation">{</span>
		p<span class="token operator">=</span>p<span class="token operator">-&gt;</span>pNext<span class="token punctuation">;</span>
		i<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">&gt;</span>pos<span class="token operator">-</span><span class="token number">1</span><span class="token operator">||</span><span class="token constant">NULL</span><span class="token operator">==</span>p<span class="token operator">-&gt;</span>pNext<span class="token punctuation">)</span>
		<span class="token keyword">return</span> false<span class="token punctuation">;</span>
	
	PNODE pNew<span class="token operator">=</span><span class="token punctuation">(</span>PNODE<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>NODE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>pNew<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"åˆ†é…å¤±è´¥ï¼\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> 
	PNODE q<span class="token operator">=</span>p<span class="token operator">-&gt;</span>pNext<span class="token punctuation">;</span>
	<span class="token operator">*</span>pVal<span class="token operator">=</span>q<span class="token operator">-&gt;</span>data<span class="token punctuation">;</span>
	p<span class="token operator">-&gt;</span>pNext<span class="token operator">=</span>p<span class="token operator">-&gt;</span>pNext<span class="token operator">-&gt;</span>pNext<span class="token punctuation">;</span>
	q<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

]]></content>
      <categories>
        <category>Cè¯­è¨€</category>
      </categories>
      <tags>
        <tag>Cè¯­è¨€</tag>
        <tag>é“¾è¡¨</tag>
      </tags>
  </entry>
  <entry>
    <title>è¿ç»­å‚¨å­˜æ•°ç»„</title>
    <url>/2022/11/13/lian-xu-chu-cun-shu-zu/</url>
    <content><![CDATA[<h1 id="ä¸€-æ•°ç»„"><a href="#ä¸€-æ•°ç»„" class="headerlink" title="ä¸€.æ•°ç»„"></a>ä¸€.æ•°ç»„</h1><ul>
<li>å­˜æ”¾ç±»å‹ç›¸åŒï¼Œå¤§å°ç›¸ç­‰çš„å…ƒç´ </li>
</ul>
<h1 id="äºŒ-ä»£ç éƒ¨åˆ†"><a href="#äºŒ-ä»£ç éƒ¨åˆ†" class="headerlink" title="äºŒ.ä»£ç éƒ¨åˆ†"></a>äºŒ.ä»£ç éƒ¨åˆ†</h1><h2 id="1-å¯¹äºä¼ å‚"><a href="#1-å¯¹äºä¼ å‚" class="headerlink" title="1.å¯¹äºä¼ å‚"></a>1.å¯¹äºä¼ å‚</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>

<span class="token keyword">struct</span> <span class="token class-name">Arr</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> <span class="token operator">*</span>pBase<span class="token punctuation">;</span>	<span class="token comment">//å­˜å‚¨çš„æ˜¯æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„åœ°å€ </span>
	<span class="token keyword">int</span> len<span class="token punctuation">;</span>	<span class="token comment">//æ•°ç»„æ‰€èƒ½å®¹çº³çš„æœ€å¤§å…ƒç´ çš„ä¸ªæ•° </span>
	<span class="token keyword">int</span> cnt<span class="token punctuation">;</span>	<span class="token comment">//å½“å‰æ•°ç»„æœ‰æ•ˆå…ƒç´ çš„ä¸ªæ•° </span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">initArr</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Arr</span> <span class="token operator">*</span>pArr<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">struct</span> <span class="token class-name">Arr</span> arr<span class="token punctuation">;</span>
	
	<span class="token function">initArr</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>				<span class="token comment">//åœ°å€åªç”¨ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åœ°å€è¡¨ç¤ºï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚çš„åœ°å€å 4ä¸ªå­—èŠ‚ </span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>arr<span class="token punctuation">.</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">initArr</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Arr</span> <span class="token operator">*</span>pArr<span class="token punctuation">)</span>	<span class="token comment">//æ­¤æ—¶æŒ‡å‘arrçš„ç¬¬ä¸€ä¸ªåœ°å€ï¼Œç°åœ¨pArrå­˜æ”¾çš„æ˜¯arrç¬¬ä¸€ä¸ªå­—èŠ‚çš„åœ°å€ </span>
<span class="token punctuation">{</span>
	<span class="token punctuation">(</span><span class="token operator">*</span>pArr<span class="token punctuation">)</span><span class="token punctuation">.</span>len<span class="token operator">=</span><span class="token number">99</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token function">initArr</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
å¯¹äºè¿™ä¸€è¡Œï¼Œå¦‚æœå†™çš„æ˜¯ğŸ‘‡
initArr(arr);
åœ¨å®šä¹‰å˜é‡æ—¶ä¼ å‚ä¼ çš„æ˜¯(struct Arr array)
æ­¤æ—¶è¿”å›åˆ°ä¸»å‡½æ•°é‡Œçš„arrçš„lenæ˜¯åƒåœ¾å€¼ï¼Œå› ä¸ºæ˜¯é™æ€åˆ†é…å†…å­˜ï¼Œå½“è°ƒç”¨å®ŒinitArrä¹‹åä¼ å‚çš„å°±ä¸å­˜åœ¨äº†
æ‰€ä»¥è¦ç”¨åˆ°"&amp;arr"ï¼Œå°†æŒ‡é’ˆçš„åœ°å€ä¼ ç»™initArrä¸­
é‚£ä¹ˆåœ¨initArrå‡½æ•°é‡Œï¼Œ*pArrå°±æ˜¯arr
è¿™æ ·åšçš„ä¼˜ç‚¹ï¼šå¯¹æ¯”ç”¨arrä¼ å‚(éœ€è¦ç”¨åˆ°12ä¸ªå­—èŠ‚)ï¼Œè¿™æ ·å­ä¼ å‚çœç©ºé—´(arrçš„ç¬¬ä¸€ä¸ªåœ°å€åªå 4ä¸ªå­—èŠ‚)
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="2-å¯¹ç»“æ„ä½“çš„ç†è§£"><a href="#2-å¯¹ç»“æ„ä½“çš„ç†è§£" class="headerlink" title="2.å¯¹ç»“æ„ä½“çš„ç†è§£"></a>2.å¯¹ç»“æ„ä½“çš„ç†è§£</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">struct</span> <span class="token class-name">Arr</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> <span class="token operator">*</span>pBase<span class="token punctuation">;</span>	<span class="token comment">//å­˜å‚¨çš„æ˜¯æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„åœ°å€ </span>
	<span class="token keyword">int</span> len<span class="token punctuation">;</span>	<span class="token comment">//æ•°ç»„æ‰€èƒ½å®¹çº³çš„æœ€å¤§å…ƒç´ çš„ä¸ªæ•° </span>
	<span class="token keyword">int</span> cnt<span class="token punctuation">;</span>	<span class="token comment">//å½“å‰æ•°ç»„æœ‰æ•ˆå…ƒç´ çš„ä¸ªæ•° </span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ğŸ‘‰å› ä¸ºæ•°ç»„åå°±æ˜¯æ•°ç»„é¦–åœ°å€å…ƒç´ ï¼Œæ‰€ä»¥åœ¨å®šä¹‰*<em>int <em>pBase</em></em> æ—¶ï¼ŒpBaseæ˜¯æŒ‡é’ˆå˜é‡ï¼Œä¹Ÿå°±æ˜¯åœ°å€ï¼ŒåŒæ—¶å®ƒæ˜¯ä¸€ä¸ªæ•°ç»„å</p>
<p>ğŸ‘‰å…¶å®ä¹Ÿå¯ä»¥ç†è§£ä¸ºï¼Œè¿™ä¸ªç»“æ„ä½“ï¼Œä¸»ä½“éƒ¨åˆ†æ˜¯pBaseï¼Œå…¶ä»–æˆå‘˜æ˜¯è¿™ä¸ªæ•°ç»„çš„ä¸€äº›å±æ€§çš„è¯´æ˜</p>
<p>ğŸ‘‰ä¸ºäº†æŠŠè¿™äº›å±æ€§å’Œæ•°ç»„ä¸»ä½“è”ç³»èµ·æ¥ï¼Œæäº†ä¸€ä¸ªç»“æ„ä½“æŠŠå®ƒä»¬æ”¾åœ¨ä¸€èµ·</p>
<h2 id="3-åˆå§‹åŒ–"><a href="#3-åˆå§‹åŒ–" class="headerlink" title="3.åˆå§‹åŒ–"></a>3.åˆå§‹åŒ–</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">initArr</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Arr</span> <span class="token operator">*</span>pArr<span class="token punctuation">,</span><span class="token keyword">int</span> length<span class="token punctuation">)</span><span class="token comment">//æ­¤æ—¶æŒ‡å‘arrçš„ç¬¬ä¸€ä¸ªåœ°å€ï¼Œç°åœ¨pArrå­˜æ”¾çš„æ˜¯arrç¬¬ä¸€ä¸ªå­—èŠ‚çš„åœ°å€ </span>
<span class="token punctuation">{</span>
	pArr<span class="token operator">-&gt;</span>pBase<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">*</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token operator">==</span>pArr<span class="token operator">-&gt;</span>pBase<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"åŠ¨æ€å†…å­˜åˆ†é…å¤±è´¥ï¼\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{</span>
		pArr<span class="token operator">-&gt;</span>len<span class="token operator">=</span>length<span class="token punctuation">;</span>
		pArr<span class="token operator">-&gt;</span>cnt<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span><span class="token punctuation">;</span><span class="token comment">//å‘Šè¯‰ç¨‹åºè¿™ä¸ªå‡½æ•°ç»“æŸäº† </span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ğŸ‘‰pBaseæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…ˆç»™ä»–åˆ†é…ç©ºé—´</p>
<ul>
<li>å¯¹pBaseå†…å­˜æ˜¯å¦åˆ†é…æˆåŠŸè¦åšä¸€ä¸ªåˆ¤å®š</li>
<li>åˆ¤å®šæˆåŠŸäº†å°±ç»™ä»–è¿™ä¸ªç»“æ„ä½“èµ‹å€¼</li>
</ul>
<h2 id="4-æ‰“å°"><a href="#4-æ‰“å°" class="headerlink" title="4.æ‰“å°"></a>4.æ‰“å°</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">showArr</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Arr</span> <span class="token operator">*</span>pArr<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>pArr<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"æ•°ç»„ä¸ºç©ºï¼\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>pArr<span class="token operator">-&gt;</span>cnt<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span>pArr<span class="token operator">-&gt;</span>pBase<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
			
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="5-åˆ¤æ–­æ•°ç»„é‡Œæ˜¯å¦æœ‰å…ƒç´ "><a href="#5-åˆ¤æ–­æ•°ç»„é‡Œæ˜¯å¦æœ‰å…ƒç´ " class="headerlink" title="5.åˆ¤æ–­æ•°ç»„é‡Œæ˜¯å¦æœ‰å…ƒç´ "></a>5.åˆ¤æ–­æ•°ç»„é‡Œæ˜¯å¦æœ‰å…ƒç´ </h2><pre class="line-numbers language-c" data-language="c"><code class="language-c">bool <span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Arr</span> <span class="token operator">*</span>pArr<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>pArr<span class="token operator">-&gt;</span>cnt<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> true<span class="token punctuation">;</span>
	<span class="token keyword">else</span>
		<span class="token keyword">return</span> false<span class="token punctuation">;</span>	
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="6-åˆ¤æ–­æ•°ç»„æ˜¯å¦æ˜¯æ»¡çš„"><a href="#6-åˆ¤æ–­æ•°ç»„æ˜¯å¦æ˜¯æ»¡çš„" class="headerlink" title="6.åˆ¤æ–­æ•°ç»„æ˜¯å¦æ˜¯æ»¡çš„"></a>6.åˆ¤æ–­æ•°ç»„æ˜¯å¦æ˜¯æ»¡çš„</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c">bool <span class="token function">isFull</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Arr</span> <span class="token operator">*</span>pArr<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>pArr<span class="token operator">-&gt;</span>cnt<span class="token operator">==</span>pArr<span class="token operator">-&gt;</span>len<span class="token punctuation">)</span>
		<span class="token keyword">return</span> true<span class="token punctuation">;</span>
	<span class="token keyword">else</span>
		<span class="token keyword">return</span> false<span class="token punctuation">;</span>	
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="7-è¿½åŠ å…ƒç´ "><a href="#7-è¿½åŠ å…ƒç´ " class="headerlink" title="7.è¿½åŠ å…ƒç´ "></a>7.è¿½åŠ å…ƒç´ </h2><pre class="line-numbers language-c" data-language="c"><code class="language-c">bool <span class="token function">appendArr</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Arr</span> <span class="token operator">*</span>pArr<span class="token punctuation">,</span><span class="token keyword">int</span> val<span class="token punctuation">)</span><span class="token comment">//valæ˜¯è¦åŠ å…¥çš„å…ƒç´ </span>
<span class="token punctuation">{</span>
	<span class="token comment">//æ»¡æ—¶è¿”å›falseï¼Œä¸åŠ </span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isFull</span><span class="token punctuation">(</span>pArr<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> false<span class="token punctuation">;</span>
	<span class="token comment">//ä¸æ»¡æ—¶è¿½åŠ </span>
	pArr<span class="token operator">-&gt;</span>pBase<span class="token punctuation">[</span>pArr<span class="token operator">-&gt;</span>cnt<span class="token punctuation">]</span><span class="token operator">=</span>val<span class="token punctuation">;</span> 
	<span class="token punctuation">(</span>pArr<span class="token operator">-&gt;</span>cnt<span class="token punctuation">)</span><span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ğŸ‘‰cntçš„å€¼=æœ€åä¸€ä¸ªå…ƒç´ çš„ä¸‹æ ‡+1</p>
<p>ğŸ‘‰æœ€åè®°å¾—è¦ç»™æœ‰æ•ˆå€¼+1</p>
<h2 id="8-æ’å…¥å…ƒç´ "><a href="#8-æ’å…¥å…ƒç´ " class="headerlink" title="8.æ’å…¥å…ƒç´ "></a>8.æ’å…¥å…ƒç´ </h2><pre class="line-numbers language-c" data-language="c"><code class="language-c">bool <span class="token function">insertArr</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Arr</span> <span class="token operator">*</span>pArr<span class="token punctuation">,</span><span class="token keyword">int</span> pos<span class="token punctuation">,</span><span class="token keyword">int</span> val<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> i<span class="token punctuation">;</span>
	
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isFull</span><span class="token punctuation">(</span>pArr<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> false<span class="token punctuation">;</span>
	
	<span class="token keyword">if</span><span class="token punctuation">(</span>pos<span class="token operator">&lt;</span><span class="token number">1</span><span class="token operator">||</span>pos<span class="token operator">&gt;</span>pArr<span class="token operator">-&gt;</span>cnt<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> false<span class="token punctuation">;</span>
	 
	<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span>pArr<span class="token operator">-&gt;</span>cnt<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&gt;=</span>pos<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token operator">--</span>i<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		pArr<span class="token operator">-&gt;</span>pBase<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>pArr<span class="token operator">-&gt;</span>pBase<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	pArr<span class="token operator">-&gt;</span>pBase<span class="token punctuation">[</span>pos<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>val<span class="token punctuation">;</span>
	<span class="token punctuation">(</span>pArr<span class="token operator">-&gt;</span>cnt<span class="token punctuation">)</span><span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> true<span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>æ»¡äº†ã€è¾“å…¥çš„ä½ç½®ä¸ç¬¦åˆæ•°ç»„ç°æœ‰çš„â†’è¿”å›é”™è¯¯ï¼Œåœ¨ä¸»ç¨‹åºé‡Œä¸æ‰§è¡Œ</li>
</ul>
<p>ğŸ‘‰å¯¹äºforé‡Œçš„</p>
<ul>
<li><strong>i=pArr-&gt;cnt-1</strong> iå¯¹åº”ç€ä¸‹æ ‡</li>
<li><strong>i=pos-1</strong> æ’å…¥æ—¶åªå˜åŠ¨è¦æ’å…¥ä½ç½®çš„è¯¥ä½ä¸Šå’Œè¯¥ä½åçš„å…ƒç´ </li>
<li><strong>â€“i</strong> è¿›è¡Œæ’å…¥çš„é€»è¾‘æ˜¯ï¼Œå…ˆå¯¹æœ€åä¸€ä½æ“ä½œï¼Œæœ€åä¸€ä½å…ˆå¾€åç§»åŠ¨ï¼Œç„¶åå‰é¢çš„å†å¾€åç§»åŠ¨ï¼Œæœ€åç©ºå‡ºä¸€ä¸ªä½ç½®ç»™è¦æ’å…¥çš„å…ƒç´ æ’å…¥</li>
</ul>
<p>ğŸ‘‰ç„¶å</p>
<ul>
<li><p>å‰ä¸€ä¸ªå…ƒç´ ç§»åŠ¨åˆ°åä¸€ä¸ªå…ƒç´ ä¸Š</p>
</li>
<li><p>æ”¾ç½®æ–°å…ƒç´ </p>
</li>
<li><p>æœ‰æ•ˆå€¼+1</p>
</li>
</ul>
<h2 id="9-åˆ é™¤å…ƒç´ "><a href="#9-åˆ é™¤å…ƒç´ " class="headerlink" title="9.åˆ é™¤å…ƒç´ "></a>9.åˆ é™¤å…ƒç´ </h2><pre class="line-numbers language-c" data-language="c"><code class="language-c">bool <span class="token function">deleteArr</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Arr</span> <span class="token operator">*</span>pArr<span class="token punctuation">,</span><span class="token keyword">int</span> pos<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">*</span>pVal<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> i<span class="token punctuation">;</span> 
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>pArr<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> false<span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>pos<span class="token operator">&lt;</span><span class="token number">1</span><span class="token operator">||</span>pos<span class="token operator">&gt;</span>pArr<span class="token operator">-&gt;</span>cnt<span class="token punctuation">)</span>
		<span class="token keyword">return</span> false<span class="token punctuation">;</span>
		
	<span class="token operator">*</span>pVal<span class="token operator">=</span>pArr<span class="token operator">-&gt;</span>pBase<span class="token punctuation">[</span>pos<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span>pos<span class="token punctuation">;</span>i<span class="token operator">&lt;</span>pArr<span class="token operator">-&gt;</span>cnt<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		pArr<span class="token operator">-&gt;</span>pBase<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>pArr<span class="token operator">-&gt;</span>pBase<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	pArr<span class="token operator">-&gt;</span>cnt<span class="token operator">--</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> true<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>ç©ºçš„ã€è¾“å…¥ä¸ç¬¦åˆæ•°ç»„ç°æœ‰çš„â†’è¿”å›é”™è¯¯ï¼Œå†ä¸»ç¨‹åºä¸­ä¸æ‰§è¡Œ</li>
</ul>
<p>æ„Ÿè§‰è·Ÿæ’å…¥ä¸€ä¸ªæ„æ€â€¦.</p>
<h2 id="10-å…ƒç´ å€’ç½®"><a href="#10-å…ƒç´ å€’ç½®" class="headerlink" title="10.å…ƒç´ å€’ç½®"></a>10.å…ƒç´ å€’ç½®</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">inversionArr</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Arr</span> <span class="token operator">*</span>pArr<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> j<span class="token operator">=</span>pArr<span class="token operator">-&gt;</span>cnt<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> t<span class="token punctuation">;</span>
	
	<span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;</span>j<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		t<span class="token operator">=</span>pArr<span class="token operator">-&gt;</span>pBase<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		pArr<span class="token operator">-&gt;</span>pBase<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>pArr<span class="token operator">-&gt;</span>pBase<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
		pArr<span class="token operator">-&gt;</span>pBase<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>t<span class="token punctuation">;</span>
		i<span class="token operator">++</span><span class="token punctuation">;</span>
		j<span class="token operator">--</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="11-å…ƒç´ æ’åº"><a href="#11-å…ƒç´ æ’åº" class="headerlink" title="11.å…ƒç´ æ’åº"></a>11.å…ƒç´ æ’åº</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">sortArr</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Arr</span><span class="token operator">*</span> pArr<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>t<span class="token punctuation">;</span>
	
	<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>pArr<span class="token operator">-&gt;</span>cnt<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>pArr<span class="token operator">-&gt;</span>cnt<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			t<span class="token operator">=</span>pArr<span class="token operator">-&gt;</span>pBase<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
			pArr<span class="token operator">-&gt;</span>pBase<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>pArr<span class="token operator">-&gt;</span>pBase<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
			pArr<span class="token operator">-&gt;</span>pBase<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>t<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

]]></content>
      <categories>
        <category>Cè¯­è¨€</category>
      </categories>
      <tags>
        <tag>Cè¯­è¨€</tag>
        <tag>æ•°ç»„</tag>
        <tag>æŒ‡é’ˆ</tag>
      </tags>
  </entry>
</search>
